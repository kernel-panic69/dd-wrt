diff -urpN freeradius-server-3.2.7/.github/workflows/ci-deb.yml freeradius-server-3.2.8/.github/workflows/ci-deb.yml
--- freeradius-server-3.2.7/.github/workflows/ci-deb.yml	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/.github/workflows/ci-deb.yml	2025-08-20 23:29:15.000000000 +0700
@@ -19,9 +19,9 @@ jobs:
           - { NAME: "ubuntu-20.04", OS: "ubuntu:20.04" }
           - { NAME: "ubuntu-22.04", OS: "ubuntu:22.04" }
           - { NAME: "ubuntu-24.04", OS: "ubuntu:24.04" }
-          - { NAME: "debian-10",    OS: "debian:buster" }
           - { NAME: "debian-11",    OS: "debian:bullseye" }
           - { NAME: "debian-12",    OS: "debian:bookworm" }
+          - { NAME: "debian-13",    OS: "debian:trixie" }
           - { NAME: "debian-sid",   OS: "debian:sid" }
       fail-fast: false
 
@@ -142,9 +142,9 @@ jobs:
           - { NAME: "ubuntu-20.04", OS: "ubuntu:20.04" }
           - { NAME: "ubuntu-22.04", OS: "ubuntu:22.04" }
           - { NAME: "ubuntu-24.04", OS: "ubuntu:24.04" }
-          - { NAME: "debian-10", OS: "debian:buster" }
           - { NAME: "debian-11", OS: "debian:bullseye" }
           - { NAME: "debian-12", OS: "debian:bookworm" }
+          - { NAME: "debian-13", OS: "debian:trixie" }
           - { NAME: "debian-sid", OS: "debian:sid" }
       fail-fast: false
 
diff -urpN freeradius-server-3.2.7/.github/workflows/ci-rpm.yml freeradius-server-3.2.8/.github/workflows/ci-rpm.yml
--- freeradius-server-3.2.7/.github/workflows/ci-rpm.yml	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/.github/workflows/ci-rpm.yml	2025-08-20 23:29:15.000000000 +0700
@@ -17,6 +17,7 @@ jobs:
         env:
           - { NAME: "rocky-8",   OS: "rockylinux/rockylinux:8" }
           - { NAME: "rocky-9",   OS: "rockylinux/rockylinux:9" }
+          - { NAME: "rocky-10",  OS: "rockylinux/rockylinux:10" }
       fail-fast: false
 
     runs-on: ubuntu-latest
@@ -71,8 +72,8 @@ jobs:
         dnf config-manager --enable PowerTools || :
         dnf config-manager --enable powertools || :
 
-    - name: Enable Code Ready Builer on Rocky 9.
-      if: ${{ matrix.env.NAME == 'rocky-9' }}
+    - name: Enable Code Ready Builer on Rocky 9 / 10.
+      if: ${{ matrix.env.NAME == 'rocky-9' || matrix.env.NAME == 'rocky-10' }}
       run: |
         dnf install -y yum-utils
         dnf config-manager --enable crb
@@ -182,6 +183,7 @@ jobs:
         env:
           - { NAME: "rocky-8",   OS: "rockylinux/rockylinux:8" }
           - { NAME: "rocky-9",   OS: "rockylinux/rockylinux:9" }
+          - { NAME: "rocky-10",  OS: "rockylinux/rockylinux:10" }
       fail-fast: false
 
     runs-on: ubuntu-latest
@@ -216,8 +218,8 @@ jobs:
         dnf config-manager --enable PowerTools || :
         dnf config-manager --enable powertools || :
 
-    - name: Enable Code Ready Builer on Rocky 9.
-      if: ${{ matrix.env.NAME == 'rocky-9' }}
+    - name: Enable Code Ready Builer on Rocky 9 / 10.
+      if: ${{ matrix.env.NAME == 'rocky-9' || matrix.env.NAME == 'rocky-10' }}
       run: |
         dnf install -y yum-utils
         dnf config-manager --enable crb
diff -urpN freeradius-server-3.2.7/.github/workflows/ci.yml freeradius-server-3.2.8/.github/workflows/ci.yml
--- freeradius-server-3.2.7/.github/workflows/ci.yml	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/.github/workflows/ci.yml	2025-08-20 23:29:15.000000000 +0700
@@ -152,9 +152,10 @@ jobs:
         libnl-genl-3-dev \
         libpam0g-dev \
         libpcap-dev \
-        libpcre3-dev \
+        libpcre2-dev \
         libperl-dev \
         libpq-dev \
+        librdkafka-dev \
         libreadline-dev \
         libruby \
         libsnmp-dev \
@@ -270,6 +271,8 @@ jobs:
             # memory leak in rlm_{ldap,rest} and problems in perl+llvm
             rm -rf src/tests/modules/ldap/
             rm -rf src/tests/modules/rest/
+            # Spurious leak that is not detected with "-m", i.e. not calling dlclose on the module
+            rm -rf src/tests/modules/kafka/
         else
             enable_sanitizers=""
             extra_cflags=""
diff -urpN freeradius-server-3.2.7/.github/workflows/crossbuild.yml freeradius-server-3.2.8/.github/workflows/crossbuild.yml
--- freeradius-server-3.2.7/.github/workflows/crossbuild.yml	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/.github/workflows/crossbuild.yml	2025-08-20 23:29:15.000000000 +0700
@@ -45,7 +45,7 @@ jobs:
     needs:
       - gen-matrix
 
-    runs-on: ubuntu-20.04
+    runs-on: ubuntu-latest
 
     strategy:
       fail-fast: false
diff -urpN freeradius-server-3.2.7/.github/workflows/docker.yml freeradius-server-3.2.8/.github/workflows/docker.yml
--- freeradius-server-3.2.7/.github/workflows/docker.yml	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/.github/workflows/docker.yml	2025-08-20 23:29:15.000000000 +0700
@@ -45,7 +45,7 @@ jobs:
     needs:
       - gen-matrix
 
-    runs-on: ubuntu-20.04
+    runs-on: ubuntu-latest
 
     strategy:
       fail-fast: false
diff -urpN freeradius-server-3.2.7/.github/workflows/dockerhub-dev.yml freeradius-server-3.2.8/.github/workflows/dockerhub-dev.yml
--- freeradius-server-3.2.7/.github/workflows/dockerhub-dev.yml	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/.github/workflows/dockerhub-dev.yml	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,111 @@
+name: Dockerhub Dev
+
+on:
+  push:
+    branches-ignore:
+      - coverity_scan
+  workflow_dispatch:
+
+env:
+  CI: 1
+  GH_ACTIONS: 1
+  DEBIAN_FRONTEND: noninteractive
+  APT_OPTS: "-y --no-install-recommends"
+  DOCKER_REPOSITORY: freeradius-dev
+  BRANCH: v3.2.x
+
+jobs:
+  #
+  #  Run docker target for each given OS and ARCH. This will
+  #  build the Docker images.
+  #
+  build_docker_images:
+    runs-on: ubuntu-24.04
+    if: github.repository_owner == 'FreeRADIUS'
+
+    strategy:
+      matrix:
+        env:
+          - { OS: "ubuntu", ARCH: "linux/amd64",    NAME: "amd64" }
+          - { OS: "ubuntu", ARCH: "linux/arm/v7",   NAME: "armv7" }
+          - { OS: "ubuntu", ARCH: "linux/arm64/v8", NAME: "arm64v8" }
+          - { OS: "alpine", ARCH: "linux/amd64",    NAME: "amd64" }
+          - { OS: "alpine", ARCH: "linux/arm/v6",   NAME: "armv6" }
+          - { OS: "alpine", ARCH: "linux/arm/v7",   NAME: "armv7" }
+          - { OS: "alpine", ARCH: "linux/arm64/v8", NAME: "arm64v8" }
+
+      fail-fast: false
+
+    name: "${{ matrix.env.OS }}-${{ matrix.env.ARCH }}"
+
+    steps:
+
+    - uses: actions/checkout@v4
+      with:
+        fetch-depth: 1
+
+    - name: Regenerate Dockerfiles
+      run: |
+        rm scripts/docker/dists/*/Dockerfile || true
+        make docker.regen
+
+    - name: Install qemu
+      run: |
+        sudo apt-get update
+        sudo apt-get install ${APT_OPTS} qemu-user-static
+
+    - name: Build docker image
+      run: |
+        make docker-${{ matrix.env.OS }} \
+          DOCKER_TAG="$DOCKER_REPOSITORY" \
+          DOCKER_BUILD_ARGS="--no-cache --platform ${{ matrix.env.ARCH }}" \
+          DOCKER_VERSION="${{ matrix.env.NAME }}-$BRANCH"
+
+    - name: Docker login
+      uses: docker/login-action@v3
+      with:
+        username: ${{ secrets.DOCKERHUB_USERNAME }}
+        password: ${{ secrets.DOCKERHUB_PASSWORD }}
+
+    - name: Push arch image to Docker registry
+      shell: bash
+      run: |
+        make docker-push-${{ matrix.env.OS }} \
+          DOCKER_TAG="$DOCKER_REPOSITORY" \
+          DOCKER_VERSION="${{ matrix.env.NAME }}-$BRANCH"
+
+
+  manifest:
+    runs-on: ubuntu-24.04
+    needs: build_docker_images
+    if: github.repository_owner == 'FreeRADIUS'
+
+    strategy:
+      matrix:
+        env:
+          - { OS: "ubuntu", ARCHS: "amd64 armv7 arm64v8", SUFFIX: "" }
+          - { OS: "alpine", ARCHS: "amd64 armv6 armv7 arm64v8", SUFFIX: "-alpine" }
+
+      fail-fast: false
+
+    name: "manifest-${{ matrix.env.OS }}"
+
+    steps:
+
+    - uses: actions/checkout@v4
+      with:
+        fetch-depth: 1
+
+    - name: Docker login
+      uses: docker/login-action@v3
+      with:
+        username: ${{ secrets.DOCKERHUB_USERNAME }}
+        password: ${{ secrets.DOCKERHUB_PASSWORD }}
+
+    - name: Create manifests
+      shell: bash
+      run: |
+        make docker-ci-manifest \
+          DOCKER_TAG="$DOCKER_REPOSITORY" \
+          DOCKER_VERSION="$BRANCH${{ matrix.env.SUFFIX }}" \
+          DOCKER_ARCHS="${{ matrix.env.ARCHS }}"
diff -urpN freeradius-server-3.2.7/.github/workflows/dockerhub-releases.yml freeradius-server-3.2.8/.github/workflows/dockerhub-releases.yml
--- freeradius-server-3.2.7/.github/workflows/dockerhub-releases.yml	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/.github/workflows/dockerhub-releases.yml	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,221 @@
+name: Dockerhub Releases
+
+on:
+# Rebuild on new release tag...
+  push:
+    tags:
+      - 'release_3_2_*'
+# ...weekly (to keep docker base OS up-to-date)...
+  schedule:
+    - cron: '30 4 * * 1'
+# ...or when manually triggered.
+  workflow_dispatch:
+
+
+# Don't run more than one build at the same time
+concurrency:
+  group: dockerhub-releases-v3.2.x
+
+
+env:
+  CI: 1
+  GH_ACTIONS: 1
+  DEBIAN_FRONTEND: noninteractive
+  APT_OPTS: "-y --no-install-recommends"
+  DOCKER_TAG: "freeradius-test"
+  BRANCH: v3.2.x
+
+
+jobs:
+
+  #
+  #  Get list of releases to rebuild
+  #
+  get_release_tags:
+    runs-on: ubuntu-latest
+
+    outputs:
+      matrix: ${{ steps.gen-matrix.outputs.matrix }}
+      latest_tag: ${{ steps.gen-matrix.outputs.tag }}
+      latest_ver: ${{ steps.gen-matrix.outputs.version }}
+
+    steps:
+
+    - uses: actions/checkout@v4
+      with:
+        fetch-depth: 0
+        lfs: false
+
+    - id: gen-matrix
+      name: Generate matrix based on recent release tags
+      run: |
+        TAGS=$(git ls-remote --tags --sort=-committerdate origin 'release_3_2_*' | head -2 | cut -d/ -f3)
+        echo "Tags: $TAGS"
+        M=$(echo "$TAGS" | perl -n -e '{chomp; $Q=$_; s/release_//; s/_/./g; push @L,"\"TAG\":\"$Q\",\"VER\":\"$_\""} END{print "[{",join("},{",@L),"}]"}')
+        T=$(git describe --abbrev=0 --tags)
+        V=$(echo "$T" | perl -pe 's/release_//; s/_/./g')
+        echo "Matrix: $M"
+        echo "Latest tag: $T"
+        echo "Latest version: $V"
+        echo "matrix=$M" >> $GITHUB_OUTPUT
+        echo "tag=$T" >> $GITHUB_OUTPUT
+        echo "version=$V" >> $GITHUB_OUTPUT
+
+
+  #
+  #  Run docker target for each given OS and ARCH. This will
+  #  build the Docker images.
+  #
+  build_docker_images:
+    needs:
+      - get_release_tags
+
+    runs-on: ubuntu-24.04
+    if: github.repository_owner == 'FreeRADIUS'
+
+    strategy:
+      matrix:
+        tag: ${{ fromJson(needs.get_release_tags.outputs.matrix) }}
+        env:
+          - { OS: "ubuntu", ARCH: "linux/amd64",    NAME: "amd64" }
+          - { OS: "ubuntu", ARCH: "linux/arm/v7",   NAME: "armv7" }
+          - { OS: "ubuntu", ARCH: "linux/arm64/v8", NAME: "arm64v8" }
+          - { OS: "alpine", ARCH: "linux/amd64",    NAME: "amd64" }
+          - { OS: "alpine", ARCH: "linux/arm/v6",   NAME: "armv6" }
+          - { OS: "alpine", ARCH: "linux/arm/v7",   NAME: "armv7" }
+          - { OS: "alpine", ARCH: "linux/arm64/v8", NAME: "arm64v8" }
+
+      fail-fast: false
+
+    name: "${{ matrix.tag.TAG }}-${{ matrix.env.OS }}-${{ matrix.env.ARCH }}"
+
+    steps:
+
+    - uses: actions/checkout@v4
+      with:
+        fetch-depth: 0
+
+    - name: Regenerate Dockerfiles
+      run: |
+        rm scripts/docker/dists/*/Dockerfile || true
+        make docker.regen
+
+    - name: Install qemu
+      run: |
+        sudo apt-get update
+        sudo apt-get install ${APT_OPTS} qemu-user-static
+
+    - name: Build docker image
+      run: |
+        make docker-${{ matrix.env.OS }} \
+          DOCKER_COMMIT="${{ matrix.tag.TAG }}" \
+          DOCKER_BUILD_ARGS="--no-cache --platform ${{ matrix.env.ARCH }}" \
+          DOCKER_TAG="$DOCKER_TAG" \
+          DOCKER_VERSION="${{ matrix.env.NAME }}-${{ matrix.tag.VER }}"
+
+    - name: Docker login
+      uses: docker/login-action@v3
+      with:
+        username: ${{ secrets.DOCKERHUB_USERNAME }}
+        password: ${{ secrets.DOCKERHUB_PASSWORD }}
+
+    - name: Push arch image to Docker registry
+      shell: bash
+      run: |
+        make docker-push-${{ matrix.env.OS }} \
+          DOCKER_TAG="$DOCKER_TAG" \
+          DOCKER_VERSION="${{ matrix.env.NAME }}-${{ matrix.tag.VER }}"
+
+
+  manifest:
+    needs:
+      - get_release_tags
+      - build_docker_images
+
+    runs-on: ubuntu-latest
+    if: github.repository_owner == 'FreeRADIUS'
+
+    strategy:
+      matrix:
+        tag: ${{ fromJson(needs.get_release_tags.outputs.matrix) }}
+        env:
+          - { OS: "ubuntu", ARCHS: "amd64 armv7 arm64v8", SUFFIX: "" }
+          - { OS: "alpine", ARCHS: "amd64 armv6 armv7 arm64v8", SUFFIX: "-alpine" }
+
+      fail-fast: false
+
+    name: "manifest-${{ matrix.tag.VER }}-${{ matrix.env.OS }}"
+
+    steps:
+
+    - uses: actions/checkout@v4
+      with:
+        fetch-depth: 1
+
+    - name: Docker login
+      uses: docker/login-action@v3
+      with:
+        username: ${{ secrets.DOCKERHUB_USERNAME }}
+        password: ${{ secrets.DOCKERHUB_PASSWORD }}
+
+    - name: Create manifests
+      shell: bash
+      run: |
+        make docker-ci-manifest \
+          DOCKER_TAG="$DOCKER_TAG" \
+          DOCKER_VERSION="${{ matrix.tag.VER }}${{ matrix.env.SUFFIX }}" \
+          DOCKER_ARCHS="${{ matrix.env.ARCHS }}"
+
+
+  #
+  #  Create/update manifest for latest version
+  #
+  #  This maintains the 'latest', 'latest-alpine', 'latest-3.2' and 'latest-3.2-alpine' image tags
+  #
+  latest_manifest:
+    needs:
+      - get_release_tags
+      - build_docker_images
+
+    runs-on: ubuntu-latest
+    if: github.repository_owner == 'FreeRADIUS'
+
+    strategy:
+      matrix:
+        env:
+          - { OS: "ubuntu", ARCHS: "amd64 armv7 arm64v8", SUFFIX: "" }
+          - { OS: "alpine", ARCHS: "amd64 armv6 armv7 arm64v8", SUFFIX: "-alpine" }
+
+      fail-fast: false
+
+    name: "manifest-${{ matrix.env.OS }}-latest"
+
+    steps:
+
+    - uses: actions/checkout@v4
+      with:
+        fetch-depth: 1
+
+    - name: Docker login
+      uses: docker/login-action@v3
+      with:
+        username: ${{ secrets.DOCKERHUB_USERNAME }}
+        password: ${{ secrets.DOCKERHUB_PASSWORD }}
+
+    - name: Create 'latest' manifests
+      shell: bash
+      run: |
+        make docker-ci-manifest \
+          DOCKER_TAG="$DOCKER_TAG" \
+          DOCKER_VERSION="${{ needs.get_release_tags.outputs.latest_ver }}${{ matrix.env.SUFFIX }}" \
+          DOCKER_MANIFEST_VERSION="latest${{ matrix.env.SUFFIX }}" \
+          DOCKER_ARCHS="${{ matrix.env.ARCHS }}"
+
+    - name: Create 'latest-3.2' manifests
+      shell: bash
+      run: |
+        make docker-ci-manifest \
+          DOCKER_TAG="$DOCKER_TAG" \
+          DOCKER_VERSION="${{ needs.get_release_tags.outputs.latest_ver }}${{ matrix.env.SUFFIX }}" \
+          DOCKER_MANIFEST_VERSION="latest-3.2${{ matrix.env.SUFFIX }}" \
+          DOCKER_ARCHS="${{ matrix.env.ARCHS }}"
diff -urpN freeradius-server-3.2.7/.github/workflows/dockerhub.yml freeradius-server-3.2.8/.github/workflows/dockerhub.yml
--- freeradius-server-3.2.7/.github/workflows/dockerhub.yml	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/.github/workflows/dockerhub.yml	1970-01-01 07:00:00.000000000 +0700
@@ -1,111 +0,0 @@
-name: Dockerhub Dev
-
-on:
-  push:
-    branches-ignore:
-      - coverity_scan
-  workflow_dispatch:
-
-env:
-  CI: 1
-  GH_ACTIONS: 1
-  DEBIAN_FRONTEND: noninteractive
-  APT_OPTS: "-y --no-install-recommends"
-  DOCKER_REPOSITORY: freeradius-dev
-  BRANCH: v3.2.x
-
-jobs:
-  #
-  #  Run docker target for each given OS and ARCH. This will
-  #  build the Docker images.
-  #
-  build_docker_images:
-    runs-on: ubuntu-22.04
-    if: github.repository_owner == 'FreeRADIUS'
-
-    strategy:
-      matrix:
-        env:
-          - { OS: "ubuntu", ARCH: "linux/amd64",    NAME: "amd64" }
-          - { OS: "ubuntu", ARCH: "linux/arm/v7",   NAME: "armv7" }
-          - { OS: "ubuntu", ARCH: "linux/arm64/v8", NAME: "arm64v8" }
-          - { OS: "alpine", ARCH: "linux/amd64",    NAME: "amd64" }
-          - { OS: "alpine", ARCH: "linux/arm/v6",   NAME: "armv6" }
-          - { OS: "alpine", ARCH: "linux/arm/v7",   NAME: "armv7" }
-          - { OS: "alpine", ARCH: "linux/arm64/v8", NAME: "arm64v8" }
-
-      fail-fast: false
-
-    name: "${{ matrix.env.OS }}-${{ matrix.env.ARCH }}"
-
-    steps:
-
-    - uses: actions/checkout@v4
-      with:
-        fetch-depth: 1
-
-    - name: Regenerate Dockerfiles
-      run: |
-        rm scripts/docker/dists/*/Dockerfile || true
-        make docker.regen
-
-    - name: Install qemu
-      run: |
-        sudo apt-get update
-        sudo apt-get install ${APT_OPTS} qemu-user-static
-
-    - name: Build docker image
-      run: |
-        make docker-${{ matrix.env.OS }} \
-          DOCKER_TAG="$DOCKER_REPOSITORY" \
-          DOCKER_BUILD_ARGS="--no-cache --platform ${{ matrix.env.ARCH }}" \
-          DOCKER_VERSION="${{ matrix.env.NAME }}-$BRANCH"
-
-    - name: Docker login
-      uses: docker/login-action@v3
-      with:
-        username: ${{ secrets.DOCKERHUB_USERNAME }}
-        password: ${{ secrets.DOCKERHUB_PASSWORD }}
-
-    - name: Push arch image to Docker registry
-      shell: bash
-      run: |
-        make docker-push-${{ matrix.env.OS }} \
-          DOCKER_TAG="$DOCKER_REPOSITORY" \
-          DOCKER_VERSION="${{ matrix.env.NAME }}-$BRANCH"
-
-
-  manifest:
-    runs-on: ubuntu-22.04
-    needs: build_docker_images
-    if: github.repository_owner == 'FreeRADIUS'
-
-    strategy:
-      matrix:
-        env:
-          - { OS: "ubuntu", ARCHS: "amd64 armv7 arm64v8", SUFFIX: "" }
-          - { OS: "alpine", ARCHS: "amd64 armv6 armv7 arm64v8", SUFFIX: "-alpine" }
-
-      fail-fast: false
-
-    name: "manifest-${{ matrix.env.OS }}"
-
-    steps:
-
-    - uses: actions/checkout@v4
-      with:
-        fetch-depth: 1
-
-    - name: Docker login
-      uses: docker/login-action@v3
-      with:
-        username: ${{ secrets.DOCKERHUB_USERNAME }}
-        password: ${{ secrets.DOCKERHUB_PASSWORD }}
-
-    - name: Create manifests
-      shell: bash
-      run: |
-        make docker-ci-manifest \
-          DOCKER_TAG="$DOCKER_REPOSITORY" \
-          DOCKER_VERSION="$BRANCH${{ matrix.env.SUFFIX }}" \
-          DOCKER_ARCHS="${{ matrix.env.ARCHS }}"
diff -urpN freeradius-server-3.2.7/.vscode/launch.json freeradius-server-3.2.8/.vscode/launch.json
--- freeradius-server-3.2.7/.vscode/launch.json	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/.vscode/launch.json	2025-08-20 23:29:15.000000000 +0700
@@ -47,6 +47,45 @@
                                         "text": "set solib-search-path ${workspaceFolder}"
                                 }
                         ]
-                }
-        ]
+                },
+		{
+			"type": "cppdbg",
+			"request": "launch",
+			"name": "Keyword Test (gdb)",
+			"program": "${workspaceFolder}/build/bin/local/unittest",
+			"args": [
+				"-D",
+				"${workspaceFolder}/share",
+				"-d",
+				"${workspaceFolder}/src/tests/keywords/",
+				"-i",
+				"${workspaceFolder}/build/tests/keywords/${input:keyword}.attrs",
+				"-f",
+				"${workspaceFolder}/build/tests/keywords/${input:keyword}.attrs",
+				"-xx"
+			],
+			"cwd": "${workspaceFolder}",
+                        "environment": [
+                                { "name": "FR_LIBRARY_PATH", "value": "${workspaceFolder}/build/lib/local/.libs" },
+                                { "name": "LD_LIBRARY_PATH", "value": "${workspaceFolder}/build/lib/local/.libs" },
+                                { "name": "KEYWORD", "value": "${input:keyword}" },
+                                { "name": "DEBUGGER_ATTACHED", "value": "yes"}
+                        ],
+                        "MIMode": "gdb",
+                        "setupCommands": [
+                                {
+                                        "description": "Set solib",
+                                        "text": "set solib-search-path ${workspaceFolder}"
+                                }
+                        ]
+
+		}
+        ],
+	"inputs": [
+		{
+			"id": "keyword",
+			"type": "promptString",
+			"description": "Keyword to test"
+		}
+	]
 }
diff -urpN freeradius-server-3.2.7/Make.inc.in freeradius-server-3.2.8/Make.inc.in
--- freeradius-server-3.2.7/Make.inc.in	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/Make.inc.in	2025-08-20 23:29:15.000000000 +0700
@@ -1,7 +1,7 @@
 # -*- makefile -*-
 # Make.inc.in
 #
-# Version:	$Id: 6d5cc1c343ce49e3bd2694a889ca238c0fdad1b7 $
+# Version:	$Id: eb15b4e554c3a63decca24cdc8d8f65a02d91e4f $
 #
 
 # Location of files.
@@ -53,6 +53,13 @@ INCLUDE		= -I. -Isrc \
 		  -include src/freeradius-devel/features.h \
 		  -include src/freeradius-devel/radpaths.h
 CFLAGS		= $(INCLUDE) -fno-strict-aliasing @CFLAGS@
+
+#
+#  To quiet modern compilers.  We're not going to fix warnings in the v3.2.x branch.
+#
+#CFLAGS		+= -Wno-unsafe-buffer-usage -Wno-extra-semi-stmt -Wno-format -Wno-reserved-macro-identifier \
+#		   -Wno-reserved-identifier -Wno-switch-default -Wno-implicit-fallthrough
+
 CPPFLAGS	= @CPPFLAGS@
 LIBPREFIX	= @LIBPREFIX@
 EXEEXT		= @EXEEXT@
diff -urpN freeradius-server-3.2.7/VERSION freeradius-server-3.2.8/VERSION
--- freeradius-server-3.2.7/VERSION	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/VERSION	2025-08-20 23:29:15.000000000 +0700
@@ -1 +1 @@
-3.2.7
+3.2.8
diff -urpN freeradius-server-3.2.7/configure freeradius-server-3.2.8/configure
--- freeradius-server-3.2.7/configure	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/configure	2025-08-20 23:29:15.000000000 +0700
@@ -1,6 +1,6 @@
 #! /bin/sh
 # Guess values for system-dependent variables and create Makefiles.
-# Generated by GNU Autoconf 2.71 for freeradius $Id: f1dfa97c44f600ef564fedd2cac9697c639d1ae6 $.
+# Generated by GNU Autoconf 2.71 for freeradius $Id: 2b82073e9cbe4af060631722bfc8aa3ef7655842 $.
 #
 # Report bugs to <http://bugs.freeradius.org>.
 #
@@ -611,8 +611,8 @@ MAKEFLAGS=
 # Identity of this package.
 PACKAGE_NAME='freeradius'
 PACKAGE_TARNAME='freeradius'
-PACKAGE_VERSION='$Id: f1dfa97c44f600ef564fedd2cac9697c639d1ae6 $'
-PACKAGE_STRING='freeradius $Id: f1dfa97c44f600ef564fedd2cac9697c639d1ae6 $'
+PACKAGE_VERSION='$Id: 2b82073e9cbe4af060631722bfc8aa3ef7655842 $'
+PACKAGE_STRING='freeradius $Id: 2b82073e9cbe4af060631722bfc8aa3ef7655842 $'
 PACKAGE_BUGREPORT='http://bugs.freeradius.org'
 PACKAGE_URL='http://www.freeradius.org'
 
@@ -1384,7 +1384,7 @@ if test "$ac_init_help" = "long"; then
   # Omit some internal or obsolete options to make the list less imposing.
   # This message is too long to be a string in the A/UX 3.1 sh.
   cat <<_ACEOF
-\`configure' configures freeradius $Id: f1dfa97c44f600ef564fedd2cac9697c639d1ae6 $ to adapt to many kinds of systems.
+\`configure' configures freeradius $Id: 2b82073e9cbe4af060631722bfc8aa3ef7655842 $ to adapt to many kinds of systems.
 
 Usage: $0 [OPTION]... [VAR=VALUE]...
 
@@ -1451,7 +1451,7 @@ fi
 
 if test -n "$ac_init_help"; then
   case $ac_init_help in
-     short | recursive ) echo "Configuration of freeradius $Id: f1dfa97c44f600ef564fedd2cac9697c639d1ae6 $:";;
+     short | recursive ) echo "Configuration of freeradius $Id: 2b82073e9cbe4af060631722bfc8aa3ef7655842 $:";;
    esac
   cat <<\_ACEOF
 
@@ -1628,7 +1628,7 @@ fi
 test -n "$ac_init_help" && exit $ac_status
 if $ac_init_version; then
   cat <<\_ACEOF
-freeradius configure $Id: f1dfa97c44f600ef564fedd2cac9697c639d1ae6 $
+freeradius configure $Id: 2b82073e9cbe4af060631722bfc8aa3ef7655842 $
 generated by GNU Autoconf 2.71
 
 Copyright (C) 2021 Free Software Foundation, Inc.
@@ -2075,7 +2075,7 @@ cat >config.log <<_ACEOF
 This file contains any messages produced by compilers while
 running configure, to aid debugging if configure makes a mistake.
 
-It was created by freeradius $as_me $Id: f1dfa97c44f600ef564fedd2cac9697c639d1ae6 $, which was
+It was created by freeradius $as_me $Id: 2b82073e9cbe4af060631722bfc8aa3ef7655842 $, which was
 generated by GNU Autoconf 2.71.  Invocation command line was
 
   $ $0$ac_configure_args_raw
@@ -7931,7 +7931,7 @@ then :
   test "$ac_res" = "none required" || LIBS="$ac_res $LIBS"
 
 else $as_nop
-  as_fn_error $? "-lsem not found.  You may want to download it from ftp://ftp.to.gd-es.com/pub/BSDI/libsem.tar.bz2 or ftp://ftp.freeradius.org/pub/radius/contrib/libsem.tar.gz" "$LINENO" 5
+  as_fn_error $? "-lsem not found.  You may want to download it from ftp://ftp.to.gd-es.com/pub/BSDI/libsem.tar.bz2 or https://www.freeradius.org/ftp/pub/radius/contrib/libsem.tar.gz" "$LINENO" 5
 
 fi
 
@@ -12492,7 +12492,7 @@ printf "%s\n" "$ax_cv_cc_weverything_fla
           fsanitizeflags=
 
         if test "x$fuzzer" = "xyes" && test "x$ax_cv_cc_clang" = "xyes"; then
-                fsanitizeflags="$fsanitizeflags,fuzzer"
+                fsanitizeflags="$fsanitizeflags,fuzzer-no-link"
   fi
 
         if test "x$address_sanitizer" = "xyes"; then
@@ -13568,6 +13568,317 @@ if test "x$REGEX" != "xno" && test "x$PC
   smart_try_dir=$pcre_include_dir
 
 
+ac_safe=`echo "pcre2.h" | sed 'y%./+-%__pm%'`
+old_CPPFLAGS="$CPPFLAGS"
+smart_include=
+smart_include_dir="/usr/local/include /opt/include"
+
+_smart_try_dir=
+_smart_include_dir=
+
+for _prefix in $smart_prefix ""; do
+  for _dir in $smart_try_dir; do
+    _smart_try_dir="${_smart_try_dir} ${_dir}/${_prefix}"
+  done
+
+  for _dir in $smart_include_dir; do
+    _smart_include_dir="${_smart_include_dir} ${_dir}/${_prefix}"
+  done
+done
+
+if test "x$_smart_try_dir" != "x"; then
+  for try in $_smart_try_dir; do
+    { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for pcre2.h in $try" >&5
+printf %s "checking for pcre2.h in $try... " >&6; }
+    CPPFLAGS="-isystem $try $old_CPPFLAGS"
+    cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+#define PCRE2_CODE_UNIT_WIDTH (8)
+		    #include <pcre2.h>
+int
+main (void)
+{
+int a = 1;
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_compile "$LINENO"
+then :
+
+		     smart_include="-isystem $try"
+		     { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: yes" >&5
+printf "%s\n" "yes" >&6; }
+		     break
+
+else $as_nop
+
+		     smart_include=
+		     { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: no" >&5
+printf "%s\n" "no" >&6; }
+
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
+  done
+  CPPFLAGS="$old_CPPFLAGS"
+fi
+
+if test "x$smart_include" = "x"; then
+  for _prefix in $smart_prefix; do
+    { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for ${_prefix}/pcre2.h" >&5
+printf %s "checking for ${_prefix}/pcre2.h... " >&6; }
+
+    cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+#define PCRE2_CODE_UNIT_WIDTH (8)
+		    #include <pcre2.h>
+int
+main (void)
+{
+int a = 1;
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_compile "$LINENO"
+then :
+
+		     smart_include="-isystem ${_prefix}/"
+		     { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: yes" >&5
+printf "%s\n" "yes" >&6; }
+		     break
+
+else $as_nop
+
+		     smart_include=
+		     { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: no" >&5
+printf "%s\n" "no" >&6; }
+
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
+  done
+fi
+
+if test "x$smart_include" = "x"; then
+    { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for pcre2.h" >&5
+printf %s "checking for pcre2.h... " >&6; }
+
+    cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+#define PCRE2_CODE_UNIT_WIDTH (8)
+		    #include <pcre2.h>
+int
+main (void)
+{
+int a = 1;
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_compile "$LINENO"
+then :
+
+		     smart_include=" "
+		     { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: yes" >&5
+printf "%s\n" "yes" >&6; }
+		     break
+
+else $as_nop
+
+		     smart_include=
+		     { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: no" >&5
+printf "%s\n" "no" >&6; }
+
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
+fi
+
+if test "x$smart_include" = "x"; then
+
+  for try in $_smart_include_dir; do
+    { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for pcre2.h in $try" >&5
+printf %s "checking for pcre2.h in $try... " >&6; }
+    CPPFLAGS="-isystem $try $old_CPPFLAGS"
+    cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+#define PCRE2_CODE_UNIT_WIDTH (8)
+		    #include <pcre2.h>
+int
+main (void)
+{
+int a = 1;
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_compile "$LINENO"
+then :
+
+		     smart_include="-isystem $try"
+		     { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: yes" >&5
+printf "%s\n" "yes" >&6; }
+		     break
+
+else $as_nop
+
+		     smart_include=
+		     { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: no" >&5
+printf "%s\n" "no" >&6; }
+
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
+  done
+  CPPFLAGS="$old_CPPFLAGS"
+fi
+
+if test "x$smart_include" != "x"; then
+  eval "ac_cv_header_$ac_safe=yes"
+  CPPFLAGS="$smart_include $old_CPPFLAGS"
+  SMART_CPPFLAGS="$smart_include $SMART_CPPFLAGS"
+fi
+
+smart_prefix=
+
+  if test "x$ac_cv_header_pcre2_h" = "xyes"; then
+    smart_try_dir=$pcre_lib_dir
+
+
+sm_lib_safe=`echo "pcre2-8" | sed 'y%./+-%__p_%'`
+sm_func_safe=`echo "pcre2_compile_8" | sed 'y%./+-%__p_%'`
+
+old_LIBS="$LIBS"
+old_CPPFLAGS="$CPPFLAGS"
+smart_lib=
+smart_ldflags=
+smart_lib_dir=
+
+if test "x$smart_try_dir" != "x"; then
+  for try in $smart_try_dir; do
+    { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for pcre2_compile_8 in -lpcre2-8 in $try" >&5
+printf %s "checking for pcre2_compile_8 in -lpcre2-8 in $try... " >&6; }
+    LIBS="-lpcre2-8 $old_LIBS"
+    CPPFLAGS="-L$try -Wl,-rpath,$try $old_CPPFLAGS"
+    cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+extern char pcre2_compile_8();
+int
+main (void)
+{
+pcre2_compile_8()
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_link "$LINENO"
+then :
+
+		 smart_lib="-lpcre2-8"
+		 smart_ldflags="-L$try -Wl,-rpath,$try"
+		 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: yes" >&5
+printf "%s\n" "yes" >&6; }
+		 break
+
+else $as_nop
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: no" >&5
+printf "%s\n" "no" >&6; }
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.beam \
+    conftest$ac_exeext conftest.$ac_ext
+  done
+  LIBS="$old_LIBS"
+  CPPFLAGS="$old_CPPFLAGS"
+fi
+
+if test "x$smart_lib" = "x"; then
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for pcre2_compile_8 in -lpcre2-8" >&5
+printf %s "checking for pcre2_compile_8 in -lpcre2-8... " >&6; }
+  LIBS="-lpcre2-8 $old_LIBS"
+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+extern char pcre2_compile_8();
+int
+main (void)
+{
+pcre2_compile_8()
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_link "$LINENO"
+then :
+
+	        smart_lib="-lpcre2-8"
+	        { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: yes" >&5
+printf "%s\n" "yes" >&6; }
+
+else $as_nop
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: no" >&5
+printf "%s\n" "no" >&6; }
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.beam \
+    conftest$ac_exeext conftest.$ac_ext
+  LIBS="$old_LIBS"
+fi
+
+if test "x$smart_lib" = "x"; then
+  for try in /usr/local/lib /opt/lib; do
+    { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for pcre2_compile_8 in -lpcre2-8 in $try" >&5
+printf %s "checking for pcre2_compile_8 in -lpcre2-8 in $try... " >&6; }
+    LIBS="-lpcre2-8 $old_LIBS"
+    CPPFLAGS="-L$try -Wl,-rpath,$try $old_CPPFLAGS"
+    cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+extern char pcre2_compile_8();
+int
+main (void)
+{
+pcre2_compile_8()
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_link "$LINENO"
+then :
+
+		  smart_lib="-lpcre2-8"
+		  smart_ldflags="-L$try -Wl,-rpath,$try"
+		  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: yes" >&5
+printf "%s\n" "yes" >&6; }
+		  break
+
+else $as_nop
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: no" >&5
+printf "%s\n" "no" >&6; }
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.beam \
+    conftest$ac_exeext conftest.$ac_ext
+  done
+  LIBS="$old_LIBS"
+  CPPFLAGS="$old_CPPFLAGS"
+fi
+
+if test "x$smart_lib" != "x"; then
+  eval "ac_cv_lib_${sm_lib_safe}_${sm_func_safe}=yes"
+  LIBS="$smart_ldflags $smart_lib $old_LIBS"
+  SMART_LIBS="$smart_ldflags $smart_lib $SMART_LIBS"
+fi
+
+    if test "x$ac_cv_lib_pcre2_8_pcre2_compile_8" = "xyes"; then
+      REGEX=yes
+
+printf "%s\n" "#define HAVE_PCRE2 1" >>confdefs.h
+
+
+printf "%s\n" "#define HAVE_BINSAFE_REGEX 1" >>confdefs.h
+
+    fi
+  fi
+fi
+
+if test "x$REGEX" = "x" && test "x$PCRE" != "xno"; then
+  smart_try_dir=$pcre_include_dir
+
+
 ac_safe=`echo "pcre.h" | sed 'y%./+-%__pm%'`
 old_CPPFLAGS="$CPPFLAGS"
 smart_include=
@@ -15250,7 +15561,7 @@ cat >>$CONFIG_STATUS <<\_ACEOF || ac_wri
 # report actual input values of CONFIG_FILES etc. instead of their
 # values after options handling.
 ac_log="
-This file was extended by freeradius $as_me $Id: f1dfa97c44f600ef564fedd2cac9697c639d1ae6 $, which was
+This file was extended by freeradius $as_me $Id: 2b82073e9cbe4af060631722bfc8aa3ef7655842 $, which was
 generated by GNU Autoconf 2.71.  Invocation command line was
 
   CONFIG_FILES    = $CONFIG_FILES
@@ -15319,7 +15630,7 @@ ac_cs_config_escaped=`printf "%s\n" "$ac
 cat >>$CONFIG_STATUS <<_ACEOF || ac_write_fail=1
 ac_cs_config='$ac_cs_config_escaped'
 ac_cs_version="\\
-freeradius config.status $Id: f1dfa97c44f600ef564fedd2cac9697c639d1ae6 $
+freeradius config.status $Id: 2b82073e9cbe4af060631722bfc8aa3ef7655842 $
 configured by $0, generated by GNU Autoconf 2.71,
   with options \\"\$ac_cs_config\\"
 
diff -urpN freeradius-server-3.2.7/configure.ac freeradius-server-3.2.8/configure.ac
--- freeradius-server-3.2.7/configure.ac	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/configure.ac	2025-08-20 23:29:15.000000000 +0700
@@ -23,7 +23,7 @@ dnl ####################################
 AC_PREREQ([2.69])
 export CFLAGS LIBS LDFLAGS CPPFLAGS
 
-AC_INIT([freeradius],[$Id: 6f292066466458fda3ec898b16d2d44e324741fb $],[http://bugs.freeradius.org],[],[http://www.freeradius.org])
+AC_INIT([freeradius],[$Id: 73e40b84d5f698b459870271c11d9426dd1f1c42 $],[http://bugs.freeradius.org],[],[http://www.freeradius.org])
 AC_CONFIG_MACRO_DIR([m4])
 AC_CONFIG_SRCDIR([src/main/radiusd.c])
 AC_CONFIG_HEADER([src/include/autoconf.h])
@@ -1049,7 +1049,7 @@ else
 
   AC_SEARCH_LIBS(sem_init, pthread sem posix4 rt semaphore,
     [],
-    [AC_MSG_ERROR([[-lsem not found.  You may want to download it from ftp://ftp.to.gd-es.com/pub/BSDI/libsem.tar.bz2 or ftp://ftp.freeradius.org/pub/radius/contrib/libsem.tar.gz]])]
+    [AC_MSG_ERROR([[-lsem not found.  You may want to download it from ftp://ftp.to.gd-es.com/pub/BSDI/libsem.tar.bz2 or https://www.freeradius.org/ftp/pub/radius/contrib/libsem.tar.gz]])]
   )
 fi
 
@@ -1990,7 +1990,7 @@ if test "x$developer" = "xyes"; then
     dnl #
     dnl #  -fsanitize=fuzzer  - Build with fuzzer support
     dnl #
-    fsanitizeflags="$fsanitizeflags,fuzzer"
+    fsanitizeflags="$fsanitizeflags,fuzzer-no-link"
   fi
 
   dnl #
@@ -2277,10 +2277,27 @@ AC_ARG_WITH(regex,
 )
 
 dnl #
-dnl #  First look for PCRE
+dnl #  First look for PCRE2
 dnl #
 if test "x$REGEX" != "xno" && test "x$PCRE" != "xno"; then
   smart_try_dir=$pcre_include_dir
+  FR_SMART_CHECK_INCLUDE(pcre2.h,[#define PCRE2_CODE_UNIT_WIDTH (8)])
+  if test "x$ac_cv_header_pcre2_h" = "xyes"; then
+    smart_try_dir=$pcre_lib_dir
+    FR_SMART_CHECK_LIB(pcre2-8, pcre2_compile_8)
+    if test "x$ac_cv_lib_pcre2_8_pcre2_compile_8" = "xyes"; then
+      REGEX=yes
+      AC_DEFINE(HAVE_PCRE2, [1], [define this if we have libpcre2])
+      AC_DEFINE(HAVE_BINSAFE_REGEX, 1, [Define if we have a binary safe regular expression library])
+    fi
+  fi
+fi
+
+dnl #
+dnl #  If no PCRE2, look for PCRE
+dnl #
+if test "x$REGEX" = "x" && test "x$PCRE" != "xno"; then
+  smart_try_dir=$pcre_include_dir
   FR_SMART_CHECK_INCLUDE(pcre.h)
   if test "x$ac_cv_header_pcre_h" = "xyes"; then
     smart_try_dir=$pcre_lib_dir
@@ -2294,7 +2311,7 @@ if test "x$REGEX" != "xno" && test "x$PC
 fi
 
 dnl #
-dnl #  If no PCRE, fallback to POSIX regular expressions
+dnl #  If no PCRE2 or PCRE, fallback to POSIX regular expressions
 dnl #
 if test "x$REGEX" = "x"; then
   smart_try_dir=
diff -urpN freeradius-server-3.2.7/debian/README.rfc freeradius-server-3.2.8/debian/README.rfc
--- freeradius-server-3.2.7/debian/README.rfc	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/debian/README.rfc	2025-08-20 23:29:15.000000000 +0700
@@ -2,7 +2,7 @@ These are the relevant RFC's that normal
 we have now decided that useful things like RFC's are not free enough, and
 so we can't ship them in Debian main.  They are all available from the
 original freeradius tarball, available at
-ftp://ftp.freeradius.org/pub/radius/
+https://www.freeradius.org/ftp/pub/radius/
 and from
 http://www.rfc-editor.org/
 
diff -urpN freeradius-server-3.2.7/debian/changelog freeradius-server-3.2.8/debian/changelog
--- freeradius-server-3.2.7/debian/changelog	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/debian/changelog	2025-08-20 23:29:15.000000000 +0700
@@ -1,3 +1,9 @@
+freeradius (3.2.8+git) unstable; urgency=medium
+
+  * New upstream version.
+
+ -- Alan DeKok <aland@freeradius.org>  Wed, 20 Aug 2025 12:00:00 +0000
+
 freeradius (3.2.7+git) unstable; urgency=medium
 
   * New upstream version.
diff -urpN freeradius-server-3.2.7/debian/control.in freeradius-server-3.2.8/debian/control.in
--- freeradius-server-3.2.7/debian/control.in	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/debian/control.in	2025-08-20 23:29:15.000000000 +0700
@@ -14,11 +14,12 @@ Build-Depends: @BUILDDEPS@ debhelper (>=
  libldap2-dev,
  libpam0g-dev,
  libpcap-dev,
- libpcre3-dev,
+ libpcre2-dev | libpcre3-dev,
  libperl-dev,
  default-libmysqlclient-dev | libmysqlclient-dev,
  libpq-dev,
  libreadline-dev,
+ librdkafka-dev,
  libsasl2-dev,
  libsqlite3-dev,
  libssl-dev,
@@ -211,6 +212,13 @@ Description: Yubikey module for FreeRADI
  This package is required to add Yubikey functionality to the
  FreeRADIUS server.
 
+Package: freeradius-kafka
+Architecture: any
+Depends: freeradius (= ${binary:Version}), ${shlibs:Depends}, ${misc:Depends}, ${dist:Depends}
+Description: Kafka producer module for FreeRADIUS server
+ This package is required to add Kafka producer functionality to the
+ FreeRADIUS server.
+
 Package: freeradius-dbg
 Architecture: any
 Section: debug
diff -urpN freeradius-server-3.2.7/debian/freeradius-kafka.install freeradius-server-3.2.8/debian/freeradius-kafka.install
--- freeradius-server-3.2.7/debian/freeradius-kafka.install	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/debian/freeradius-kafka.install	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1 @@
+usr/lib/freeradius/rlm_kafka.so
diff -urpN freeradius-server-3.2.7/debian/freeradius-kafka.lintian-overrides freeradius-server-3.2.8/debian/freeradius-kafka.lintian-overrides
--- freeradius-server-3.2.7/debian/freeradius-kafka.lintian-overrides	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/debian/freeradius-kafka.lintian-overrides	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,3 @@
+# There's plenty in the description of this package to identify
+# what it does.
+freeradius-kafka: extended-description-is-probably-too-short
diff -urpN freeradius-server-3.2.7/debian/freeradius-kafka.postinst freeradius-server-3.2.8/debian/freeradius-kafka.postinst
--- freeradius-server-3.2.7/debian/freeradius-kafka.postinst	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/debian/freeradius-kafka.postinst	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,19 @@
+#! /bin/sh
+
+set -e
+
+case "$1" in
+  configure)
+        if [ -x "`which invoke-rc.d 2>/dev/null`" ]; then
+          invoke-rc.d freeradius force-reload || true
+        else
+          /etc/init.d/freeradius force-reload
+        fi
+	;;
+esac
+
+#DEBHELPER#
+
+exit 0
+
+
diff -urpN freeradius-server-3.2.7/debian/rules freeradius-server-3.2.8/debian/rules
--- freeradius-server-3.2.7/debian/rules	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/debian/rules	2025-08-20 23:29:15.000000000 +0700
@@ -33,7 +33,7 @@ logdir          = /var/log/$(package)
 pkgdocdir       = /usr/share/doc/$(package)
 raddbdir        = /etc/$(package)
 
-modulelist=krb5 ldap sql_freetds sql_mysql sql_postgresql sql_unixodbc dhcp python2 python3 redis rest unbound yubikey
+modulelist=krb5 ldap sql_freetds sql_mysql sql_postgresql sql_unixodbc dhcp python2 python3 redis rest unbound yubikey kafka
 pkgs=$(shell dh_listpackages)
 
 # This has to be exported to make some magic below work.
diff -urpN freeradius-server-3.2.7/debian/watch freeradius-server-3.2.8/debian/watch
--- freeradius-server-3.2.7/debian/watch	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/debian/watch	2025-08-20 23:29:15.000000000 +0700
@@ -1,9 +1,6 @@
-version=3
-
-opts=pasv,\
-pgpsigurlmangle=s/$/.sig/,\
+version=4
+opts=pgpsigurlmangle=s/$/.sig/,\
 repacksuffix=+dfsg,\
 dversionmangle=s/\+git$//,\
-uversionmangle=s/(\d)[_\.\-\+]?((RC|rc|pre|dev|beta|alpha)\d*)$/$1~$2/\
-  ftp://ftp.freeradius.org/pub/freeradius/freeradius-server-(.+)\.tar\.gz
-
+uversionmangle=s/(\d)[_\.\-\+]?((RC|rc|pre|dev|beta|alpha)\d*)$/$1~$2/ \
+https://www.freeradius.org/ftp/pub/freeradius/ freeradius-server-(.+)\.tar\.gz
diff -urpN freeradius-server-3.2.7/doc/ChangeLog freeradius-server-3.2.8/doc/ChangeLog
--- freeradius-server-3.2.7/doc/ChangeLog	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/doc/ChangeLog	2025-08-20 23:29:15.000000000 +0700
@@ -1,3 +1,69 @@
+FreeRADIUS 3.2.8 Wed 20 Aug 2025 12:00:00 UTC urgency=low
+	Configuration changes
+	* Replace dictionary.infinera with the correct one.
+	* Update dictionary.alteon
+
+	Feature improvements
+	* Add support for automated fuzzing.  This doesn't affect
+	  normal operations, but it does allow for testing of the
+	  RADIUS decoder.
+	* Allow tagged attributes to use ":V" as a tag in some cases.
+	  The tag is then read from the value which is being assigned
+	  to the attribute.  This functionality is allowed in 'update'
+	  sections, including 'update' in module configurations.
+	  See mods-available/ldap for an example.
+	* Add kafka module.  See mods-available/kafka.
+	* Allow &control:Packet-SRC-IP-Address to be used when
+	  proxying needs a given source address.
+	* Change lower limit for reject_delay to 0.5s.  Apparently
+	  some NASes will panic and go crazy with a 1s reject_delay.
+	* Rate limit complaints when limiting new connections.
+	* Update raddb/certs/Makefile to support DER output.
+	* Elapsed statistics for packets do not include proxy timers,
+	  which helps clarify where any issues are.  The total time
+	  is still available by adding "our" time to the "proxy" time.
+	* Added kafka module.  See mods-available/kafka.
+	* json module can now print dates as integers.
+	  See mods-available/json
+	* The debug output now points to the online documentation in
+	  many cases, when there are syntax errors in the configuration.
+	* Add support for 389ds password hashes.  Patch from Gerald Vogt.
+	* reject_delay does not _add_ a delay, but instead ensures that
+	  the reject is delayed for _at least_ that time.  This change
+	  means that reject_delay can be set in more situations, including
+	  for proxies.
+	* Add delay_proxy_rejects.  By default, proxied rejects are not
+	  delayed.  Setting this flag means that reject_delay is applied
+	  to proxied rejects, too.
+	* The proxy_rate_limit module can now be listed in the
+	  "authorize" section.
+	* Update dpsk module to be faster, and be easier to configure
+	  with databases.  See mods-available/dpsk
+
+	Bug fixes
+	* Move assertion in thread / queue code, which only affects
+	  debug builds.  Fixes #5512.
+	* Update CRL checks to avoid crash in some cases.  Fixes #5515
+	* More tweaks to the TEAP code.
+	* Allow building when OpenSSL is missing PSK.  Fixes #5520
+	* Move assertion so that it isn't triggered when the incoming
+	  queue is full, and the server is blocked.  Fixes #5512
+	* Fix crash when multiple certs are used along with
+	  CRL distribution points.  Fixes #5515
+	* Fix typo in rlm_cache which could cause crashes. Fixes #5522
+	* Be more forgiving about '%' in strings.  Fixes #5525.
+	* Move assertion in threading code.
+	* Fixes to interaction with python interpreter
+	* Don't crash when setting client hostname in RADIUS/TLS.
+	  Fixes #5552
+	* Ignore ".dpkg*" and ".rpm*" files when loading configuration
+	  directories.  Package managers can leave these around.
+	* Complain more loudly if all of the "authorize" etc. sections
+	  have been removed, but the server is still configured to
+	  process Access-Request packets.
+	* Use OCIStmtPrepare2 to prepare Oracle queries. Fixes #5540
+	* Allow dynamic clients with TCP listeners.
+
 FreeRADIUS 3.2.7 Fri 31 Jan 2025 12:00:00 UTC urgency=low
 	Configuration changes
 	* The dpsk module now supports dynamic expansion of the
diff -urpN freeradius-server-3.2.7/doc/antora/antora.yml freeradius-server-3.2.8/doc/antora/antora.yml
--- freeradius-server-3.2.7/doc/antora/antora.yml	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/antora.yml	2025-08-20 23:29:15.000000000 +0700
@@ -5,7 +5,7 @@
 #
 name: freeradius-server
 title: The FreeRADIUS Server
-version: '3.2.7'
+version: '3.2.8'
 start_page: ROOT:index.adoc
 nav:
 - modules/ROOT/nav.adoc
@@ -15,4 +15,3 @@ nav:
 - modules/tutorials/nav.adoc
 - modules/unlang/nav.adoc
 - modules/developers/nav.adoc
-- modules/raddb/nav.adoc
diff -urpN freeradius-server-3.2.7/doc/antora/modules/ROOT/pages/index.adoc freeradius-server-3.2.8/doc/antora/modules/ROOT/pages/index.adoc
--- freeradius-server-3.2.7/doc/antora/modules/ROOT/pages/index.adoc	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/ROOT/pages/index.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -7,7 +7,7 @@ in the `LICENSE` file in this directory.
 FreeRADIUS is a complex piece of software with many configuration
 options. However, we have taken great care to make the default
 configuration work in most circumstances. The result is that for most
-simple systems, it is trivial to install and configure the server. For
+simple systems, it is easy to install and configure the server. For
 those situations, this documentation will serve to answer basic
 questions about functionality, configuration, etc.
 
@@ -20,27 +20,29 @@ piece of the configuration to change, an
 This documentation will answer those questions. The FreeRADIUS team has
 put substantial effort into writing the documentation for this release.
 Everything in the server is fully documented, and there are many
-`how-to` guides available.
+`Howto` guides available.
+
+include::ROOT:partial$externaldoc.adoc[]
 
 The documentation is split into sections by subject area, oganized by
 desired outcome. At a high level, the subject areas describe:
 
-* xref:concepts:index.adoc[Concepts] and introduction for newcomers.
-* xref:installation:index.adoc[Installing] and xref:installation:upgrade.adoc[upgrading] FreeRADIUS.
-* The syntax of the xref:unlang:index.adoc[unlang] processing language.
-* The xref:raddb:index.adoc[configuration files] located in `/etc/raddb/`, or `/etc/freeradius/`
-* Various xref:howto:index.adoc[how-to] guides.
-* xref:developers:index.adoc[Developer documentation].
+* xref:installation:index.adoc[Install and Upgrade] Guides.
+* xref:concepts:index.adoc[Concepts] provides an high level explanation for newcomers .
+* The syntax of the xref:unlang:index.adoc[Unlang] Policy Language.
+* The https://github.com/FreeRADIUS/freeradius-server/tree/v3.2.x/raddb[configuration files] located in `/etc/raddb/`, or `/etc/freeradius/`.
+* Various xref:howto:index.adoc[Howto Guides] gives step-by-step instructions on how to complete tasks.
+* xref:developers:index.adoc[Developers] documentation outlines coding standards, raising defects, and using GitHub.
 
-This organization means that for example, the `ldap` module will have
+This organization means that for example, the `ldap` module has
 documention located in multiple places. We feel that organizing the
-documentation by desired _goal_ is better than the alternatives.
+documentation by desired *goal* is better than the alternatives.
 
 Within each section, the documentation is split into small pages, which
 are generally no more than a few screens worth of information. We feel
 that having multiple small pages with cross-links is more helpful than
 having a smaller number of enormous pages. This division ensures that
-(for example) the `how-to` guides are split into a series of small
+(for example) the `Howto` guides are split into a series of small
 steps, each of which can be performed quickly.
 
 We hope that this extended documentation will address any lingering
@@ -49,51 +51,46 @@ concerns about the quality of the FreeRA
 == Changes From Earlier Versions
 
 Administrators who have version 2 and wish to upgrade to version 3
-should read the xref:installation:upgrade.adoc[upgrading] documentation.
+should read the xref:installation:upgrade.adoc[Upgrade to v3] documentation.
 That documentation explains the differences between the two versions, and
 how an existing configuration can be reproduced in the latest
-release. We do _not_ recommend using version 2 configuration files
-with version 3. The configuration files are _not_ compatible across a
+release. We do *not* recommend using version 2 configuration files
+with version 3. The configuration files are *not* compatible across a
 major version upgrade.
 
 == Getting Started with FreeRADIUS
 
 FreeRADIUS can be installed using the pre-built packages available
-from http://packages.networkradius.com[Network RADIUS,
-window="_blank"]. That page contains packages for all common OS
-distributions.  New packages are available as soon as a new version
-has been released.  Packages for older releases are also available for
-historical purposes.
+from https://packages.inkbridgenetworks.com/[InkBridge Networks]. That page contains packages for all common OS distributions.  New packages are available as soon as a new version has been released.  Packages for older releases are also available for historical purposes.
 
 FreeRADIUS can also be installed from the source code.  Please see the
-xref:installation:index.adoc[installation guide] for instructions.
+xref:installation:index.adoc[Installation Guide] for instructions.
 
-WARNING: Many Operating System distributions ship versions of FreeRADIUS
+[WARNING]
+====
+Many Operating System distributions ship versions of FreeRADIUS
 which are years out of date. Those versions may contain bugs which have
 been fixed in newer releases. We recommend using the
-http://packages.networkradius.com[Network RADIUS, window="_blank"] packages where
-possible.
+https://packages.inkbridgenetworks.com/[InkBridge Networks] packages where possible.
+====
 
 Administrators who are new to FreeRADIUS should read the
-xref:concepts:index.adoc[concepts section] as it describes the concepts behind
+xref:concepts:index.adoc[Concepts] section as it describes the key components behind
 FreeRADIUS. It is vital for newcomers to understand these concepts, as the rest
 of the documentation assumes familiarity with them.
 
-A detailed xref:unlang:index.adoc[unlang] reference guide is also available.
+A detailed xref:unlang:index.adoc[Unlang] reference guide is also available.
 This section describes the syntax and functionality of the keywords,
 data types, etc. used in the `unlang` processing language.
 
-All of the xref:raddb:index.adoc[configuration files] are available in
-hypertext format. In can often be easier to read the configuration files
-in a nicely formatted version, instead of as a fixed-width font in a
-text editor.
+All of the https://github.com/FreeRADIUS/freeradius-server/tree/v3.2.x/raddb[configuration files] are available in GitHub.
 
-For specific problem solving, we recommend the xref:howto:index.adoc[how-to]
+For specific problem solving, we recommend the xref:howto:index.adoc[Howto]
 guides. These guides give instructions for reaching high-level goals, or
-for configuring and testing individual xref:howto:modules/index.adoc[modules].
+for configuring and testing individual https://github.com/FreeRADIUS/freeradius-server/tree/v3.2.x/doc/modules[modules].
 
-There is also xref:developers:index.adoc[developer documentation]. This section
-documents the APIs for developers. Most people can ignore it.
+There is also xref:developers:index.adoc[Developers] documentation. This section
+documents the APIs for developers. Most people can bypass this section.
 
 == Debugging
 
@@ -115,8 +112,8 @@ debug output. In many cases, those messa
 going wrong, and how to fix it.
 
 For further details, about the debug output see the
-http://wiki.freeradius.org/radiusd-X[radiusd-X, window="_blank"] page on the
-http://wiki.freeradius.org[wiki, window="_blank"].
+refer to the https://www.freeradius.org/documentation/freeradius-server/3.2.8/radiusd_x.html[debug output] page on the
+http://www.freeradius.org[freeradius org] website.
 
 == Getting Help
 
@@ -125,13 +122,12 @@ http://lists.freeradius.org/mailman/list
 list] in order to ask questions and receive answers. The developers are
 not on Stack Overflow, IRC, or other web sites. While the FreeRADIUS
 source is available on
-https://github.com/FreeRADIUS/freeradius-server/[GitHub, window="_blank"], questions
-posted there will not be answered.
+https://github.com/FreeRADIUS/freeradius-server/[GitHub, window="_blank"], questions posted there will not be answered.
 
 Before posting to the list, please read the
-http://wiki.freeradius.org/list-help[list help, window="_blank"] page. That page explains
+https://www.freeradius.org/documentation/freeradius-server/3.2.8/radiusd_x.html[debugging] page. That page explains
 how to run the server in debugging mode; how to understand the debug
 output; and what information to post to the list.
 
 Commercial support for FreeRADIUS is available from
-https://networkradius.com/freeradius-support/[Network RADIUS, window="_blank"].
+https://packages.inkbridgenetworks.com/[InkBridge Networks].
diff -urpN freeradius-server-3.2.7/doc/antora/modules/ROOT/pages/radiusd_x.adoc freeradius-server-3.2.8/doc/antora/modules/ROOT/pages/radiusd_x.adoc
--- freeradius-server-3.2.7/doc/antora/modules/ROOT/pages/radiusd_x.adoc	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/ROOT/pages/radiusd_x.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -1,6 +1,6 @@
-# How to use `radiusd -X` (debug mode)
+# `radiusd -X` 
 
-This page explains how to read the output of `radiusd -X`.
+This page explains How to use how use `radiusd` in debug mode and how to read the output of `radiusd -X` (debug mode).
 
 The first part of the debug output is the *startup* text.  Once the server is started, it prints `Ready to receive requests`.  The next part of the debug output is the *packet processing* text.  Both parts need to be read (and posted to the list!) in order to solve issues.
 
@@ -578,7 +578,7 @@ The `suffix` module splits the `User-Nam
     (2) suffix: Adding Stripped-User-Name = "bob"
     (2) suffix: Adding Realm = "int"
     (2) suffix: Proxying request from user bob to realm int
-    (2) suffix: Preparing to proxy authentication request to realm "int" 
+    (2) suffix: Preparing to proxy authentication request to realm "int"
     (2)     [suffix] = updated
     (2)     [files] = noop
     (2)   } # authorize = updated
@@ -637,7 +637,7 @@ Because this is a proxied request, it no
     (2)       if ("%{debug_attr:reply:}" == '') {
     (2)       Attributes matching "reply:"
     (2)         EXPAND %{debug_attr:reply:}
-    (2)            --> 
+    (2)            -->
     (2)         if ("%{debug_attr:reply:}" == '')  -> TRUE
     (2)         if ("%{debug_attr:reply:}" == '')  {
     (2)           [noop] = noop
diff -urpN freeradius-server-3.2.7/doc/antora/modules/ROOT/partials/externaldoc.adoc freeradius-server-3.2.8/doc/antora/modules/ROOT/partials/externaldoc.adoc
--- freeradius-server-3.2.7/doc/antora/modules/ROOT/partials/externaldoc.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/ROOT/partials/externaldoc.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,4 @@
+[NOTE]
+====
+Some of the information on this page is located on external sites. You may be redirected to https://github.com/FreeRADIUS[FreeRADIUS Project GitHub], https://www.freeradius.org/[FreeRADIUS org], or the https://www.inkbridgenetworks.com/[InkBridge Networks] websites. Other external references may also be used such as vendor or technical sites.
+====
diff -urpN freeradius-server-3.2.7/doc/antora/modules/ROOT/partials/mailinglist.adoc freeradius-server-3.2.8/doc/antora/modules/ROOT/partials/mailinglist.adoc
--- freeradius-server-3.2.7/doc/antora/modules/ROOT/partials/mailinglist.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/ROOT/partials/mailinglist.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,22 @@
+Please see the following for a description of the FreeRADIUS mailing lists. For normal discussion of the server and how to use it, subscribe to the FreeRADIUS user-list. Only subscribe to the development list if you are interested in writing software for the new server.
+
+
+[cols="1,3"]
+|===
+|Mailing List|Description
+
+|mailto:freeradius-announce@lists.freeradius.org[freeradius-announce]
+|Announcements about FreeRADIUS, including new versions and security issues, are made here.
+
+|mailto:freeradius-users@lists.freeradius.org[freeradius-users]
+|This list is for all users of FreeRADIUS and deals with general questions related to FreeRADIUS.
+
+|mailto:freeradius-devel@lists.freeradius.org[freeradius-devel]
+|This list is for developers who are writing code for FreeRADIUS. The content is highly technical and is not suited to the average user. If you looking to contribute code, please join this list.
+
+|https://lists.freeradius.org/pipermail/freeradius-users/[User Mailing List Archive]
+|An archive of all previous posts and emails from the users' email list.
+
+|https://lists.freeradius.org/pipermail/freeradius-devel/[Developer Mailing List Archive]
+|An archive of all previous posts and emails from the developement users' email list.
+|===
diff -urpN freeradius-server-3.2.7/doc/antora/modules/concepts/images/request_flow.svg freeradius-server-3.2.8/doc/antora/modules/concepts/images/request_flow.svg
--- freeradius-server-3.2.7/doc/antora/modules/concepts/images/request_flow.svg	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/concepts/images/request_flow.svg	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,3 @@
+<?xml version="1.0" encoding="utf-8" standalone="no"?>
+<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
+<svg xmlns="http://www.w3.org/2000/svg" xmlns:xl="http://www.w3.org/1999/xlink" version="1.1" viewBox="47 152 1052 514" width="1052pt" height="514pt" xmlns:dc="http://purl.org/dc/elements/1.1/"><metadata> Produced by OmniGraffle 6.2 <dc:date>2015-04-15 01:50:58 +0000</dc:date></metadata><defs><font-face font-family="Helvetica" font-size="10" units-per-em="1000" underline-position="-75.683594" underline-thickness="49.316406" slope="0" x-height="522.94922" cap-height="717.28516" ascent="770.01953" descent="-229.98047" font-weight="500"><font-face-src><font-face-name name="Helvetica"/></font-face-src></font-face><marker orient="auto" overflow="visible" markerUnits="strokeWidth" id="FilledArrow_Marker" viewBox="-1 -4 10 8" markerWidth="10" markerHeight="8" color="#00c0c0"><g><path d="M 8 0 L 0 -3 L 0 3 Z" fill="currentColor" stroke="currentColor" stroke-width="1"/></g></marker><font-face font-family="Helvetica Neue" font-size="14" panose-1="2 0 5 3 0 0 0 2 0 4" units-per-em="1000" underline-position="-100" underline-thickness="50" slope="0" x-height="517" cap-height="714" ascent="951.99585" descent="-212.99744" font-weight="500"><font-face-src><font-face-name name="HelveticaNeue"/></font-face-src></font-face><font-face font-family="Helvetica" font-size="10" units-per-em="1000" underline-position="-75.683594" underline-thickness="49.316406" slope="-1200" x-height="522.94922" cap-height="717.28516" ascent="770.01953" descent="-229.98047" font-style="italic" font-weight="500"><font-face-src><font-face-name name="Helvetica-Oblique"/></font-face-src></font-face><marker orient="auto" overflow="visible" markerUnits="strokeWidth" id="FilledArrow_Marker_2" viewBox="-1 -4 10 8" markerWidth="10" markerHeight="8" color="#6c0"><g><path d="M 8 0 L 0 -3 L 0 3 Z" fill="currentColor" stroke="currentColor" stroke-width="1"/></g></marker><marker orient="auto" overflow="visible" markerUnits="strokeWidth" id="FilledArrow_Marker_3" viewBox="-1 -4 10 8" markerWidth="10" markerHeight="8" color="#b70000"><g><path d="M 8 0 L 0 -3 L 0 3 Z" fill="currentColor" stroke="currentColor" stroke-width="1"/></g></marker><marker orient="auto" overflow="visible" markerUnits="strokeWidth" id="FilledArrow_Marker_4" viewBox="-9 -4 10 8" markerWidth="10" markerHeight="8" color="#6c0"><g><path d="M -8 0 L 0 3 L 0 -3 Z" fill="currentColor" stroke="currentColor" stroke-width="1"/></g></marker><marker orient="auto" overflow="visible" markerUnits="strokeWidth" id="FilledArrow_Marker_5" viewBox="-1 -4 10 8" markerWidth="10" markerHeight="8" color="#d39925"><g><path d="M 8 0 L 0 -3 L 0 3 Z" fill="currentColor" stroke="currentColor" stroke-width="1"/></g></marker><font-face font-family="Helvetica Neue" font-size="9" panose-1="2 0 5 3 0 0 0 2 0 4" units-per-em="1000" underline-position="-100" underline-thickness="50" slope="0" x-height="517" cap-height="714" ascent="951.99585" descent="-212.99744" font-weight="500"><font-face-src><font-face-name name="HelveticaNeue"/></font-face-src></font-face><font-face font-family="Helvetica Neue" font-size="16" panose-1="2 0 5 3 0 0 0 2 0 4" units-per-em="1000" underline-position="-100" underline-thickness="50" slope="0" x-height="517" cap-height="714" ascent="951.99585" descent="-212.99744" font-weight="500"><font-face-src><font-face-name name="HelveticaNeue"/></font-face-src></font-face><marker orient="auto" overflow="visible" markerUnits="strokeWidth" id="FilledArrow_Marker_6" viewBox="-1 -4 8 8" markerWidth="8" markerHeight="8" color="#6c0"><g><path d="M 5.6 0 L 0 -2.1 L 0 2.1 Z" fill="currentColor" stroke="currentColor" stroke-width="1"/></g></marker></defs><g stroke="none" stroke-opacity="1" stroke-dasharray="none" fill="none" fill-opacity="1"><title>Canvas 1</title><g><title>Railroad</title><path d="M 316.77165 279.28345 L 323.77165 279.28345 L 385.1811 279.28345 C 388.4948 279.28345 391.1811 281.96974 391.1811 285.28345 L 391.1811 396.8504 L 391.1811 405.02362 C 391.1811 408.33733 393.8674 411.02362 397.1811 411.02362 L 408.18897 411.02362 L 674.31496 411.02362 C 677.62867 411.02362 680.31496 408.33733 680.31496 405.02362 L 680.31496 396.8504 L 680.31496 321.64567 L 680.31496 314.64567" stroke="#b70000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><rect x="558.4252" y="303.30708" width="90.70866" height="30.330709" fill="#f6ffec"/><rect x="558.4252" y="303.30708" width="90.70866" height="30.330709" stroke="#6c0" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(563.4252 312.47244)" fill="black"><tspan font-family="Helvetica" font-size="10" font-weight="500" x="20.066245" y="10" textLength="40.576172">module x</tspan></text><path d="M 649.13385 355.25197 L 656.13385 355.25197 L 674.31496 355.25197 C 677.62867 355.25197 680.31496 352.56567 680.31496 349.25197 L 680.31496 321.64567 L 680.31496 314.64567" stroke="#b70000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><rect x="558.4252" y="332.50393" width="90.70866" height="30.330709" fill="#f6ffec"/><rect x="558.4252" y="332.50393" width="90.70866" height="30.330709" stroke="#6c0" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(563.4252 341.66929)" fill="black"><tspan font-family="Helvetica" font-size="10" font-weight="500" x="20.066245" y="10" textLength="40.576172">module y</tspan></text><path d="M 629.29133 505.55905 L 636.29133 505.55905 L 674.31496 505.55905 C 677.62867 505.55905 680.31496 502.87276 680.31496 499.55905 L 680.31496 321.64567 L 680.31496 314.64567" stroke="#b70000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><line x1="181.41732" y1="270.28346" x2="216.87165" y2="270.28346" marker-end="url(#FilledArrow_Marker)" stroke="#00c0c0" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(61.692913 206.75984)" fill="black"><tspan font-family="Helvetica Neue" font-size="14" font-weight="500" x=".212" y="13" textLength="51.576">server {}</tspan></text><rect x="510.23622" y="490.3937" width="119.05512" height="30.33071" fill="#b70000"/><rect x="510.23622" y="490.3937" width="119.05512" height="30.33071" stroke="#b70000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(515.23622 499.55905)" fill="white"><tspan font-family="Helvetica" font-size="10" font-weight="500" fill="white" x="3.3947462" y="10" textLength="58.339844">Post-Proxy-T</tspan><tspan font-family="Helvetica" font-size="10" font-weight="500" fill="white" x="61.187715" y="10" textLength="18.901367">ype </tspan><tspan font-family="Helvetica" font-size="10" font-style="italic" font-weight="500" fill="white" x="80.08908" y="10" textLength="16.113281">Fail</tspan><tspan font-family="Helvetica" font-size="10" font-weight="500" fill="white" x="96.202363" y="10" textLength="9.458008"> {}</tspan></text><path d="M 316.77165 270.28345 L 322.67165 270.28345 C 325.98536 270.28345 328.67165 272.96974 328.67165 276.28345 L 328.67165 276.7874 C 328.67165 280.10111 325.98536 282.7874 322.67165 282.7874 L 221.43307 282.7874 C 218.11936 282.7874 215.43307 285.4737 215.43307 288.7874 L 215.43307 295.46458 C 215.43307 298.77829 218.11936 301.46458 221.43307 301.46458 L 243.21811 301.46458 L 245.21811 301.46458" marker-end="url(#FilledArrow_Marker)" stroke="#00c0c0" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" stroke-dasharray="2,2"/><path d="M 316.77165 270.28345 L 322.67165 270.28345 C 325.98536 270.28345 328.67165 272.96974 328.67165 276.28345 L 328.67165 276.7874 C 328.67165 280.10111 325.98536 282.7874 322.67165 282.7874 L 221.43307 282.7874 C 218.11936 282.7874 215.43307 285.4737 215.43307 288.7874 L 215.43307 323.81103 C 215.43307 327.12474 218.11936 329.81103 221.43307 329.81103 L 243.21811 329.81103 L 245.21811 329.81103" marker-end="url(#FilledArrow_Marker)" stroke="#00c0c0" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" stroke-dasharray="2,2"/><path d="M 316.77165 270.28345 L 322.67165 270.28345 C 325.98536 270.28345 328.67165 272.96974 328.67165 276.28345 L 328.67165 276.7874 C 328.67165 280.10111 325.98536 282.7874 322.67165 282.7874 L 221.43307 282.7874 C 218.11936 282.7874 215.43307 285.4737 215.43307 288.7874 L 215.43307 352.1575 C 215.43307 355.4712 218.11936 358.1575 221.43307 358.1575 L 243.21811 358.1575 L 245.21811 358.1575" marker-end="url(#FilledArrow_Marker)" stroke="#00c0c0" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" stroke-dasharray="2,2"/><rect x="481.88976" y="252.28346" width="90.70866" height="119.05512" fill="#6c0"/><rect x="481.88976" y="252.28346" width="90.70866" height="119.05512" stroke="#6c0" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(482.93955 265.7874)" fill="black"><tspan font-family="Helvetica" font-size="10" font-weight="500" x="12.637224" y="10" textLength="65.05371">Authenticate {}</tspan></text><rect x="558.4252" y="360.8504" width="90.70866" height="30.330709" fill="#f6ffec"/><rect x="558.4252" y="360.8504" width="90.70866" height="30.330709" stroke="#6c0" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(563.4252 370.01575)" fill="black"><tspan font-family="Helvetica" font-size="10" font-weight="500" x="20.066245" y="10" textLength="40.576172">module z</tspan></text><rect x="481.88976" y="342.99213" width="90.70866" height="30.330709" fill="#dfffd1"/><rect x="481.88976" y="342.99213" width="90.70866" height="30.330709" stroke="#6c0" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(486.88976 352.15749)" fill="black"><tspan font-family="Helvetica" font-size="10" font-weight="500" x="8.9431976" y="10" textLength="30.009766">Auth-T</tspan><tspan font-family="Helvetica" font-size="10" font-weight="500" x="38.406088" y="10" textLength="33.359375">ype z {}</tspan></text><path d="M 398.44456 329.81103 L 410.34456 329.81103 L 448.2992 329.81103 C 451.19544 329.81103 453.5433 327.46317 453.5433 324.56693 L 453.5433 319.32282 L 453.5433 307.46458 C 453.5433 304.15087 456.2296 301.46458 459.5433 301.46458 L 469.98976 301.46458 L 471.98976 301.46458" marker-end="url(#FilledArrow_Marker_2)" stroke="#6c0" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><line x1="399.5" y1="329.81103" x2="471.98976" y2="329.81103" marker-end="url(#FilledArrow_Marker_2)" stroke="#6c0" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><path d="M 649.13385 326.05512 L 661.03385 326.05512 L 674.61023 326.05512 C 677.76086 326.05512 680.31496 323.50102 680.31496 320.3504 L 680.31496 314.64567 L 680.31496 307.46458 C 680.31496 304.15087 683.00125 301.46458 686.31496 301.46458 L 753.45433 301.46458 L 755.45433 301.46458" marker-end="url(#FilledArrow_Marker_3)" stroke="#b70000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><path d="M 216.87165 474.37795 L 214.87165 474.37795 L 204.4252 474.37795 C 201.11149 474.37795 198.4252 477.06424 198.4252 480.37795 L 198.4252 519.59055 L 198.4252 527.9055 C 198.4252 531.2192 195.7389 533.9055 192.4252 533.9055 L 182.30945 533.9055 L 170.40945 533.9055" marker-start="url(#FilledArrow_Marker_4)" stroke="#6c0" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><path d="M 316.77165 474.37795 L 328.67165 474.37795 L 399.3307 474.37795 L 469.98976 474.37795 L 471.98976 474.37795" marker-end="url(#FilledArrow_Marker_5)" stroke="#d39925" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><path d="M 951.16535 252.28345 L 1024.5827 252.28345 C 1033.2669 252.28345 1040.31496 260.34745 1040.31496 270.28345 C 1040.31496 280.21945 1033.2669 288.28345 1024.5827 288.28345 L 951.16535 288.28345 C 942.48113 288.28345 935.43307 280.21945 935.43307 270.28345 C 935.43307 260.34745 942.48113 252.28345 951.16535 252.28345" fill="white"/><path d="M 951.16535 252.28345 L 1024.5827 252.28345 C 1033.2669 252.28345 1040.31496 260.34745 1040.31496 270.28345 C 1040.31496 280.21945 1033.2669 288.28345 1024.5827 288.28345 L 951.16535 288.28345 C 942.48113 288.28345 935.43307 280.21945 935.43307 270.28345 C 935.43307 260.34745 942.48113 252.28345 951.16535 252.28345" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(950.92125 264.28345)" fill="black"><tspan font-family="Helvetica" font-size="10" font-weight="500" x="2.2091039" y="10" textLength="38.354492">Listener </tspan><tspan font-family="Helvetica" font-size="10" font-style="italic" font-weight="500" x="40.563596" y="10" textLength="31.132812">proto a</tspan></text><line x1="827.71653" y1="270.28345" x2="925.53307" y2="270.28345" marker-end="url(#FilledArrow_Marker_5)" stroke="#d39925" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><path d="M 649.13385 383.59842 L 656.13385 383.59842 L 674.31496 383.59842 C 677.62867 383.59842 680.31496 380.91213 680.31496 377.59842 L 680.31496 321.64567 L 680.31496 314.64567" stroke="#b70000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><path d="M 892.9134 301.46458 L 904.8134 301.46458 L 908.78464 301.46458 C 910.9779 301.46458 912.7559 299.68658 912.7559 297.49332 L 912.7559 283.46457 L 912.7559 275.67203 C 912.7559 272.696 915.16845 270.28345 918.1445 270.28345 L 923.53307 270.28345 L 925.53307 270.28345" marker-end="url(#FilledArrow_Marker_3)" stroke="#b70000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(897.83464 618.96063)" fill="black"><tspan font-family="Helvetica Neue" font-size="9" font-weight="500" x="0" y="9" textLength="83.511">Author Arran Cudbar</tspan><tspan font-family="Helvetica Neue" font-size="9" font-weight="500" x="83.349" y="9" textLength="23.832">d-Bell</tspan><tspan font-family="Helvetica Neue" font-size="9" font-weight="500" x="0" y="20" textLength="113.706">Copyright 2014-2015 The Fr</tspan><tspan font-family="Helvetica Neue" font-size="9" font-weight="500" x="113.544" y="20" textLength="53.496">eeRADIUS pr</tspan><tspan font-family="Helvetica Neue" font-size="9" font-weight="500" x="166.878" y="20" textLength="19.665">oject</tspan><tspan font-family="Helvetica Neue" font-size="9" font-weight="500" x="0" y="31" textLength="9.495">Cr</tspan><tspan font-family="Helvetica Neue" font-size="9" font-weight="500" x="9.333" y="31" textLength="126.855">eative commons license CC BY</tspan></text><path d="M 577.55905 483.37795 L 584.55905 483.37795 L 674.31496 483.37795 C 677.62867 483.37795 680.31496 480.69166 680.31496 477.37795 L 680.31496 464.8819 L 680.31496 396.70775 L 680.31496 389.70775" stroke="#b70000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><path d="M 397.93045 329.81103 L 409.83045 329.81103 L 447.5433 329.81103 C 450.857 329.81103 453.5433 332.49732 453.5433 335.81103 L 453.5433 345.82677 L 453.5433 352.15749 C 453.5433 355.4712 456.2296 358.15749 459.5433 358.15749 L 469.98976 358.15749 L 471.98976 358.15749" marker-end="url(#FilledArrow_Marker_2)" stroke="#6c0" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><path d="M 345.82677 301.46458 L 352.82677 301.46458 L 362.50393 301.46458 C 365.81764 301.46458 368.50393 304.15087 368.50393 307.46458 L 368.50393 320.31496 L 368.50393 325.063 C 368.50393 327.68526 370.6297 329.81103 373.25197 329.81103 L 474.88976 329.81103 L 481.88976 329.81103" stroke="#6c0" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><path d="M 737.71653 270.28345 L 730.71653 270.28345 L 672.14173 270.28345 C 668.828 270.28345 666.14173 272.96974 666.14173 276.28345 L 666.14173 328.8189 L 666.14173 371.0118 C 666.14173 373.7754 663.9014 376.01575 661.1378 376.01575 L 656.13385 376.01575 L 649.13385 376.01575" stroke="#d39925" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><path d="M 649.13385 318.47244 L 656.13385 318.47244 L 661.1378 318.47244 C 663.9014 318.47244 666.14173 316.2321 666.14173 313.4685 L 666.14173 303.30708 L 666.14173 276.28345 C 666.14173 272.96974 668.828 270.28345 672.14173 270.28345 L 730.71653 270.28345 L 737.71653 270.28345" stroke="#d39925" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><rect x="481.88976" y="314.64568" width="90.70866" height="30.330709" fill="#dfffd1"/><rect x="481.88976" y="314.64568" width="90.70866" height="30.330709" stroke="#6c0" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(486.88976 323.81103)" fill="black"><tspan font-family="Helvetica" font-size="10" font-weight="500" x="8.9431976" y="10" textLength="30.009766">Auth-T</tspan><tspan font-family="Helvetica" font-size="10" font-weight="500" x="38.406088" y="10" textLength="18.901367">ype </tspan><tspan font-family="Helvetica" font-size="10" font-style="italic" font-weight="500" x="57.307455" y="10" textLength="5">y</tspan><tspan font-family="Helvetica" font-size="10" font-weight="500" x="62.307455" y="10" textLength="9.458008"> {}</tspan></text><rect x="481.88976" y="286.29922" width="90.70866" height="30.330709" fill="#dfffd1"/><rect x="481.88976" y="286.29922" width="90.70866" height="30.330709" stroke="#6c0" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(486.88976 295.46458)" fill="black"><tspan font-family="Helvetica" font-size="10" font-weight="500" x="8.9431976" y="10" textLength="30.009766">Auth-T</tspan><tspan font-family="Helvetica" font-size="10" font-weight="500" x="38.406088" y="10" textLength="33.359375">ype x {}</tspan></text><rect x="481.88976" y="456.37795" width="95.66929" height="36" fill="#d39925"/><rect x="481.88976" y="456.37795" width="95.66929" height="36" stroke="#d39925" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(486.88976 468.37795)" fill="black"><tspan font-family="Helvetica" font-size="10" font-weight="500" x="13.654958" y="10" textLength="58.359375">Post-Proxy {}</tspan></text><path d="M 92.267716 252.28346 L 165.68504 252.28346 C 174.36926 252.28346 181.41732 260.34746 181.41732 270.28346 C 181.41732 280.21946 174.36926 288.28346 165.68504 288.28346 L 92.267716 288.28346 C 83.583496 288.28346 76.535433 280.21946 76.535433 270.28346 C 76.535433 260.34746 83.583496 252.28346 92.267716 252.28346" fill="white"/><path d="M 92.267716 252.28346 L 165.68504 252.28346 C 174.36926 252.28346 181.41732 260.34746 181.41732 270.28346 C 181.41732 280.21946 174.36926 288.28346 165.68504 288.28346 L 92.267716 288.28346 C 83.583496 288.28346 76.535433 280.21946 76.535433 270.28346 C 76.535433 260.34746 83.583496 252.28346 92.267716 252.28346" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(92.02362 264.28346)" fill="black"><tspan font-family="Helvetica" font-size="10" font-weight="500" x="2.2091039" y="10" textLength="38.354492">Listener </tspan><tspan font-family="Helvetica" font-size="10" font-style="italic" font-weight="500" x="40.563596" y="10" textLength="31.132812">proto a</tspan></text><path d="M 737.71653 270.28345 L 730.71653 270.28345 L 672.14173 270.28345 C 668.828 270.28345 666.14173 272.96974 666.14173 276.28345 L 666.14173 328.8189 L 666.14173 342.66535 C 666.14173 345.42895 663.9014 347.66929 661.1378 347.66929 L 656.13385 347.66929 L 649.13385 347.66929" stroke="#d39925" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><path d="M 245.21811 505.55903 L 243.21811 505.55903 L 232.77165 505.55903 C 229.45794 505.55903 226.77165 508.24532 226.77165 511.55903 L 226.77165 518.74015 L 226.77165 527.9055 C 226.77165 531.2192 224.08536 533.9055 220.77165 533.9055 L 193.4 533.9055 L 181.5 533.9055" marker-start="url(#FilledArrow_Marker_4)" stroke="#6c0" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><path d="M 245.21811 562.25194 L 243.21811 562.25194 L 232.77165 562.25194 C 229.45794 562.25194 226.77165 559.56565 226.77165 556.25194 L 226.77165 549.92126 L 226.77165 539.9055 C 226.77165 536.59178 224.08536 533.9055 220.77165 533.9055 L 197.40001 533.9055 L 185.50001 533.9055" marker-start="url(#FilledArrow_Marker_4)" stroke="#6c0" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(61.692913 167.5748)" fill="black"><tspan font-family="Helvetica Neue" font-size="16" font-weight="500" x=".124" y="15" textLength="72.304">Request fl</tspan><tspan font-family="Helvetica Neue" font-size="16" font-weight="500" x="72.428" y="15" textLength="40.272">ow Fr</tspan><tspan font-family="Helvetica Neue" font-size="16" font-weight="500" x="112.412" y="15" textLength="156.464">eeRADIUS 2.2.x-3.0.x</tspan></text><path d="M 827.71653 270.28345 L 832.6008 270.28345 C 836.47547 270.28345 839.61653 273.42451 839.61653 277.2992 L 839.61653 277.2992 C 839.61653 281.1739 836.47547 284.31496 832.6008 284.31496 L 731.40945 284.31496 C 726.6737 284.31496 722.83464 288.15403 722.83464 292.88977 L 722.83464 292.88977 C 722.83464 297.6255 726.6737 301.46458 731.40945 301.46458 L 753.45433 301.46458 L 755.45433 301.46458" marker-end="url(#FilledArrow_Marker_3)" stroke="#b70000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" stroke-dasharray="2,2"/><rect x="765.35433" y="286.29922" width="127.559054" height="30.33071" fill="#b70000"/><rect x="765.35433" y="286.29922" width="127.559054" height="30.33071" stroke="#b70000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(770.35433 295.46458)" fill="white"><tspan font-family="Helvetica" font-size="10" font-weight="500" fill="white" x="4.0261092" y="10" textLength="53.34961">Post-Auth-T</tspan><tspan font-family="Helvetica" font-size="10" font-weight="500" fill="white" x="56.828844" y="10" textLength="18.901367">ype </tspan><tspan font-family="Helvetica" font-size="10" font-style="italic" font-weight="500" fill="white" x="75.73021" y="10" textLength="28.344727">Reject</tspan><tspan font-family="Helvetica" font-size="10" font-weight="500" fill="white" x="104.07494" y="10" textLength="9.458008"> {}</tspan></text><rect x="737.71653" y="252.28345" width="90" height="36" fill="#d39925"/><rect x="737.71653" y="252.28345" width="90" height="36" stroke="#d39925" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(742.71653 264.28345)" fill="black"><tspan font-family="Helvetica" font-size="10" font-weight="500" x="13.31543" y="10" textLength="53.36914">Post-Auth {}</tspan></text><path d="M 354.3307 569.83462 L 361.3307 569.83462 L 385.1811 569.83462 C 388.4948 569.83462 391.1811 567.14833 391.1811 563.83462 L 391.1811 425.19685 L 391.1811 416.02756 C 391.1811 413.26396 393.42144 411.02362 396.18504 411.02362 L 401.18897 411.02362 L 408.18897 411.02362" stroke="#b70000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><path d="M 354.3307 541.48817 L 361.3307 541.48817 L 385.1811 541.48817 C 388.4948 541.48817 391.1811 538.80187 391.1811 535.48817 L 391.1811 521.5748 L 391.1811 432.19685 L 391.1811 425.19685" stroke="#b70000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><path d="M 354.3307 513.1417 L 361.3307 513.1417 L 385.1811 513.1417 C 388.4948 513.1417 391.1811 510.45542 391.1811 507.1417 L 391.1811 496.063 L 391.1811 432.19685 L 391.1811 425.19685" stroke="#b70000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><path d="M 316.77165 480.37795 L 323.77165 480.37795 L 385.1811 480.37795 C 388.4948 480.37795 391.1811 477.69166 391.1811 474.37795 L 391.1811 466.3937 L 391.1811 432.19685 L 391.1811 425.19685" stroke="#b70000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><path d="M 345.82677 363.2126 L 352.82677 363.2126 L 385.1811 363.2126 C 388.4948 363.2126 391.1811 365.8989 391.1811 369.2126 L 391.1811 382.67716 L 391.1811 389.8504 L 391.1811 396.8504" stroke="#b70000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><path d="M 345.82677 334.86615 L 352.82677 334.86615 L 385.1811 334.86615 C 388.4948 334.86615 391.1811 337.55244 391.1811 340.86615 L 391.1811 371.33858 L 391.1811 389.8504 L 391.1811 396.8504" stroke="#b70000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><path d="M 391.1811 396.8504 L 391.1811 389.8504 L 391.1811 342.99212 L 391.1811 312.5197 C 391.1811 309.20599 388.4948 306.5197 385.1811 306.5197 L 352.82677 306.5197 L 345.82677 306.5197" stroke="#b70000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><path d="M 354.3307 533.9055 L 366.2307 533.9055 L 370.20197 533.9055 C 372.39523 533.9055 374.17323 532.1275 374.17323 529.93423 L 374.17323 498.89763 L 374.17323 480.37795 C 374.17323 477.06424 376.85952 474.37795 380.17323 474.37795 L 469.98976 474.37795 L 471.98976 474.37795" marker-end="url(#FilledArrow_Marker_5)" stroke="#d39925" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><path d="M 481.88976 474.37795 L 474.88976 474.37795 L 380.17323 474.37795 C 376.85952 474.37795 374.17323 477.06424 374.17323 480.37795 L 374.17323 498.89763 L 374.17323 556.25194 C 374.17323 559.56565 371.48693 562.25194 368.17323 562.25194 L 361.3307 562.25194 L 354.3307 562.25194" stroke="#d39925" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><path d="M 481.88976 474.37795 L 474.88976 474.37795 L 380.17323 474.37795 C 376.85952 474.37795 374.17323 477.06424 374.17323 480.37795 L 374.17323 493.22834 L 374.17323 499.55903 C 374.17323 502.87274 371.48693 505.55903 368.17323 505.55903 L 361.3307 505.55903 L 354.3307 505.55903" stroke="#d39925" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><path d="M 345.82677 329.81103 L 352.82677 329.81103 L 405.02362 329.81103 C 408.33733 329.81103 411.02362 332.49732 411.02362 335.81103 L 411.02362 418.19685 L 411.02362 425.19685" stroke="#6c0" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><path d="M 345.82677 358.1575 L 352.82677 358.1575 L 362.50393 358.1575 C 365.81764 358.1575 368.50393 355.4712 368.50393 352.1575 L 368.50393 345.82677 L 368.50393 335.81103 C 368.50393 332.49732 371.19023 329.81103 374.50393 329.81103 L 474.88976 329.81103 L 481.88976 329.81103" stroke="#6c0" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><path d="M 316.77165 270.28345 L 326.27165 270.28345 L 405.02362 270.28345 C 408.33733 270.28345 411.02362 272.96974 411.02362 276.28345 L 411.02362 303.30708 L 411.02362 323.81103 C 411.02362 327.12474 413.7099 329.81103 417.02362 329.81103 L 472.38976 329.81103 L 474.38976 329.81103" marker-end="url(#FilledArrow_Marker_6)" stroke="#6c0" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(61.692913 638.80315)" fill="black"><tspan font-family="Helvetica Neue" font-size="9" font-weight="500" x="0" y="9" textLength="119.331">Reject path is followed if the r</tspan><tspan font-family="Helvetica Neue" font-size="9" font-weight="500" x="119.169" y="9" textLength="132.012">code set for a section when the r</tspan><tspan font-family="Helvetica Neue" font-size="9" font-weight="500" x="251.019" y="9" textLength="141.372">equest leaves, is not ok or updated</tspan></text><rect x="255.11811" y="490.39368" width="99.2126" height="30.33071" fill="#dfffd1"/><rect x="255.11811" y="490.39368" width="99.2126" height="30.33071" stroke="#6c0" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(260.11811 499.55903)" fill="black"><tspan font-family="Helvetica" font-size="10" font-weight="500" x="1.25424814" y="10" textLength="53.8916">Pre-Proxy-T</tspan><tspan font-family="Helvetica" font-size="10" font-weight="500" x="54.598975" y="10" textLength="18.901367">ype </tspan><tspan font-family="Helvetica" font-size="10" font-style="italic" font-weight="500" x="73.50034" y="10" textLength="5">x</tspan><tspan font-family="Helvetica" font-size="10" font-weight="500" x="78.50034" y="10" textLength="9.458008"> {}</tspan></text><rect x="255.11811" y="547.0866" width="99.2126" height="30.33071" fill="#dfffd1"/><rect x="255.11811" y="547.0866" width="99.2126" height="30.33071" stroke="#6c0" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(260.11811 556.25194)" fill="black"><tspan font-family="Helvetica" font-size="10" font-weight="500" x="1.25424814" y="10" textLength="53.8916">Pre-Proxy-T</tspan><tspan font-family="Helvetica" font-size="10" font-weight="500" x="54.598975" y="10" textLength="18.901367">ype </tspan><tspan font-family="Helvetica" font-size="10" font-style="italic" font-weight="500" x="73.50034" y="10" textLength="5">z</tspan><tspan font-family="Helvetica" font-size="10" font-weight="500" x="78.50034" y="10" textLength="9.458008"> {}</tspan></text><rect x="255.11811" y="518.74013" width="99.2126" height="30.33071" fill="#dfffd1"/><rect x="255.11811" y="518.74013" width="99.2126" height="30.33071" stroke="#6c0" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(260.11811 527.9055)" fill="black"><tspan font-family="Helvetica" font-size="10" font-weight="500" x="1.25424814" y="10" textLength="53.8916">Pre-Proxy-T</tspan><tspan font-family="Helvetica" font-size="10" font-weight="500" x="54.598975" y="10" textLength="18.901367">ype </tspan><tspan font-family="Helvetica" font-size="10" font-style="italic" font-weight="500" x="73.50034" y="10" textLength="5">y</tspan><tspan font-family="Helvetica" font-size="10" font-weight="500" x="78.50034" y="10" textLength="9.458008"> {}</tspan></text><path d="M 577.55905 474.37795 L 589.45905 474.37795 L 660.14173 474.37795 C 663.45544 474.37795 666.14173 471.69166 666.14173 468.37795 L 666.14173 371.33858 L 666.14173 276.28345 C 666.14173 272.96974 668.828 270.28345 672.14173 270.28345 L 725.81653 270.28345 L 727.81653 270.28345" marker-end="url(#FilledArrow_Marker_5)" stroke="#d39925" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><path d="M 411.02362 319.46458 L 411.02362 425.19685 L 411.02362 436.20472 C 411.02362 439.51843 408.33733 442.20472 405.02362 442.20472 L 201.25984 442.20472 L 170.40945 442.20472 C 167.09574 442.20472 164.40945 444.89101 164.40945 448.20472 L 164.40945 520.7244 L 164.40945 527.9055 C 164.40945 531.2192 167.09574 533.9055 170.40945 533.9055 L 243.21811 533.9055 L 245.21811 533.9055" marker-end="url(#FilledArrow_Marker_2)" stroke="#6c0" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><rect x="255.11811" y="286.29922" width="90.70866" height="30.33071" fill="#d0e6da"/><rect x="255.11811" y="286.29922" width="90.70866" height="30.33071" stroke="#00c0c0" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(260.11811 295.46458)" fill="black"><tspan font-family="Helvetica" font-size="10" font-weight="500" x="8.9431976" y="10" textLength="29.448242">Autz-T</tspan><tspan font-family="Helvetica" font-size="10" font-weight="500" x="37.844565" y="10" textLength="18.901367">ype </tspan><tspan font-family="Helvetica" font-size="10" font-style="italic" font-weight="500" x="56.745932" y="10" textLength="5.5615234">a</tspan><tspan font-family="Helvetica" font-size="10" font-weight="500" x="62.307455" y="10" textLength="9.458008"> {}</tspan></text><rect x="255.11811" y="314.64568" width="90.70866" height="30.33071" fill="#d0e6da"/><rect x="255.11811" y="314.64568" width="90.70866" height="30.33071" stroke="#00c0c0" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(260.11811 323.81103)" fill="black"><tspan font-family="Helvetica" font-size="10" font-weight="500" x="8.9431976" y="10" textLength="29.448242">Autz-T</tspan><tspan font-family="Helvetica" font-size="10" font-weight="500" x="37.844565" y="10" textLength="18.901367">ype </tspan><tspan font-family="Helvetica" font-size="10" font-style="italic" font-weight="500" x="56.745932" y="10" textLength="5.5615234">b</tspan><tspan font-family="Helvetica" font-size="10" font-weight="500" x="62.307455" y="10" textLength="9.458008"> {}</tspan></text><rect x="255.11811" y="342.99213" width="90.70866" height="30.33071" fill="#d0e6da"/><rect x="255.11811" y="342.99213" width="90.70866" height="30.33071" stroke="#00c0c0" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(260.11811 352.1575)" fill="black"><tspan font-family="Helvetica" font-size="10" font-weight="500" x="9.2239594" y="10" textLength="29.448242">Autz-T</tspan><tspan font-family="Helvetica" font-size="10" font-weight="500" x="38.125327" y="10" textLength="18.901367">ype </tspan><tspan font-family="Helvetica" font-size="10" font-style="italic" font-weight="500" x="57.026694" y="10" textLength="5">c</tspan><tspan font-family="Helvetica" font-size="10" font-weight="500" x="62.026694" y="10" textLength="9.458008"> {}</tspan></text><rect x="226.77165" y="456.37795" width="90" height="36" fill="#6c0"/><rect x="226.77165" y="456.37795" width="90" height="36" stroke="#6c0" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(231.77165 468.37795)" fill="black"><tspan font-family="Helvetica" font-size="10" font-weight="500" x="13.0444336" y="10" textLength="53.911133">Pre-Proxy {}</tspan></text><rect x="226.77165" y="252.28345" width="90" height="36" fill="#00c0c0"/><rect x="226.77165" y="252.28345" width="90" height="36" stroke="#00c0c0" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(231.77165 264.28345)" fill="black"><tspan font-family="Helvetica" font-size="10" font-weight="500" x="14.147949" y="10" textLength="51.704102">Authorize {}</tspan></text></g></g></svg>
diff -urpN freeradius-server-3.2.7/doc/antora/modules/concepts/nav.adoc freeradius-server-3.2.8/doc/antora/modules/concepts/nav.adoc
--- freeradius-server-3.2.7/doc/antora/modules/concepts/nav.adoc	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/concepts/nav.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -1,6 +1,20 @@
 * xref:index.adoc[Concepts]
-** General
-*** xref:aaa.adoc[AAA]
-** Modules
-*** LDAP
-**** xref:modules/ldap/authentication.adoc[Authentication]
+** xref:overview.adoc[Overview]
+*** xref:freeradius.adoc[What is FreeRADIUS?]
+*** xref:aaa/aaa.adoc[Authentication Authorization Accounting (AAA)]
+**** xref:aaa/authz.adoc[Authorization]
+**** xref:aaa/authn.adoc[Authentication]
+**** xref:aaa/acct.adoc[Accounting]
+*** xref:components/architecture.adoc[RADIUS System Components]
+**** xref:components/nas.adoc[Network Access Server (NAS)]
+**** xref:components/radius_servers.adoc[RADIUS Server]
+***** xref:components/radius_servers.adoc#policy[Server Policies]
+**** xref:components/datastore.adoc[Datastores]
+*** xref:session/radius_session.adoc[RADIUS Sessions]
+**** xref:session/radius_session_msg.adoc[Messages]
+**** xref:session/processing.adoc[Processing]
+** xref:protocol/authproto.adoc[Protocols]
+** xref:modules/ldap/authentication.adoc[Authentication with LDAP]
+*** xref:modules/ldap/password_storage.adoc[Password Storage]
+*** xref:modules/ldap/novell.adoc[Integrate Novell]
+** xref:resources.adoc[Resources]
diff -urpN freeradius-server-3.2.7/doc/antora/modules/concepts/pages/aaa/aaa.adoc freeradius-server-3.2.8/doc/antora/modules/concepts/pages/aaa/aaa.adoc
--- freeradius-server-3.2.7/doc/antora/modules/concepts/pages/aaa/aaa.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/concepts/pages/aaa/aaa.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,33 @@
+= Authorization, Authentication, and Accounting (AAA)
+
+RADIUS is one of a number of Authentication, Authorization, and Accounting (AAA) protocols. Other examples of AAA protocols include TACACS+ and Diameter. AAA defines an architecture that authenticates and grants Authorization to users and accounts for their activity. When AAA is not used, the network architecture is "open", where anyone can gain access and do anything, without any tracking. The open network architecture is commonly used in small businesses, where access to an office can be physically controlled. The open network architecture is poorly suited to ISPs, where access needs to be strictly controlled and accounted for.
+
+It is possible to incorporate only a portion of AAA in a system. For example, if a company is not concerned about billing users for their network usage, they may decide to both authenticate and authorise users, but ignore user activity and not deal with accounting. Similarly, a monitoring system will look for unusual user activity (accounting), but may delegate the authentication and Authorization decisions to another part of the network.
+
+Without AAA, a network administrator would have to statically configure a network. Even in the earliest days of dialup access, network administrators found a static model inadequate. AAA ensures the flexibility of network policies. AAA also gives network administrators the ability to move systems; without AAA, they would have to clearly define connectivity options.
+
+Today, the proliferation of mobile devices, diverse network consumers, and varied network access methods combine to create an environment that places greater demands on AAA. AAA has a part to play in almost all the ways we access a network: wireless hotspots use AAA for security; partitioned networks require AAA to enforce access; all forms of remote access use AAA to authorise remote users.
+
+The following sections describe each part of the AAA solution, and how each one works.
+
+== AAA request handling
+
+AAA request handling refers to the process by which a system manages xref:aaa/authn.adoc[authentication], xref:aaa/authz.adoc[Authorization], and xref:aaa/acct.adoc[accounting] (AAA) services for users accessing computer resources or network services. This process involves verifying user identities, granting access based on permissions, and tracking their activities for auditing or billing purposes.
+
+Normally there are two steps in processing an authentication request
+coming from a NAS in FreeRADIUS: Authorization and authentication.
+If we use FreeRADIUS as a proxy to re-send the request to another
+RADIUS server there will be additional steps.
+
+=== Authentication vs. Authorization
+
+The following analogy illustrates the difference between Authentication and Authorization:
+
+Imagine you are driving a car and you are stopped by a police officer. The officer asks you to provide a piece of identification to identify yourself. You could, for example, use your passport, driver’s license, or ID card to prove or *authenticate* who you are. In terms of the RADIUS protocol, the authentication process identifies the user as someone who is allowed to access the network.
+
+The police officer may also ask you to prove that you are authorized to drive. In this case, there is only one document - a driver’s license - that proves that you are permitted or *authorized* to drive a car.
+
+The Authorization process combines the policy on the RADIUS server and the information in the request from the NAS. The NAS may add additional information to the request, such as the user’s Media Access Control (MAC) address. The NAS sends the information to the server, where an Authorization decision is made.
+
+// Copyright (C) 2025 Network RADIUS SAS.  Licenced under CC-by-NC 4.0.
+// This documentation was developed by Network RADIUS SAS.
diff -urpN freeradius-server-3.2.7/doc/antora/modules/concepts/pages/aaa/acct.adoc freeradius-server-3.2.8/doc/antora/modules/concepts/pages/aaa/acct.adoc
--- freeradius-server-3.2.7/doc/antora/modules/concepts/pages/aaa/acct.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/concepts/pages/aaa/acct.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,13 @@
+= Accounting
+
+Accounting refers to the recording of resources a user consumes during the time they are on the network. The information gathered can include the amount of system time used, the amount of data sent, or the quantity of data received by the user during a session.
+
+During a network session, the NAS periodically sends an accounting of user activity to the server. This accounting is a summary, and the collected data is used for billing purposes.
+
+ISPs are a large consumer of accounting data, because each user is billed for every minute of network access. However, corporations have not, historically, relied on network accounting information gathered by RADIUS because employees were not traditionally billed for network access. As their need for ongoing
+network monitoring increases, though, so does the need to store and process accounting information.
+
+The accounting summary sent by the NAS to the server does not include detailed information such as web sites visited or even how many bytes were transferred using a particular protocol (SMTP, HTTP, and so forth). That type of detailed information is only available to the NAS, and it does not send that data to the
+server.
+
+If detailed information about user activity is required, network administrators can obtain it through other protocols such as sFlow or NetFlow. Network administrators may find it difficult to tie the pieces together to get a more comprehensive understanding of user activity.
diff -urpN freeradius-server-3.2.7/doc/antora/modules/concepts/pages/aaa/authn.adoc freeradius-server-3.2.8/doc/antora/modules/concepts/pages/aaa/authn.adoc
--- freeradius-server-3.2.7/doc/antora/modules/concepts/pages/aaa/authn.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/concepts/pages/aaa/authn.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,22 @@
+= Authentication
+
+Authentication refers to the process of validating the identity of the user by matching the credentials supplied by the user (for example, name, password) to those configured on the AAA server (for example, name, password). If the credentials match, the user is authenticated and gains access to the network. If
+the credentials do not match, authentication fails, and network access is denied.
+
+Authentication can also fail if user credentials are entered incorrectly. For example, site policy may allow a user network access from an on-site location using a cleartext password. However, if the same password is entered by the user from a remote location, access may be denied.
+
+An ISP can also choose to deny network access to authenticated users if the users’ account has been suspended. An administrator can choose to permit limited network access to unknown users, as well. For example, an administrator can provide access to an area where the user can purchase additional network
+connectivity. This last example is most often seen in for-pay WiFi hotspots.
+
+Authentication is simply a process of comparing user’s credentials in request with the "known good" credentials retrieved from a database. Authentication usually deals with password encryption. The modules `pap`, `chap`, `mschap`, etc. do authentication.
+
+Some modules do both authentication and limited authorisation. For
+example, the `mschap` module authenticates MS-CHAP credentials, but it
+may also be used as an authorisation module, which verifies that
+request contains `MS-CHAP` related attribute.  If so, the module
+instructs the server to use `mschap` for authentication, too
+
+These dual modules are usually related to protocol-specific
+attributes, such as the `pap` module for the `User-Password`
+attribute, `chap` for `CHAP-Password`, `mschap` for `MS-CHAP-*`, etc.
+
diff -urpN freeradius-server-3.2.7/doc/antora/modules/concepts/pages/aaa/authz.adoc freeradius-server-3.2.8/doc/antora/modules/concepts/pages/aaa/authz.adoc
--- freeradius-server-3.2.7/doc/antora/modules/concepts/pages/aaa/authz.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/concepts/pages/aaa/authz.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,41 @@
+= Authorisation
+
+Authorisation is the process of finding and returning information
+about what the user is allowed to do.  For example, finding out what
+kind of authentication methods they are allowed to run, and what VLAN
+the user should be placed into.
+
+Authorisation modules generally "get data" from somewhere,
+e.g. `ldap`, `sql`, `files`, etc.
+
+The authentication method is usually determined when the server gets
+the users credentials from a database.  Once the credentials are
+available, the server can authenticate the user.
+
+Authorisation refers to the process of determining what permissions are granted to the user. For example, the user may or may not be permitted certain kinds of network access or allowed to issue certain commands.
+
+The NAS sends a “request” - a packet of information about the user - and the RADIUS server either grants or denies authorisation based solely on information in the “request” sent by the NAS.In each case, the RADIUS server manages the authorisation policy and the NAS enforces the policy.
+
+The NAS “request” is really a set of statements. For example, the NAS may send the RADIUS server a “request” containing the following user information:
+
+```
+“user name is Bob”
+“password is Hello”
+“ip address is 192.02.34”
+```
+
+Once the server receives the request, it uses that information to figure out what properties the user should have (i.e. “Bob” is saying he/she has IP address 192.0.2.34, do the server records contradict this statement?).
+The server then sends a reply to the NAS. The reply contains a series of statements about what properties the user should have:
+
+```
+"user name is Bob"
+"ip address is 192.0.2.78"
+```
+
+[NOTE]
+====
+The RADIUS server can’t request further information from the NAS. In contrast with SQL systems, RADIUS is limited in that it cannot make complicated queries. In SQL, queries such as "SELECT name from table where ipaddress = 192.02.34" are common. RADIUS does not have that capability. Instead, RADIUS
+only makes statements about what is, and what should be.
+====
+
+Upon receipt of a reply from the server, the NAS tries to enforce those properties on the user. properties cannot be enforced, the NAS closes the connection.
diff -urpN freeradius-server-3.2.7/doc/antora/modules/concepts/pages/components/architecture.adoc freeradius-server-3.2.8/doc/antora/modules/concepts/pages/components/architecture.adoc
--- freeradius-server-3.2.7/doc/antora/modules/concepts/pages/components/architecture.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/concepts/pages/components/architecture.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,24 @@
+= RADIUS System Components
+
+RADIUS is a network protocol, a system that defines rules and conventions for communication between network devices. Like many protocols, RADIUS uses a client-server model. A RADIUS client (also called a Network Access Server (NAS) ) sends requests to a RADIUS server. The RADIUS server then processes the
+request and sends back a response.
+
+Common NAS products include wireless access points such as the Linksys WRT54G and dial-up equipment commonly available from large network manufacturers. Common RADIUS server products include Cisco ACS, Microsoft IAS, Juniper, Open Systems Radiator, and FreeRADIUS.
+
+The RADIUS protocol shares the general concept of client-server communication with many other protocols such as HTTP and SMTP, the specifics of RADIUS communications differ. This section describes the RADIUS system in more detail, including the specific roles of the NAS, the server, and datastores such as MySQL and Lightweight Directory Access Protocol (LDAP).
+
+This section describes the RADIUS system in more detail, including the specific roles of the NAS, the server, and datastores such as MySQL and Lightweight Directory Access Protocol (LDAP).
+
+.Examples of System Components
+[opts="headers, autowidth"]
+|===
+| *Component*             | *Description*                  | *Examples*
+| User or a device        | Requests access to the network.| Laptop, tablet, modem, mobile, or VOIP phone.
+| Network Access Server (NAS)| Provides access to the network for the user or device.                                                    | Switch, wireless access point (WAP), or VPN terminator.
+| Authentication Server   | Receives authentication requests from the NAS and returns authentication results to the NAS. Optionally requests user and configuration information from the datastore. The server may also
+return configuration parameters to the NAS. Receives accounting information from the NAS.                                              | FreeRADIUS, Radiator, Network Policy Server (NPS), or an Internet Authentication Service (IAS).
+| Optional datastore such as a database or directory containing user authentication and authorisation information.| RADIUS server communicates with the datastore using a database API or LDAP.                | SQL Database, Kerberos Service Server, or an LDAP Directory.
+|===
+
+// Copyright (C) 2025 Network RADIUS SAS.  Licenced under CC-by-NC 4.0.
+// This documentation was developed by Network RADIUS SAS.
diff -urpN freeradius-server-3.2.7/doc/antora/modules/concepts/pages/components/datastore.adoc freeradius-server-3.2.8/doc/antora/modules/concepts/pages/components/datastore.adoc
--- freeradius-server-3.2.7/doc/antora/modules/concepts/pages/components/datastore.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/concepts/pages/components/datastore.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,24 @@
+= Datastore
+
+Datastores (i.e., databases or directories) permit the storage and retrieval of data. They have limited decision-making capabilities. While stored procedures are possible in most databases, they are rarely
+used when simple data storage is required.
+
+The key differences between RADIUS servers and datastores are the way they support policies and authentication. The role of a data store in the authentication process is to provide data to a RADIUS server. The server then uses an authentication method to authenticate the user.
+
+When a RADIUS server authenticates a user or stores accounting data for that user, it reads from or writes to a database or directory.User information (i.e., user name, password, credit amount) and session data (i.e., total session time and statistics for total traffic to and from the user) are stored on this database or directory.
+
+In many respects, the RADIUS protocol is similar to a remote database query language. Specifically, while an SQL or LDAP database stores user data, that database cannot be queried directly by the NAS. Instead, the NAS sends a request to the server, which in turn queries the database. This simplification of the normal database query language means that it is easy to add authentication and accounting to an NAS instead of implementing a full-featured SQL client, which would be very resource intensive and costly.
+
+.Comparison of Datastores and RADIUS Servers
+[opts="headers, autowidth"]
+|===
+| *Datastore*                                   | *RADIUS Server*
+| Stores authentication and authorisation data  | Processes data retrieved from the datastore.
+| Rarely implements policies.                   | Implements policies.
+| Supports basic authentication queries,
+such as LDAP “bind as user”                     | Support authentication protocols that include CHAP, MS-CHAP, MS-CHAPv2, and  802.1X (EAP, EAP-TLS, PEAP, EAP-TTLS, EAP-MD5).
+|===
+
+
+// Copyright (C) 2025 Network RADIUS SAS.  Licenced under CC-by-NC 4.0.
+// This documentation was developed by Network RADIUS SAS.
diff -urpN freeradius-server-3.2.7/doc/antora/modules/concepts/pages/components/nas.adoc freeradius-server-3.2.8/doc/antora/modules/concepts/pages/components/nas.adoc
--- freeradius-server-3.2.7/doc/antora/modules/concepts/pages/components/nas.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/concepts/pages/components/nas.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,61 @@
+= Network Access Server
+
+A Network Access Server (NAS) is a system that provides access to
+a network. In some cases, it's also known as a Terminal Server or Remote
+Access Server (RAS).
+
+The NAS is meant to act as a gateway to guard access to a
+protected resource. This can be anything from a telephone network,
+to printers, to the Internet.
+
+The client connects to the NAS. The NAS then connects to another
+resource asking whether the client's supplied credentials are
+valid. Based on that answer the NAS then allows or disallows
+access to the protected resource.
+
+The NAS contains no information about what clients can connect or
+what credentials are valid. All the NAS does is send the
+credentials the client supplied to a resource which does know how
+to process the credentials.
+
+== Examples
+
+The above translates into different implementations for different uses.
+Here are some examples.
+
+-   The most common use would be for access to the Internet. A
+    user opens their browser. The NAS detects that the user is not
+    currently authorized to have access to the Internet, so the NAS
+    prompts the user for their username and password. The user
+    supplies them and sends them back to the NAS. The NAS then uses
+    RADIUS to connect to an AAA server (in this case,
+    it is running FreeRADIUS) and passes off the
+    username and password to the FreeRADIUS server. The FreeRADIUS
+    server searches through its resources and finds that the
+    credentials are valid and notifies the NAS they are valid. The NAS
+    then grants the user access to the internet.
+
+-   Another use of a NAS would be in VoIP.  However,
+    instead of using a username and password, many times a phone
+    number or IP Address are used. If the phone number is a valid
+    customer then the call can be completed. Other uses might be if
+    the phone number has long distance access or is a telephone card
+    and has minutes left.
+
+== Associated Protocols
+
+Although not required, NAS are almost exclusively used with
+AAA servers. Of the AAA protocols available,
+RADIUS tends to be the most widely used.
+DIAMETER is a new protocol which extends on
+RADIUS by providing error handling and inter-domain
+communications which is starting to be implimented in some high
+end NAS.
+
+== More Information
+
+-   https://datatracker.ietf.org/doc/html/rfc2881[RFC 2881] Network Access Server Requirements Next Generation NAS Model
+-   https://datatracker.ietf.org/doc/html/rfc2881[RFC 2882] Network Access Servers Requirements: Extended RADIUS Practices
+
+// Copyright (C) 2025 Network RADIUS SAS.  Licenced under CC-by-NC 4.0.
+// This documentation was developed by Network RADIUS SAS.
diff -urpN freeradius-server-3.2.7/doc/antora/modules/concepts/pages/components/policy.adoc freeradius-server-3.2.8/doc/antora/modules/concepts/pages/components/policy.adoc
--- freeradius-server-3.2.7/doc/antora/modules/concepts/pages/components/policy.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/concepts/pages/components/policy.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,18 @@
+= Server Policies
+The RADIUS server processes an NAS request based on the following criteria:
+
+* Contents of the NAS request.
+* Information available locally to the RADUS server (flat files, SQL, LDAP).
+
+The limitations inherent in the above processing criteria mean that the server can't negotiate with a NAS to request more information. The server takes what the NAS sends and returns either an acknowledgment or a non-acknowledgment.
+
+The RADIUS server has no control over the content of the request that the NAS sends. When the RADIUS server receives the request from the NAS, it uses local policies to decide how best to respond to the NAS request. The policies may be simple, such as “accept anyone with a correct user name and password”. More complex policies may be “allow basic users to request premium services in
+non-premium hours, except for Sundays and holidays, if their payment status is current”.
+
+In all cases, the policies must be designed, implemented, and deployed by the network administrator. because policies are based on the contents of the NAS requests. Note that the NAS documentation does not always describe the content of the NAS requests. The only way for a network administrator to determine the NAS request content is to set up a test network.
+
+Test logins will result in the receipt of requests by the server. The administrator can then examine these requests to determine their content and create policies that look for those specific sets of attributes. Once
+the policy is created, the server then uses that information to make decisions.
+This process becomes more complicated when different NAS elements send the same information in different formats.
+
+For example, RADIUS has no MAC address data type, which means that the MAC address is sent as ASCII strings. Some NAS elements send a MAC address in the format of “00:01:02:03:04:05”, while others use the format “00-01-02-03-04-05”. The fact that these differences are not documented makes policy creation very difficult.In most cases, the administrator has to resort to trial and error methods to determine how to implement policies.
diff -urpN freeradius-server-3.2.7/doc/antora/modules/concepts/pages/components/radius.adoc freeradius-server-3.2.8/doc/antora/modules/concepts/pages/components/radius.adoc
--- freeradius-server-3.2.7/doc/antora/modules/concepts/pages/components/radius.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/concepts/pages/components/radius.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,31 @@
+= RADIUS
+
+RADIUS is a protocol for remote user Authorisation, Authentication and Accounting. Its primary use is for Internet Service Providers, though it may as well be used on any network that needs a centralized authentication and/or accounting service for its workstations.
+
+RADIUS is often used in larger Wi-Fi (wireless) networks for authentication purposes, replacing the simple shared key methods which are uncomfortable if a Wi-Fi network reaches a specific size.
+
+The protocol originally was designed by the well known terminal server manufacturer Livingston for use with their Portmaster series of terminal servers. Since then it has been implemented by hundreds other vendors and has a become an Internet Standard RFC.
+
+The DIAMETER protocol is the designated successor, but RADIUS is still commonly used today.
+
+== Protocol dependencies
+
+UDP: RADIUS uses UDP as its underlying protocol. The registered UDP port for RADIUS traffic is 1812; the early deployment of RADIUS used UDP port 1645, which conflicted with the "datametrics" service.  When RADIUS is used for accounting rather than authentication and configuration, the registered UDP port is 1813; the early deployment used port 1646, which conflicted with the "sa-msg-port" service.
+
+== External links
+
+* RFC 2865 Remote Authentication Dial In User Service (RADIUS)
+* RFC 2866 RADIUS Accounting
+* RFC 2867 RADIUS Accounting Modifications for Tunnel Protocol Support
+* RFC 2868 RADIUS Attributes for Tunnel Protocol Support
+* RFC 2869 RADIUS Extensions
+* RADIUS attributes and packet type codes
+
+== See Also
+
+* FreeRADIUS
+* RADIUS-Clients
+* Other RADIUS Servers
+
+// Copyright (C) 2025 Network RADIUS SAS.  Licenced under CC-by-NC 4.0.
+// This documentation was developed by Network RADIUS SAS.
diff -urpN freeradius-server-3.2.7/doc/antora/modules/concepts/pages/components/radius_servers.adoc freeradius-server-3.2.8/doc/antora/modules/concepts/pages/components/radius_servers.adoc
--- freeradius-server-3.2.7/doc/antora/modules/concepts/pages/components/radius_servers.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/concepts/pages/components/radius_servers.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,37 @@
+= RADIUS Server
+
+A RADIUS server is a central authority that handles authentication, authorisation, and accounting (AAA) for network access. The server receives requests from network access servers (NASs) like wireless access points or VPN concentrators and determines whether a user should be granted access based on predefined policies and data stored in a datastore.
+
+The RADIUS server is usually a software application running on a self-contained server. A physical device such as RADIUS appliances, with simplified maintenance and management interfaces, are also used. In either scenario, the server waits for a request from an NAS, processes or forwards the request, and then returns a response to the NAS. The response can contain authorisation policies or an acknowledgment of accounting data received.
+
+A single RADIUS server can receive and process many simultaneous access requests from numerous types of NASs (such as ADSL, dial-up, or VPN concentrators) in many different locations. A single server may also
+access flat files, SQL databases, LDAP directories, or other RADIUS servers. In order to make a decision regarding an access request, the RADIUS server must first use information from many sources.
+
+Once the server makes a decision, it returns a response to the NAS. The NAS may enforce the policy in that response, or it may ignore it altogether. The server is not aware if the NAS has received its response, or if the NAS is obeying the instructions in that response. Since it is customary for the NAS to log very little information about what has been received or how server responses are processed, it is very difficult to create and debug local site policies.
+
+The RADIUS server has no control over what the NAS does with a response.
+Consider the following analogy to help illustrate the point: a Human Resources (HR) department acts like a RADIUS server, by setting policies, and a security guard acts like the NAS in a network, by carrying out those HR department policies.
+
+In this example, the company policy is that when an employee is fired, HR notifies security and removes building access from that employee. The security guard is then responsible for ensuring the fired employee no longer accesses the company building. If one day an employee gets fired (similar to a user
+being denied access) and the HR department informs the security guard that the employee is no longer free to come and go (similar to the RADIUS server decision sent to the NAS), it is then up to the security guard at the company front desk to perform the task of refusing entry to the fired employee (similar to the NAS enforcing system access in a network). In the network, the NAS enforces system access. The RADIUS server does little more than offer advice to the NAS.
+
+[#policy]
+== RADIUS Server Policies
+
+The RADIUS server processes an NAS request based on the following criteria:
+
+* Contents of the NAS request.
+* Information available locally to the RADUS server (flat files, SQL, LDAP).
+
+This processing criteria limits the server ability to perform more complex authentication scenarios. The server can't negotiate with a NAS to request more information. The server uses the initial information that the NAS sends and returns either an acknowledgment or a non-acknowledgment.
+
+The RADIUS server has no control over the content of the request that the NAS sends. When the RADIUS server receives the request from the NAS, it uses local policies to decide how best to respond to the NAS request. The policies may be simple, such as “accept anyone with a correct user name and password”. More complex policies may be “allow basic users to request premium services in
+non-premium hours, except for Sundays and holidays, if their payment status is current”.
+
+In all cases, the policies must be designed, implemented, and deployed by the network administrator because policies are based on the contents of the NAS requests. Often, the NAS documentation doesn't describe the content of the NAS requests. The only way for a network administrator to determine the NAS request content is to set up a test network.
+
+Test logins will result in the receipt of requests by the server. The administrator can examine these requests to determine their content and create policies that look for those specific sets of attributes. Once
+the policy is created, the server then uses that information to make decisions.
+This process becomes more complex when different NAS elements send the same information in different formats.
+
+For example, RADIUS has no MAC address data type, which means that the MAC address is sent as ASCII strings. Some NAS elements send a MAC address in the format of “00:01:02:03:04:05”, while others use the format “00-01-02-03-04-05”. The fact that these differences are not documented makes policy creation very difficult.In most cases, the administrator has to resort to trial and error methods to determine how to implement policies.
diff -urpN freeradius-server-3.2.7/doc/antora/modules/concepts/pages/freeradius.adoc freeradius-server-3.2.8/doc/antora/modules/concepts/pages/freeradius.adoc
--- freeradius-server-3.2.7/doc/antora/modules/concepts/pages/freeradius.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/concepts/pages/freeradius.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,43 @@
+= What is FreeRADIUS?
+
+FreeRADIUS is the most popular and the most widely deployed open source RADIUS server in the world.
+It serves as the basis for multiple commercial offerings, and it supplies the authentication, authorisation, and accounting (AAA) needs of many Fortune 500 companies and Tier 1 ISPs. It is also widely used by the academic community (i.e., eduroam, the world-wide roaming access service developed for the international research and education community, utilises FreeRADIUS software).
+
+FreeRADIUS was started in August 1999 by Alan DeKok and Miquel van Smoorenburg. Miquel had previously written the Cistron RADIUS server software, which had been widely adopted when the Livingston server was no longer in service. FreeRADIUS was developed using a modular design, to encourage more active community involvement.
+
+== Features
+
+More authentication types are supported by FreeRADIUS than by any other open source server. For example, FreeRADIUS is the only open source RADIUS server to support Extensible Authentication Protocol (EAP).
+
+FreeRADIUS is also the only open source RADIUS server to support virtual servers. The use of virtual servers means that complex implementations are simplified. Ongoing support and maintenance costs for network administrators are greatly reduced. FreeRADIUS's ability to support virtual servers
+gives it a huge advantage over the competition.
+
+== Modularity
+
+The modular design protocol makes FreeRADIUS easy to understand. The modular interface also simplifies adding or removing modules. If a feature is not needed for a configuration, the module is removed with a simple edit of the configuration file. Once the module is removed, it does not affect server performance, memory use, or security. This flexibility enables the server to run on platforms ranging from embedded systems to multi-core machines with gigabytes of RAM.
+
+The server core does the basic RADIUS and network handling. Almost everyother feature is managed with a module. This modular design increases the flexibility of the policy language. The policy language can execute multiple modules in any order, allowing for highly customizable workflows. Each module handles a specific, isolated task such as authentication, logging, or database access.
+
+For example, each of the authentication methods (PAP,CHAP, MS-CHAP, TOTP, and EAP) are individual modules. Similarly, each database connector (SQL,Redis, LDAP, etc.) are individual modules. In many cases, no code changes to the server core have to be made in order to support complex new functionality.
+
+This modular design streamlines development, testing, and enhances the system’s adaptability to new requirements or technologies.
+
+== Scalability
+
+A single FreeRADIUS server is easily reconfigured to handle a wide range of workloads, from just a few requests per second to thousands—by adjusting a few default settings. This adaptability makes FreeRADIUS suitable for both small deployments and very large organisations, including those with over 10 million customers who rely on it for authentication, authorization, and accounting (AAA) services.
+
+A single FreeRADIUS server can transition from handling one request every few seconds to processing thousands of requests per second. These varied workloads are handled by changing a few default settings. FreeRADIUS is suitable for both small deployments and very large organisations, including those with over 10 million customers.  Often, only a single FreeRADIUS server is required to fulfill an organisation's requirements for their AAA services.
+
+While many commercial severs offer different versions of their software to handle different needs, only the latest version of FreeRADIUS provides better performance, more realms, more RADIUS clients, and more features, with no need to purchase additional product licenses.
+
+== Features
+
+* Complete support for https://datatracker.ietf.org/doc/html/rfc2865[RFC 2865] and https://datatracker.ietf.org/doc/html/rfc2866[RFC 2866] attributes.
+* Authentication Protocol supports for:
+** EAP or protocol/EAP with EAP-MD5, EAP-SIM, EAP-TLS, EAP-TTLS.
+** EAP-PEAP or protocol/EAP-PEAP.
+** Cisco LEAP or protocol/LEAP and EAP sub-types.
+* Vendor Specific Attributes for over a hundred vendors including BinTec, Foundry, Cisco, Juniper, Lucent/Ascend, HP ProCurve, Microsoft, USR/3Com.
+* All known RADIUS clients.
+* Flexible configurations using attribute pairs.
+* Supports virtual servers.
diff -urpN freeradius-server-3.2.7/doc/antora/modules/concepts/pages/index.adoc freeradius-server-3.2.8/doc/antora/modules/concepts/pages/index.adoc
--- freeradius-server-3.2.7/doc/antora/modules/concepts/pages/index.adoc	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/concepts/pages/index.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -1,8 +1,24 @@
 = Concepts
 
-This section documents concerning the protocols and modules used by the
-FreeRADIUS server.
+The Concepts guide introduces the main concepts for readers who are new to RADIUS (Remote Authentication Dial-In User Service) and its associated components.  This information explains the foundational ideas and principles behind RADIUS to help you understand what RADIUS is, what it does, and how it operates within a network environment. By covering these basics, the section aims to provide a solid starting point for further exploration or practical use of RADIUS in network authentication, authorization, and accounting.
 
-It intended to provide more theoretical information about particular subjects
-than would be appropriate to include inline in module configurations or as
-sidebars in howto guides.
+== Sections in this Guide
+
+* xref:concepts:overview.adoc[Overview] explains the RADIUS server, FreeRADIUS, and the core services provided.
+        ** xref:freeradius.adoc[What is FreeRADIUS] explains the benefits of the open-source software version.
+        ** xref:aaa/aaa.adoc[Authentication Authorisation Accounting (AAA)] explains the core services provided by FreeRADIUS.
+                *** xref:aaa/authz.adoc[Authorisation] is the process of allowing an authenticated user to access services on the network.
+                *** xref:aaa/authn.adoc[Authentication] if the process of verifying an end-user's credentials.
+                *** xref:aaa/acct.adoc[Accounting] operations record the time spent on the network and services accessed for auditing or billing purposes.
+        ** xref:components/architecture.adoc[RADIUS System Components] explains the RADIUS design and components.
+                *** xref:components/nas.adoc[Network Access Server (NAS)] outlines the NAS operations and access management.
+                *** xref:components/radius_servers.adoc[RADIUS Server] describes the role of the server and how server policies work.
+                *** xref:components/datastore.adoc[Datastores] details how datastores work and what's supported.
+        ** xref:session/radius_session.adoc[RADIUS Sessions] explains session transmission and management or these session on the network.
+                *** xref:session/radius_session_msg.adoc[Session Messages] details the format and content of session messages.
+                *** xref:session/processing.adoc[Processing] outlines the flow of messages and how aaa services are implemented.
+* xref:protocol/authproto.adoc[Protocols] defines the protocols used in the RADIUS environment.
+* xref:modules/ldap/authentication.adoc[Authentication with LDAP] can be used by RADIUS servers to authenticate the network users.
+        ** xref:modules/ldap/password_storage.adoc[Password Storage] explains the methods of how the user's information can be stored.
+        ** xref:modules/ldap/novell.adoc[Integrate Novell] with RADIUS networks using LDAP.
+* xref:resources.adoc[Resources] find more help, mailing lists, and related documentation to help learn about deploying FreeRADIUS.
diff -urpN freeradius-server-3.2.7/doc/antora/modules/concepts/pages/modules/ldap/authentication.adoc freeradius-server-3.2.8/doc/antora/modules/concepts/pages/modules/ldap/authentication.adoc
--- freeradius-server-3.2.7/doc/antora/modules/concepts/pages/modules/ldap/authentication.adoc	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/concepts/pages/modules/ldap/authentication.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -12,6 +12,8 @@ read the "known good" password from LDAP
 information to authenticate the user.  It is almost always wrong to
 use the LDAP "bind as user" method for authenticating users.
 
+include::ROOT:partial$externaldoc.adoc[]
+
 The only caveat to the above recommendation is Active Directory.  For
 "security" reasons, Active Directory will not return the "known good"
 password to FreeRADIUS over a standard LDAP query.  Therefore when
@@ -20,8 +22,8 @@ Active Directory is used, the choices ar
 PAP::
 Use "bind as user"
 
-MS-CHAP::
-Use xref:raddb:mods-available/ntlm_auth.adoc[`ntlm`] or xref:raddb:mods-available/winbind.adoc[`winbind`].
+https://github.com/FreeRADIUS/freeradius-server/blob/v3.2.x/raddb/mods-available/mschap[MS-CHAP::]
+Use https://github.com/FreeRADIUS/freeradius-server/blob/v3.2.x/raddb/mods-available/ntlm_auth[`ntlm`] and https://github.com/FreeRADIUS/freeradius-server/blob/v3.2.x/raddb/mods-available/mschap[`winbind`] configuration.
 
 Due to the limitations of Active Directory, There are unfortunately no
 other possible choices.
@@ -32,11 +34,11 @@ The credentials (username *and* password
 connect to your LDAP server(s) should be secure.  We make the
 following recommendations for LDAP "best practices" security.
 
-* Create a dedicated account for use by FreeRADIUS
+* Create a dedicated account for use by FreeRADIUS.
 
-* Ensure that this account does not have administrator access
+* Ensure that this account does not have administrator access.
 
-* Ensure that this account is read-only, and has no write permissions
+* Ensure that this account is read-only, and has no write permissions.
 
 * Start by using 'simple authentication' instead of
   https://en.wikipedia.org/wiki/Simple_Authentication_and_Security_Layer[SASL].
@@ -44,7 +46,7 @@ following recommendations for LDAP "best
   authentication' has been verified to work.
 
 * Use TLS for connecting between FreeRADIUS and the LDAP server.  See
-  the `tls` sub-section of the default `ldap` module for instructions
+  the `tls` sub-section of the default `ldap` module for instructions.
 
 * When storing RADIUS user profiles (quotas, `Simultaneous-Use` flags,
   access time restrictions, etc) in LDAP, the LDAP schema
@@ -58,7 +60,7 @@ methods.  Note that we say _compatible_,
 servers are databases, and do not support authentication protocols
 such as CHAP, MS-CHAP, or EAP.
 
-PAP::
+https://github.com/FreeRADIUS/freeradius-server/blob/v3.2.x/raddb/mods-available/pap[PAP::]
 The user supplies a `User-Password` (plaintext or EAP-TTLS/PAP)
 +
 FreeRADIUS reads the "known good" password from LDAP, and compares
@@ -71,13 +73,13 @@ FreeRADIUS uses that password to "bind a
 supplied `User-Name` and `User-Password.  If the bind is successfull,
 the user is authenticated.  Otherwise, authentication fails.
 
-CHAP::
+https://github.com/FreeRADIUS/freeradius-server/blob/v3.2.x/raddb/mods-available/chap[CHAP::]
 The user supplies a `CHAP` password attribute.
 +
 FreeRADIUS reads the "known good" password from LDAP in cleartext, and
 compares that to what the user entered.
 
-MS-CHAP::
+https://github.com/FreeRADIUS/freeradius-server/blob/v3.2.x/raddb/mods-available/mschap[MS-CHAP::]
 The user supplies a `MS-CHAP` password attribute.  Either as
 MS-CHAPv2, or as PEAP/MSCHAPv2, or as EAP-TTLS/MS-CHAPv2.
 +
@@ -94,7 +96,7 @@ involves giving the FreeRADIUS "read-onl
 `userPassword` field.
 
 Again, the best method is to test authentication is with the
-xref:howto:modules/ldap/ldapsearch/index.adoc[ldapsearch] tool.
+https://www.freeradius.org/documentation/freeradius-server/4.0.0/howto/modules/ldap/ldapsearch/index.html[ldapsearch] tool.
 These tests *must* be run prior to configuring FreeRADIUS.  We strongly
 recommend having the LDAP database return the `userPassword` field to
 FreeRADIUS, so that FreeRADIUS can authenticate the user.
@@ -109,9 +111,9 @@ more detail.
 If the `userPassword` field is returned from LDAP to FreeRADIUS, that
 information can be stored in a number of different formats:
 
-* the value can be cleartext
-* the value can be prepended with a string enclosed by braces, such as with `{crypt}` or `{ssha3}`.
-* the value can be have a suffix of `::`, in which case the password is generally a https://en.wikipedia.org/wiki/Base64[base64] encoded version of the real password
+* The value can be cleartext.
+* The value can be prepended with a string enclosed by braces, such as with `{crypt}` or `{ssha3}`.
+* The value can be have a suffix of `::`, in which case the password is generally a https://en.wikipedia.org/wiki/Base64[base64] encoded version of the real password.
 
 TIP: Base64 values can be decoded via the command: `printf "%s"
 "VALUE" | base64 -d`
@@ -121,7 +123,7 @@ formats.  There is sufficient informatio
 determine what format it is in (base64, binary, or text), and what
 password "encryption" mechanism has been used (crypt, MD5, SHA, SSHA2,
 SHA3, etc).  All that is necessary is that the
-xref:raddb:mods-available/ldap.adoc[ldap module] be configured to map
+https://github.com/FreeRADIUS/freeradius-server/tree/v3.2.x/raddb/mods-available/ldap[ldap module] be configured to map
 the `userPassword` LDAP field to the `&control.Password.With-Header`
 attribute in FreeRADIUS.  FreeRADIUS will then "do the right thing" to
 authenticate the user.
@@ -129,7 +131,7 @@ authenticate the user.
 This mapping is done in the default module configuration.  There are
 no additional changes required for FreeRADIUS to correctly read and
 decode the `userPassword` field from LDAP.  Please see the
-xref:raddb:mods-available/pap.adoc[pap module] for a full list of
+https://github.com/FreeRADIUS/freeradius-server/blob/v3.2.x/raddb/mods-available/pap[pap module] for a full list of
 supported password "encryption" formats.
 
 == Additional Considerations
@@ -199,5 +201,4 @@ policies on the user accounts can still
 integrating with RADIUS. Also, you can make use of the intruder lockout
 facility of eDirectory by logging the failed logins into eDirectory.
 
-For configuration information please refer to the Novell documentation
-https://www.netiq.com/documentation/edir_radius/
+For configuration information please refer to the https://www.netiq.com/documentation/edir_radius/[Novell documentation].
diff -urpN freeradius-server-3.2.7/doc/antora/modules/concepts/pages/modules/ldap/ldap_authentication.adoc freeradius-server-3.2.8/doc/antora/modules/concepts/pages/modules/ldap/ldap_authentication.adoc
--- freeradius-server-3.2.7/doc/antora/modules/concepts/pages/modules/ldap/ldap_authentication.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/concepts/pages/modules/ldap/ldap_authentication.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,138 @@
+= Authentication with LDAP
+
+LDAP servers function primarily as databases that store user credentials and related information. They do not implement or handle authentication protocols themselves.
+
+The RADIUS server handles the authentication protocols such as `PAP`, `CHAP`, or `MS-CHAP`.  The LDAP server is a backend accessed by the RADIUS server to verify user credentials. The LDAP module interacts with these protocols by retrieving and comparing data. The RADIUS server performs the authentication logic, not the LDAP server.
+
+The LDAP module is compatible a few different kinds of authentication
+methods.  Note that we say _compatible_, and not _supports_.  LDAP
+servers are databases, and do not support authentication protocols.
+
+PAP::
+The user supplies a `User-Password` (plaintext or EAP-TTLS/PAP)
++
+FreeRADIUS reads the "known good" password from LDAP, and compares
+that to what the user entered.
+
+Bind as user::
+The user supplies a `User-Password` (plaintext or EAP-TTLS/PAP)
++
+FreeRADIUS uses that password to "bind as the user" to LDAP, using the
+supplied `User-Name` and `User-Password.  If the bind is successfull,
+the user is authenticated.  Otherwise, authentication fails.
+
+CHAP::
+The user supplies a `CHAP` password attribute.
++
+FreeRADIUS reads the "known good" password from LDAP in cleartext, and
+compares that to what the user entered.
+
+MS-CHAP::
+The user supplies a `MS-CHAP` password attribute.  Either as
+MS-CHAPv2, or as PEAP/MSCHAPv2, or as EAP-TTLS/MS-CHAPv2.
++
+FreeRADIUS reads the "known good" password from LDAP in cleartext, or
+as an NT hash, and compares that to what the user entered.
+
+All of above authentication methods other than "bind as user" require
+that FreeRADIUS obtain the `userPassword` field from LDAP.  If that
+field is not returned to FreeRADIUS, then normal authentication is
+impossible.  Either FreeRADIUS has to be configured to use "bind as
+user" for authentication, or the LDAP database has to be updated to
+return the `userPassword` field to FreeRADIUS.  This change usually
+involves giving the FreeRADIUS "read-only" user permission to read the
+`userPassword` field.
+
+Again, the best method is to test authentication is with the
+ldap search tool. These tests *must* be
+run prior to configuring FreeRADIUS.  We strongly recommend having the
+LDAP database return the `userPassword` field to FreeRADIUS, so that
+FreeRADIUS can authenticate the user.
+
+We recommend that the passwords be stored in LDAP as
+cleartext.  Otherwise, the only authentication methods that will work
+are PAP and EAP-TTLS/PAP.  The next section explains these issues in
+more detail.
+
+== Password Storage Methods
+
+If the `userPassword` field is returned from LDAP to FreeRADIUS, that
+information can be stored in a number of different formats:
+
+* the value can be cleartext
+* the value can be prepended with a string enclosed by braces, such as with `{crypt}` or `{ssha3}`.
+* the value can be have a suffix of `::`, in which case the password is generally a https://en.wikipedia.org/wiki/Base64[base64] encoded version of the real password
+
+TIP: Base64 values can be decoded via the command: `printf "%s"
+"VALUE" | base64 -d`
+
+FreeRADIUS is capable of understanding and parsing all of the above
+formats.  There is sufficient information in the password values to
+determine what format it is in (base64, binary, or text), and what
+password "encryption" mechanism has been used (crypt, MD5, SHA, SSHA2,
+SHA3, etc).  All that is necessary is that the
+https://github.com/FreeRADIUS/freeradius-server/blob/v3.2.x/raddb/mods-available/ldap[ldap module] be configured to map
+the `userPassword` LDAP field to the `control.Password-With-Header`
+attribute in FreeRADIUS.  FreeRADIUS will then "do the right thing" to
+authenticate the user.
+
+This mapping is done in the default module configuration.  There are
+no additional changes required for FreeRADIUS to correctly read and
+decode the `userPassword` field from LDAP.  Please see the
+https://github.com/FreeRADIUS/freeradius-server/blob/v3.2.x/man/man5/rlm_pap.5[pap module] for a full list of
+supported password "encryption" formats.
+
+== Additional Considerations
+
+There are some major caveats with the above authentication methods.
+The first is that we *strongly recommend* against using "bind as
+user".  This process is slow, and causes unnecessary churn in the
+connections used to contact the LDAP server.  Further, the "bind as
+user" process works _only_ when a `User-Password attribute exists in
+the request.  If any other authentication type is used in the request,
+then the "bind as user" _will not work_.  There is no amount of
+"fixing" things or configuration changes which will make it work.
+
+The second caveat is that the `CHAP` authentication type works _only_
+when a "clear text" password is stored in the LDAP database.  The
+`CHAP` calclulations are designed around having access to the "clear
+text" password.  It is impossible to use any "encrypted" or "hashed"
+passwords with `CHAP`.
+
+The third caveat is that the `MS-CHAP` authentication type works
+_only_ when a "clear text" password or "NT hashed" passwords which are
+stored in the LDAP database.  The `MS-CHAP` calculations are designed
+around having access to "known good" passwords in those formats.  It
+is impossible to use any other kind of "encrypted" or "hashed"
+passwords with `MS-CHAP`.
+
+The final caveat is that when the LDAP database contains "encrypted"
+or "hashed" passwords, the _only_ authentication type which is
+compatible with those passwords is PAP.  i.e. when the `User-Password`
+is supplied to FreeRADIUS.
+
+For recommendations on password storage methods in LDAP, please see
+the LDAP
+https://openldap.org/doc/admin24/security.html#Password%20Storage[password
+storage] page.  Please note that the recommendations there are made
+for LDAP security, and pay no attention to the caveats described
+above.  When both RADIUS and LDAP are used together, then the
+requirements of _both_ systems must be met in order for them to work
+together.  In many cases, a naive approach to LDAP security will
+prevent RADIUS from working.
+
+The issue of a database storing passwords in clear-text has to be
+balanced against the users sending clear-text passwords in
+authentication protocols.  While those passwords are protected by TLS
+(EAP-TTLS) or by RADIUS (in it's own "encryption" mechanism), it is
+generally better to use a stronger authentication method than just
+PAP.
+
+In the end, there is no perfect solution to security requirements.
+The choice may be either to give up on using a particular
+authentication method, or to relax the security requirements on LDAP
+and on password storage.  The final decision as to which choice is
+best can only be made by a local administrator.
+
+// Copyright (C) 2025 Network RADIUS SAS.  Licenced under CC-by-NC 4.0.
+// This documentation was developed by Network RADIUS SAS.
diff -urpN freeradius-server-3.2.7/doc/antora/modules/concepts/pages/modules/ldap/novell.adoc freeradius-server-3.2.8/doc/antora/modules/concepts/pages/modules/ldap/novell.adoc
--- freeradius-server-3.2.7/doc/antora/modules/concepts/pages/modules/ldap/novell.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/concepts/pages/modules/ldap/novell.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,15 @@
+= Integrate Novell eDirectory
+
+You can integrate Novell eDirectoryTM 8.7.1 or later with FreeRADIUS to allow wireless authentication for eDirectory users. By
+integrating eDirectory with FreeRADIUS, you can do the following:
+
+* Use universal password for RADIUS authentication. Universal password
+provides single login and authentication for eDirectory users.
+Therefore, the users need not have a separate password for RADIUS and
+eDirectory authentication.
+* Enforce eDirectory account policies for users. The existing eDirectory
+policies on the user accounts can still be applied even after
+integrating with RADIUS. Also, you can make use of the intruder lockout
+facility of eDirectory by logging the failed logins into eDirectory.
+
+For configuration information please refer to the https://www.netiq.com/documentation/edir_radius/[Novell documentation].
diff -urpN freeradius-server-3.2.7/doc/antora/modules/concepts/pages/modules/ldap/password_storage.adoc freeradius-server-3.2.8/doc/antora/modules/concepts/pages/modules/ldap/password_storage.adoc
--- freeradius-server-3.2.7/doc/antora/modules/concepts/pages/modules/ldap/password_storage.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/concepts/pages/modules/ldap/password_storage.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,82 @@
+= Password Storage Methods
+
+If the `userPassword` field is returned from LDAP to FreeRADIUS, that
+information can be stored in a number of different formats:
+
+* The value can be cleartext.
+* The value can be prepended with a string enclosed by braces, such as with `{crypt}` or `{ssha3}`.
+* the value can be have a suffix of `::`, in which case the password is generally a https://en.wikipedia.org/wiki/Base64[base64] encoded version of the real password.
+
+[TIP]
+====
+Base64 values can be decoded via the command: `printf "%s"
+"VALUE" | base64 -d`.
+====
+
+FreeRADIUS understands and parses all of the above
+formats.  There is sufficient information in the password values to
+determine what format it is in (base64, binary, or text), and what
+password "encryption" mechanism has been used (crypt, MD5, SHA, SSHA2,
+SHA3, etc).  All that is necessary is that the
+xhttps://github.com/FreeRADIUS/freeradius-server/blob/v3.2.x/raddb/mods-available/ldap[ldap module] be configured to map
+the `userPassword` LDAP field to the `control.Password.With-Header`
+attribute in FreeRADIUS.  FreeRADIUS will then "do the right thing" to
+authenticate the user.
+
+This mapping is done in the default module configuration.  There are
+no additional changes required for FreeRADIUS to correctly read and
+decode the `userPassword` field from LDAP.  Please see the
+https://github.com/FreeRADIUS/freeradius-server/blob/v3.2.x/raddb/mods-available/pap[pap module] for a full list of
+supported password "encryption" formats.
+
+== Additional Considerations
+
+There are some major caveats with the above authentication methods.
+The first is that we *strongly recommend* against using "bind as
+user".  This process is slow, and causes unnecessary churn in the
+connections used to contact the LDAP server.  Further, the "bind as
+user" process works _only_ when a `User-Password attribute exists in
+the request.  If any other authentication type is used in the request,
+then the "bind as user" _will not work_.  There is no amount of
+"fixing" things or configuration changes which will make it work.
+
+The second caveat is that the `CHAP` authentication type works _only_
+when a "clear text" password is stored in the LDAP database.  The
+`CHAP` calculations are designed around having access to the "clear
+text" password.  It is impossible to use any "encrypted" or "hashed"
+passwords with `CHAP`.
+
+The third caveat is that the `MS-CHAP` authentication type works
+_only_ when a "clear text" password or "NT hashed" passwords which are
+stored in the LDAP database.  The `MS-CHAP` calculations are designed
+around having access to "known good" passwords in those formats.  It
+is impossible to use any other kind of "encrypted" or "hashed"
+passwords with `MS-CHAP`.
+
+The final caveat is that when the LDAP database contains "encrypted"
+or "hashed" passwords, the _only_ authentication type which is
+compatible with those passwords is PAP.  i.e. when the `User-Password`
+is supplied to FreeRADIUS.
+
+For recommendations on password storage methods in LDAP, please see
+the LDAP
+https://openldap.org/doc/admin24/security.html#Password%20Storage[password
+storage] page.  Please note that the recommendations there are made
+for LDAP security, and pay no attention to the caveats described
+above.  When both RADIUS and LDAP are used together, then the
+requirements of _both_ systems must be met in order for them to work
+together.  In many cases, a naive approach to LDAP security will
+prevent RADIUS from working.
+
+The issue of a database storing passwords in clear-text has to be
+balanced against the users sending clear-text passwords in
+authentication protocols.  While those passwords are protected by TLS
+(EAP-TTLS) or by RADIUS (in it's own "encryption" mechanism), it is
+generally better to use a stronger authentication method than just
+PAP.
+
+In the end, there is no perfect solution to security requirements.
+The choice may be either to give up on using a particular
+authentication method, or to relax the security requirements on LDAP
+and on password storage.  The final decision as to which choice is
+best can only be made by a local administrator.
diff -urpN freeradius-server-3.2.7/doc/antora/modules/concepts/pages/overview.adoc freeradius-server-3.2.8/doc/antora/modules/concepts/pages/overview.adoc
--- freeradius-server-3.2.7/doc/antora/modules/concepts/pages/overview.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/concepts/pages/overview.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,75 @@
+= Overview
+
+A RADIUS (Remote Authentication Dial In User Service) server offers authentication, authorisation, and accounting (AAA) services for network access.  A Network Access Servers (NAS) sends authentication and accounting requests to a RADIUS server. The server then verifies user credentials and returns configuration details to the NAS. The NAS either grants or denies network access to the end-user or device.
+
+The key concepts of any RADIUS include:
+
+* *Centralized AAA*: RADIUS servers manage network access by verifying user credentials, granting access rights, and tracking user activity. 
+
+* *Client-Server Protocol*: RADIUS uses a client-server protocol. Network Access Servers are RADIUS clients that send requests to the RADIUS server. 
+
+* *Background Process*: RADIUS servers run as background processes or daemons on UNIX systems. 
+
+* *User Credentials:* The server stores or can access user account information and verifies authentication requests. 
+
+* *Configuration Details*: The RADIUS server sends details to the client, enabling it to grant or deny network access. 
+
+== What is RADIUS?
+
+RADIUS is a network protocol that defines rules and conventions for communication between network devices for remote user authentication and accounting. Commonly used by Internet Service Providers (ISPs), cellular network
+providers, and corporate and educational networks, the RADIUS protocol serves three primary functions:
+
+* Authenticates users or devices before allowing them access to a network.
+* Authorises those users or devices for specific network services.
+* Accounts for and tracks the usage of those services.
+
+=== History
+
+In 1991, Merit Network, a non-profit internet provider, required a creative way to manage dial-in access to various Points-Of-Presence (POPs) across its network. In response to this need, RADIUS was created by Livingston Enterprises.
+When RADIUS was created, network access systems were distributed across a wide area and were run by multiple independent organisations. Central administrators wanted to prevent security and scalability issues, and therefore didn't want to distribute user names and passwords. Instead, they wanted the remote access servers to contact a central server to authorise access to the requested system or service.
+
+[NOTE]
+====
+A remote access server (RAS) is often called a Network Access Server (NAS),  Network Access Client (NAC), or simply client.
+====
+
+In response to contact from the remote access server, the central server would return a “success” or “failure” message, and the remote machines would enforce this response for each end-user. This process ensures that authentication decisions are centralized, while enforcement happens at the network edge, maintaining both security and scalability in the system.
+
+The goal of RADIUS was to create a central location for user authentication, wherein users from many locations could request network access.
+The simplicity, efficiency, and usability of the RADIUS system led to its widespread adoption by network equipment vendors. RADIUS evolved into an industry and Internet Engineering Task Force (IETF) standard as outlined in https://datatracker.ietf.org/doc/html/rfc2865[RFC 2865].
+
+=== Customers
+
+Many types of businesses and organisations use the RADIUS protocol for their authentication and accounting needs. Some examples of RADIUS customers are:
+
+* Cellular network providers with millions of users.
+* Small to large ISPs to authenticate users connecting to the internet.
+* Enterprise networks implementing Network Access Control (NAC) using 802.1x or to manage access to their internal networks and VPNs.
+* Wireless networks in educational institutions and campuses.
+
+=== Benefits
+
+The RADIUS client-server architecture is an open and scalable solution. RADIUS supports a wide range of environments and can grow to handle increased demand. Its adoption by many vendors ensures compatibility with a variety of products and systems. Organizations configure RADIUS to work with various security systems, including legacy solutions. Any RADIUS client-protocol-supporting communications device can interact with a RADIUS server, simplifying integration.
+
+The RADIUS authentication mechanisms enable organizations to integrate their existing security technologies. RADIUS architecture offers authentication and authorisation services to any supported security component. Additionally, the central server can integrate with a separate authentication mechanism. RADIUS extends beyond network access devices and terminal servers. ISPs integrating RADIUS leverage their infrastructure to provide Virtual Private Network (VPN) services.
+
+The distributive nature of RADIUS separates security processes from the communications processes. This design provides a single centralized information store for authorisation and authentication information. Centralization reduces the administrative burden of providing adequate access control for remote users.
+
+[NOTE]
+====
+The authentication server manages the security processes. The network access server (NAS) handles the communication processes.
+====
+
+If high availability is not a priority, redundancy is not necessary. All RADIUS-compatible hardware on the network can derive authentication services from a single server.
+
+In summary, the RADIUS client-server protocol provides these advantages:
+
+* An open and scalable solution.
+* Broad support by a large vendor base.
+* Easy modification.
+* Separation of security and communication processes.
+* Adaptable to most security systems.
+* Workable with any communication device that supports RADIUS client protocol.
+
+// Copyright (C) 2025 Network RADIUS SAS.  Licenced under CC-by-NC 4.0.
+// This documentation was developed by Network RADIUS SAS.
diff -urpN freeradius-server-3.2.7/doc/antora/modules/concepts/pages/protocol/authproto.adoc freeradius-server-3.2.8/doc/antora/modules/concepts/pages/protocol/authproto.adoc
--- freeradius-server-3.2.7/doc/antora/modules/concepts/pages/protocol/authproto.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/concepts/pages/protocol/authproto.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,149 @@
+= Protocols
+
+== RADIUS Protocol
+
+RADIUS is a protocol for remote user Authorisation, Authentication, and Accounting. It's very important for Internet Service Providers, and any network that needs a centralized authentication and/or accounting services for its infrastructure.
+
+RADIUS is often used in larger Wi-Fi (wireless) networks for authentication purposes, replacing the simple shared key methods which are uncomfortable if a Wi-Fi network reaches a specific size.
+
+The protocol originally was designed by the well known terminal server manufacturer Livingston for use with their Portmaster series of terminal servers. Since then it has been implemented by hundreds other vendors and has a become an Internet Standard RFC. The DIAMETER protocol is the designated successor, but RADIUS is still commonly used today.
+
+=== RADIUS Protocol Dependencies
+
+RADIUS uses UDP as its underlying protocol. The registered UDP port for RADIUS traffic is 1812 for authentication and configuration. The early deployment of RADIUS used UDP port 1645, which conflicted with the "datametrics" service.  When RADIUS is used for accounting  the registered UDP port is 1813. The earlier RADIUS version used port 1646, which conflicted with the "sa-msg-port" service.
+
+== Authentication Protocols
+
+In order for RADIUS authentication to work, user passwords need to be stored in a format that is understood by the authentication protocol used by the client. Many protocols integrated with RADIUS include:
+
+* PAP
+* CHAP
+* MS-CHAP
+* EAP
+
+Authentication protocols used in RADIUS are not always compatible with the way the passwords have been stored. The following table shows which protocol is compatible with what kind of password.
+
+=== Authentication Protocol and Password Compatibility
+
+Passwords may be stored in a datastore in many forms. Clear-text, MD5 hashed, crypt'd, NT hash, or other methods are all commonly used. Authentication protocols used in RADIUS are not always compatible with the way the passwords have been stored. The following table shows which protocol is compatible with what kind of password.
+
+[#Proto-Password-Compat]
+.Protocol Password Compatibility
+[cols="2,1,1,1,1,1,1,1"]
+|===
+|*Protocol*|*Clear-text*|*NT hash*|*MD5 hash*|*Salted MD5 hash*|*SHA1 hash*|*Salted SHA1 hash*|*Unix Crypt*
+|*PAP*
+|   ✔️
+|   ✔️
+|   ✔️
+|   ✔️
+|   ✔️
+|   ✔️
+|   ✔️
+
+|*CHAP*
+|   ✔️
+|   ❌
+|   ❌
+|   ❌
+|   ❌
+|   ❌
+|   ❌
+
+|*Digest*
+|   ✔️
+|   ❌
+|   ❌
+|   ❌
+|   ❌
+|   ❌
+|   ❌
+
+|*MSCHAP*
+|   ✔️
+|   ✔️
+|   ❌
+|   ❌
+|   ❌
+|   ❌
+|   ❌
+
+|*PEAP*
+|   ✔️
+|   ✔️
+|   ❌
+|   ❌
+|   ❌
+|   ❌
+|   ❌
+
+|*EA-MSCHAP2*
+|   ✔️
+|   ✔️
+|   ❌
+|   ❌
+|   ❌
+|   ❌
+|   ❌
+
+|*Cisco-LEAP*
+|   ✔️
+|   ✔️
+|   ❌
+|   ❌
+|   ❌
+|   ❌
+|   ❌
+
+|*EAP-GTC*
+|   ✔️
+|   ✔️
+|   ✔️
+|   ✔️
+|   ✔️
+|   ✔️
+|   ✔️
+
+|*EAP-MD5*
+|   ✔️
+|   ❌
+|   ❌
+|   ❌
+|   ❌
+|   ❌
+|   ❌
+
+|*EAP-PWD*
+|   ✔️
+|   ❌
+|   ❌
+|   ❌
+|   ❌
+|   ✔️
+|   ✔️
+
+|===
+
+Many people store passwords in their databases in hashed or encrypted form. They later decide that they need to support an authentication protocol that the above table shows is incompatible with their password storage method. They then ask "How can I make authentication protocol X work with passwords stored as Y?" The short answer is "you can't".
+
+The password hashes, and authentication protocols were designed to be incompatible. If the cell in the above table is red, then it's impossible to make the authentication protocol use that form of the password. Your only choices are to stop trying to use that authentication protocol, or to store the passwords in a form compatible with that authentication protocol. The last choice often means asking all users to change their passwords, unfortunately.
+
+== More Information
+
+Refer to https://github.com/FreeRADIUS/freeradius-server/tree/v3.2.x/share[Attributes] for more protocol attribute details and https://www.iana.org/assignments/radius-types/radius-types.xhtml[RADIUS Packet Types].
+
+The relevant RFCs are:
+
+* https://datatracker.ietf.org/doc/html/rfc2867[RFC 2867] RADIUS Accounting Modifications for Tunnel Protocol Support
+
+* https://datatracker.ietf.org/doc/html/rfc2868[RFC 2868] RADIUS Attributes for Tunnel Protocol Support
+
+* https://datatracker.ietf.org/doc/html/rfc2869[RFC 2869] RADIUS Extensions
+
+* https://datatracker.ietf.org/doc/html/rfc3758[RFC 3748] Extensible Authentication Protocol (EAP)
+
+* https://datatracker.ietf.org/doc/html/rfc3579[RFC 3579] RADIUS (Remote Authentication Dial In User Service) Support For Extensible Authentication Protocol (EAP)
+
+
+// Copyright (C) 2025 Network RADIUS SAS.  Licenced under CC-by-NC 4.0.
+// This documentation was developed by Network RADIUS SAS.
diff -urpN freeradius-server-3.2.7/doc/antora/modules/concepts/pages/protocol/peap.adoc freeradius-server-3.2.8/doc/antora/modules/concepts/pages/protocol/peap.adoc
--- freeradius-server-3.2.7/doc/antora/modules/concepts/pages/protocol/peap.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/concepts/pages/protocol/peap.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,63 @@
+*Protected Extensible Authentication Protocol*, *Protected EAP*, or simply *PEAP* (pronounced *peep*), is a method to securely transmit authentication information, including passwords, over wireless LANs. It was jointly developed by Microsoft, RSA Security and Cisco.
+It is an IETF open standard.
+
+PEAP is **not** an encryption protocol; as with other EAP types it only authenticates a client into a network. 
+
+PEAP uses only server-side public key certificates to authenticate clients by creating an encrypted SSL/TLS tunnel between the client and the authentication server, which protects the ensuing exchange of authentication information from casual inspection.
+
+PEAP is similar in design to EAP-TTLS, requiring only a server-side PKI certificate to create a secure TLS tunnel to protect user authentication.
+
+As of May of 2005, there were two PEAP sub-types certified for the updated WPA and WPA2 standard. They are:
+
+* PEAPv0/EAP-MSCHAPv2
+* PEAPv1/EAP-GTC
+
+== Types
+
+=== PEAPv0/EAP-MSCHAPv2
+
+PEAPv0/EAP-MSCHAPv2 is the most common form of PEAP in use, and what is usually referred to as PEAP. 
+
+Behind EAP-TLS, PEAPv0/EAP-MSCHAPv2 is the second most widely supported EAP standard in the world. There are client and server implementations of it from various vendors, including support in all recent releases from Microsoft, Apple and Cisco.
+Other implementations exist such as AEGIS from Meetinghouse and xsupplicant from the Open1x.org project.
+
+=== PEAPv1/EAP-GTC
+
+PEAPv1/EAP-GTC was created by Cisco as an alternative to PEAPv0/EAP-MSCHAPv2. It allows the use of an inner authentication protocol other than Microsoft’s MSCHAPv2.
+
+Even though Microsoft co-invented the PEAP standard, Microsoft never added support for PEAPv1 in general, which means PEAPv1/EAP-GTC has no native Windows OS support.
+
+Since Cisco has always favored the use of its own less secure proprietary LEAP and EAP-FAST protocols over PEAP and markets them as simpler certificate-less solutions, standardized PEAP is rarely promoted by Cisco.
+
+Cisco stands to gain a monopoly in the access point market if LEAP or EAP-FAST is universally adopted. As a result, most Cisco customers run Cisco's proprietary LEAP or EAP-FAST authentication protocols due to their promotion by Cisco. With no interest from Microsoft to support PEAPv1 and little interest from Cisco to promote PEAP in general, PEAPv1 authentication is rarely used. There is no native OS support for this EAP protocol.
+
+Note: The PEAP standard was created by Microsoft, Cisco, and RSA after EAP-TTLS had already come on the market. Even with its late start, Microsoft’s and Cisco’s size allowed them to quickly overtake EAP-TTLS in the market.
+
+Microsoft and Cisco parted ways when Microsoft only supported the PEAPv0 standard while Cisco supported both PEAPv0 and PEAPv1. PEAPv0 and PEAPv1 both refer to the outer authentication method and is the mechanism that creates the secure TLS tunnel to protect subsequent authentication transactions while EAP-MSCHAPv2, EAP-GTC, and EAP-SIM refer to the inner authentication method which facilitates user or device authentication.
+
+From Cisco’s perspective, PEAPv0 supports inner EAP methods EAP-MSCHAPv2 and EAP-SIM while PEAPv1 supports inner EAP methods EAP-GTC and EAP-SIM.
+
+Since Microsoft only supports PEAPv0 and doesn’t support PEAPv1, Microsoft simply calls PEAPv0 PEAP without the v0 or v1 designator. Another difference between Microsoft and Cisco is that Microsoft only supports PEAPv0/EAP-MSCHAPv2 mode but not PEAPv0/EAP-SIM mode.
+
+=== PEAP-EAP-TLS
+
+Microsoft supports another form of PEAPv0 (which Microsoft calls PEAP-EAP-TLS) that Cisco and other third-party server and client software don’t support. PEAP-EAP-TLS does require a client-side digital certificate located on the client’s hard drive or a more secure smartcard. PEAP-EAP-TLS is very similar in operation to the original EAP-TLS but provides slightly more protection due to the fact that portions of the client certificate that are unencrypted in EAP-TLS are encrypted in PEAP-EAP-TLS. 
+
+Since few third-party clients and servers support PEAP-EAP-TLS, users should probably avoid it unless they only intend to use Microsoft desktop clients and servers.
+
+Ultimately, PEAPv0/EAP-MSCHAPv2 is the only form of PEAP that most people will ever know. PEAP is so successful in the market place that even Funk Software, the inventor and backer of EAP-TTLS, had no choice but to support PEAP in their server and client software for wireless networks.
+
+== References
+
+* Understanding the updated WPA and WPA2 standards(http://blogs.zdnet.com/Ou/index.php?p=67)
+
+== External links
+
+* draft-josefsson-pppext-eap-tls-eap(http://www.potaroo.net/ietf/idref/draft-josefsson-pppext-eap-tls-eap/) - The PEAP protocol specifications
+
+== See Also
+
+* EAP
+
+// Copyright (C) 2025 Network RADIUS SAS.  Licenced under CC-by-NC 4.0.
+// This documentation was developed by Network RADIUS SAS.
diff -urpN freeradius-server-3.2.7/doc/antora/modules/concepts/pages/protocol/wep.adoc freeradius-server-3.2.8/doc/antora/modules/concepts/pages/protocol/wep.adoc
--- freeradius-server-3.2.7/doc/antora/modules/concepts/pages/protocol/wep.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/concepts/pages/protocol/wep.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,88 @@
+
+== Overview
+
+*Wired Equivalent Privacy (WEP)* is a scheme that is part of the IEEE 802.11 wireless networking standard to secure IEEE 802.11 wireless computer network (also known as Wi-Fi networks). Because a wireless network broadcasts messages using radio, it is particularly susceptible to eavesdropping. WEP was intended to provide comparable confidentiality to a traditional wired local area network|network (in particular it doesn't protect users of the network from each other), hence the name. Several serious weaknesses were identified by cryptanalysts, and WEP was superseded by Wi-Fi Protected Access (WPA) in 2003, and then by the full IEEE 802.11i standard (also known as WPA2) in 2004. Despite the weaknesses, WEP provides a level of security that can deter casual snooping.
+
+== Details
+
+WEP is part of the IEEE 802.11 standard ratified in September 1999. WEP uses the stream cipher RC4 for confidentiality and the CRC-32 checksum for integrity.
+
+Standard 64-bit WEP uses a 40-bit encryption|40 bit key, which is concatenated to a 24-bit initialization vector (IV) to form the RC4 traffic key.  At the time that the original WEP standard was being drafted, US Government export of cryptography limited the keysize. Once the restrictions were lifted, all of the major manufacturers eventually implemented an extended 128-bit WEP protocol using a 104-bit key size. 
+A 128-bit WEP key is almost always entered by users as a string of 26 Hexadecimal (Hex) characters (0-9 and A-F).  Each character represents 4 bits of the key. 4 * 26 = 104 bits.  Adding the 24-bit IV brings us what we call a "128-bit WEP key". A 256-bit WEP system is available from some vendors, and as with the above-mentioned system, 24 bits of that is for the I.V., leaving 232 actual bits for protection.  This is typically entered as 58 Hexadecimal characters. (58 * 4 = 232 bits) + 24 I.V. bits = 256 bits of WEP protection. 
+
+Key size is not the only major security limitation in WEP. Cryptanalysis a longer key requires interception of more packets, but there are active attacks that stimulate the necessary traffic. There are other weaknesses in WEP, including the possibility of IV collisions and altered packets, that are not helped at all by a longer key. See stream cipher attack.
+
+== Flaws
+
+Because RC4 is a stream cipher, the same traffic key must never be used twice. The purpose of an IV, which is transmitted as plaintext, is to prevent any repetition, but a 24-bit IV is not long enough to ensure this on a busy network. The way the IV was used also opened WEP to a [[related key attack]]. For a 24-bit IV, there is a 50% probability the same IV will repeat after 5000 packets. 
+
+Many WEP systems require a key in hexadecimal format. Some users choose keys that spell words in the limited 0-9, A-F hex character set, for example _C0DE C0DE C0DE C0DE_. Such keys are often easily guessed.
+
+In August 2001, Scott Fluhrer, Itzik Mantin, and Adi Shamir published a cryptanalysis of WEP that exploits the way the RC4 cipher and IV is used in WEP, resulting in a passive attack that can recover the RC4 key (cryptography) after eavesdropping on the network (depending on the network traffic (the number of packets you can inspect) the length could be from 10 minutes to indefinitely (if there is no data being sent at all)). There are also ways to force the traffic onto the network which is rejected, but packets are sent and thus can also be inspected to find the key. The attack was soon implemented, and automated tools have since been released. It is possible to perform the attack with a personal computer, off-the-shelf hardware and freely-available software. 
+
+Cam-Winget et al. (2003) surveyed a variety of shortcomings in WEP. They write "_Experiments in the field indicate that, with proper equipment, it is practical to eavesdrop on WEP-protected networks from distances of a mile or more from the target._" They also reported two generic weaknesses:
+* the use of WEP was optional, resulting in many installations never even activating it, and 
+* WEP did not include a key management protocol, relying instead on a single shared key amongst users.
+
+In 2005, a group from the U.S. Federal Bureau of Investigation gave a demonstration where they cracked a WEP-protected network in 3 minutes using publicly available tools.<ref>http://www.tomsnetworking.com/2005/03/31/the_feds_can_own_your_wlan_too/</ref>
+
+In 2006, Bittau, Handley and Lackey showed that the 802.11 protocol itself can be used against WEP to enable earlier attacks that were previously thought impractical.  After eavesdropping a single packet, an attacker can rapidly bootstrap to be able to transmit arbitrary data.  Then the eavesdropped packet can be decrypted a byte at a time (by transmitting about 128 packets per byte to decrypt) to discover the local network IP addresses.  Finally if the 802.11 network is connected to the Internet, the attacker can use 802.11 fragmentation to replay eavesdropped packets while crafting a new IP header on to them.  The access point can then be used to decrypt these packets and relay them on to a buddy on the Internet, allowing real-time decryption of WEP traffic within a minute of eavesdropping the first packet.
+
+== Remedies
+
+=== WEP2
+
+A stopgap enhancement to WEP, implementable on _some_ (not all) hardware not able to handle WPA/WPA2, based on:
+* Enlarged IV value
+* Enforced 128-bit encryption
+However, WEP2 remains vulnerable to known WEP attacks -- at most it will just slow an attacker down a bit -- and thus shouldn't really be considered more secure than WEP.
+
+=== WEPplus 
+
+Also known as WEP+.  A proprietary enhancement to WEP by Agere Systems (formerly a subsidiary of Lucent Technologies) that enhances WEP security by avoiding "weak IVs".  It is only completely effective when WEPplus is used at _both ends_ of the wireless connection. As this cannot easily be enforced, it remains serious limitation.  It is possible that successful attacks against WEPplus will eventually be found. It also does not necessarily prevent Replay attack|replay attacks.
+
+=== WPA/WPA2 
+
+The most widely recommended solution to WEP security problems is to switch to WPA or WPA2. Either is much more secure than WEP. Some old WiFi access points might need to be replaced to do this or have their operating system, in flash memory, upgraded; however, replacements are relatively inexpensive. Another alternative is to use a tunneling protocol, such as IPsec, although that only protects traffic streams, not the network itself.
+
+== References
+
+* Nikita Borisov, Ian Goldberg, David Wagner, "Intercepting mobile communications: the insecurity of 802.11." MOBICOM 2001, pp180&ndash;189.
+* Nancy Cam-Winget, Russell Housley, David Wagner, Jesse Walker: Security flaws in 802.11 data link protocols. Communications of the ACM 46(5): 35-39 (2003)
+* Scott R. Fluhrer, Itsik Mantin, Adi Shamir, "Weaknesses in the Key Scheduling Algorithm of RC4". Selected Areas in Cryptography 2001: pp1&ndash;24.
+* Andrea Bittau, Mark Handley, Joshua Lackey, "The Final Nail in WEP's Coffin", IEEE Symposium on Security and Privacy (Oakland) 2006.
+* Update: Stepping Up Your WLAN Security (http://www.networkmagazineindia.com/200112/focus3.htm 802.11b)
+* Wireless LAN Deployment and Security Basics (http://www.extremetech.com/article2/0,1697,1157728,00.asp)
+* An Inductive Chosen Plaintext Attack against WEP/WEP2 (http://www.cs.umd.edu/~waa/attack/v3dcmnt.htm)
+* [http://www.starkrealities.com/wireless003.html It Came Out of the Sky -- WEP2, Credibility Zero]
+* [http://www.agere.com/NEWS/PRESS2001/111201b.html Agere Systems press release]
+** [http://www.proxim.com/learn/library/whitepapers/wireless_security.pdf Wireless Network Security] ([[Proxim Wireless]] white paper)
+* Weak IVs
+** [http://www.cs.virginia.edu/sammyg/CS551/node16.html Weak IV Attack]
+** [http://www.informit.com/guides/content.asp?g=security&seqNum=85&rl=1 WPA Part 2: Weak IV's]
+** [http://airsnort.shmoo.com/faq.html Frequently Asked Questions About AirSnort]
+* [http://www.cs.virginia.edu/sammyg/CS551/node18.html Replay Attack]
+
+==External links==
+
+*[http://www.profit42.com/index.php/2006/08/02/92/ This simple but detailled guide describes how to crack wep step by step]
+*[http://www.isaac.cs.berkeley.edu/isaac/wep-faq.html (In)Security of the WEP algorithm]
+*[http://www.drizzle.com/~aboba/IEEE/rc4_ksaproc.pdf Weaknesses in the Key Scheduling Algorithm of RC4]
+*[http://www.cs.virginia.edu/sammyg/CS551/node12.html WEP Weaknesses]
+*[http://www.cs.umd.edu/~waa/wireless.html List of security problems with WEP]
+*[http://securityfocus.com/infocus/1814 WEP: Dead Again, Part 1 (Dec. 14, 2004)]
+*[http://securityfocus.com/infocus/1824 WEP: Dead Again, Part 2 (Mar. 8, 2005)]
+*[http://www.tomsnetworking.com/Sections-article111.php The Feds can own your WLAN too : TomsNetworking]
+* Humphrey Cheung, How to crack WEP, [http://www.tomsnetworking.com/Sections-article118.php part one], [http://www.tomsnetworking.com/Sections-article120.php part two], [http://www.tomsnetworking.com/Sections-article124.php part three] May/June 2005.
+
+
+*Several software tools are available to compute and recover WEP keys by passively monitoring transmissions.
+**[http://www.tuto-fr.com/tutoriaux/crack-wep/fichiers/wlan/en-index.php aircrack]
+**[[aircrack-ng|Aircrack-ng (aircrack-ng is the next generation of aircrack)]]
+**[http://airsnort.shmoo.com/ AirSnort]
+**[http://sourceforge.net/projects/wepcrack WEPCrack]
+**[http://sourceforge.net/projects/weplab Weplab]
+**[http://kismac.binaervarianz.de/ KisMAC]
+
+// Copyright (C) 2025 Network RADIUS SAS.  Licenced under CC-by-NC 4.0.
+// This documentation was developed by Network RADIUS SAS.
diff -urpN freeradius-server-3.2.7/doc/antora/modules/concepts/pages/protocol/wpa.adoc freeradius-server-3.2.8/doc/antora/modules/concepts/pages/protocol/wpa.adoc
--- freeradius-server-3.2.7/doc/antora/modules/concepts/pages/protocol/wpa.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/concepts/pages/protocol/wpa.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,77 @@
+== Overview
+
+*Wi-Fi Protected Access* (*WPA* and *WPA2*) is a class of systems to secure wireless (Wi-Fi) computer networks. It was created in response to several serious weaknesses researchers had found in the previous system, Wired Equivalent Privacy (WEP). WPA implements the majority of the IEEE 802.11i standard, and was intended as an intermediate measure to take the place of WEP while 802.11i was prepared. WPA is designed to work with all wireless network interface cards, but not necessarily with first generation wireless access points. WPA2 implements the full standard, but will not work with some older network cards. Both provide good security, with two significant issues:
+
+* either WPA or WPA2  must be enabled and chosen in preference to WEP. WEP is usually presented as the first security choice in most installation instructions.
+* in the "Personal" mode, the most likely choice for homes and small offices, a passphrase is required that, for full security, must be longer than the typical 6 to 8 character passwords users are taught to employ.
+
+== History
+
+WPA was created by the The Wi-Fi Alliance, an industry trade group, which owns the trademark to the Wi-Fi name and certifies devices that carry that name.
+
+WPA is designed for use with an IEEE 802.1X authentication server, which distributes different keys to each user; however, it can also be used in a less secure *"pre-shared key" (PSK)* mode, where every user is given the same passphrase. The design of WPA is based on a Draft 3 of the IEEE 802.11i standard.
+
+The Wi-Fi Alliance created WPA to enable introduction of standard-based secure wireless network products prior to the IEEE 802.11i group finishing its work. The Wi-Fi Alliance at the time already anticipated the WPA2 certification based on the final draft of the IEEE 802.11i standard, therefore the tags on the frame fields (Information Elements or IEs) are intentionally made different from 802.11i to avoid the confusion in unified WPA/WPA2 implementations.
+
+Data is encrypted using the RC4 (cipher), with a 128-bit key and a 48-bit initialization vector (IV). One major improvement in WPA over WEP is the Temporal Key Integrity Protocol (TKIP), which dynamically changes keys as the system is used. When combined with the much larger IV, this defeats the well-known related-key attack on WEP.
+
+In addition to authentication and encryption, WPA also provides vastly improved payload integrity. The cyclic redundancy check (CRC) used in WEP is inherently insecure; it is possible to alter the payload and update the message CRC without knowing the WEP key.  A more secure message authentication code (usually known as a MAC, but here termed a *MIC* for "Message Integrity Code") is used in WPA, an algorithm named "Michael". The MIC used in WPA includes a frame counter, which prevents replay attack being executed;
+
+By increasing the size of the keys and IVs, reducing the number of packets sent with related keys, and adding a secure message verification system, WPA makes breaking into a Wireless LAN far more difficult. The Michael algorithm was the strongest that WPA designers could come up with that would still work with most older network cards. Due to inevitable weaknesses of Michael, WPA includes special countermeasure mechanism that detects the attempt to break TKIP and temporarily blocks communications with the attacker.
+
+== WPA2
+
+WPA2 implements the mandatory elements of 802.11i. In particular, in addition to TKIP and the Michael algorithm, it introduces a new Advanced Encryption Standard based algorithm, CCMP, that is considered fully secure. Official support for WPA2 in Microsoft Windows XP was rolled out on 1 May 2005. Driver upgrades for network cards may be required. Apple Computer supports WPA2 on all AirPort Extreme-enabled Apple Macintosh, the AirPort Extreme Base Station, and the AirPort Express. Firmware upgrades needed are included in AirPort 4.2, released July 14, 2005. Note that from March 13, 2006, WPA2 certification is mandatory for all new devices wishing to be Wi-Fi certified.
+
+== Security in pre-shared key mode
+
+Pre-shared key mode (PSK, also known as *personal* mode) is designed for home and small office networks that cannot afford the cost and complexity of an 802.1X authentication server. Each user must enter a passphrase to access the network. The passphrase may be from 8 to 63 ASCII characters or 64 hexadecimal digits (256 bits). If you choose to use the ASCII characters, a Hash_function|hash function reduces it from 504 bits (63 characters * 8 bits/character) to 256 bits (using also the SSID). The passphrase may be stored on the user's computer at their discretion under most operating systems to avoid re-entry. The passphrase must remain stored in the Wi-Fi access point.
+
+Security is strengthened by employing a PBKDF2 key derivation function. However, the weak passphrases users typically employ are vulnerable to password cracking attack. Password cracking can be defeated by using a passphrase of at least 5 Diceware words or 14 completely random letters with WPA and WPA2. For maximum strength, 8 Diceware words or 22 random characters should be employed. Passphrases should be changed at regular intervals, or whenever an individual with access is no longer authorized to use the network or when a device configured to use the network is lost or compromised.
+
+Some consumer chip manufacturers have attempted to bypass weak passphrase choice by adding a method of automatically generating and distributing strong keys through a software or hardware interface that uses an external method of adding a new Wi-Fi adapter or appliance to a network. These methods include pushing a button (Broadcom and Buffalo AirStation One-Touch Secure System]) and entering a short challenge phrase through software (Atheros). The Wi-Fi Alliance is currently working on standardisation of this approach as part of its Simple Configuration effort.
+
+== EAP types under WPA- and WPA2- Enterprise
+
+The Wi-Fi alliance has announced the inclusion of additional EAP (Extensible Authentication Protocol) types to its certification programs for WPA- and WPA2- Enterprise.  This was to ensure that WPA-Enterprise certified products can interoperate with one another.  Previously, only EAP-TLS (Transport Layer Security) was certified by the Wi-Fi alliance.
+
+The EAP types now included in the certification program are:
+
+* EAP-TLS (previously tested)
+* EAP-TTLS/MSCHAPv2
+* PEAPv0/EAP-MSCHAPv2
+* PEAPv1/EAP-GTC
+* EAP-SIM
+
+Other EAP types may be supported by 802.1X clients and servers developed by specific firms. This certification is an attempt for popular EAP types to interoperate; their failure to do so is currently one of the major issues preventing rollout of 802.1X on heterogeneous networks.
+
+== See also
+
+* WAPI —<!-- controversial--> Chinese National Standard for wireless LAN security.
+* tinyPEAP — a small-footprint RADIUS server designed to load into a wireless access point
+* FreeRADIUS - a free [[open source]] RADIUS server
+* Radiuz — a "cooperative WiFi network" that provides free RADIUS service for WPA-Enterprise compatible routers
+* SecureMyWiFi — Service that provides WPA/WPA2-Enterprise security with User/Network Management Interface.
+* SecureEasySetup — a technology developed by Broadcom to easily set up wireless LANs with WPA
+
+== References
+
+* Wi-Fi Alliance. (2003). Wi-Fi Protected Access: Strong, standards-based, interoperable security for today’s Wi-Fi networks. Retrieved March 1, 2004 from http://www.wifialliance.com/OpenSection/pdf/Whitepaper_Wi-Fi_Security4-29-03.pdf
+* Wi-Fi Alliance. (2004). Wi-Fi Protected Access&trade; security sees strong adoption: Wi-Fi Alliance takes strong position by requiring WPA security for product certification. Retrieved January 5, 2004 from http://www.wi-fi.org/opensection/ReleaseDisplay.asp?TID=4&ItemID=165&StrYear=2004&strmonth=2
+* Weakness in Passphrase Choice in WPA Interface, by Robert Moskowitz. Retrieved March 2, 2004 from http://wifinetnews.com/archives/002452.html
+* Press Release about new EAP types supported under WPA-Enterprise from http://www.wi-fi.org/OpenSection/ReleaseDisplay.asp?TID=4&ItemID=205&StrYear=2005&strmonth=4
+
+== External links
+
+* Wi-Fi Alliance's WPA page (http://www.wi-fi.org/opensection/protected_access.asp)
+* Wi-Fi Alliance's Interoperability Certificate page (http://www.wi-fi.org/opensection/certification-certificate.asp)
+* Network Configuration with WPA (http://www.wi-fiplanet.com/tutorials/article.php/3552826)
+* Apple Airport and Wi-Fi Network Security (http://theworld.com/~reinhold/airport.html)
+* EAP types supported under WPA-Enterprise (http://www.wi-fi.org/OpenSection/eap.asp)
+* Linux WPA/WPA2/IEEE 802.1X Supplicant (http://hostap.epitest.fi/wpa_supplicant/)
+* SmithMicro Quicklink Mobile Software (http://www.smithmicro.com/default.tpl?sku=QLMWA0EE&group=product_full)
+* Steve Gibson's Perfect Passwords(https://www.grc.com/passwords/)
+* GRC's Ultra High Security Password Generators(http://darkvoice.dyndns.org/wlankeygen/ Online WEP-/WPA-Key Generator)
+
+// Copyright (C) 2025 Network RADIUS SAS.  Licenced under CC-by-NC 4.0.
+// This documentation was developed by Network RADIUS SAS.
diff -urpN freeradius-server-3.2.7/doc/antora/modules/concepts/pages/resources.adoc freeradius-server-3.2.8/doc/antora/modules/concepts/pages/resources.adoc
--- freeradius-server-3.2.7/doc/antora/modules/concepts/pages/resources.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/concepts/pages/resources.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,29 @@
+= RESOURCES
+
+== Primary Sites
+
+* *https://www.freeradius.org/[FreeRADIUS]*
+* *https://www.inkbridgenetworks.com/[Inkbridge Networks]*
+
+== Mailing lists
+
+include::ROOT:partial$mailinglist.adoc[]
+
+== RFCs
+
+* http://www.freeradius.org/rfc/[Related RFCs and Drafts]
+
+* https://datatracker.ietf.org/doc/html/rfc2865[RFC 2865] Remote Authentication Dial In User Service (RADIUS)
+* https://datatracker.ietf.org/doc/html/rfc2866[RFC 2866] RADIUS Accounting
+* https://datatracker.ietf.org/doc/html/rfc2867[RFC 2867] RADIUS Accounting Modifications for Tunnel Protocol Support
+* https://datatracker.ietf.org/doc/html/rfc2868[RFC 2868] RADIUS Attributes for Tunnel Protocol Support
+* https://datatracker.ietf.org/doc/html/rfc2869[RFC 2869] RADIUS Extensions
+* https://datatracker.ietf.org/doc/html/rfc3758[RFC 3748] Extensible Authentication Protocol (EAP)
+* https://datatracker.ietf.org/doc/html/rfc3579[RFC 3579] - RADIUS (Remote Authentication Dial In User Service) Support For Extensible Authentication Protocol (EAP)
+
+== Related RADIUS Sites
+* *https://www.iana.org/assignments/radius-types/radius-types.xhtml[RADIUS Packet Types]*
+
+
+// Copyright (C) 2025 Network RADIUS SAS.  Licenced under CC-by-NC 4.0.
+// This documentation was developed by Network RADIUS SAS.
diff -urpN freeradius-server-3.2.7/doc/antora/modules/concepts/pages/session/processing.adoc freeradius-server-3.2.8/doc/antora/modules/concepts/pages/session/processing.adoc
--- freeradius-server-3.2.7/doc/antora/modules/concepts/pages/session/processing.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/concepts/pages/session/processing.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,126 @@
+= Processing
+
+The server processes requests through local site policy. That policy is used to examine the request, the request attributes, and the attribute values. The server then builds a reply message using responses (determined by local policy) such as time of day restrictions, group access limitations, and IP address
+allocation. The processing stage may include keeping track of <<server-attr,server-side attributes>>.
+
+== How things work in RADIUS
+
+The client sends the server a RADIUS authentication request. You don't decide what's in the request, the client does.  The server doesn't decide what's in the request, the client does.  The client is 100% responsible for everything in the request.
+
+
+.FreeRADIUS v3 Request Flow
+image:request_flow.svg[Process Flow railroad diagram].
+
+=== Summary of the Request Flow Steps
+
+. An end-user tries to access a network through a RADIUS client such as a wireless access point. 
+. The RADIUS client sends a request to the RADIUS server along with the user's credentials.
+. The RADIUS server verifies the user's credentials against its datastore (flat file, SQL, LDAP, etc.). 
+. If authentication passes, the server returns configuration details (including authorisation) to the client. The client can now grant network access to the end-user 
+. If the authentication fails, the server denies access, and the RADIUS client informs the end-user.
+
+
+Users new to RADIUS, AAA, or EAP are encouraged to read the standards listed below. This documentation provides you with a solid foundation in RADIUS concepts and EAP at a protocol level.
+
+- https://datatracker.ietf.org/doc/html/rfc2865[RFC 2865] - Remote Authentication Dial In User Service (RADIUS)
+- https://datatracker.ietf.org/doc/html/rfc2866[RFC 2866] - RADIUS Accounting
+
+- https://datatracker.ietf.org/doc/html/rfc3748[RFC 3748] - Extensible Authentication Protocol (EAP)
+- https://datatracker.ietf.org/doc/html/rfc2865[RFC 3579] - RADIUS Support For Extensible Authentication Protocol (EAP)
+
+
+== Request Processing
+
+When the server processes requests, it manages four xref:unlang:list.adoc[attribute lists]. All of these lists are available to all modules.  All of these lists are available in xref:unlang:index.adoc[Unlang]
+
+.Attribute Lists and Details
+
+[cols="1,2"]
+|===
+|*Attribute List*|*Description*
+
+|`request`
+|Attributes taken from the received packet.
+
+|`reply`
+|Attributes which will be sent in the reply.
+
+|`control`
+|Attributes used to control how the server operates.  These are never sent in a packet.
+
+|`session-state`
+|Attributes which are saved and restored across multiple request / reply exchanges.
+|===
+
+
+
+== Select an Auth-Type - authorise {}
+
+The RADIUS server looks at the request and says:
+
+> Hmmm... can I deal with this request?
+
+The answer to that depends on what authentication types are enabled in the server, what the server can look up in a datastore, and what is in the request.
+
+The server starts querying the modules in the authorise section:
+
+> Unix module, can you handle this one?
+
+> Pap module, can you handle this one?
+
+> Mschap module, can you handle this one?
+
+At some point, one of the modules will say:
+
+>  Yes, I see something in the request I recognize.  I can do something!
+
+The module does this by looking for key attributes in the received request, such as MS-CHAP-Challenge (for mschap), or CHAP-Challenge (for chap), or EAP-Message (for eap). Or it may just assume it needs to add something to every request.
+
+If the module thinks has a possibility of authenticating the user, it'll say:
+
+> I can't authenticate this user now (I was just told to authorise them i.e. set the Auth-Type),
+> but my pal in the Authenticate section can!
+> Hey, set the Auth-Type to me!
+
+TThe module performs no action if it doesn't recognize anything in the request.  If the module knows it doesn't need to do lookups, the module also does nothing.
+
+== Authenticate a user - authenticate {}
+
+At the end of the authorise process, the server checks if the Auth-Type has been set by a module.
+
+If no module sets the Auth-Type, the server immediately rejects the request.
+
+For example, the client sends a request with a User-Password attribute, and pap is enabled. The pap module then sets the ``Auth-Type = pap``.
+
+During this authenticate process, the server calls the pap module again:
+
+> I see a User-Password, which is what the user entered.
+> That's nice, but I need to compare it with something.
+> Ah! Another module added the "known good" password for this user in authorise!
+
+Next, the server compares the local "known good" password to the password as entered by the user.  This is how authentication works.
+
+The "known good" password comes from another module.  The pap module just does PAP authentication, and nothing more.  The benefit of this approach is that the "known good" password can come from the 'users' file, SQL, LDAP, ``/etc/passwd``, or any external program.
+
+For this example, the ldap module is listed in the authorise section. It will have run and checked:
+
+> Hmm... Can I find a "known good" password for this user?
+
+If so, it will have added the "known good" password to the request, so that another module in authenticate can use it.
+
+== Insufficient information
+
+But WAIT! What if the client sends a MSCHAP request? What does the RADIUS server say then?
+
+> Well, this difficult and not the same as previous request
+> That client has made this difficult. I'm limited by some constraints!
+
+In this case, the mschap module looks at the request, and finds the MS-CHAP attributes.  It sets the *Auth-Type* to itself (mschap).  A database module (such as LDAP, above) gets the "known good" password, and adds it to the request.  The mschap module is then run for authentication.  It looks for either a clear text password or nt-hash. See an explanation for this limitation is explained in the xref:protocol/authproto.adoc#Proto-Password-Compat[Protocol Password Compatibilty] table. If one of those hasn't been added by a database, the mschap module says:
+
+> Sorry, I can't authenticate the user,
+> because I don't have the information I need to validate MSCHAP.
+
+But now the server has run out of options! Its only choice was mschap because that's what the client sent in the request.  The mschap module can't do anything because you didn't give it a useful "known good" password . So the server has no choice but to reject the request.  The MSCHAP data might be correct, but the server has no way to know that.  So it replies with a reject.
+
+// Copyright (C) 2025 Network RADIUS SAS.  Licenced under CC-by-NC 4.0.
+// This documentation was developed by Network RADIUS SAS.
diff -urpN freeradius-server-3.2.7/doc/antora/modules/concepts/pages/session/radius_session.adoc freeradius-server-3.2.8/doc/antora/modules/concepts/pages/session/radius_session.adoc
--- freeradius-server-3.2.7/doc/antora/modules/concepts/pages/session/radius_session.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/concepts/pages/session/radius_session.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,39 @@
+= RADIUS Sessions
+
+A RADIUS session consists of the following steps:
+
+. A remote user connects to a RADIUS client device (using Point-to-Point Protocol (PPP, 802.1X) or another Data Layer link protocol) and initiates a login:
+
+* The NAS initiates all conversations (Authentication Sessions) in RADIUS.
+* All information sent to the server is done solely at the discretion of the client.
+* The RADIUS server does not control what the NAS sends.
+
+. The Network Access Server communicates with the RADIUS server using a shared secret mechanism:
+
+* RADIUS uses User Datagram Protocol (UDP) port 1812 for authentication and 1813 for accounting.
+
+. The NAS sends a RADIUS message (called an Access-Request) to the server.
+
+* This message contains information about the user, including user name, authentication credentials, and requested service.
+* In addition, the message may contain information about the NAS, such as its host name, MAC address, or wireless SSID.
+* The message is sent using the Password Authentication Protocol (PAP), Challenge-Handshake Authentication Protocol (CHAP), or Extensible Authentication Protocol (EAP).
+* The server must decide whether to authenticate or authorise a user based solely on the information contained within the NAS request, as it does not have access to any additional user information.
+* If the NAS sends a packet with an authentication protocol that the server does not support, the server will reject that request.
+
+. The RADIUS server processes the request and verifies the login request against either a local data- base or the authentication service running on the network.
+
+* Authentication services can include: LDAP servers for a domain validation; Active Directory servers on Windows networks; Kerberos servers; SQL Server or another type of database for getting information from a database
+
+. The RADIUS server sends validation results back to the NAS in one of the following forms: Access Reject, Access Challenge, or Access Accept.
+
+* Access Reject locks the user out of the network if the user is invalid or not authorized, denying them access to the requested resource.
+* Access Challenge occurs when the server requires additional information from the user. Since RADIUS packages are limited in size, Access Challenges allow the exchange of larger amounts of data.
+* Access Accept provides the user access to the resource and contains policy information which the NAS uses to provide services to, and enforce the behavior of the user. An Access Accept condition does not apply to all resources. Each additional resource is checked as required. The RADIUS client also verifies the original access offered on a periodic basis.
+* An Access Accept response results in the NAS providing the following services to the remote client: supplys a static or dynamic IP address; assigning a Time-to-Live for the session; downloading and applying the users’ Access Control List (ACL); setting up any L2TP , VLAN, and QoS session parameters required
+
+. Once the session is established on the RADIUS client, the accounting process is initiated:
+
+* The Accounting-Request (start) message, sent by the NAS to the server, indicates the commencement of the session. The the session account record is then created. * The Accounting-Request account record is then closed.
+(stop) message indicates the end of the session; the session
+* The data stored in the database during the accounting sessions is used to generate billable information and reports.
+* Accounting information retained in the database includes the following: time of session, number of packets and amount of data transferred, user and machine identification, network address, and point of attachment information.
diff -urpN freeradius-server-3.2.7/doc/antora/modules/concepts/pages/session/radius_session_msg.adoc freeradius-server-3.2.8/doc/antora/modules/concepts/pages/session/radius_session_msg.adoc
--- freeradius-server-3.2.7/doc/antora/modules/concepts/pages/session/radius_session_msg.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/concepts/pages/session/radius_session_msg.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,127 @@
+= Messages
+
+A RADIUS session message consists of a single User Datagram Protocol (UDP) packet, containing a short header followed by the authentication, authorisation, or accounting data.
+
+== Message Attributes
+
+Each message contains a list of Attribute Value Pairs (AVPs), commonly referred to as attributes. These attributes carry information from the NAS to the server or virtual proxy server and from the server to the NAS. Common attributes include items such as user name, password, IP address, and NAS address; each
+attribute contains only one of these items. An attribute can also contain sub-attributes, for grouping purposes.
+
+For a complete list of standardized attributes, see the http://freeradius.org/rfc/attributes.html[FreeRADIUS RFC Attributes] for more details.
+Each client and server supports only a limited set of attributes. In some cases, attributes may not be supported because the server or NAS software may have been written before a standard was published, or the software may not support that particular functionality.
+
+Consult the software vendor documentation to determine what attributes are supported. If the documentation doesn't contain this information, the select attributes are probably not supported. Contact the vendor for additional information.
+
+In addition to standardized attributes, vendors can extend RADIUS with vendor-specific attributes (VSAs). Using VSAs means that the vendor can rapidly add functionality without having to do a time-consuming standardisation process.
+In order to be useful in the RADIUS client protocol, however, VSAs must be defined on the RADIUS server. Because VSAs are non-standardized attributes, it is difficult to discover any information about them. In addition, they are all vendor-specific (only work on that vendor’s products). Thus, defining VSAs for
+RADIUS server use may be difficult.
+
+== Attribute Types
+
+Basic RADIUS attribute types are defined in http://tools.ietf.org/html/rfc2865[RFC 2865]. Since the original implementation and standardisation, additional attribute types have been also defined.
+
+.RADIUS Attribute Types
+[options="headers, autowidth"]
+|===
+| *Type*                | *Format*                       | *Description*
+| integer               | Value between 0 - 4294967295   | Unsigned 32-bit integer.
+| ipaddr                | x.x.x.x                        | IPv4 address
+| date                  | 10 digit epoch time (xxxxxxxxxx)| Unix timestamp in seconds since January 1, 1970 GMT.
+| string                | Variable-length string field   | Used by FreeRADIUS for printable text strings.
+| octet                 | Variable-length string field   | Used by FreeRADIUS for binary data.
+| ifid                  | x.x.x.x.x.x.x.x                | IPv6 interface ID (host portion).
+| ipv6addr              | x.x.x.x.x.x.x.x                | IPv6 address.
+| ipv6prefix            | Value between 0 - 128          | IPv6prefix.
+| byte                  | Single-byte integer            | Supported in FreeRADIUS > v2.
+Value between 0 - 255.
+| short                 | Two-byte integer               | Supported in FreeRADIUS > v3.
+Values between 0 - 65535, integer64, 8-byte integer.
+|===
+
+See xref:unlang:type/index.adoc[data types of attributes] for a more details.
+
+== https://github.com/FreeRADIUS/freeradius-server/tree/v3.2.x/share[Attribute Definition Dictionaries]
+
+FreeRADIUS contains over 100 dictionaries, which hold nearly 5000 attribute definitions.
+
+Unlike text-based protocols such as SMTP or HTTP, RADIUS is a binary protocol; therefore, although attributes are commonly referred to by name (for example, “User-Name”), these names have no meaning in the protocol. Data (i.e., “User-Name”) are encoded in a message as a binary header with binary data, and not as text strings.
+
+Dictionary files are used to map between the names used by people and the binary data in the RADIUS packets.
+
+The packets sent by the NAS contain attributes that have a number, a length, and binary data. By contrast, a dictionary file consists of a list of entries with name, number, and data type.
+
+The server uses the dictionaries to interpret the binary data as follows: the server searches the dictionaries to match the number from the packet, and the corresponding data type in the dictionary entry is then used by the server to interpret the binary data in the packet. The name within the dictionary entry appears in all logs and debug messages, in order to present the attribute in a form that is understandable to people.
+
+This process also works in reverse: the server uses the dictionaries to encode a string (i.e., “User-Name = Bob”) as “number, length, binary data” in a packet.
+
+For example, a server may receive a packet that contains the number 1 and some binary data. The server would not be able to decode these attributes without knowing if the binary data were in the form of a string, an IP address, or an integer. The corresponding dictionary entry may state: the number ‘1’ is called
+‘User-Name’ and it is in the form ‘string’. This information (i.e., form = ‘string’), contained in the dictionary entry, allows the server to successfully decode the packet.
+
+Adding new attributes to RADIUS software is made simpler through the use of dictionaries, as they allow the administrator to create new mappings without upgrading the software.
+
+Vendors can define new attributes in the dictionary without changing any of the server or client source code. These new attributes can then be incorporated in policy decisions or logged in an accounting record.Vendors can also define new functionality for their equipment by publishing a new dictionary file.
+Server support for an NAS can easily be added by writing the correct dictionary file for that NAS.
+
+There is no direct connection between the NAS and the dictionary files, as the dictionary files reside only on the server. For example, if names are edited in a local dictionary file, there is no effect on any other NAS or RADIUS server, because these names appear only in the local dictionary file. The RADIUS packets remain in binary format and contain only numbers, not names.
+
+[NOTE]
+====
+Editing attribute names in a local dictionary file does not effect any other NAS or RADIUS server. Only the attribute numbers are encoded and sent in RADIUS packets.
+
+The NAS and server may use different dictionaries, which may cause problems if they are not coordinated (a set of data may be interpreted differently by the NAS and the server, i.e., as a string by the NAS and an IP address by the server)
+====
+
+Since the attribute names are not sent in RADIUS packets, the dictionaries are limited to the local server and to the policy implemented by that server.
+In this respect, NAS implementations are much simpler than server implementations. Each NAS “looks” in the RADIUS packet for what it “understands” and ignores everything else. In contrast, each RADIUS server
+is presented with all of the information from every NAS in the RADIUS deployment. Each RADIUS server must be capable of “understanding” the functionality and configure-ability of every attribute that is
+necessary to authenticate or authorise the users.
+
+== Dictionary File Format
+
+It is very important to use the correct dictionaries. If the wrong dictionaries are used, the server may not properly interpret local configuration, or generate the correct response for the NAS.
+
+If the server does not have access to the correct vendor-specific attributes and dictionaries, it cannot correctly process any VSAs it receives for that vendor.
+
+[NOTE]
+====
+Servers must have access to a vendor dictionary to understand vendor attributes.
+====
+
+Some servers may not contain all the necessary dictionary files because each vendor defines their own dictionaries and release schedule. If a server does not include dictionaries for a particular vendor, contact that vendor, and not the organisation that supplied the RADIUS server.
+
+[#server-attr]
+=== Server-side Attributes
+
+Server-side attributes are attributes that control the server’s behavior. It is frequently necessary to define these server-side attributes, while ensuring that information pertaining to server-side attributes never
+gets sent through the network in a RADIUS message. Server-side attributes should not be included in RADIUS messages, since these attributes are internal to server implementation.
+
+Definitions for server-side attributes may vary by server vendor, or may vary even from one version of the same server to another. Only FreeRADIUS definitions for internal attributes are referenced in this document. Those definitions are generally the same across all versions of the server, but other vendors may have different implementations.
+
+Information such as “use LDAP server X”, or “remember that the user is in group Y” should be used to create local policy. This information should be stored in server-side attributes (also known as “non-protocol attributes”).
+
+Server-side attributes are presented using the same format as standard or vendor RADIUS attributes. This format gives the administrator the same control over internal aspects of the server behavior as over the server external responses. The server-side attribute information can be retrieved as part of one policy and checked later as part of another policy. For example, the policy can say “use LDAP server X for this request” and “respond with attribute X, value Y”.
+
+=== xref:session/processing.adoc[Processing Requests]
+
+The server processes requests through local site policy. That policy is used to examine the request, the request attributes, and the attribute values. The server then builds a reply message using responses (determined by local policy) such as time of day restrictions, group access limitations, and IP address allocation. The processing stage may include keeping track of <<server-attr,server-side attributes>>. FreeRADIUS maintains these attribute lists for every request.
+
+.Attribute Lists and Details
+
+[cols="1,2"]
+|===
+|*Attribute List*|*Description*
+
+|`request`
+|Attributes taken from the received packet.
+
+|`reply`
+|Attributes which will be sent in the reply.
+
+|`control`
+|Attributes used to control how the server operates.  These are never sent in a packet.
+
+|`session-state`
+|Attributes which are saved and restored across multiple request / reply exchanges.
+|===
+
+See the xref:unlang:list.adoc[Attribute Lists] reference documentation for more details.
diff -urpN freeradius-server-3.2.7/doc/antora/modules/developers/pages/bugs.adoc freeradius-server-3.2.8/doc/antora/modules/developers/pages/bugs.adoc
--- freeradius-server-3.2.7/doc/antora/modules/developers/pages/bugs.adoc	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/developers/pages/bugs.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -2,8 +2,8 @@
 
 == Introduction
 
-The FreeRADIUS web site is at https://freeradius.org/, and most
-information referenced in this document can be found there.
+The https://freeradius.org/[FreeRADIUS website] contains most of the
+information referenced in this document.
 
 This document is primarily for non-developers of the FreeRADIUS
 server. If you are able to patch the code to work correctly, then
@@ -15,10 +15,10 @@ the place for you!
 
 Where the server terminates ungracefully due to a bus error,
 segmentation violation, or other memory error, you should create a new
-issue in the issue tracker https://bugs.freeradius.org/, including
+issue in the https://freeradius.org/[issue tracker], including
 information from the debugging sections below.
 
-For any other issues, you should first discuss them on the
+For any other issues, first post and discuss them on the
 https://freeradius.org/support/[FreeRADIUS users list], to
 see if anyone can reproduce them. Often there’s a simple explanation of
 why the server behaves as it does, and it’s not necessarily a bug in the
@@ -29,8 +29,8 @@ If the behavior is correct but confusing
 you should file a bug against our documentation.
 
 For more information about the users list, the lists’ archives and the
-faq, please visit https://www.freeradius.org/list/users.html Please make
-sure to READ and RESPECT the house-rules. You will get much better
+faq, please visit https://www.freeradius.org/list/users.html[FreeRADIUS org]. Please make
+sure to *read* and *respect* the house-rules. You will get much better
 response and much faster if you do!
 
 == Core dumps
diff -urpN freeradius-server-3.2.7/doc/antora/modules/developers/pages/coding-methods.adoc freeradius-server-3.2.8/doc/antora/modules/developers/pages/coding-methods.adoc
--- freeradius-server-3.2.7/doc/antora/modules/developers/pages/coding-methods.adoc	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/developers/pages/coding-methods.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -18,7 +18,7 @@ If someone _really_ hates you, you’ll
 someone else wrote. You don’t want to do that.
 
 For FreeRADIUS, use doxygen `@`-style comments so you get the
-benefits of the developer documentation site, https://doc.freeradius.org/.
+benefits of the developer documentation https://doc.freeradius.org/[site].
 
 == Give things reasonable names
 
@@ -77,11 +77,9 @@ If the programmer had bothered to check
 condition), then they could have produced a descriptive error message
 instead of having the program core dump.
 
-== Core dumps are for weenies
+== Core dumps are *ineffectual*
 
-If your program core dumps accidentally, you’re a bad programmer. You don’t know
-what your program is doing, or what it’s supposed to be doing when anything goes
-wrong.
+If your program core dumps accidentally, it's an indication of bad or weak programming. You don’t know what your program is doing, or what it’s supposed to be doing when anything goes wrong.
 
 If it hits an `assert()` and calls `abort()`, you’re a genius. You’ve thought
 ahead to what _might_ go wrong, and put in an assertion to ensure that it fails
diff -urpN freeradius-server-3.2.7/doc/antora/modules/howto/pages/protocols/proxy/enable_radsec.adoc freeradius-server-3.2.8/doc/antora/modules/howto/pages/protocols/proxy/enable_radsec.adoc
--- freeradius-server-3.2.7/doc/antora/modules/howto/pages/protocols/proxy/enable_radsec.adoc	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/howto/pages/protocols/proxy/enable_radsec.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -6,10 +6,10 @@ FreeRADIUS to accept RADIUS over TLS req
 The following steps should be performed on the host which will be the
 RadSec server, we will call it `radsecsvr`.
 
-You can install FreeRADIUS using the NetworkRADIUS packages by
+You can install FreeRADIUS using the InkBridge Networks packages by
 following the instructions provided here:
 
-<https://networkradius.com/packages/>
+<https://inkbridgenetworks.com/packages/>
 
 Before making any configuration changes, you should stop the radiusd
 service:
diff -urpN freeradius-server-3.2.7/doc/antora/modules/howto/pages/protocols/proxy/radsec_client.adoc freeradius-server-3.2.8/doc/antora/modules/howto/pages/protocols/proxy/radsec_client.adoc
--- freeradius-server-3.2.7/doc/antora/modules/howto/pages/protocols/proxy/radsec_client.adoc	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/howto/pages/protocols/proxy/radsec_client.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -10,10 +10,10 @@ will call `radseccli`.  This system shou
 different IP address.  That is, you shoudl not edit the configuration
 on the `radsecsvr` host.  Doing so will break the RadSec configuration.
 
-Install FreeRADIUS using the NetworkRADIUS packages by following the
+Install FreeRADIUS using the InkBridge Networks packages by following the
 instructions provided here:
 
-<https://networkradius.com/packages/>
+<https://inkbridgenetworks.com/packages/>
 
 Before making any configuration changes, you should stop the radiusd
 service:
diff -urpN freeradius-server-3.2.7/doc/antora/modules/installation/nav.adoc freeradius-server-3.2.8/doc/antora/modules/installation/nav.adoc
--- freeradius-server-3.2.7/doc/antora/modules/installation/nav.adoc	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/installation/nav.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -1,5 +1,5 @@
-* xref:index.adoc[Installing and upgrading]
+* xref:index.adoc[Install and Upgrade]
 ** xref:packages.adoc[Install from packages]
 ** xref:dependencies.adoc[Dependencies]
-** xref:source.adoc[Build from source]
-** xref:upgrade.adoc[Upgrading to v3]
+** xref:source.adoc[Build from Source]
+** xref:upgrade.adoc[Upgrade to v3]
diff -urpN freeradius-server-3.2.7/doc/antora/modules/installation/pages/dependencies.adoc freeradius-server-3.2.8/doc/antora/modules/installation/pages/dependencies.adoc
--- freeradius-server-3.2.7/doc/antora/modules/installation/pages/dependencies.adoc	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/installation/pages/dependencies.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -1,4 +1,4 @@
-= FreeRADIUS Dependencies
+= Dependencies
 
 Some external dependencies must be installed before building or
 running FreeRADIUS. For version 3, the core depends on one
@@ -17,8 +17,8 @@ particular module to be skipped.
 
 === libtalloc
 
-Talloc is a memory allocation library available at
-https://talloc.samba.org/talloc/doc/html/index.html
+Talloc is a memory allocation library available on the
+https://talloc.samba.org/talloc/doc/html/index.html[Samba] website.
 
 *OSX*
 
diff -urpN freeradius-server-3.2.7/doc/antora/modules/installation/pages/index.adoc freeradius-server-3.2.8/doc/antora/modules/installation/pages/index.adoc
--- freeradius-server-3.2.7/doc/antora/modules/installation/pages/index.adoc	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/installation/pages/index.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -2,7 +2,7 @@
 
 FreeRADIUS is available from multiple sources:
 
-* Official xref:packages.adoc[Network RADIUS packages]
+* Official xref:packages.adoc[InkBridge Networks] FreeRADIUS packages
 * xref:source.adoc[Source code]
 * Many Operating System distributions
 
diff -urpN freeradius-server-3.2.7/doc/antora/modules/installation/pages/packages.adoc freeradius-server-3.2.8/doc/antora/modules/installation/pages/packages.adoc
--- freeradius-server-3.2.7/doc/antora/modules/installation/pages/packages.adoc	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/installation/pages/packages.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -1,14 +1,14 @@
-== Install from packages
+= Install from packages
 
 Network RADIUS provide pre-built binary packages of FreeRADIUS for
 common Linux distributions. This is the recommended installation
 method when packages are available for your system.
 
-The official http://packages.networkradius.com[Network RADIUS
+The official https://packages.inkbridgenetworks.com/[InkBridge Networks
 packages] page contains recent FreeRADIUS packages and
 installation instructions.
 
-=== Distribution-supplied packages
+== Distribution-supplied packages
 
 While many Operating System distributions ship FreeRADIUS
 packages, the versions they include are often years out of date.
diff -urpN freeradius-server-3.2.7/doc/antora/modules/installation/pages/source.adoc freeradius-server-3.2.8/doc/antora/modules/installation/pages/source.adoc
--- freeradius-server-3.2.7/doc/antora/modules/installation/pages/source.adoc	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/installation/pages/source.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -1,10 +1,10 @@
-== Building from Source
+= Building from Source
 
 We recommend xref:packages.adoc[installing from packages] if
 possible. Full instructions on building and installing from source
 code follow.
 
-The mandatory xref:installation:dependencies.adoc[dependencies]
+The xref:installation:dependencies.adoc[dependencies]
 must be installed before FreeRADIUS can be built. These dependencies
 are `libtalloc` and `libkqueue`, which FreeRADIUS uses for memory
 management, and platform-independent event handling.
@@ -18,12 +18,12 @@ require are not enabled you should inspe
 output to figure out which additional development libraries need
 to be installed.
 
+include::xref:ROOT/partial$externaldoc.adoc
+
 The FreeRADIUS source may be obtained from a number of locations:
 
 * Download the latest version of the FreeRADIUS source from
   https://www.freeradius.org/releases/[the FreeRADIUS web site]; or
-* download directly from the
-  ftp://ftp.freeradius.org/pub/freeradius/[FreeRADIUS FTP site]; or
 * download from
   https://github.com/FreeRADIUS/freeradius-server/[GitHub].
 
@@ -51,14 +51,14 @@ make
 sudo make install
 ----
 
-=== Custom build
+== Custom build
 
 FreeRADIUS has GNU autoconf support. This means you have to run
 `./configure`, and then run `make`. To see which configuration
 options are supported, run `./configure --help`, and read its output.
 
 The `make install` stage will install the binaries, the "man" pages,
-and _may_ install the configuration files. If you have not installed a
+and *may* install the configuration files. If you have not installed a
 RADIUS server before, then the configuration files for FreeRADIUS will
 be installed.
 
@@ -75,7 +75,7 @@ this may cause undesired behavior and fa
 
 The initial output from running in debugging mode (`radiusd -X`)
 will tell you which configuration files are being used. See
-xref:installation:upgrade.adoc[Upgrading] for information about
+xref:installation:upgrade.adoc[Upgrade to v3] for information about
 upgrading from older versions. There _may_ be changes in the
 dictionary files which are required for a new version of the
 software. These files will not be installed over your current
@@ -93,7 +93,7 @@ Please do _not_ post questions to the Fr
 without first carefully reading the output of this process as it
 often contains the information needed to resolve a problem.
 
-== Upgrading To A New Minor Release
+== Upgrade To A New Minor Release
 
 The installation process will not over-write your existing configuration
 files. It will, however, warn you about the files it did not install.
@@ -103,16 +103,16 @@ It is not possible to re-use configurati
 versions of the server.
 
 For details on what has changed between the version, see the
-xref:installation:upgrade.adoc[upgrade] guide.
+xref:installation:upgrade.adoc[Upgrade to v3] guide.
 
-We _strongly_ recommend that new major versions be installed in a
+We *strongly* recommend that new major versions be installed in a
 different location than any existing installations. Any local policies
 can then be migrated gradually to the configuration format of the new
 major version. The number of differences in the new configuration mean
 that is is both simpler and safer to migrate your configurations rather
 than to try and just get the old configuration to work.
 
-== Running the server
+== Run the Server
 
 If the server builds and installs, but doesn’t run correctly, then
 you should first use debugging mode (`radiusd -X`) to figure out
@@ -124,7 +124,7 @@ your problem will often be in a warning
 
 We really cannot emphasize that last sentence enough. Configuring
 a RADIUS server for complex local authentication isn’t a trivial
-task. Your _best_ and _only_ method for debugging it is to read
+task. Your *best* and *only* method for debugging it is to read
 the debug messages, where the server will tell you exactly what
 it’s doing, and why. You should then compare its behaviour to what
 you intended, and edit the configuration files as appropriate.
@@ -150,9 +150,8 @@ radiusd -X
 ----
 
 You should see a lot of text printed on the screen as it starts up. If
-you don’t, or if you see error messages, please read the FAQ:
+you don’t, or if you see error messages, please read the https://www.freeradius.org/documentation/freeradius-server/4.0.0/faq.html[FAQ]:
 
-https://wiki.freeradius.org/guide/FAQ
 
 If the server says `Ready to process requests.`, then it is running
 properly. From another shell (or another window), type
@@ -175,7 +174,7 @@ server, edit `raddb/clients.conf`. Pleas
 carefully, as many configuration options are only documented in comments
 in the file.
 
-Note that is is _highly_ recommended that you use some sort of version
+Note that is is *highly* recommended that you use some sort of version
 control system to manage your configuration, such as git or Subversion.
 You should then make small changes to the configuration, checking in and
 testing as you go. When a config change causes the server to stop
@@ -193,7 +192,6 @@ Configuring and running the server MAY b
 Please read the documentation in the doc/ directory. The comments in the
 configuration files also contain a lot of documentation.
 
-If you have any additional issues, the FAQ is also a good place to
-start.
+If you have any additional issues, the https://www.freeradius.org/documentation/freeradius-server/4.0.0/faq.html[FAQ] or https://www.freeradius.org/documentation/freeradius-server/4.0.0/trouble-shooting/index.html[Troubleshooting] guides are good places to start.
+
 
-https://wiki.freeradius.org/guide/FAQ
diff -urpN freeradius-server-3.2.7/doc/antora/modules/installation/pages/upgrade.adoc freeradius-server-3.2.8/doc/antora/modules/installation/pages/upgrade.adoc
--- freeradius-server-3.2.7/doc/antora/modules/installation/pages/upgrade.adoc	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/installation/pages/upgrade.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -1,7 +1,7 @@
-= Upgrading from v2 to v3
+= Upgrade to v3
 
-The configuration for 3.0 is *largely* compatible with the 2.x.x
-configuration.  However, it is NOT possible to simply use the 2.x.x
+The configuration for version 3 is *largely* compatible with the version 2
+configuration.  However, it is NOT possible to simply use the v2
 configuration as-is.  Instead, you should re-create it.
 
 == Security
@@ -64,7 +64,7 @@ server are placed in the `mods-enabled/`
 modules in that directory will be loaded.  This means that the
 `instantiate` section of radiusd.conf is less important.  The only
 reason to list a module in the `instantiate` section is to force
-ordering when the modules are loaded. 
+ordering when the modules are loaded.
 
 Modules can be enabled by creating a soft link.  For module `foo`, do:
 
@@ -340,8 +340,8 @@ if (userlock) {
 	}
 }
 ----
-  
-  
+
+
 === rlm_unix
 
 The `unix` module does not have an `authenticate` section.  So you
@@ -374,13 +374,13 @@ to get them being processed.
 
 Instances of rlm_date register an xlat method which can translate
 integer and date values to an arbitrarily formatted date time
-string, or an arbitrarily formated time string to an integer, 
+string, or an arbitrarily formated time string to an integer,
 depending on the attribute type passed.
 
 
 === rlm_rest
 
-The `rest` module is used to translate RADIUS requests into 
+The `rest` module is used to translate RADIUS requests into
 RESTfull HTTP requests. Currently supported body types are JSON
 and POST.
 
@@ -403,12 +403,12 @@ All integers are assumed to be in networ
 === rlm_yubikey
 
 The `yubikey` module can be used to forward yubikey OTP token
-values to a Yubico validation server, or decrypt the token 
+values to a Yubico validation server, or decrypt the token
 using a PSK.
 
 
 == Deleted Modules
- 
+
 The following modules have been deleted, and are no longer supported
 in Version 3.  If you are using one of these modules, your
 configuration can probably be changed to not need it.  Otherwise email
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/SAVE.svg freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/SAVE.svg
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/SAVE.svg	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/SAVE.svg	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,396 @@
+<?xml version="1.0" standalone="no"?>
+<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
+"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
+<!-- Creator: fig2dev Version 3.2 Patchlevel 5e -->
+<!-- CreationDate: Mon Aug 11 20:51:55 2014 -->
+<!-- Magnification: 1.000 -->
+<svg	xmlns="http://www.w3.org/2000/svg"
+	xmlns:xlink="http://www.w3.org/1999/xlink"
+	width="6.0in" height="6.5in"
+	viewBox="578 288 7244 7824">
+<g style="stroke-width:.025in; fill:none">
+<!-- Line: box -->
+<rect x="600" y="300" width="900" height="600" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="1800" y="300" width="900" height="600" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="3000" y="300" width="900" height="600" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="4200" y="300" width="900" height="600" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="6825" y="300" width="975" height="600" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="5475" y="300" width="975" height="600" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="600" y="3000" width="1200" height="600" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="2100" y="3000" width="1200" height="600" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="3600" y="3000" width="1200" height="600" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="5100" y="3000" width="1200" height="600" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="6600" y="3000" width="1200" height="600" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="600" y="4200" width="1200" height="300" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="600" y="4575" width="1200" height="300" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="600" y="4950" width="1200" height="300" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="600" y="5325" width="1200" height="300" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="600" y="5700" width="1200" height="300" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="600" y="6075" width="1200" height="300" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="4875" y="7500" width="1650" height="600" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="600" y="1800" width="7200" height="900" rx="0" 
+style="stroke:#000000;stroke-width:15;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1050,975
+1050,1605
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 1050 975 - 1050 1740-->
+<polygon points="1020 1604
+1050 1724
+1080 1604
+1020 1604
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line -->
+<polyline points="2250,975
+2250,1605
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 2250 975 - 2250 1740-->
+<polygon points="2220 1604
+2250 1724
+2280 1604
+2220 1604
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line -->
+<polyline points="3450,975
+3450,1605
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 3450 975 - 3450 1740-->
+<polygon points="3420 1604
+3450 1724
+3480 1604
+3420 1604
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line -->
+<polyline points="4650,975
+4650,1605
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 4650 975 - 4650 1740-->
+<polygon points="4620 1604
+4650 1724
+4680 1604
+4620 1604
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line -->
+<polyline points="6000,975
+6000,1605
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 6000 975 - 6000 1740-->
+<polygon points="5970 1604
+6000 1724
+6030 1604
+5970 1604
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line -->
+<polyline points="7350,975
+7350,1605
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 7350 975 - 7350 1740-->
+<polygon points="7320 1604
+7350 1724
+7380 1604
+7320 1604
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line: box -->
+<rect x="3600" y="4200" width="1200" height="300" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="5100" y="4200" width="1200" height="300" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="5100" y="4575" width="1200" height="300" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="5100" y="4950" width="1200" height="300" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="5100" y="5325" width="1200" height="300" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="5100" y="5700" width="1200" height="300" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="5100" y="6075" width="1200" height="300" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="6600" y="4200" width="1200" height="300" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="6600" y="4575" width="1200" height="300" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="6600" y="4950" width="1200" height="300" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="5700,6750
+5700,7305
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 5700 6750 - 5700 7440-->
+<polygon points="5670 7304
+5700 7424
+5730 7304
+5670 7304
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line -->
+<polyline points="4200,2700
+1918,2985
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 4200 2700 - 1785 3001-->
+<polygon points="1916 2954
+1801 2999
+1923 3013
+1916 2954
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line -->
+<polyline points="4200,2700
+3413,2962
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 4200 2700 - 3285 3004-->
+<polygon points="3404 2932
+3300 2999
+3423 2989
+3404 2932
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line -->
+<polyline points="4200,2700
+4200,2880
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 4200 2700 - 4200 3015-->
+<polygon points="4170 2879
+4200 2999
+4230 2879
+4170 2879
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line -->
+<polyline points="4200,2700
+4986,2962
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 4200 2700 - 5114 3004-->
+<polygon points="4975 2989
+5099 2999
+4994 2932
+4975 2989
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line -->
+<polyline points="4200,2700
+6481,2985
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 4200 2700 - 6614 3001-->
+<polygon points="6475 3013
+6598 2999
+6482 2954
+6475 3013
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Text -->
+<text xml:space="preserve" x="825" y="675" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">NAS</text>
+<!-- Text -->
+<text xml:space="preserve" x="2025" y="675" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">NAS</text>
+<!-- Text -->
+<text xml:space="preserve" x="3225" y="675" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">NAS</text>
+<!-- Text -->
+<text xml:space="preserve" x="4425" y="675" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">NAS</text>
+<!-- Text -->
+<text xml:space="preserve" x="7050" y="675" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">Proxy</text>
+<!-- Text -->
+<text xml:space="preserve" x="5700" y="675" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">Proxy</text>
+<!-- Text -->
+<text xml:space="preserve" x="900" y="3375" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">thread</text>
+<!-- Text -->
+<text xml:space="preserve" x="2400" y="3375" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">thread</text>
+<!-- Text -->
+<text xml:space="preserve" x="3900" y="3375" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">thread</text>
+<!-- Text -->
+<text xml:space="preserve" x="5400" y="3375" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">thread</text>
+<!-- Text -->
+<text xml:space="preserve" x="6900" y="3375" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">thread</text>
+<!-- Text -->
+<text xml:space="preserve" x="675" y="4425" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">preprocess</text>
+<!-- Text -->
+<text xml:space="preserve" x="675" y="4800" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">chap</text>
+<!-- Text -->
+<text xml:space="preserve" x="675" y="5175" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">suffix</text>
+<!-- Text -->
+<text xml:space="preserve" x="675" y="5550" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">files</text>
+<!-- Text -->
+<text xml:space="preserve" x="675" y="5925" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">eap</text>
+<!-- Text -->
+<text xml:space="preserve" x="675" y="6300" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">sql</text>
+<!-- Text -->
+<text xml:space="preserve" x="750" y="4125" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">authorize</text>
+<!-- Text -->
+<text xml:space="preserve" x="5100" y="7875" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">Home server</text>
+<!-- Text -->
+<text xml:space="preserve" x="2400" y="4125" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">waiting</text>
+<!-- Text -->
+<text xml:space="preserve" x="3750" y="4125" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">authenticate</text>
+<!-- Text -->
+<text xml:space="preserve" x="3675" y="4425" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">unix</text>
+<!-- Text -->
+<text xml:space="preserve" x="5250" y="4125" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">authorize</text>
+<!-- Text -->
+<text xml:space="preserve" x="5175" y="4425" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">preprocess</text>
+<!-- Text -->
+<text xml:space="preserve" x="5175" y="4800" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">chap</text>
+<!-- Text -->
+<text xml:space="preserve" x="5175" y="5175" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">suffix</text>
+<!-- Text -->
+<text xml:space="preserve" x="5175" y="5550" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">files</text>
+<!-- Text -->
+<text xml:space="preserve" x="5175" y="5925" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">eap</text>
+<!-- Text -->
+<text xml:space="preserve" x="5175" y="6300" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">sql</text>
+<!-- Text -->
+<text xml:space="preserve" x="5175" y="6600" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">proxy to realm</text>
+<!-- Text -->
+<text xml:space="preserve" x="6675" y="4425" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">preprocess</text>
+<!-- Text -->
+<text xml:space="preserve" x="6750" y="4125" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">accounting</text>
+<!-- Text -->
+<text xml:space="preserve" x="6675" y="4800" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">suffix</text>
+<!-- Text -->
+<text xml:space="preserve" x="6675" y="5175" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">files</text>
+<!-- Text -->
+<text xml:space="preserve" x="2625" y="2325" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="216" text-anchor="start">FreeRADIUS Server core</text>
+</g>
+</svg>
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/access-challenge.svg freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/access-challenge.svg
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/access-challenge.svg	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/access-challenge.svg	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,109 @@
+<?xml version="1.0" standalone="no"?>
+<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
+"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
+<!-- Creator: fig2dev Version 3.2 Patchlevel 5e -->
+<!-- CreationDate: Mon Aug 11 20:51:55 2014 -->
+<!-- Magnification: 1.000 -->
+<svg	xmlns="http://www.w3.org/2000/svg"
+	xmlns:xlink="http://www.w3.org/1999/xlink"
+	width="4.0in" height="4.3in"
+	viewBox="285 224 4846 5188">
+<g style="stroke-width:.025in; fill:none">
+<!-- Line -->
+<polyline points="1800,3300
+2586,3562
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 1800 3300 - 2714 3604-->
+<polygon points="2575 3589
+2699 3599
+2594 3532
+2575 3589
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line -->
+<polyline points="1800,1200
+2586,1462
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 1800 1200 - 2714 1504-->
+<polygon points="2575 1489
+2699 1499
+2594 1432
+2575 1489
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line -->
+<polyline points="2700,2700
+1913,2962
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 2700 2700 - 1785 3004-->
+<polygon points="1904 2932
+1800 2999
+1923 2989
+1904 2932
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line -->
+<polyline points="5100,225
+5100,300
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 5100 225 - 5100 300-->
+<polygon points="5070 296
+5100 296
+5130 296
+5070 296
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line -->
+<polyline points="2700,5100
+1913,5362
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 2700 5100 - 1785 5404-->
+<polygon points="1904 5332
+1800 5399
+1923 5389
+1904 5332
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Text -->
+<text xml:space="preserve" x="300" y="3225" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">Access-Request</text>
+<!-- Text -->
+<text xml:space="preserve" x="300" y="1125" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">Access-Request</text>
+<!-- Text -->
+<text xml:space="preserve" x="2850" y="2625" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">Access-Challenge</text>
+<!-- Text -->
+<text xml:space="preserve" x="450" y="3525" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">State = 0x01</text>
+<!-- Text -->
+<text xml:space="preserve" x="3000" y="2925" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">State = 0x01</text>
+<!-- Text -->
+<text xml:space="preserve" x="2850" y="5025" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">Access-Accept</text>
+<!-- Text -->
+<text xml:space="preserve" x="2850" y="1725" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">authorize</text>
+<!-- Text -->
+<text xml:space="preserve" x="2850" y="2025" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">authenticate</text>
+<!-- Text -->
+<text xml:space="preserve" x="2850" y="3825" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">authorize</text>
+<!-- Text -->
+<text xml:space="preserve" x="2850" y="4110" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">authenticate</text>
+<!-- Text -->
+<text xml:space="preserve" x="2850" y="4395" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">post-auth</text>
+<!-- Text -->
+<text xml:space="preserve" x="3000" y="600" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">Server</text>
+<!-- Text -->
+<text xml:space="preserve" x="600" y="600" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">NAS</text>
+</g>
+</svg>
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/access-request-proxy.svg freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/access-request-proxy.svg
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/access-request-proxy.svg	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/access-request-proxy.svg	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,121 @@
+<?xml version="1.0" standalone="no"?>
+<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
+"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
+<!-- Creator: fig2dev Version 3.2 Patchlevel 5e -->
+<!-- CreationDate: Mon Aug 11 20:51:55 2014 -->
+<!-- Magnification: 1.000 -->
+<svg	xmlns="http://www.w3.org/2000/svg"
+	xmlns:xlink="http://www.w3.org/1999/xlink"
+	width="6.4in" height="5.1in"
+	viewBox="285 224 7696 6088">
+<g style="stroke-width:.025in; fill:none">
+<!-- Line -->
+<polyline points="4800,2925
+5586,3187
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 4800 2925 - 5714 3229-->
+<polygon points="5575 3214
+5699 3224
+5594 3157
+5575 3214
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line -->
+<polyline points="5700,4800
+4913,5062
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 5700 4800 - 4785 5104-->
+<polygon points="4904 5032
+4800 5099
+4923 5089
+4904 5032
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line -->
+<polyline points="1800,1200
+2586,1462
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 1800 1200 - 2714 1504-->
+<polygon points="2575 1489
+2699 1499
+2594 1432
+2575 1489
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line -->
+<polyline points="2700,6000
+1913,6262
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 2700 6000 - 1785 6304-->
+<polygon points="1904 6232
+1800 6299
+1923 6289
+1904 6232
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line -->
+<polyline points="7950,300
+7950,450
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 7950 300 - 7950 450-->
+<polygon points="7920 446
+7950 446
+7980 446
+7920 446
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line -->
+<polyline points="600,225
+825,225
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Text -->
+<text xml:space="preserve" x="5850" y="4725" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">Access-Accept</text>
+<!-- Text -->
+<text xml:space="preserve" x="6000" y="5025" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">Proxy-State = 0x01</text>
+<!-- Text -->
+<text xml:space="preserve" x="2850" y="2925" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">Access-Request</text>
+<!-- Text -->
+<text xml:space="preserve" x="3000" y="3225" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">Proxy-State = 0x01</text>
+<!-- Text -->
+<text xml:space="preserve" x="300" y="1125" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">Access-Request</text>
+<!-- Text -->
+<text xml:space="preserve" x="2850" y="5925" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">Access-Accept</text>
+<!-- Text -->
+<text xml:space="preserve" x="5850" y="3525" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">authorize</text>
+<!-- Text -->
+<text xml:space="preserve" x="5850" y="3825" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">authenticate</text>
+<!-- Text -->
+<text xml:space="preserve" x="5850" y="4095" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">post-auth</text>
+<!-- Text -->
+<text xml:space="preserve" x="2850" y="1725" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">authorize</text>
+<!-- Text -->
+<text xml:space="preserve" x="2850" y="2010" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">authenticate</text>
+<!-- Text -->
+<text xml:space="preserve" x="2850" y="2325" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">pre-proxy</text>
+<!-- Text -->
+<text xml:space="preserve" x="2925" y="5325" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">post-proxy</text>
+<!-- Text -->
+<text xml:space="preserve" x="675" y="600" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">NAS</text>
+<!-- Text -->
+<text xml:space="preserve" x="3000" y="600" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">Proxy</text>
+<!-- Text -->
+<text xml:space="preserve" x="6000" y="600" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="240" text-anchor="start">Home server</text>
+</g>
+</svg>
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/access-request.svg freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/access-request.svg
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/access-request.svg	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/access-request.svg	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,69 @@
+<?xml version="1.0" standalone="no"?>
+<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
+"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
+<!-- Creator: fig2dev Version 3.2 Patchlevel 5e -->
+<!-- CreationDate: Mon Aug 11 20:51:55 2014 -->
+<!-- Magnification: 1.000 -->
+<svg	xmlns="http://www.w3.org/2000/svg"
+	xmlns:xlink="http://www.w3.org/1999/xlink"
+	width="3.8in" height="2.5in"
+	viewBox="285 299 4546 3013">
+<g style="stroke-width:.025in; fill:none">
+<!-- Line -->
+<polyline points="1800,1200
+2586,1462
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 1800 1200 - 2714 1504-->
+<polygon points="2575 1489
+2699 1499
+2594 1432
+2575 1489
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line -->
+<polyline points="2700,3000
+1913,3262
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 2700 3000 - 1785 3304-->
+<polygon points="1904 3232
+1800 3299
+1923 3289
+1904 3232
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line -->
+<polyline points="4800,300
+4800,525
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 4800 300 - 4800 525-->
+<polygon points="4770 521
+4800 521
+4830 521
+4770 521
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Text -->
+<text xml:space="preserve" x="300" y="1125" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">Access-Request</text>
+<!-- Text -->
+<text xml:space="preserve" x="2850" y="2925" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">Access-Accept</text>
+<!-- Text -->
+<text xml:space="preserve" x="2850" y="1725" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">authorize</text>
+<!-- Text -->
+<text xml:space="preserve" x="2850" y="2010" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">authenticate</text>
+<!-- Text -->
+<text xml:space="preserve" x="2850" y="2295" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">post-auth</text>
+<!-- Text -->
+<text xml:space="preserve" x="3000" y="600" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">Server</text>
+<!-- Text -->
+<text xml:space="preserve" x="600" y="600" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">NAS</text>
+</g>
+</svg>
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/accounting-request-proxy.svg freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/accounting-request-proxy.svg
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/accounting-request-proxy.svg	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/accounting-request-proxy.svg	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,119 @@
+<?xml version="1.0" standalone="no"?>
+<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
+"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
+<!-- Creator: fig2dev Version 3.2 Patchlevel 5e -->
+<!-- CreationDate: Mon Aug 11 20:51:55 2014 -->
+<!-- Magnification: 1.000 -->
+<svg	xmlns="http://www.w3.org/2000/svg"
+	xmlns:xlink="http://www.w3.org/1999/xlink"
+	width="6.3in" height="5.1in"
+	viewBox="285 224 7502 6163">
+<g style="stroke-width:.025in; fill:none">
+<!-- Line -->
+<polyline points="600,225
+825,225
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1500,1200
+2286,1462
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 1500 1200 - 2414 1504-->
+<polygon points="2275 1489
+2399 1499
+2294 1432
+2275 1489
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line -->
+<polyline points="7650,300
+7650,450
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 7650 300 - 7650 450-->
+<polygon points="7620 446
+7650 446
+7680 446
+7620 446
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line -->
+<polyline points="2400,6075
+1613,6337
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 2400 6075 - 1485 6379-->
+<polygon points="1604 6307
+1500 6374
+1623 6364
+1604 6307
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line -->
+<polyline points="4200,3300
+4986,3562
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 4200 3300 - 5114 3604-->
+<polygon points="4975 3589
+5099 3599
+4994 3532
+4975 3589
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line -->
+<polyline points="5100,4875
+4313,5137
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 5100 4875 - 4185 5179-->
+<polygon points="4304 5107
+4200 5174
+4323 5164
+4304 5107
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Text -->
+<text xml:space="preserve" x="675" y="600" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">NAS</text>
+<!-- Text -->
+<text xml:space="preserve" x="300" y="1125" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">Accounting-Request</text>
+<!-- Text -->
+<text xml:space="preserve" x="2700" y="3225" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">Proxy-State = 0x01</text>
+<!-- Text -->
+<text xml:space="preserve" x="2550" y="2325" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">pre-proxy</text>
+<!-- Text -->
+<text xml:space="preserve" x="2700" y="600" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">Proxy</text>
+<!-- Text -->
+<text xml:space="preserve" x="2550" y="1725" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">preacct</text>
+<!-- Text -->
+<text xml:space="preserve" x="2550" y="2010" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">accounting</text>
+<!-- Text -->
+<text xml:space="preserve" x="2550" y="2925" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">Accounting-Request</text>
+<!-- Text -->
+<text xml:space="preserve" x="2625" y="5400" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">post-proxy</text>
+<!-- Text -->
+<text xml:space="preserve" x="2550" y="6000" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">Accounting-Response</text>
+<!-- Text -->
+<text xml:space="preserve" x="5325" y="600" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="240" text-anchor="start">Home server</text>
+<!-- Text -->
+<text xml:space="preserve" x="5250" y="3900" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">preacct</text>
+<!-- Text -->
+<text xml:space="preserve" x="5250" y="4200" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">accounting</text>
+<!-- Text -->
+<text xml:space="preserve" x="5400" y="5100" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">Proxy-State = 0x01</text>
+<!-- Text -->
+<text xml:space="preserve" x="5250" y="4800" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">Accounting-Response</text>
+</g>
+</svg>
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/accounting-request.svg freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/accounting-request.svg
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/accounting-request.svg	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/accounting-request.svg	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,67 @@
+<?xml version="1.0" standalone="no"?>
+<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
+"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
+<!-- Creator: fig2dev Version 3.2 Patchlevel 5e -->
+<!-- CreationDate: Mon Aug 11 20:51:55 2014 -->
+<!-- Magnification: 1.000 -->
+<svg	xmlns="http://www.w3.org/2000/svg"
+	xmlns:xlink="http://www.w3.org/1999/xlink"
+	width="4.3in" height="2.3in"
+	viewBox="285 299 5102 2713">
+<g style="stroke-width:.025in; fill:none">
+<!-- Line -->
+<polyline points="1800,1200
+2586,1462
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 1800 1200 - 2714 1504-->
+<polygon points="2575 1489
+2699 1499
+2594 1432
+2575 1489
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line -->
+<polyline points="4800,300
+4800,525
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 4800 300 - 4800 525-->
+<polygon points="4770 521
+4800 521
+4830 521
+4770 521
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line -->
+<polyline points="2700,2700
+1913,2962
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 2700 2700 - 1785 3004-->
+<polygon points="1904 2932
+1800 2999
+1923 2989
+1904 2932
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Text -->
+<text xml:space="preserve" x="3000" y="600" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">Server</text>
+<!-- Text -->
+<text xml:space="preserve" x="600" y="600" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">NAS</text>
+<!-- Text -->
+<text xml:space="preserve" x="300" y="1125" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">Accounting-Request</text>
+<!-- Text -->
+<text xml:space="preserve" x="2850" y="1725" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">preacct</text>
+<!-- Text -->
+<text xml:space="preserve" x="2850" y="2010" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">accounting</text>
+<!-- Text -->
+<text xml:space="preserve" x="2850" y="2625" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">Accounting-Response</text>
+</g>
+</svg>
Binary files freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/asciifull.gif and freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/asciifull.gif differ
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/dispatcher.svg freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/dispatcher.svg
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/dispatcher.svg	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/dispatcher.svg	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,243 @@
+<?xml version="1.0" standalone="no"?>
+<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
+"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
+<!-- Creator: fig2dev Version 3.2 Patchlevel 5e -->
+<!-- CreationDate: Mon Aug 11 20:51:55 2014 -->
+<!-- Magnification: 1.000 -->
+<svg	xmlns="http://www.w3.org/2000/svg"
+	xmlns:xlink="http://www.w3.org/1999/xlink"
+	width="6.9in" height="4.2in"
+	viewBox="878 222 8269 5044">
+<g style="stroke-width:.025in; fill:none">
+<!-- Line: box -->
+<rect x="2100" y="1200" width="600" height="600" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="3300" y="1200" width="600" height="600" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="4500" y="1200" width="600" height="600" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="5700" y="1200" width="600" height="600" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="2100" y="3000" width="900" height="600" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="3600" y="3000" width="900" height="600" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="5100" y="3000" width="900" height="600" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="6600" y="3000" width="900" height="600" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="8100" y="3000" width="900" height="600" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="6600" y="4500" width="600" height="600" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4500,4800
+6060,4800
+" style="stroke:#0000ff;stroke-width:15;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 4500 4800 - 6330 4800-->
+<polygon points="6058 4860
+6298 4800
+6058 4740
+6058 4860
+
+" style="stroke:#0000ff;stroke-width:15;stroke-miterlimit:8;
+fill:#0000ff;"/>
+<!-- Line -->
+<polyline points="7500,4800
+7502,4800
+7505,4800
+7511,4801
+7521,4802
+7534,4803
+7551,4804
+7572,4805
+7597,4806
+7625,4807
+7657,4808
+7690,4808
+7726,4808
+7763,4807
+7800,4805
+7839,4802
+7878,4797
+7918,4791
+7958,4783
+7998,4773
+8039,4760
+8080,4744
+8121,4726
+8162,4704
+8204,4678
+8246,4648
+8286,4613
+8325,4575
+8359,4536
+8389,4496
+8416,4454
+8440,4412
+8461,4370
+8478,4328
+8494,4286
+8506,4245
+8517,4204
+8526,4163
+8533,4122
+8539,4082
+8544,4042
+8547,4002
+8550,3963
+8552,3925
+8553,3889
+8554,3854
+8554,3822
+8554,3792
+8553,3765
+8553,3742
+8552,3722
+8551,3706
+8551,3694
+8562,3914
+" style="stroke:#0000ff;stroke-width:15;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 8551 3694 - 8548 3645-->
+<polygon points="8624 3912
+8550 3677
+8504 3920
+8624 3912
+
+" style="stroke:#0000ff;stroke-width:15;stroke-miterlimit:8;
+fill:#0000ff;"/>
+<!-- Line -->
+<polyline points="1800,3300
+1799,3299
+1796,3298
+1790,3295
+1781,3290
+1769,3284
+1752,3275
+1732,3264
+1707,3251
+1679,3236
+1647,3218
+1612,3199
+1574,3177
+1534,3154
+1492,3129
+1450,3103
+1406,3075
+1363,3046
+1320,3017
+1277,2986
+1235,2954
+1195,2921
+1156,2887
+1119,2852
+1083,2815
+1050,2776
+1019,2736
+991,2694
+965,2650
+943,2603
+925,2555
+912,2505
+903,2453
+900,2400
+903,2347
+912,2295
+925,2245
+943,2197
+965,2150
+991,2106
+1019,2064
+1050,2024
+1083,1985
+1119,1948
+1156,1913
+1195,1879
+1235,1846
+1277,1814
+1320,1783
+1363,1754
+1406,1725
+1450,1697
+1492,1671
+1534,1646
+1574,1623
+1612,1601
+1647,1582
+1679,1564
+1707,1549
+1732,1536
+1752,1525
+1769,1516
+1781,1510
+1588,1611
+" style="stroke:#0000ff;stroke-width:15;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 1781 1510 - 1826 1486-->
+<polygon points="1613 1666
+1797 1501
+1557 1561
+1613 1666
+
+" style="stroke:#0000ff;stroke-width:15;stroke-miterlimit:8;
+fill:#0000ff;"/>
+<!-- Text -->
+<text xml:space="preserve" x="1950" y="1125" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">Thread 1</text>
+<!-- Text -->
+<text xml:space="preserve" x="3150" y="1125" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">Thread 2</text>
+<!-- Text -->
+<text xml:space="preserve" x="4350" y="1125" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">Thread 3</text>
+<!-- Text -->
+<text xml:space="preserve" x="5550" y="1125" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">Thread 4</text>
+<!-- Text -->
+<text xml:space="preserve" x="2025" y="2925" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">Request 1</text>
+<!-- Text -->
+<text xml:space="preserve" x="3525" y="2925" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">Request 2</text>
+<!-- Text -->
+<text xml:space="preserve" x="5025" y="2925" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">Request 3</text>
+<!-- Text -->
+<text xml:space="preserve" x="6525" y="2925" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">Request 4</text>
+<!-- Text -->
+<text xml:space="preserve" x="8025" y="2925" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">Request 5</text>
+<!-- Text -->
+<text xml:space="preserve" x="6300" y="4425" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">Server core</text>
+<!-- Text -->
+<text xml:space="preserve" x="1425" y="525" fill="#000000"  font-family="Helvetica" font-style="normal" font-weight="bold" font-size="240" text-anchor="start">Thread Pool and request dispatcher</text>
+<!-- Text -->
+<text xml:space="preserve" x="4125" y="5175" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">Access-Request</text>
+</g>
+</svg>
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/dual_nas_backup_server.svg freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/dual_nas_backup_server.svg
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/dual_nas_backup_server.svg	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/dual_nas_backup_server.svg	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,3024 @@
+<?xml version="1.0" standalone="no"?>
+<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
+"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
+<!-- Creator: fig2dev Version 3.2 Patchlevel 5e -->
+<!-- CreationDate: Mon Aug 11 20:51:55 2014 -->
+<!-- Magnification: 1.000 -->
+<svg	xmlns="http://www.w3.org/2000/svg"
+	xmlns:xlink="http://www.w3.org/1999/xlink"
+	width="6.3in" height="4.8in"
+	viewBox="288 288 7536 5799">
+<g style="stroke-width:.025in; fill:none">
+<!-- Line -->
+<polygon points="1784,4365
+1515,4558
+1515,4711
+2283,4788
+2283,4634
+2437,4404
+1784,4365
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:round; stroke-linecap:butt;
+fill:#aaaaaa;
+"/>
+<!-- Line -->
+<polygon points="1784,1215
+1515,1408
+1515,1561
+2283,1638
+2283,1484
+2437,1254
+1784,1215
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:round; stroke-linecap:butt;
+fill:#aaaaaa;
+"/>
+<!-- Line: box -->
+<rect x="1899" y="4634" width="231" height="62" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line: box -->
+<rect x="1554" y="4638" width="38" height="23" rx="0" 
+style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line: box -->
+<rect x="1899" y="1484" width="231" height="62" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line: box -->
+<rect x="1554" y="1488" width="38" height="23" rx="0" 
+style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line -->
+<polygon points="2283,4634
+2283,4788
+2437,4519
+2437,4404
+2283,4634
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:round; stroke-linecap:butt;
+fill:#555555;
+"/>
+<!-- Line -->
+<polyline points="2283,4749
+1515,4673
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2245,4746
+2245,4669
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1784,4700
+1784,4623
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2245,4707
+1784,4661
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="1535" y="4598" width="77" height="46" rx="0" 
+style="stroke:#ff0000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#ff0000;
+"/>
+<!-- Line: box -->
+<rect x="2168" y="4661" width="58" height="25" rx="0" 
+style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#555555;
+"/>
+<!-- Line -->
+<polyline points="2206,4742
+2206,4703
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2168,4738
+2168,4700
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polygon points="2283,1484
+2283,1638
+2437,1369
+2437,1254
+2283,1484
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:round; stroke-linecap:butt;
+fill:#555555;
+"/>
+<!-- Line -->
+<polyline points="2283,1599
+1515,1523
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2245,1596
+2245,1519
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1784,1550
+1784,1473
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2245,1557
+1784,1511
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="1535" y="1448" width="77" height="46" rx="0" 
+style="stroke:#ff0000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#ff0000;
+"/>
+<!-- Line: box -->
+<rect x="2168" y="1511" width="58" height="25" rx="0" 
+style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#555555;
+"/>
+<!-- Line -->
+<polyline points="2206,1592
+2206,1553
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2168,1588
+2168,1550
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1515,4558
+2283,4634
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1544,4560
+1808,4367
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1572,4563
+1833,4368
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1601,4566
+1857,4370
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1629,4569
+1881,4371
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1658,4572
+1905,4372
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1686,4575
+1929,4374
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1715,4577
+1953,4376
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1743,4580
+1977,4377
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1771,4583
+2002,4378
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1800,4586
+2026,4380
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1828,4589
+2050,4381
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1857,4592
+2074,4382
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1885,4594
+2098,4384
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1914,4597
+2122,4385
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1942,4600
+2147,4387
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1970,4603
+2171,4388
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1999,4606
+2195,4389
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2027,4609
+2219,4391
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2056,4611
+2243,4393
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2084,4614
+2267,4394
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2113,4617
+2292,4395
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2141,4620
+2316,4397
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2170,4623
+2340,4398
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2198,4626
+2365,4400
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2226,4628
+2388,4401
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2255,4632
+2412,4402
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1546,4676
+1546,4714
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1577,4679
+1577,4717
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1608,4681
+1608,4720
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1639,4685
+1639,4723
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1669,4688
+1669,4727
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1700,4691
+1700,4729
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1731,4694
+1731,4732
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1761,4697
+1761,4736
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1792,4700
+1792,4738
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1823,4703
+1823,4742
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1853,4706
+1853,4745
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1884,4710
+1884,4748
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1915,4712
+1915,4751
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1946,4715
+1946,4754
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1976,4719
+1976,4757
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2007,4722
+2007,4760
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2038,4725
+2038,4763
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2068,4728
+2068,4766
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2099,4731
+2099,4769
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2130,4734
+2130,4772
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2161,4737
+2161,4775
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2191,4740
+2191,4779
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2222,4743
+2222,4781
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2253,4746
+2253,4784
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2283,4673
+1515,4596
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1515,1408
+2283,1484
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1544,1410
+1808,1217
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1572,1413
+1833,1218
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1601,1416
+1857,1220
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1629,1419
+1881,1221
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1658,1422
+1905,1222
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1686,1425
+1929,1224
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1715,1427
+1953,1226
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1743,1430
+1977,1227
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1771,1433
+2002,1228
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1800,1436
+2026,1230
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1828,1439
+2050,1231
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1857,1442
+2074,1232
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1885,1444
+2098,1234
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1914,1447
+2122,1235
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1942,1450
+2147,1237
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1970,1453
+2171,1238
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1999,1456
+2195,1239
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2027,1459
+2219,1241
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2056,1461
+2243,1243
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2084,1464
+2267,1244
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2113,1467
+2292,1245
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2141,1470
+2316,1247
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2170,1473
+2340,1248
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2198,1476
+2365,1250
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2226,1478
+2388,1251
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2255,1482
+2412,1252
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1546,1526
+1546,1564
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1577,1529
+1577,1567
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1608,1531
+1608,1570
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1639,1535
+1639,1573
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1669,1538
+1669,1577
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1700,1541
+1700,1579
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1731,1544
+1731,1582
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1761,1547
+1761,1586
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1792,1550
+1792,1588
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1823,1553
+1823,1592
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1853,1556
+1853,1595
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1884,1560
+1884,1598
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1915,1562
+1915,1601
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1946,1565
+1946,1604
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1976,1569
+1976,1607
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2007,1572
+2007,1610
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2038,1575
+2038,1613
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2068,1578
+2068,1616
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2099,1581
+2099,1619
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2130,1584
+2130,1622
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2161,1587
+2161,1625
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2191,1590
+2191,1629
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2222,1593
+2222,1631
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2253,1596
+2253,1634
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2283,1523
+1515,1446
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="3600" y="900" width="1215" height="900" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#e7e7e7;
+"/>
+<!-- Line: box -->
+<rect x="3600" y="4050" width="1215" height="900" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#e7e7e7;
+"/>
+<!-- Line -->
+<polyline points="1200,4425
+1800,4425
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1200,1275
+1800,1275
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4800,1350
+5250,1350
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4800,4500
+5250,4500
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polygon points="6525,375
+6560,368
+6590,361
+6611,353
+6623,347
+6630,341
+6631,335
+6631,330
+6631,325
+6633,319
+6640,314
+6654,309
+6677,305
+6710,301
+6750,300
+6784,301
+6816,303
+6844,306
+6868,310
+6887,314
+6902,318
+6914,323
+6923,327
+6931,331
+6940,336
+6949,340
+6961,345
+6977,350
+6997,355
+7022,360
+7053,365
+7088,370
+7125,375
+7166,379
+7202,381
+7231,381
+7253,380
+7269,377
+7280,373
+7288,368
+7294,363
+7299,357
+7306,353
+7316,350
+7329,349
+7347,350
+7370,355
+7396,363
+7425,375
+7451,390
+7473,406
+7489,421
+7500,434
+7506,445
+7508,454
+7508,462
+7506,469
+7505,476
+7504,485
+7506,495
+7511,509
+7520,526
+7534,547
+7553,572
+7575,600
+7599,628
+7621,652
+7641,671
+7659,686
+7673,695
+7686,701
+7696,704
+7706,706
+7716,708
+7726,712
+7737,718
+7748,729
+7762,744
+7775,766
+7789,793
+7800,825
+7807,854
+7810,882
+7812,906
+7812,926
+7812,942
+7811,955
+7810,966
+7808,974
+7806,981
+7804,989
+7801,997
+7797,1006
+7791,1019
+7783,1034
+7773,1053
+7760,1075
+7744,1100
+7725,1125
+7703,1149
+7682,1169
+7661,1185
+7644,1197
+7630,1205
+7618,1210
+7609,1212
+7601,1213
+7594,1212
+7586,1212
+7578,1212
+7567,1214
+7554,1217
+7536,1223
+7514,1232
+7488,1244
+7458,1259
+7425,1275
+7392,1291
+7362,1307
+7337,1320
+7317,1331
+7302,1340
+7291,1347
+7284,1353
+7279,1358
+7275,1363
+7271,1367
+7266,1371
+7259,1376
+7248,1382
+7233,1389
+7213,1397
+7188,1406
+7158,1416
+7125,1425
+7088,1433
+7056,1439
+7029,1443
+7009,1445
+6995,1446
+6986,1446
+6979,1445
+6975,1444
+6971,1442
+6964,1441
+6955,1439
+6941,1437
+6921,1435
+6894,1432
+6862,1429
+6825,1425
+6788,1420
+6756,1414
+6730,1409
+6710,1404
+6697,1399
+6689,1395
+6684,1391
+6681,1388
+6678,1384
+6673,1380
+6664,1376
+6650,1371
+6630,1366
+6601,1361
+6566,1355
+6525,1350
+6488,1346
+6453,1344
+6422,1343
+6397,1344
+6377,1346
+6361,1349
+6349,1353
+6340,1358
+6331,1363
+6323,1367
+6314,1371
+6302,1374
+6287,1376
+6268,1376
+6244,1374
+6216,1369
+6184,1361
+6150,1350
+6118,1336
+6090,1322
+6066,1308
+6047,1296
+6032,1285
+6020,1276
+6012,1268
+6005,1261
+6000,1255
+5995,1248
+5989,1241
+5983,1232
+5976,1221
+5967,1207
+5957,1190
+5946,1171
+5935,1149
+5925,1125
+5918,1095
+5916,1070
+5918,1051
+5924,1039
+5932,1032
+5942,1029
+5952,1028
+5962,1026
+5973,1023
+5982,1015
+5991,1002
+5998,981
+6002,952
+6004,918
+6003,886
+6000,856
+5996,831
+5990,809
+5983,792
+5976,779
+5968,768
+5961,759
+5953,749
+5946,738
+5940,726
+5934,710
+5929,691
+5927,669
+5926,644
+5929,618
+5936,593
+5945,573
+5954,561
+5962,555
+5970,553
+5976,554
+5983,558
+5990,561
+5998,563
+6007,563
+6020,560
+6035,552
+6054,540
+6075,525
+6096,509
+6113,494
+6126,482
+6134,472
+6138,464
+6140,458
+6139,453
+6140,448
+6142,442
+6147,435
+6158,426
+6175,416
+6199,404
+6229,393
+6258,385
+6285,379
+6308,375
+6327,373
+6342,373
+6354,374
+6363,377
+6371,379
+6379,382
+6389,384
+6401,386
+6417,387
+6437,386
+6463,384
+6493,380
+6525,375
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="750,5100
+3435,5100
+" style="stroke:#0000d1;stroke-width:15;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 750 5100 - 3705 5100-->
+<polygon points="3433 5160
+3673 5100
+3433 5040
+3433 5160
+
+" style="stroke:#0000d1;stroke-width:15;stroke-miterlimit:8;
+fill:#0000d1;"/>
+<!-- Line -->
+<polyline points="750,1950
+3435,1950
+" style="stroke:#0000d1;stroke-width:15;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 750 1950 - 3705 1950-->
+<polygon points="3433 2010
+3673 1950
+3433 1890
+3433 2010
+
+" style="stroke:#0000d1;stroke-width:15;stroke-miterlimit:8;
+fill:#0000d1;"/>
+<!-- Line -->
+<polyline points="2325,1500
+2850,1500
+2925,1275
+3075,1725
+3150,1500
+3600,1500
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2325,4650
+2850,4650
+2925,4425
+3075,4875
+3150,4650
+3600,4650
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="5250,900
+6000,900
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="5250,5325
+6300,5325
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="5250,3000
+6300,3000
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4200,1950
+5625,1950
+5625,2850
+5985,2850
+" style="stroke:#0000d1;stroke-width:15;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 5625 2850 - 6255 2850-->
+<polygon points="5983 2910
+6223 2850
+5983 2790
+5983 2910
+
+" style="stroke:#0000d1;stroke-width:15;stroke-miterlimit:8;
+fill:#0000d1;"/>
+<!-- Line -->
+<polyline points="5250,450
+5250,6075
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4200,5100
+5100,5100
+5100,5550
+5985,5550
+" style="stroke:#0000d1;stroke-width:15;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 5100 5550 - 6255 5550-->
+<polygon points="5983 5610
+6223 5550
+5983 5490
+5983 5610
+
+" style="stroke:#0000d1;stroke-width:15;stroke-miterlimit:8;
+fill:#0000d1;"/>
+<!-- Text -->
+<text xml:space="preserve" x="3825" y="750" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">NAS</text>
+<!-- Text -->
+<text xml:space="preserve" x="3825" y="3900" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">NAS</text>
+<!-- Text -->
+<text xml:space="preserve" x="6225" y="975" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">Internet</text>
+<!-- Text -->
+<text xml:space="preserve" x="6300" y="1950" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">One</text>
+<!-- Text -->
+<text xml:space="preserve" x="6300" y="4275" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">Two</text>
+<!-- Line: box -->
+<rect x="652" y="4232" width="391" height="39" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#808080;
+"/>
+<!-- Line: box -->
+<rect x="613" y="4271" width="469" height="39" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#808080;
+"/>
+<!-- Line: box -->
+<rect x="378" y="3450" width="939" height="782" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#e0e0e0;
+"/>
+<!-- Line -->
+<polygon points="417,4583
+1278,4583
+1395,4779
+1395,4818
+300,4818
+300,4779
+417,4583
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="398" y="4524" width="117" height="20" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="1180" y="4524" width="117" height="20" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="398" y="4310" width="899" height="216" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="652" y="1082" width="391" height="39" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#808080;
+"/>
+<!-- Line: box -->
+<rect x="613" y="1121" width="469" height="39" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#808080;
+"/>
+<!-- Line: box -->
+<rect x="378" y="300" width="939" height="782" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#e0e0e0;
+"/>
+<!-- Line -->
+<polygon points="417,1433
+1278,1433
+1395,1629
+1395,1668
+300,1668
+300,1629
+417,1433
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="398" y="1374" width="117" height="20" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="1180" y="1374" width="117" height="20" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="398" y="1160" width="899" height="216" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#e0e0e0;
+"/>
+<!-- Line -->
+<polyline points="3600,999
+4810,999
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3600,990
+4810,990
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3600,1007
+4810,1007
+" style="stroke:#c7c7c7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3600,1652
+4810,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3600,1642
+4810,1642
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3600,1659
+4810,1659
+" style="stroke:#c7c7c7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3901,995
+3901,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3910,995
+3910,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3893,995
+3893,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3831,995
+3831,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3840,995
+3840,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3823,995
+3823,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4129,995
+4129,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4139,995
+4139,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4122,995
+4122,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4060,995
+4060,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4069,995
+4069,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4052,995
+4052,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4351,995
+4351,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4361,995
+4361,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4343,995
+4343,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4281,995
+4281,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4290,995
+4290,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4274,995
+4274,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4576,995
+4576,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4585,995
+4585,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4569,995
+4569,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4506,995
+4506,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4515,995
+4515,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4498,995
+4498,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4781,995
+4781,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4789,995
+4789,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4773,995
+4773,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4711,995
+4711,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4720,995
+4720,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4702,995
+4702,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4131,995
+4131,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3600,4149
+4810,4149
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3600,4140
+4810,4140
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3600,4157
+4810,4157
+" style="stroke:#c7c7c7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3600,4802
+4810,4802
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3600,4792
+4810,4792
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3600,4809
+4810,4809
+" style="stroke:#c7c7c7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3901,4145
+3901,4802
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3910,4145
+3910,4802
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3893,4145
+3893,4802
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3831,4145
+3831,4802
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3840,4145
+3840,4802
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3823,4145
+3823,4802
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4129,4145
+4129,4802
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4139,4145
+4139,4802
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4122,4145
+4122,4802
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4060,4145
+4060,4802
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4069,4145
+4069,4802
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4052,4145
+4052,4802
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4351,4145
+4351,4802
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4361,4145
+4361,4802
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4343,4145
+4343,4802
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4281,4145
+4281,4802
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4290,4145
+4290,4802
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4274,4145
+4274,4802
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4576,4145
+4576,4802
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4585,4145
+4585,4802
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4569,4145
+4569,4802
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4506,4145
+4506,4802
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4515,4145
+4515,4802
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4498,4145
+4498,4802
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4781,4145
+4781,4802
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4789,4145
+4789,4802
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4773,4145
+4773,4802
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4711,4145
+4711,4802
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4720,4145
+4720,4802
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4702,4145
+4702,4802
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4131,4145
+4131,4802
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="6300" y="2100" width="900" height="1569" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Line: box -->
+<rect x="6300" y="4425" width="900" height="1569" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polyline points="300,4779
+300,4818
+1395,4818
+1395,4779
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polygon points="456,4623
+378,4740
+1082,4740
+1043,4623
+456,4623
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#ffffff;
+"/>
+<!-- Line -->
+<polygon points="1239,4623
+1082,4623
+1121,4740
+1317,4740
+1239,4623
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#ffffff;
+"/>
+<!-- Line -->
+<polyline points="976,4390
+976,4370
+1061,4370
+1061,4351
+1166,4351
+" style="stroke:#808080;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1061,4429
+1061,4390
+1166,4390
+" style="stroke:#808080;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1166,4370
+1250,4370
+" style="stroke:#808080;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1166,4351
+1166,4370
+" style="stroke:#ffffff;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="976,4390
+1061,4390
+" style="stroke:#ffffff;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1061,4429
+1166,4429
+1166,4390
+1250,4390
+1250,4370
+" style="stroke:#ffffff;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1187,4429
+1229,4429
+1229,4409
+" style="stroke:#808080;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1187,4429
+1187,4409
+1229,4409
+" style="stroke:#ffffff;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="300,1629
+300,1668
+1395,1668
+1395,1629
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polygon points="456,1473
+378,1590
+1082,1590
+1043,1473
+456,1473
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#ffffff;
+"/>
+<!-- Line -->
+<polygon points="1239,1473
+1082,1473
+1121,1590
+1317,1590
+1239,1473
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#ffffff;
+"/>
+<!-- Line -->
+<polyline points="976,1240
+976,1220
+1061,1220
+1061,1201
+1166,1201
+" style="stroke:#808080;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1061,1279
+1061,1240
+1166,1240
+" style="stroke:#808080;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1166,1220
+1250,1220
+" style="stroke:#808080;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1166,1201
+1166,1220
+" style="stroke:#ffffff;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="976,1240
+1061,1240
+" style="stroke:#ffffff;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1061,1279
+1166,1279
+1166,1240
+1250,1240
+1250,1220
+" style="stroke:#ffffff;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1187,1279
+1229,1279
+1229,1259
+" style="stroke:#808080;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1187,1279
+1187,1259
+1229,1259
+" style="stroke:#ffffff;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="2701" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="2668" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="2801" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="2768" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="2901" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="2868" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="3001" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="2968" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="3101" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="3068" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="3203" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="3168" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="3301" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="3269" width="700" height="32" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="3402" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="3369" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="2468" width="700" height="32" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="2433" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="2367" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="2333" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="2267" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="2233" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6300" y="3536" width="900" height="133" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line -->
+<polyline points="6300,2566
+7200,2566
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5026" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="4993" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5126" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5093" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5226" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5193" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5326" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5293" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5426" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5393" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5528" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5493" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5626" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5594" width="700" height="32" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5727" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5694" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="4793" width="700" height="32" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="4758" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="4692" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="4658" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="4592" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="4558" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6300" y="5861" width="900" height="133" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line -->
+<polyline points="6300,4891
+7200,4891
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polygon points="456,4154
+457,4153
+464,4146
+476,4134
+488,4122
+495,4115
+496,4114
+496,4111
+496,4105
+496,4093
+496,4075
+496,4050
+496,4019
+496,3981
+496,3937
+496,3890
+496,3840
+496,3791
+496,3744
+496,3700
+496,3662
+496,3631
+496,3606
+496,3588
+496,3576
+496,3570
+496,3567
+495,3566
+488,3559
+476,3547
+464,3536
+457,3529
+456,3528
+456,3531
+456,3536
+456,3547
+456,3563
+456,3586
+456,3615
+456,3651
+456,3693
+456,3739
+456,3789
+456,3841
+456,3893
+456,3943
+456,3989
+456,4031
+456,4067
+456,4096
+456,4119
+456,4135
+456,4146
+456,4151
+456,4154
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polygon points="1239,4154
+1238,4153
+1231,4146
+1219,4134
+1207,4122
+1200,4115
+1199,4114
+1199,4111
+1199,4105
+1199,4093
+1199,4075
+1199,4050
+1199,4019
+1199,3981
+1199,3937
+1199,3890
+1199,3840
+1199,3791
+1199,3744
+1199,3700
+1199,3662
+1199,3631
+1199,3606
+1199,3588
+1199,3576
+1199,3570
+1199,3567
+1200,3566
+1207,3559
+1219,3547
+1231,3536
+1238,3529
+1239,3528
+1239,3531
+1239,3536
+1239,3547
+1239,3563
+1239,3586
+1239,3615
+1239,3651
+1239,3693
+1239,3739
+1239,3789
+1239,3841
+1239,3893
+1239,3943
+1239,3989
+1239,4031
+1239,4067
+1239,4096
+1239,4119
+1239,4135
+1239,4146
+1239,4151
+1239,4154
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polygon points="496,3567
+498,3567
+502,3567
+508,3566
+518,3565
+532,3564
+548,3563
+567,3562
+587,3560
+609,3559
+633,3558
+658,3556
+685,3555
+714,3554
+745,3553
+779,3553
+816,3552
+855,3552
+894,3552
+930,3553
+963,3553
+994,3554
+1022,3555
+1047,3556
+1071,3558
+1094,3559
+1114,3560
+1134,3562
+1151,3563
+1166,3564
+1178,3565
+1188,3566
+1194,3567
+1197,3567
+1199,3567
+1200,3566
+1207,3559
+1219,3547
+1231,3536
+1238,3529
+1239,3528
+1236,3528
+1231,3528
+1220,3528
+1204,3528
+1181,3528
+1151,3528
+1114,3528
+1070,3528
+1020,3528
+966,3528
+907,3528
+847,3528
+788,3528
+729,3528
+675,3528
+625,3528
+581,3528
+544,3528
+514,3528
+491,3528
+475,3528
+464,3528
+459,3528
+456,3528
+457,3529
+464,3536
+476,3548
+488,3559
+495,3566
+496,3567
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#808080;
+"/>
+<!-- Line -->
+<polygon points="496,4114
+498,4114
+502,4114
+508,4115
+518,4116
+532,4117
+548,4118
+567,4120
+587,4121
+609,4122
+633,4124
+658,4125
+685,4126
+714,4128
+745,4129
+779,4129
+816,4130
+855,4130
+894,4130
+930,4129
+963,4129
+994,4128
+1022,4126
+1047,4125
+1071,4124
+1094,4122
+1114,4121
+1134,4120
+1151,4118
+1166,4117
+1178,4116
+1188,4115
+1194,4114
+1197,4114
+1199,4114
+1200,4115
+1207,4122
+1219,4134
+1231,4146
+1238,4153
+1239,4154
+1236,4154
+1231,4154
+1220,4154
+1204,4154
+1181,4154
+1151,4154
+1114,4154
+1070,4154
+1020,4154
+966,4154
+907,4154
+847,4154
+788,4154
+729,4154
+675,4154
+625,4154
+581,4154
+544,4154
+514,4154
+491,4154
+475,4154
+464,4154
+459,4154
+456,4154
+457,4153
+464,4146
+476,4134
+488,4122
+495,4115
+496,4114
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#ffffff;
+"/>
+<!-- Line: box -->
+<rect x="378" y="4740" width="704" height="14" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#808080;
+"/>
+<!-- Line -->
+<polygon points="442,4623
+378,4740
+496,4740
+512,4701
+485,4701
+500,4662
+475,4662
+496,4623
+442,4623
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polygon points="1082,4740
+965,4740
+965,4700
+990,4701
+986,4662
+1004,4662
+1010,4662
+1002,4623
+1050,4623
+1082,4740
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polygon points="1317,4740
+1281,4740
+1239,4646
+1089,4646
+1082,4623
+1255,4623
+1317,4740
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#c0c0c0;
+"/>
+<!-- Line: box -->
+<rect x="1121" y="4740" width="196" height="13" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#808080;
+"/>
+<!-- Line -->
+<polygon points="1121,4740
+1121,4754
+1081,4634
+1082,4623
+1121,4740
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#808080;
+"/>
+<!-- Line -->
+<polygon points="456,1004
+457,1003
+464,996
+476,984
+488,972
+495,965
+496,964
+496,961
+496,955
+496,943
+496,925
+496,900
+496,869
+496,831
+496,787
+496,740
+496,690
+496,641
+496,594
+496,550
+496,512
+496,481
+496,456
+496,438
+496,426
+496,420
+496,417
+495,416
+488,409
+476,397
+464,386
+457,379
+456,378
+456,381
+456,386
+456,397
+456,413
+456,436
+456,465
+456,501
+456,543
+456,589
+456,639
+456,691
+456,743
+456,793
+456,839
+456,881
+456,917
+456,946
+456,969
+456,985
+456,996
+456,1001
+456,1004
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polygon points="1239,1004
+1238,1003
+1231,996
+1219,984
+1207,972
+1200,965
+1199,964
+1199,961
+1199,955
+1199,943
+1199,925
+1199,900
+1199,869
+1199,831
+1199,787
+1199,740
+1199,690
+1199,641
+1199,594
+1199,550
+1199,512
+1199,481
+1199,456
+1199,438
+1199,426
+1199,420
+1199,417
+1200,416
+1207,409
+1219,397
+1231,386
+1238,379
+1239,378
+1239,381
+1239,386
+1239,397
+1239,413
+1239,436
+1239,465
+1239,501
+1239,543
+1239,589
+1239,639
+1239,691
+1239,743
+1239,793
+1239,839
+1239,881
+1239,917
+1239,946
+1239,969
+1239,985
+1239,996
+1239,1001
+1239,1004
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polygon points="496,417
+498,417
+502,417
+508,416
+518,415
+532,414
+548,413
+567,412
+587,410
+609,409
+633,408
+658,406
+685,405
+714,404
+745,403
+779,403
+816,402
+855,402
+894,402
+930,403
+963,403
+994,404
+1022,405
+1047,406
+1071,408
+1094,409
+1114,410
+1134,412
+1151,413
+1166,414
+1178,415
+1188,416
+1194,417
+1197,417
+1199,417
+1200,416
+1207,409
+1219,397
+1231,386
+1238,379
+1239,378
+1236,378
+1231,378
+1220,378
+1204,378
+1181,378
+1151,378
+1114,378
+1070,378
+1020,378
+966,378
+907,378
+847,378
+788,378
+729,378
+675,378
+625,378
+581,378
+544,378
+514,378
+491,378
+475,378
+464,378
+459,378
+456,378
+457,379
+464,386
+476,398
+488,409
+495,416
+496,417
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#808080;
+"/>
+<!-- Line -->
+<polygon points="496,964
+498,964
+502,964
+508,965
+518,966
+532,967
+548,968
+567,970
+587,971
+609,972
+633,974
+658,975
+685,976
+714,978
+745,979
+779,979
+816,980
+855,980
+894,980
+930,979
+963,979
+994,978
+1022,976
+1047,975
+1071,974
+1094,972
+1114,971
+1134,970
+1151,968
+1166,967
+1178,966
+1188,965
+1194,964
+1197,964
+1199,964
+1200,965
+1207,972
+1219,984
+1231,996
+1238,1003
+1239,1004
+1236,1004
+1231,1004
+1220,1004
+1204,1004
+1181,1004
+1151,1004
+1114,1004
+1070,1004
+1020,1004
+966,1004
+907,1004
+847,1004
+788,1004
+729,1004
+675,1004
+625,1004
+581,1004
+544,1004
+514,1004
+491,1004
+475,1004
+464,1004
+459,1004
+456,1004
+457,1003
+464,996
+476,984
+488,972
+495,965
+496,964
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#ffffff;
+"/>
+<!-- Line: box -->
+<rect x="378" y="1590" width="704" height="14" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#808080;
+"/>
+<!-- Line -->
+<polygon points="442,1473
+378,1590
+496,1590
+512,1551
+485,1551
+500,1512
+475,1512
+496,1473
+442,1473
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polygon points="1082,1590
+965,1590
+965,1550
+990,1551
+986,1512
+1004,1512
+1010,1512
+1002,1473
+1050,1473
+1082,1590
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polygon points="1317,1590
+1281,1590
+1239,1496
+1089,1496
+1082,1473
+1255,1473
+1317,1590
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#c0c0c0;
+"/>
+<!-- Line: box -->
+<rect x="1121" y="1590" width="196" height="13" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#808080;
+"/>
+<!-- Line -->
+<polygon points="1121,1590
+1121,1604
+1081,1484
+1082,1473
+1121,1590
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#808080;
+"/>
+<!-- Line -->
+<polyline points="3645,1170
+3645,1260
+3738,1260
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#c7c7c7;
+"/>
+<!-- Line -->
+<polyline points="3640,1170
+3735,1170
+3735,1259
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#c7c7c7;
+"/>
+<!-- Line -->
+<polyline points="3645,4320
+3645,4410
+3738,4410
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#c7c7c7;
+"/>
+<!-- Line -->
+<polyline points="3640,4320
+3735,4320
+3735,4409
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#c7c7c7;
+"/>
+<!-- Line -->
+<polyline points="3649,1185
+3730,1186
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:round; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line -->
+<polyline points="3649,1222
+3730,1222
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:round; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line -->
+<polyline points="3649,4335
+3730,4336
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:round; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line -->
+<polyline points="3649,4372
+3730,4372
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:round; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line -->
+<polyline points="4950,4275
+5100,4275
+5100,3300
+5910,3300
+" style="stroke:#0000b0;stroke-width:15;
+stroke-linejoin:miter; stroke-linecap:butt;
+stroke-dasharray:60 60;"/>
+<!-- Arrowhead on XXXpoint 5100 3300 - 6180 3300-->
+<polygon points="5908 3360
+6148 3300
+5908 3240
+5908 3360
+
+" style="stroke:#0000b0;stroke-width:15;stroke-miterlimit:8;
+fill:#0000b0;"/>
+<!-- Line -->
+<polyline points="4950,1125
+5400,1125
+5400,5100
+5910,5100
+" style="stroke:#0000b0;stroke-width:15;
+stroke-linejoin:miter; stroke-linecap:butt;
+stroke-dasharray:60 60;"/>
+<!-- Arrowhead on XXXpoint 5400 5100 - 6180 5100-->
+<polygon points="5908 5160
+6148 5100
+5908 5040
+5908 5160
+
+" style="stroke:#0000b0;stroke-width:15;stroke-miterlimit:8;
+fill:#0000b0;"/>
+<!-- Text -->
+<text xml:space="preserve" x="2175" y="5475" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">User Two</text>
+<!-- Text -->
+<text xml:space="preserve" x="2025" y="2325" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">User One</text>
+<!-- Line: box -->
+<rect x="3645" y="1193" width="81" height="21" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line: box -->
+<rect x="3645" y="4343" width="81" height="21" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#000000;
+"/>
+</g>
+</svg>
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/dual_nas_backup_server_failover.svg freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/dual_nas_backup_server_failover.svg
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/dual_nas_backup_server_failover.svg	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/dual_nas_backup_server_failover.svg	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,3004 @@
+<?xml version="1.0" standalone="no"?>
+<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
+"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
+<!-- Creator: fig2dev Version 3.2 Patchlevel 5e -->
+<!-- CreationDate: Mon Aug 11 20:51:55 2014 -->
+<!-- Magnification: 1.000 -->
+<svg	xmlns="http://www.w3.org/2000/svg"
+	xmlns:xlink="http://www.w3.org/1999/xlink"
+	width="6.3in" height="4.8in"
+	viewBox="288 288 7536 5799">
+<g style="stroke-width:.025in; fill:none">
+<!-- Line -->
+<polygon points="1784,4365
+1515,4558
+1515,4711
+2283,4788
+2283,4634
+2437,4404
+1784,4365
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:round; stroke-linecap:butt;
+fill:#aaaaaa;
+"/>
+<!-- Line -->
+<polygon points="1784,1215
+1515,1408
+1515,1561
+2283,1638
+2283,1484
+2437,1254
+1784,1215
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:round; stroke-linecap:butt;
+fill:#aaaaaa;
+"/>
+<!-- Line: box -->
+<rect x="1899" y="4634" width="231" height="62" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line: box -->
+<rect x="1554" y="4638" width="38" height="23" rx="0" 
+style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line: box -->
+<rect x="1899" y="1484" width="231" height="62" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line: box -->
+<rect x="1554" y="1488" width="38" height="23" rx="0" 
+style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line -->
+<polygon points="2283,4634
+2283,4788
+2437,4519
+2437,4404
+2283,4634
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:round; stroke-linecap:butt;
+fill:#555555;
+"/>
+<!-- Line -->
+<polyline points="2283,4749
+1515,4673
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2245,4746
+2245,4669
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1784,4700
+1784,4623
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2245,4707
+1784,4661
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="1535" y="4598" width="77" height="46" rx="0" 
+style="stroke:#ff0000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#ff0000;
+"/>
+<!-- Line: box -->
+<rect x="2168" y="4661" width="58" height="25" rx="0" 
+style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#555555;
+"/>
+<!-- Line -->
+<polyline points="2206,4742
+2206,4703
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2168,4738
+2168,4700
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polygon points="2283,1484
+2283,1638
+2437,1369
+2437,1254
+2283,1484
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:round; stroke-linecap:butt;
+fill:#555555;
+"/>
+<!-- Line -->
+<polyline points="2283,1599
+1515,1523
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2245,1596
+2245,1519
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1784,1550
+1784,1473
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2245,1557
+1784,1511
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="1535" y="1448" width="77" height="46" rx="0" 
+style="stroke:#ff0000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#ff0000;
+"/>
+<!-- Line: box -->
+<rect x="2168" y="1511" width="58" height="25" rx="0" 
+style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#555555;
+"/>
+<!-- Line -->
+<polyline points="2206,1592
+2206,1553
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2168,1588
+2168,1550
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1515,4558
+2283,4634
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1544,4560
+1808,4367
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1572,4563
+1833,4368
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1601,4566
+1857,4370
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1629,4569
+1881,4371
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1658,4572
+1905,4372
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1686,4575
+1929,4374
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1715,4577
+1953,4376
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1743,4580
+1977,4377
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1771,4583
+2002,4378
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1800,4586
+2026,4380
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1828,4589
+2050,4381
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1857,4592
+2074,4382
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1885,4594
+2098,4384
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1914,4597
+2122,4385
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1942,4600
+2147,4387
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1970,4603
+2171,4388
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1999,4606
+2195,4389
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2027,4609
+2219,4391
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2056,4611
+2243,4393
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2084,4614
+2267,4394
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2113,4617
+2292,4395
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2141,4620
+2316,4397
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2170,4623
+2340,4398
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2198,4626
+2365,4400
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2226,4628
+2388,4401
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2255,4632
+2412,4402
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1546,4676
+1546,4714
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1577,4679
+1577,4717
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1608,4681
+1608,4720
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1639,4685
+1639,4723
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1669,4688
+1669,4727
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1700,4691
+1700,4729
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1731,4694
+1731,4732
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1761,4697
+1761,4736
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1792,4700
+1792,4738
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1823,4703
+1823,4742
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1853,4706
+1853,4745
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1884,4710
+1884,4748
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1915,4712
+1915,4751
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1946,4715
+1946,4754
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1976,4719
+1976,4757
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2007,4722
+2007,4760
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2038,4725
+2038,4763
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2068,4728
+2068,4766
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2099,4731
+2099,4769
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2130,4734
+2130,4772
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2161,4737
+2161,4775
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2191,4740
+2191,4779
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2222,4743
+2222,4781
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2253,4746
+2253,4784
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2283,4673
+1515,4596
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1515,1408
+2283,1484
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1544,1410
+1808,1217
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1572,1413
+1833,1218
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1601,1416
+1857,1220
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1629,1419
+1881,1221
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1658,1422
+1905,1222
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1686,1425
+1929,1224
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1715,1427
+1953,1226
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1743,1430
+1977,1227
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1771,1433
+2002,1228
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1800,1436
+2026,1230
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1828,1439
+2050,1231
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1857,1442
+2074,1232
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1885,1444
+2098,1234
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1914,1447
+2122,1235
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1942,1450
+2147,1237
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1970,1453
+2171,1238
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1999,1456
+2195,1239
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2027,1459
+2219,1241
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2056,1461
+2243,1243
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2084,1464
+2267,1244
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2113,1467
+2292,1245
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2141,1470
+2316,1247
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2170,1473
+2340,1248
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2198,1476
+2365,1250
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2226,1478
+2388,1251
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2255,1482
+2412,1252
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1546,1526
+1546,1564
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1577,1529
+1577,1567
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1608,1531
+1608,1570
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1639,1535
+1639,1573
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1669,1538
+1669,1577
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1700,1541
+1700,1579
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1731,1544
+1731,1582
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1761,1547
+1761,1586
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1792,1550
+1792,1588
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1823,1553
+1823,1592
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1853,1556
+1853,1595
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1884,1560
+1884,1598
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1915,1562
+1915,1601
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1946,1565
+1946,1604
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1976,1569
+1976,1607
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2007,1572
+2007,1610
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2038,1575
+2038,1613
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2068,1578
+2068,1616
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2099,1581
+2099,1619
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2130,1584
+2130,1622
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2161,1587
+2161,1625
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2191,1590
+2191,1629
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2222,1593
+2222,1631
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2253,1596
+2253,1634
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2283,1523
+1515,1446
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="3600" y="900" width="1215" height="900" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#e7e7e7;
+"/>
+<!-- Line: box -->
+<rect x="3600" y="4050" width="1215" height="900" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#e7e7e7;
+"/>
+<!-- Line -->
+<polyline points="1200,4425
+1800,4425
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1200,1275
+1800,1275
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4800,1350
+5250,1350
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4800,4500
+5250,4500
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polygon points="6525,375
+6560,368
+6590,361
+6611,353
+6623,347
+6630,341
+6631,335
+6631,330
+6631,325
+6633,319
+6640,314
+6654,309
+6677,305
+6710,301
+6750,300
+6784,301
+6816,303
+6844,306
+6868,310
+6887,314
+6902,318
+6914,323
+6923,327
+6931,331
+6940,336
+6949,340
+6961,345
+6977,350
+6997,355
+7022,360
+7053,365
+7088,370
+7125,375
+7166,379
+7202,381
+7231,381
+7253,380
+7269,377
+7280,373
+7288,368
+7294,363
+7299,357
+7306,353
+7316,350
+7329,349
+7347,350
+7370,355
+7396,363
+7425,375
+7451,390
+7473,406
+7489,421
+7500,434
+7506,445
+7508,454
+7508,462
+7506,469
+7505,476
+7504,485
+7506,495
+7511,509
+7520,526
+7534,547
+7553,572
+7575,600
+7599,628
+7621,652
+7641,671
+7659,686
+7673,695
+7686,701
+7696,704
+7706,706
+7716,708
+7726,712
+7737,718
+7748,729
+7762,744
+7775,766
+7789,793
+7800,825
+7807,854
+7810,882
+7812,906
+7812,926
+7812,942
+7811,955
+7810,966
+7808,974
+7806,981
+7804,989
+7801,997
+7797,1006
+7791,1019
+7783,1034
+7773,1053
+7760,1075
+7744,1100
+7725,1125
+7703,1149
+7682,1169
+7661,1185
+7644,1197
+7630,1205
+7618,1210
+7609,1212
+7601,1213
+7594,1212
+7586,1212
+7578,1212
+7567,1214
+7554,1217
+7536,1223
+7514,1232
+7488,1244
+7458,1259
+7425,1275
+7392,1291
+7362,1307
+7337,1320
+7317,1331
+7302,1340
+7291,1347
+7284,1353
+7279,1358
+7275,1363
+7271,1367
+7266,1371
+7259,1376
+7248,1382
+7233,1389
+7213,1397
+7188,1406
+7158,1416
+7125,1425
+7088,1433
+7056,1439
+7029,1443
+7009,1445
+6995,1446
+6986,1446
+6979,1445
+6975,1444
+6971,1442
+6964,1441
+6955,1439
+6941,1437
+6921,1435
+6894,1432
+6862,1429
+6825,1425
+6788,1420
+6756,1414
+6730,1409
+6710,1404
+6697,1399
+6689,1395
+6684,1391
+6681,1388
+6678,1384
+6673,1380
+6664,1376
+6650,1371
+6630,1366
+6601,1361
+6566,1355
+6525,1350
+6488,1346
+6453,1344
+6422,1343
+6397,1344
+6377,1346
+6361,1349
+6349,1353
+6340,1358
+6331,1363
+6323,1367
+6314,1371
+6302,1374
+6287,1376
+6268,1376
+6244,1374
+6216,1369
+6184,1361
+6150,1350
+6118,1336
+6090,1322
+6066,1308
+6047,1296
+6032,1285
+6020,1276
+6012,1268
+6005,1261
+6000,1255
+5995,1248
+5989,1241
+5983,1232
+5976,1221
+5967,1207
+5957,1190
+5946,1171
+5935,1149
+5925,1125
+5918,1095
+5916,1070
+5918,1051
+5924,1039
+5932,1032
+5942,1029
+5952,1028
+5962,1026
+5973,1023
+5982,1015
+5991,1002
+5998,981
+6002,952
+6004,918
+6003,886
+6000,856
+5996,831
+5990,809
+5983,792
+5976,779
+5968,768
+5961,759
+5953,749
+5946,738
+5940,726
+5934,710
+5929,691
+5927,669
+5926,644
+5929,618
+5936,593
+5945,573
+5954,561
+5962,555
+5970,553
+5976,554
+5983,558
+5990,561
+5998,563
+6007,563
+6020,560
+6035,552
+6054,540
+6075,525
+6096,509
+6113,494
+6126,482
+6134,472
+6138,464
+6140,458
+6139,453
+6140,448
+6142,442
+6147,435
+6158,426
+6175,416
+6199,404
+6229,393
+6258,385
+6285,379
+6308,375
+6327,373
+6342,373
+6354,374
+6363,377
+6371,379
+6379,382
+6389,384
+6401,386
+6417,387
+6437,386
+6463,384
+6493,380
+6525,375
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="750,5100
+3510,5100
+" style="stroke:#0000d1;stroke-width:15;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 750 5100 - 3780 5100-->
+<polygon points="3508 5160
+3748 5100
+3508 5040
+3508 5160
+
+" style="stroke:#0000d1;stroke-width:15;stroke-miterlimit:8;
+fill:#0000d1;"/>
+<!-- Line -->
+<polyline points="750,1950
+3510,1950
+" style="stroke:#0000d1;stroke-width:15;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 750 1950 - 3780 1950-->
+<polygon points="3508 2010
+3748 1950
+3508 1890
+3508 2010
+
+" style="stroke:#0000d1;stroke-width:15;stroke-miterlimit:8;
+fill:#0000d1;"/>
+<!-- Line -->
+<polyline points="2250,1500
+2850,1500
+2925,1275
+3075,1725
+3150,1500
+3600,1500
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2250,4650
+2850,4650
+2925,4425
+3075,4875
+3150,4650
+3600,4650
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="5250,900
+6000,900
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="5250,5325
+6300,5325
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="5250,3000
+6300,3000
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="5250,450
+5250,6075
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4200,5100
+5100,5100
+5100,5550
+5985,5550
+" style="stroke:#0000d1;stroke-width:15;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 5100 5550 - 6255 5550-->
+<polygon points="5983 5610
+6223 5550
+5983 5490
+5983 5610
+
+" style="stroke:#0000d1;stroke-width:15;stroke-miterlimit:8;
+fill:#0000d1;"/>
+<!-- Text -->
+<text xml:space="preserve" x="3825" y="750" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">NAS</text>
+<!-- Text -->
+<text xml:space="preserve" x="3825" y="3900" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">NAS</text>
+<!-- Text -->
+<text xml:space="preserve" x="6225" y="975" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">Internet</text>
+<!-- Text -->
+<text xml:space="preserve" x="6300" y="1950" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">One</text>
+<!-- Text -->
+<text xml:space="preserve" x="6300" y="4275" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">Two</text>
+<!-- Line: box -->
+<rect x="652" y="4232" width="391" height="39" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#808080;
+"/>
+<!-- Line: box -->
+<rect x="613" y="4271" width="469" height="39" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#808080;
+"/>
+<!-- Line: box -->
+<rect x="378" y="3450" width="939" height="782" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#e0e0e0;
+"/>
+<!-- Line -->
+<polygon points="417,4583
+1278,4583
+1395,4779
+1395,4818
+300,4818
+300,4779
+417,4583
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="398" y="4524" width="117" height="20" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="1180" y="4524" width="117" height="20" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="398" y="4310" width="899" height="216" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="652" y="1082" width="391" height="39" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#808080;
+"/>
+<!-- Line: box -->
+<rect x="613" y="1121" width="469" height="39" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#808080;
+"/>
+<!-- Line: box -->
+<rect x="378" y="300" width="939" height="782" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#e0e0e0;
+"/>
+<!-- Line -->
+<polygon points="417,1433
+1278,1433
+1395,1629
+1395,1668
+300,1668
+300,1629
+417,1433
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="398" y="1374" width="117" height="20" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="1180" y="1374" width="117" height="20" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="398" y="1160" width="899" height="216" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#e0e0e0;
+"/>
+<!-- Line -->
+<polyline points="3600,999
+4810,999
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3600,990
+4810,990
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3600,1007
+4810,1007
+" style="stroke:#c7c7c7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3600,1652
+4810,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3600,1642
+4810,1642
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3600,1659
+4810,1659
+" style="stroke:#c7c7c7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3901,995
+3901,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3910,995
+3910,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3893,995
+3893,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3831,995
+3831,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3840,995
+3840,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3823,995
+3823,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4129,995
+4129,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4139,995
+4139,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4122,995
+4122,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4060,995
+4060,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4069,995
+4069,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4052,995
+4052,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4351,995
+4351,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4361,995
+4361,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4343,995
+4343,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4281,995
+4281,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4290,995
+4290,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4274,995
+4274,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4576,995
+4576,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4585,995
+4585,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4569,995
+4569,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4506,995
+4506,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4515,995
+4515,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4498,995
+4498,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4781,995
+4781,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4789,995
+4789,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4773,995
+4773,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4711,995
+4711,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4720,995
+4720,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4702,995
+4702,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4131,995
+4131,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3600,4149
+4810,4149
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3600,4140
+4810,4140
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3600,4157
+4810,4157
+" style="stroke:#c7c7c7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3600,4802
+4810,4802
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3600,4792
+4810,4792
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3600,4809
+4810,4809
+" style="stroke:#c7c7c7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3901,4145
+3901,4802
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3910,4145
+3910,4802
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3893,4145
+3893,4802
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3831,4145
+3831,4802
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3840,4145
+3840,4802
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3823,4145
+3823,4802
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4129,4145
+4129,4802
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4139,4145
+4139,4802
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4122,4145
+4122,4802
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4060,4145
+4060,4802
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4069,4145
+4069,4802
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4052,4145
+4052,4802
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4351,4145
+4351,4802
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4361,4145
+4361,4802
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4343,4145
+4343,4802
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4281,4145
+4281,4802
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4290,4145
+4290,4802
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4274,4145
+4274,4802
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4576,4145
+4576,4802
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4585,4145
+4585,4802
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4569,4145
+4569,4802
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4506,4145
+4506,4802
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4515,4145
+4515,4802
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4498,4145
+4498,4802
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4781,4145
+4781,4802
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4789,4145
+4789,4802
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4773,4145
+4773,4802
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4711,4145
+4711,4802
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4720,4145
+4720,4802
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4702,4145
+4702,4802
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4131,4145
+4131,4802
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="6300" y="2100" width="900" height="1569" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Line: box -->
+<rect x="6300" y="4425" width="900" height="1569" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polyline points="300,4779
+300,4818
+1395,4818
+1395,4779
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polygon points="456,4623
+378,4740
+1082,4740
+1043,4623
+456,4623
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#ffffff;
+"/>
+<!-- Line -->
+<polygon points="1239,4623
+1082,4623
+1121,4740
+1317,4740
+1239,4623
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#ffffff;
+"/>
+<!-- Line -->
+<polyline points="976,4390
+976,4370
+1061,4370
+1061,4351
+1166,4351
+" style="stroke:#808080;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1061,4429
+1061,4390
+1166,4390
+" style="stroke:#808080;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1166,4370
+1250,4370
+" style="stroke:#808080;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1166,4351
+1166,4370
+" style="stroke:#ffffff;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="976,4390
+1061,4390
+" style="stroke:#ffffff;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1061,4429
+1166,4429
+1166,4390
+1250,4390
+1250,4370
+" style="stroke:#ffffff;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1187,4429
+1229,4429
+1229,4409
+" style="stroke:#808080;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1187,4429
+1187,4409
+1229,4409
+" style="stroke:#ffffff;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="300,1629
+300,1668
+1395,1668
+1395,1629
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polygon points="456,1473
+378,1590
+1082,1590
+1043,1473
+456,1473
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#ffffff;
+"/>
+<!-- Line -->
+<polygon points="1239,1473
+1082,1473
+1121,1590
+1317,1590
+1239,1473
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#ffffff;
+"/>
+<!-- Line -->
+<polyline points="976,1240
+976,1220
+1061,1220
+1061,1201
+1166,1201
+" style="stroke:#808080;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1061,1279
+1061,1240
+1166,1240
+" style="stroke:#808080;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1166,1220
+1250,1220
+" style="stroke:#808080;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1166,1201
+1166,1220
+" style="stroke:#ffffff;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="976,1240
+1061,1240
+" style="stroke:#ffffff;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1061,1279
+1166,1279
+1166,1240
+1250,1240
+1250,1220
+" style="stroke:#ffffff;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1187,1279
+1229,1279
+1229,1259
+" style="stroke:#808080;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1187,1279
+1187,1259
+1229,1259
+" style="stroke:#ffffff;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="2701" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="2668" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="2801" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="2768" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="2901" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="2868" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="3001" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="2968" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="3101" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="3068" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="3203" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="3168" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="3301" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="3269" width="700" height="32" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="3402" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="3369" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="2468" width="700" height="32" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="2433" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="2367" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="2333" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="2267" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="2233" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6300" y="3536" width="900" height="133" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line -->
+<polyline points="6300,2566
+7200,2566
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5026" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="4993" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5126" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5093" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5226" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5193" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5326" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5293" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5426" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5393" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5528" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5493" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5626" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5594" width="700" height="32" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5727" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5694" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="4793" width="700" height="32" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="4758" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="4692" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="4658" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="4592" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="4558" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6300" y="5861" width="900" height="133" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line -->
+<polyline points="6300,4891
+7200,4891
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polygon points="456,4154
+457,4153
+464,4146
+476,4134
+488,4122
+495,4115
+496,4114
+496,4111
+496,4105
+496,4093
+496,4075
+496,4050
+496,4019
+496,3981
+496,3937
+496,3890
+496,3840
+496,3791
+496,3744
+496,3700
+496,3662
+496,3631
+496,3606
+496,3588
+496,3576
+496,3570
+496,3567
+495,3566
+488,3559
+476,3547
+464,3536
+457,3529
+456,3528
+456,3531
+456,3536
+456,3547
+456,3563
+456,3586
+456,3615
+456,3651
+456,3693
+456,3739
+456,3789
+456,3841
+456,3893
+456,3943
+456,3989
+456,4031
+456,4067
+456,4096
+456,4119
+456,4135
+456,4146
+456,4151
+456,4154
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polygon points="1239,4154
+1238,4153
+1231,4146
+1219,4134
+1207,4122
+1200,4115
+1199,4114
+1199,4111
+1199,4105
+1199,4093
+1199,4075
+1199,4050
+1199,4019
+1199,3981
+1199,3937
+1199,3890
+1199,3840
+1199,3791
+1199,3744
+1199,3700
+1199,3662
+1199,3631
+1199,3606
+1199,3588
+1199,3576
+1199,3570
+1199,3567
+1200,3566
+1207,3559
+1219,3547
+1231,3536
+1238,3529
+1239,3528
+1239,3531
+1239,3536
+1239,3547
+1239,3563
+1239,3586
+1239,3615
+1239,3651
+1239,3693
+1239,3739
+1239,3789
+1239,3841
+1239,3893
+1239,3943
+1239,3989
+1239,4031
+1239,4067
+1239,4096
+1239,4119
+1239,4135
+1239,4146
+1239,4151
+1239,4154
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polygon points="496,3567
+498,3567
+502,3567
+508,3566
+518,3565
+532,3564
+548,3563
+567,3562
+587,3560
+609,3559
+633,3558
+658,3556
+685,3555
+714,3554
+745,3553
+779,3553
+816,3552
+855,3552
+894,3552
+930,3553
+963,3553
+994,3554
+1022,3555
+1047,3556
+1071,3558
+1094,3559
+1114,3560
+1134,3562
+1151,3563
+1166,3564
+1178,3565
+1188,3566
+1194,3567
+1197,3567
+1199,3567
+1200,3566
+1207,3559
+1219,3547
+1231,3536
+1238,3529
+1239,3528
+1236,3528
+1231,3528
+1220,3528
+1204,3528
+1181,3528
+1151,3528
+1114,3528
+1070,3528
+1020,3528
+966,3528
+907,3528
+847,3528
+788,3528
+729,3528
+675,3528
+625,3528
+581,3528
+544,3528
+514,3528
+491,3528
+475,3528
+464,3528
+459,3528
+456,3528
+457,3529
+464,3536
+476,3548
+488,3559
+495,3566
+496,3567
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#808080;
+"/>
+<!-- Line -->
+<polygon points="496,4114
+498,4114
+502,4114
+508,4115
+518,4116
+532,4117
+548,4118
+567,4120
+587,4121
+609,4122
+633,4124
+658,4125
+685,4126
+714,4128
+745,4129
+779,4129
+816,4130
+855,4130
+894,4130
+930,4129
+963,4129
+994,4128
+1022,4126
+1047,4125
+1071,4124
+1094,4122
+1114,4121
+1134,4120
+1151,4118
+1166,4117
+1178,4116
+1188,4115
+1194,4114
+1197,4114
+1199,4114
+1200,4115
+1207,4122
+1219,4134
+1231,4146
+1238,4153
+1239,4154
+1236,4154
+1231,4154
+1220,4154
+1204,4154
+1181,4154
+1151,4154
+1114,4154
+1070,4154
+1020,4154
+966,4154
+907,4154
+847,4154
+788,4154
+729,4154
+675,4154
+625,4154
+581,4154
+544,4154
+514,4154
+491,4154
+475,4154
+464,4154
+459,4154
+456,4154
+457,4153
+464,4146
+476,4134
+488,4122
+495,4115
+496,4114
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#ffffff;
+"/>
+<!-- Line: box -->
+<rect x="378" y="4740" width="704" height="14" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#808080;
+"/>
+<!-- Line -->
+<polygon points="442,4623
+378,4740
+496,4740
+512,4701
+485,4701
+500,4662
+475,4662
+496,4623
+442,4623
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polygon points="1082,4740
+965,4740
+965,4700
+990,4701
+986,4662
+1004,4662
+1010,4662
+1002,4623
+1050,4623
+1082,4740
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polygon points="1317,4740
+1281,4740
+1239,4646
+1089,4646
+1082,4623
+1255,4623
+1317,4740
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#c0c0c0;
+"/>
+<!-- Line: box -->
+<rect x="1121" y="4740" width="196" height="13" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#808080;
+"/>
+<!-- Line -->
+<polygon points="1121,4740
+1121,4754
+1081,4634
+1082,4623
+1121,4740
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#808080;
+"/>
+<!-- Line -->
+<polygon points="456,1004
+457,1003
+464,996
+476,984
+488,972
+495,965
+496,964
+496,961
+496,955
+496,943
+496,925
+496,900
+496,869
+496,831
+496,787
+496,740
+496,690
+496,641
+496,594
+496,550
+496,512
+496,481
+496,456
+496,438
+496,426
+496,420
+496,417
+495,416
+488,409
+476,397
+464,386
+457,379
+456,378
+456,381
+456,386
+456,397
+456,413
+456,436
+456,465
+456,501
+456,543
+456,589
+456,639
+456,691
+456,743
+456,793
+456,839
+456,881
+456,917
+456,946
+456,969
+456,985
+456,996
+456,1001
+456,1004
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polygon points="1239,1004
+1238,1003
+1231,996
+1219,984
+1207,972
+1200,965
+1199,964
+1199,961
+1199,955
+1199,943
+1199,925
+1199,900
+1199,869
+1199,831
+1199,787
+1199,740
+1199,690
+1199,641
+1199,594
+1199,550
+1199,512
+1199,481
+1199,456
+1199,438
+1199,426
+1199,420
+1199,417
+1200,416
+1207,409
+1219,397
+1231,386
+1238,379
+1239,378
+1239,381
+1239,386
+1239,397
+1239,413
+1239,436
+1239,465
+1239,501
+1239,543
+1239,589
+1239,639
+1239,691
+1239,743
+1239,793
+1239,839
+1239,881
+1239,917
+1239,946
+1239,969
+1239,985
+1239,996
+1239,1001
+1239,1004
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polygon points="496,417
+498,417
+502,417
+508,416
+518,415
+532,414
+548,413
+567,412
+587,410
+609,409
+633,408
+658,406
+685,405
+714,404
+745,403
+779,403
+816,402
+855,402
+894,402
+930,403
+963,403
+994,404
+1022,405
+1047,406
+1071,408
+1094,409
+1114,410
+1134,412
+1151,413
+1166,414
+1178,415
+1188,416
+1194,417
+1197,417
+1199,417
+1200,416
+1207,409
+1219,397
+1231,386
+1238,379
+1239,378
+1236,378
+1231,378
+1220,378
+1204,378
+1181,378
+1151,378
+1114,378
+1070,378
+1020,378
+966,378
+907,378
+847,378
+788,378
+729,378
+675,378
+625,378
+581,378
+544,378
+514,378
+491,378
+475,378
+464,378
+459,378
+456,378
+457,379
+464,386
+476,398
+488,409
+495,416
+496,417
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#808080;
+"/>
+<!-- Line -->
+<polygon points="496,964
+498,964
+502,964
+508,965
+518,966
+532,967
+548,968
+567,970
+587,971
+609,972
+633,974
+658,975
+685,976
+714,978
+745,979
+779,979
+816,980
+855,980
+894,980
+930,979
+963,979
+994,978
+1022,976
+1047,975
+1071,974
+1094,972
+1114,971
+1134,970
+1151,968
+1166,967
+1178,966
+1188,965
+1194,964
+1197,964
+1199,964
+1200,965
+1207,972
+1219,984
+1231,996
+1238,1003
+1239,1004
+1236,1004
+1231,1004
+1220,1004
+1204,1004
+1181,1004
+1151,1004
+1114,1004
+1070,1004
+1020,1004
+966,1004
+907,1004
+847,1004
+788,1004
+729,1004
+675,1004
+625,1004
+581,1004
+544,1004
+514,1004
+491,1004
+475,1004
+464,1004
+459,1004
+456,1004
+457,1003
+464,996
+476,984
+488,972
+495,965
+496,964
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#ffffff;
+"/>
+<!-- Line: box -->
+<rect x="378" y="1590" width="704" height="14" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#808080;
+"/>
+<!-- Line -->
+<polygon points="442,1473
+378,1590
+496,1590
+512,1551
+485,1551
+500,1512
+475,1512
+496,1473
+442,1473
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polygon points="1082,1590
+965,1590
+965,1550
+990,1551
+986,1512
+1004,1512
+1010,1512
+1002,1473
+1050,1473
+1082,1590
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polygon points="1317,1590
+1281,1590
+1239,1496
+1089,1496
+1082,1473
+1255,1473
+1317,1590
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#c0c0c0;
+"/>
+<!-- Line: box -->
+<rect x="1121" y="1590" width="196" height="13" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#808080;
+"/>
+<!-- Line -->
+<polygon points="1121,1590
+1121,1604
+1081,1484
+1082,1473
+1121,1590
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#808080;
+"/>
+<!-- Line -->
+<polyline points="3645,1170
+3645,1260
+3738,1260
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#c7c7c7;
+"/>
+<!-- Line -->
+<polyline points="3640,1170
+3735,1170
+3735,1259
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#c7c7c7;
+"/>
+<!-- Line -->
+<polyline points="3645,4320
+3645,4410
+3738,4410
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#c7c7c7;
+"/>
+<!-- Line -->
+<polyline points="3640,4320
+3735,4320
+3735,4409
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#c7c7c7;
+"/>
+<!-- Line -->
+<polyline points="3649,1185
+3730,1186
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:round; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line -->
+<polyline points="3649,1222
+3730,1222
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:round; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line -->
+<polyline points="3649,4335
+3730,4336
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:round; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line -->
+<polyline points="3649,4372
+3730,4372
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:round; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line -->
+<polyline points="4950,1125
+5400,1125
+5400,5100
+5910,5100
+" style="stroke:#0000ff;stroke-width:15;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 5400 5100 - 6180 5100-->
+<polygon points="5908 5160
+6148 5100
+5908 5040
+5908 5160
+
+" style="stroke:#0000ff;stroke-width:15;stroke-miterlimit:8;
+fill:#0000ff;"/>
+<!-- Line -->
+<polyline points="6000,1800
+7500,3900
+" style="stroke:#ff0000;stroke-width:30;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="7500,1800
+6000,3900
+" style="stroke:#ff0000;stroke-width:30;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Text -->
+<text xml:space="preserve" x="2025" y="2325" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">User One</text>
+<!-- Text -->
+<text xml:space="preserve" x="2175" y="5475" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">User Two</text>
+<!-- Line: box -->
+<rect x="3645" y="1193" width="81" height="21" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line: box -->
+<rect x="3645" y="4343" width="81" height="21" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#000000;
+"/>
+</g>
+</svg>
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/dual_nas_backup_server_redundancy.svg freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/dual_nas_backup_server_redundancy.svg
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/dual_nas_backup_server_redundancy.svg	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/dual_nas_backup_server_redundancy.svg	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,1508 @@
+<?xml version="1.0" standalone="no"?>
+<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
+"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
+<!-- Creator: fig2dev Version 3.2 Patchlevel 5e -->
+<!-- CreationDate: Mon Aug 11 20:51:55 2014 -->
+<!-- Magnification: 1.000 -->
+<svg	xmlns="http://www.w3.org/2000/svg"
+	xmlns:xlink="http://www.w3.org/1999/xlink"
+	width="5.2in" height="4.8in"
+	viewBox="288 288 6221 5799">
+<g style="stroke-width:.025in; fill:none">
+<!-- Line: box -->
+<rect x="300" y="900" width="1215" height="900" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#e7e7e7;
+"/>
+<!-- Line: box -->
+<rect x="300" y="4050" width="1215" height="900" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#e7e7e7;
+"/>
+<!-- Line -->
+<polyline points="1500,1350
+1950,1350
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1500,4500
+1950,4500
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polygon points="4125,375
+4160,368
+4190,361
+4211,353
+4223,347
+4230,341
+4231,335
+4231,330
+4231,325
+4233,319
+4240,314
+4254,309
+4277,305
+4310,301
+4350,300
+4384,301
+4416,303
+4444,306
+4468,310
+4487,314
+4502,318
+4514,323
+4523,327
+4531,331
+4540,336
+4549,340
+4561,345
+4577,350
+4597,355
+4622,360
+4653,365
+4688,370
+4725,375
+4766,379
+4802,381
+4831,381
+4853,380
+4869,377
+4880,373
+4888,368
+4894,363
+4899,357
+4906,353
+4916,350
+4929,349
+4947,350
+4970,355
+4996,363
+5025,375
+5051,390
+5073,406
+5089,421
+5100,434
+5106,445
+5108,454
+5108,462
+5106,469
+5105,476
+5104,485
+5106,495
+5111,509
+5120,526
+5134,547
+5153,572
+5175,600
+5199,628
+5221,652
+5241,671
+5259,686
+5273,695
+5286,701
+5296,704
+5306,706
+5316,708
+5326,712
+5337,718
+5348,729
+5362,744
+5375,766
+5389,793
+5400,825
+5407,854
+5410,882
+5412,906
+5412,926
+5412,942
+5411,955
+5410,966
+5408,974
+5406,981
+5404,989
+5401,997
+5397,1006
+5391,1019
+5383,1034
+5373,1053
+5360,1075
+5344,1100
+5325,1125
+5303,1149
+5282,1169
+5261,1185
+5244,1197
+5230,1205
+5218,1210
+5209,1212
+5201,1213
+5194,1212
+5186,1212
+5178,1212
+5167,1214
+5154,1217
+5136,1223
+5114,1232
+5088,1244
+5058,1259
+5025,1275
+4992,1291
+4962,1307
+4937,1320
+4917,1331
+4902,1340
+4891,1347
+4884,1353
+4879,1358
+4875,1363
+4871,1367
+4866,1371
+4859,1376
+4848,1382
+4833,1389
+4813,1397
+4788,1406
+4758,1416
+4725,1425
+4688,1433
+4656,1439
+4629,1443
+4609,1445
+4595,1446
+4586,1446
+4579,1445
+4575,1444
+4571,1442
+4564,1441
+4555,1439
+4541,1437
+4521,1435
+4494,1432
+4462,1429
+4425,1425
+4388,1420
+4356,1414
+4330,1409
+4310,1404
+4297,1399
+4289,1395
+4284,1391
+4281,1388
+4278,1384
+4273,1380
+4264,1376
+4250,1371
+4230,1366
+4201,1361
+4166,1355
+4125,1350
+4088,1346
+4053,1344
+4022,1343
+3997,1344
+3977,1346
+3961,1349
+3949,1353
+3940,1358
+3931,1363
+3923,1367
+3914,1371
+3902,1374
+3887,1376
+3868,1376
+3844,1374
+3816,1369
+3784,1361
+3750,1350
+3718,1336
+3690,1322
+3666,1308
+3647,1296
+3632,1285
+3620,1276
+3612,1268
+3605,1261
+3600,1255
+3595,1248
+3589,1241
+3583,1232
+3576,1221
+3567,1207
+3557,1190
+3546,1171
+3535,1149
+3525,1125
+3518,1095
+3516,1070
+3518,1051
+3524,1039
+3532,1032
+3542,1029
+3552,1028
+3562,1026
+3573,1023
+3582,1015
+3591,1002
+3598,981
+3602,952
+3604,918
+3603,886
+3600,856
+3596,831
+3590,809
+3583,792
+3576,779
+3568,768
+3561,759
+3553,749
+3546,738
+3540,726
+3534,710
+3529,691
+3527,669
+3526,644
+3529,618
+3536,593
+3545,573
+3554,561
+3562,555
+3570,553
+3576,554
+3583,558
+3590,561
+3598,563
+3607,563
+3620,560
+3635,552
+3654,540
+3675,525
+3696,509
+3713,494
+3726,482
+3734,472
+3738,464
+3740,458
+3739,453
+3740,448
+3742,442
+3747,435
+3758,426
+3775,416
+3799,404
+3829,393
+3858,385
+3885,379
+3908,375
+3927,373
+3942,373
+3954,374
+3963,377
+3971,379
+3979,382
+3989,384
+4001,386
+4017,387
+4037,386
+4063,384
+4093,380
+4125,375
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1950,900
+3600,900
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1950,5325
+3000,5325
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1950,3000
+3000,3000
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="900,1950
+2325,1950
+2325,2850
+2685,2850
+" style="stroke:#0000d1;stroke-width:15;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 2325 2850 - 2955 2850-->
+<polygon points="2683 2910
+2923 2850
+2683 2790
+2683 2910
+
+" style="stroke:#0000d1;stroke-width:15;stroke-miterlimit:8;
+fill:#0000d1;"/>
+<!-- Line -->
+<polyline points="1950,450
+1950,6075
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="900,5100
+1800,5100
+1800,5550
+2685,5550
+" style="stroke:#0000d1;stroke-width:15;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 1800 5550 - 2955 5550-->
+<polygon points="2683 5610
+2923 5550
+2683 5490
+2683 5610
+
+" style="stroke:#0000d1;stroke-width:15;stroke-miterlimit:8;
+fill:#0000d1;"/>
+<!-- Text -->
+<text xml:space="preserve" x="525" y="750" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">NAS</text>
+<!-- Text -->
+<text xml:space="preserve" x="525" y="3900" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">NAS</text>
+<!-- Text -->
+<text xml:space="preserve" x="3825" y="975" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">Internet</text>
+<!-- Text -->
+<text xml:space="preserve" x="3000" y="1950" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">One</text>
+<!-- Text -->
+<text xml:space="preserve" x="3000" y="4275" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">Two</text>
+<!-- Line -->
+<polyline points="300,999
+1510,999
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="300,990
+1510,990
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="300,1007
+1510,1007
+" style="stroke:#c7c7c7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="300,1652
+1510,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="300,1642
+1510,1642
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="300,1659
+1510,1659
+" style="stroke:#c7c7c7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="601,995
+601,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="610,995
+610,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="593,995
+593,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="531,995
+531,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="540,995
+540,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="523,995
+523,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="829,995
+829,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="839,995
+839,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="822,995
+822,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="760,995
+760,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="769,995
+769,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="752,995
+752,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1051,995
+1051,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1061,995
+1061,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1043,995
+1043,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="981,995
+981,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="990,995
+990,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="974,995
+974,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1276,995
+1276,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1285,995
+1285,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1269,995
+1269,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1206,995
+1206,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1215,995
+1215,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1198,995
+1198,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1481,995
+1481,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1489,995
+1489,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1473,995
+1473,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1411,995
+1411,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1420,995
+1420,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1402,995
+1402,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="831,995
+831,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="300,4149
+1510,4149
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="300,4140
+1510,4140
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="300,4157
+1510,4157
+" style="stroke:#c7c7c7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="300,4802
+1510,4802
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="300,4792
+1510,4792
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="300,4809
+1510,4809
+" style="stroke:#c7c7c7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="601,4145
+601,4802
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="610,4145
+610,4802
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="593,4145
+593,4802
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="531,4145
+531,4802
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="540,4145
+540,4802
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="523,4145
+523,4802
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="829,4145
+829,4802
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="839,4145
+839,4802
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="822,4145
+822,4802
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="760,4145
+760,4802
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="769,4145
+769,4802
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="752,4145
+752,4802
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1051,4145
+1051,4802
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1061,4145
+1061,4802
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1043,4145
+1043,4802
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="981,4145
+981,4802
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="990,4145
+990,4802
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="974,4145
+974,4802
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1276,4145
+1276,4802
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1285,4145
+1285,4802
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1269,4145
+1269,4802
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1206,4145
+1206,4802
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1215,4145
+1215,4802
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1198,4145
+1198,4802
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1481,4145
+1481,4802
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1489,4145
+1489,4802
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1473,4145
+1473,4802
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1411,4145
+1411,4802
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1420,4145
+1420,4802
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1402,4145
+1402,4802
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="831,4145
+831,4802
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="3000" y="2100" width="900" height="1569" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Line: box -->
+<rect x="3000" y="4425" width="900" height="1569" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="2701" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="2668" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="2801" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="2768" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="2901" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="2868" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="3001" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="2968" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="3101" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="3068" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="3203" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="3168" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="3301" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="3269" width="700" height="32" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="3402" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="3369" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="2468" width="700" height="32" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="2433" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="2367" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="2333" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="2267" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="2233" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="3000" y="3536" width="900" height="133" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line -->
+<polyline points="3000,2566
+3900,2566
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="5026" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="4993" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="5126" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="5093" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="5226" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="5193" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="5326" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="5293" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="5426" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="5393" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="5528" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="5493" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="5626" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="5594" width="700" height="32" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="5727" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="5694" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="4793" width="700" height="32" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="4758" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="4692" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="4658" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="4592" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="4558" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="3000" y="5861" width="900" height="133" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line -->
+<polyline points="3000,4891
+3900,4891
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polyline points="345,1170
+345,1260
+438,1260
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#c7c7c7;
+"/>
+<!-- Line -->
+<polyline points="340,1170
+435,1170
+435,1259
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#c7c7c7;
+"/>
+<!-- Line -->
+<polyline points="345,4320
+345,4410
+438,4410
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#c7c7c7;
+"/>
+<!-- Line -->
+<polyline points="340,4320
+435,4320
+435,4409
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#c7c7c7;
+"/>
+<!-- Line -->
+<polyline points="349,1185
+430,1186
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:round; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line -->
+<polyline points="349,1222
+430,1222
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:round; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line -->
+<polyline points="349,4335
+430,4336
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:round; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line -->
+<polyline points="349,4372
+430,4372
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:round; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line -->
+<polyline points="1650,1125
+2100,1125
+2100,5100
+2610,5100
+" style="stroke:#0000b0;stroke-width:15;
+stroke-linejoin:miter; stroke-linecap:butt;
+stroke-dasharray:60 60;"/>
+<!-- Arrowhead on XXXpoint 2100 5100 - 2880 5100-->
+<polygon points="2608 5160
+2848 5100
+2608 5040
+2608 5160
+
+" style="stroke:#0000b0;stroke-width:15;stroke-miterlimit:8;
+fill:#0000b0;"/>
+<!-- Line -->
+<polyline points="1650,4275
+1800,4275
+1800,3300
+2610,3300
+" style="stroke:#0000b0;stroke-width:15;
+stroke-linejoin:miter; stroke-linecap:butt;
+stroke-dasharray:60 60;"/>
+<!-- Arrowhead on XXXpoint 1800 3300 - 2880 3300-->
+<polygon points="2608 3360
+2848 3300
+2608 3240
+2608 3360
+
+" style="stroke:#0000b0;stroke-width:15;stroke-miterlimit:8;
+fill:#0000b0;"/>
+<!-- Line -->
+<polyline points="4125,5550
+4126,5550
+4129,5550
+4133,5550
+4140,5550
+4151,5550
+4165,5551
+4183,5551
+4205,5551
+4232,5551
+4262,5551
+4297,5551
+4336,5550
+4379,5549
+4425,5548
+4475,5547
+4527,5545
+4582,5543
+4640,5540
+4699,5536
+4759,5532
+4821,5527
+4884,5520
+4947,5513
+5010,5505
+5074,5496
+5138,5485
+5202,5473
+5266,5459
+5329,5444
+5392,5427
+5455,5407
+5518,5386
+5580,5362
+5642,5335
+5703,5306
+5764,5273
+5824,5237
+5883,5198
+5940,5156
+5997,5110
+6051,5060
+6102,5006
+6150,4950
+6190,4896
+6227,4840
+6261,4784
+6291,4728
+6318,4673
+6343,4618
+6364,4566
+6383,4515
+6400,4466
+6415,4419
+6427,4375
+6438,4333
+6448,4293
+6456,4256
+6463,4220
+6469,4187
+6473,4155
+6477,4124
+6481,4095
+6483,4067
+6485,4040
+6486,4014
+6487,3988
+6487,3962
+6487,3937
+6486,3911
+6485,3885
+6483,3858
+6481,3830
+6477,3802
+6473,3771
+6469,3740
+6463,3707
+6456,3672
+6448,3635
+6438,3595
+6427,3554
+6415,3511
+6400,3465
+6383,3418
+6364,3369
+6343,3317
+6318,3265
+6291,3212
+6261,3158
+6227,3104
+6190,3051
+6150,3000
+6102,2947
+6051,2898
+5997,2852
+5940,2810
+5883,2771
+5824,2737
+5764,2705
+5703,2677
+5642,2653
+5580,2631
+5518,2611
+5455,2594
+5392,2580
+5329,2567
+5266,2556
+5202,2547
+5138,2540
+5074,2534
+5010,2529
+4947,2526
+4884,2523
+4821,2522
+4759,2521
+4699,2521
+4640,2522
+4582,2523
+4527,2525
+4475,2527
+4425,2529
+4379,2532
+4336,2534
+4297,2537
+4262,2539
+4232,2541
+4205,2543
+4183,2545
+4165,2546
+4151,2548
+4140,2549
+4363,2534
+" style="stroke:#00d100;stroke-width:15;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 4140 2549 - 4095 2551-->
+<polygon points="4364 2479
+4127 2550
+4369 2599
+4364 2479
+
+" style="stroke:#00d100;stroke-width:15;stroke-miterlimit:8;
+fill:#00d100;"/>
+<!-- Line -->
+<polyline points="4125,3000
+4126,3000
+4129,3000
+4133,3000
+4141,3000
+4151,2999
+4165,2999
+4183,2999
+4205,2999
+4230,2998
+4260,2998
+4293,2998
+4330,2998
+4370,2999
+4413,2999
+4459,3000
+4506,3002
+4556,3004
+4607,3006
+4659,3009
+4712,3013
+4766,3018
+4820,3023
+4874,3030
+4929,3037
+4983,3046
+5037,3056
+5091,3068
+5145,3081
+5199,3096
+5252,3112
+5305,3131
+5358,3152
+5411,3176
+5462,3202
+5513,3231
+5563,3263
+5611,3297
+5657,3335
+5700,3375
+5739,3417
+5775,3461
+5807,3504
+5836,3548
+5861,3590
+5883,3631
+5902,3669
+5919,3706
+5934,3741
+5947,3773
+5958,3803
+5967,3832
+5975,3858
+5982,3882
+5988,3905
+5993,3927
+5998,3948
+6001,3968
+6004,3987
+6006,4006
+6008,4025
+6009,4045
+6009,4065
+6009,4086
+6008,4107
+6006,4131
+6003,4155
+5999,4182
+5994,4210
+5987,4241
+5979,4274
+5968,4309
+5955,4347
+5939,4386
+5921,4428
+5899,4471
+5874,4516
+5845,4561
+5812,4606
+5775,4650
+5734,4692
+5689,4732
+5641,4768
+5592,4803
+5540,4834
+5488,4863
+5434,4889
+5380,4912
+5325,4934
+5269,4953
+5213,4970
+5157,4986
+5100,5000
+5043,5013
+4986,5024
+4928,5034
+4871,5043
+4813,5051
+4756,5058
+4699,5065
+4643,5070
+4589,5075
+4536,5080
+4484,5083
+4435,5087
+4389,5089
+4346,5092
+4306,5094
+4270,5095
+4238,5097
+4211,5098
+4187,5098
+4168,5099
+4153,5099
+4142,5100
+4364,5100
+" style="stroke:#00d100;stroke-width:15;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 4142 5100 - 4095 5100-->
+<polygon points="4367 5040
+4127 5100
+4367 5160
+4367 5040
+
+" style="stroke:#00d100;stroke-width:15;stroke-miterlimit:8;
+fill:#00d100;"/>
+<!-- Text -->
+<text xml:space="preserve" x="5025" y="4050" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">Copy</text>
+<!-- Line: box -->
+<rect x="345" y="1193" width="81" height="21" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line: box -->
+<rect x="345" y="4343" width="81" height="21" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#000000;
+"/>
+</g>
+</svg>
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/dual_nas_load_balance.svg freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/dual_nas_load_balance.svg
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/dual_nas_load_balance.svg	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/dual_nas_load_balance.svg	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,2402 @@
+<?xml version="1.0" standalone="no"?>
+<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
+"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
+<!-- Creator: fig2dev Version 3.2 Patchlevel 5e -->
+<!-- CreationDate: Mon Aug 11 20:51:55 2014 -->
+<!-- Magnification: 1.000 -->
+<svg	xmlns="http://www.w3.org/2000/svg"
+	xmlns:xlink="http://www.w3.org/1999/xlink"
+	width="9.9in" height="7.0in"
+	viewBox="288 330 11884 8392">
+<g style="stroke-width:.025in; fill:none">
+<!-- Line -->
+<polyline points="1650,1200
+2250,1200
+2250,2850
+1650,2850
+" style="stroke:#0000d1;stroke-width:15;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2250,2250
+2685,2250
+" style="stroke:#0000d1;stroke-width:15;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 2250 2250 - 2955 2250-->
+<polygon points="2683 2310
+2923 2250
+2683 2190
+2683 2310
+
+" style="stroke:#0000d1;stroke-width:15;stroke-miterlimit:8;
+fill:#0000d1;"/>
+<!-- Line -->
+<polyline points="1650,4500
+2250,4500
+2250,6150
+1650,6150
+" style="stroke:#0000d1;stroke-width:15;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2250,5550
+2685,5550
+" style="stroke:#0000d1;stroke-width:15;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 2250 5550 - 2955 5550-->
+<polygon points="2683 5610
+2923 5550
+2683 5490
+2683 5610
+
+" style="stroke:#0000d1;stroke-width:15;stroke-miterlimit:8;
+fill:#0000d1;"/>
+<!-- Line: box -->
+<rect x="300" y="900" width="1215" height="900" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#e7e7e7;
+"/>
+<!-- Line: box -->
+<rect x="300" y="2550" width="1215" height="900" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#e7e7e7;
+"/>
+<!-- Line: box -->
+<rect x="300" y="4200" width="1215" height="900" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#e7e7e7;
+"/>
+<!-- Line: box -->
+<rect x="300" y="5850" width="1215" height="900" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#e7e7e7;
+"/>
+<!-- Line -->
+<polyline points="1500,1350
+1950,1350
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1500,3000
+1950,3000
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1500,4650
+1950,4650
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1500,6300
+1950,6300
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1950,450
+1950,6300
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4500,900
+6300,900
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1950,2475
+3000,2475
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4500,900
+4500,5775
+3900,5775
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1950,5775
+3000,5775
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Text -->
+<text xml:space="preserve" x="525" y="750" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">NAS</text>
+<!-- Text -->
+<text xml:space="preserve" x="525" y="2400" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">NAS</text>
+<!-- Text -->
+<text xml:space="preserve" x="525" y="4050" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">NAS</text>
+<!-- Text -->
+<text xml:space="preserve" x="525" y="5700" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">NAS</text>
+<!-- Text -->
+<text xml:space="preserve" x="3075" y="1350" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">One</text>
+<!-- Text -->
+<text xml:space="preserve" x="3075" y="4575" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">Two</text>
+<!-- Line -->
+<polyline points="300,999
+1510,999
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="300,990
+1510,990
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="300,1007
+1510,1007
+" style="stroke:#c7c7c7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="300,1652
+1510,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="300,1642
+1510,1642
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="300,1659
+1510,1659
+" style="stroke:#c7c7c7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="601,995
+601,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="610,995
+610,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="593,995
+593,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="531,995
+531,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="540,995
+540,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="523,995
+523,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="829,995
+829,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="839,995
+839,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="822,995
+822,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="760,995
+760,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="769,995
+769,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="752,995
+752,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1051,995
+1051,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1061,995
+1061,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1043,995
+1043,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="981,995
+981,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="990,995
+990,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="974,995
+974,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1276,995
+1276,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1285,995
+1285,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1269,995
+1269,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1206,995
+1206,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1215,995
+1215,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1198,995
+1198,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1481,995
+1481,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1489,995
+1489,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1473,995
+1473,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1411,995
+1411,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1420,995
+1420,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1402,995
+1402,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="831,995
+831,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="300,2649
+1510,2649
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="300,2640
+1510,2640
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="300,2657
+1510,2657
+" style="stroke:#c7c7c7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="300,3302
+1510,3302
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="300,3292
+1510,3292
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="300,3309
+1510,3309
+" style="stroke:#c7c7c7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="601,2645
+601,3302
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="610,2645
+610,3302
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="593,2645
+593,3302
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="531,2645
+531,3302
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="540,2645
+540,3302
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="523,2645
+523,3302
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="829,2645
+829,3302
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="839,2645
+839,3302
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="822,2645
+822,3302
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="760,2645
+760,3302
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="769,2645
+769,3302
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="752,2645
+752,3302
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1051,2645
+1051,3302
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1061,2645
+1061,3302
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1043,2645
+1043,3302
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="981,2645
+981,3302
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="990,2645
+990,3302
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="974,2645
+974,3302
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1276,2645
+1276,3302
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1285,2645
+1285,3302
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1269,2645
+1269,3302
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1206,2645
+1206,3302
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1215,2645
+1215,3302
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1198,2645
+1198,3302
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1481,2645
+1481,3302
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1489,2645
+1489,3302
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1473,2645
+1473,3302
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1411,2645
+1411,3302
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1420,2645
+1420,3302
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1402,2645
+1402,3302
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="831,2645
+831,3302
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="300,4299
+1510,4299
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="300,4290
+1510,4290
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="300,4307
+1510,4307
+" style="stroke:#c7c7c7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="300,4952
+1510,4952
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="300,4942
+1510,4942
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="300,4959
+1510,4959
+" style="stroke:#c7c7c7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="601,4295
+601,4952
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="610,4295
+610,4952
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="593,4295
+593,4952
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="531,4295
+531,4952
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="540,4295
+540,4952
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="523,4295
+523,4952
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="829,4295
+829,4952
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="839,4295
+839,4952
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="822,4295
+822,4952
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="760,4295
+760,4952
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="769,4295
+769,4952
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="752,4295
+752,4952
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1051,4295
+1051,4952
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1061,4295
+1061,4952
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1043,4295
+1043,4952
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="981,4295
+981,4952
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="990,4295
+990,4952
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="974,4295
+974,4952
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1276,4295
+1276,4952
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1285,4295
+1285,4952
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1269,4295
+1269,4952
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1206,4295
+1206,4952
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1215,4295
+1215,4952
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1198,4295
+1198,4952
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1481,4295
+1481,4952
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1489,4295
+1489,4952
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1473,4295
+1473,4952
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1411,4295
+1411,4952
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1420,4295
+1420,4952
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1402,4295
+1402,4952
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="831,4295
+831,4952
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="300,5949
+1510,5949
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="300,5940
+1510,5940
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="300,5957
+1510,5957
+" style="stroke:#c7c7c7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="300,6602
+1510,6602
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="300,6592
+1510,6592
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="300,6609
+1510,6609
+" style="stroke:#c7c7c7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="601,5945
+601,6602
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="610,5945
+610,6602
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="593,5945
+593,6602
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="531,5945
+531,6602
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="540,5945
+540,6602
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="523,5945
+523,6602
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="829,5945
+829,6602
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="839,5945
+839,6602
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="822,5945
+822,6602
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="760,5945
+760,6602
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="769,5945
+769,6602
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="752,5945
+752,6602
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1051,5945
+1051,6602
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1061,5945
+1061,6602
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1043,5945
+1043,6602
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="981,5945
+981,6602
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="990,5945
+990,6602
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="974,5945
+974,6602
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1276,5945
+1276,6602
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1285,5945
+1285,6602
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1269,5945
+1269,6602
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1206,5945
+1206,6602
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1215,5945
+1215,6602
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1198,5945
+1198,6602
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1481,5945
+1481,6602
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1489,5945
+1489,6602
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1473,5945
+1473,6602
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1411,5945
+1411,6602
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1420,5945
+1420,6602
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1402,5945
+1402,6602
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="831,5945
+831,6602
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="3000" y="1500" width="900" height="1569" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Line: box -->
+<rect x="3000" y="4725" width="900" height="1569" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Line: box -->
+<rect x="6900" y="900" width="600" height="1046" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Line: box -->
+<rect x="6900" y="2100" width="600" height="1046" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Line: box -->
+<rect x="6900" y="3300" width="600" height="1046" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Line: box -->
+<rect x="6900" y="4500" width="600" height="1046" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Line: box -->
+<rect x="6900" y="5700" width="600" height="1046" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="2101" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="2068" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="2201" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="2168" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="2301" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="2268" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="2401" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="2368" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="2501" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="2468" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="2603" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="2568" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="2701" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="2669" width="700" height="32" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="2802" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="2769" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="1868" width="700" height="32" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="1833" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="1767" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="1733" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="1667" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="1633" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="3000" y="2936" width="900" height="133" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line -->
+<polyline points="3000,1966
+3900,1966
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="5326" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="5293" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="5426" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="5393" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="5526" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="5493" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="5626" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="5593" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="5726" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="5693" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="5828" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="5793" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="5926" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="5894" width="700" height="32" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="6027" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="5994" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="5093" width="700" height="32" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="5058" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="4992" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="4958" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="4892" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="3100" y="4858" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="3000" y="6161" width="900" height="133" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line -->
+<polyline points="3000,5191
+3900,5191
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="1301" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="1279" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="1367" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="1345" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="1434" width="466" height="23" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="1412" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="1501" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="1479" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="1567" width="466" height="24" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="1545" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="1635" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="1612" width="466" height="23" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="1701" width="466" height="23" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="1679" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="1768" width="466" height="23" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="1746" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="1145" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="1122" width="466" height="23" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="1078" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="1055" width="466" height="23" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="1011" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="989" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6900" y="1857" width="600" height="89" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line -->
+<polyline points="6900,1211
+7500,1211
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="2501" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="2479" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="2567" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="2545" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="2634" width="466" height="23" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="2612" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="2701" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="2679" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="2767" width="466" height="24" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="2745" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="2835" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="2812" width="466" height="23" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="2901" width="466" height="23" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="2879" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="2968" width="466" height="23" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="2946" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="2345" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="2322" width="466" height="23" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="2278" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="2255" width="466" height="23" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="2211" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="2189" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6900" y="3057" width="600" height="89" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line -->
+<polyline points="6900,2411
+7500,2411
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="3701" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="3679" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="3767" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="3745" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="3834" width="466" height="23" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="3812" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="3901" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="3879" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="3967" width="466" height="24" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="3945" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="4035" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="4012" width="466" height="23" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="4101" width="466" height="23" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="4079" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="4168" width="466" height="23" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="4146" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="3545" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="3522" width="466" height="23" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="3478" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="3455" width="466" height="23" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="3411" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="3389" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6900" y="4257" width="600" height="89" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line -->
+<polyline points="6900,3611
+7500,3611
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="4901" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="4879" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="4967" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="4945" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="5034" width="466" height="23" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="5012" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="5101" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="5079" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="5167" width="466" height="24" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="5145" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="5235" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="5212" width="466" height="23" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="5301" width="466" height="23" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="5279" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="5368" width="466" height="23" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="5346" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="4745" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="4722" width="466" height="23" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="4678" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="4655" width="466" height="23" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="4611" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="4589" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6900" y="5457" width="600" height="89" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line -->
+<polyline points="6900,4811
+7500,4811
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="6101" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="6079" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="6167" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="6145" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="6234" width="466" height="23" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="6212" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="6301" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="6279" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="6367" width="466" height="24" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="6345" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="6435" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="6412" width="466" height="23" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="6501" width="466" height="23" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="6479" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="6568" width="466" height="23" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="6546" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="5945" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="5922" width="466" height="23" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="5878" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="5855" width="466" height="23" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="5811" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6967" y="5789" width="466" height="22" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6900" y="6657" width="600" height="89" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line -->
+<polyline points="6900,6011
+7500,6011
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polyline points="345,1170
+345,1260
+438,1260
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#c7c7c7;
+"/>
+<!-- Line -->
+<polyline points="340,1170
+435,1170
+435,1259
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#c7c7c7;
+"/>
+<!-- Line -->
+<polyline points="345,2820
+345,2910
+438,2910
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#c7c7c7;
+"/>
+<!-- Line -->
+<polyline points="340,2820
+435,2820
+435,2909
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#c7c7c7;
+"/>
+<!-- Line -->
+<polyline points="345,4470
+345,4560
+438,4560
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#c7c7c7;
+"/>
+<!-- Line -->
+<polyline points="340,4470
+435,4470
+435,4559
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#c7c7c7;
+"/>
+<!-- Line -->
+<polyline points="345,6120
+345,6210
+438,6210
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#c7c7c7;
+"/>
+<!-- Line -->
+<polyline points="340,6120
+435,6120
+435,6209
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#c7c7c7;
+"/>
+<!-- Line -->
+<polyline points="349,1185
+430,1186
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:round; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line -->
+<polyline points="349,1222
+430,1222
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:round; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line -->
+<polyline points="349,2835
+430,2836
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:round; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line -->
+<polyline points="349,2872
+430,2872
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:round; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line -->
+<polyline points="349,4485
+430,4486
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:round; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line -->
+<polyline points="349,4522
+430,4522
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:round; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line -->
+<polyline points="349,6135
+430,6136
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:round; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line -->
+<polyline points="349,6172
+430,6172
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:round; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line -->
+<polyline points="4950,1125
+5310,1125
+" style="stroke:#0000d1;stroke-width:15;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 4950 1125 - 5580 1125-->
+<polygon points="5308 1185
+5548 1125
+5308 1065
+5308 1185
+
+" style="stroke:#0000d1;stroke-width:15;stroke-miterlimit:8;
+fill:#0000d1;"/>
+<!-- Line -->
+<polyline points="6300,750
+6300,6900
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="12150,8700
+" style="stroke:#000000;stroke-width:15;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4050,2325
+4725,2325
+4725,1125
+6150,1125
+6150,6600
+" style="stroke:#0000d1;stroke-width:45;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4050,5550
+4725,5550
+4725,2325
+" style="stroke:#0000d1;stroke-width:45;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4725,4200
+4725,3539
+" style="stroke:#0000d1;stroke-width:15;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 4725 4200 - 4725 3270-->
+<polygon points="4785 3542
+4725 3302
+4665 3542
+4785 3542
+
+" style="stroke:#0000d1;stroke-width:15;stroke-miterlimit:8;
+fill:#0000d1;"/>
+<!-- Line -->
+<polyline points="3900,2475
+4500,2475
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="6300,1500
+6900,1500
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="6300,2700
+6900,2700
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="6300,5100
+6900,5100
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="6300,6300
+6900,6300
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="6300,3900
+6900,3900
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="6150,3000
+6585,3000
+" style="stroke:#0000d1;stroke-width:15;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 6150 3000 - 6855 3000-->
+<polygon points="6583 3060
+6823 3000
+6583 2940
+6583 3060
+
+" style="stroke:#0000d1;stroke-width:15;stroke-miterlimit:8;
+fill:#0000d1;"/>
+<!-- Line -->
+<polyline points="6150,4125
+6585,4125
+" style="stroke:#0000d1;stroke-width:15;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 6150 4125 - 6855 4125-->
+<polygon points="6583 4185
+6823 4125
+6583 4065
+6583 4185
+
+" style="stroke:#0000d1;stroke-width:15;stroke-miterlimit:8;
+fill:#0000d1;"/>
+<!-- Line -->
+<polyline points="6150,1800
+6585,1800
+" style="stroke:#0000d1;stroke-width:15;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 6150 1800 - 6855 1800-->
+<polygon points="6583 1860
+6823 1800
+6583 1740
+6583 1860
+
+" style="stroke:#0000d1;stroke-width:15;stroke-miterlimit:8;
+fill:#0000d1;"/>
+<!-- Line -->
+<polyline points="6150,6600
+6585,6600
+" style="stroke:#0000d1;stroke-width:15;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 6150 6600 - 6855 6600-->
+<polygon points="6583 6660
+6823 6600
+6583 6540
+6583 6660
+
+" style="stroke:#0000d1;stroke-width:15;stroke-miterlimit:8;
+fill:#0000d1;"/>
+<!-- Line -->
+<polyline points="6150,5400
+6585,5400
+" style="stroke:#0000d1;stroke-width:15;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 6150 5400 - 6855 5400-->
+<polygon points="6583 5460
+6823 5400
+6583 5340
+6583 5460
+
+" style="stroke:#0000d1;stroke-width:15;stroke-miterlimit:8;
+fill:#0000d1;"/>
+<!-- Text -->
+<text xml:space="preserve" x="2850" y="750" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="240" text-anchor="start">Proxies</text>
+<!-- Text -->
+<text xml:space="preserve" x="6000" y="600" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="240" text-anchor="start">Server Pool</text>
+<!-- Line: box -->
+<rect x="345" y="1193" width="81" height="21" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line: box -->
+<rect x="345" y="2843" width="81" height="21" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line: box -->
+<rect x="345" y="4493" width="81" height="21" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line: box -->
+<rect x="345" y="6143" width="81" height="21" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#000000;
+"/>
+</g>
+</svg>
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/eap-md5.svg freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/eap-md5.svg
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/eap-md5.svg	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/eap-md5.svg	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,157 @@
+<?xml version="1.0" standalone="no"?>
+<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
+"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
+<!-- Creator: fig2dev Version 3.2 Patchlevel 5e -->
+<!-- CreationDate: Mon Aug 11 20:51:55 2014 -->
+<!-- Magnification: 1.000 -->
+<svg	xmlns="http://www.w3.org/2000/svg"
+	xmlns:xlink="http://www.w3.org/1999/xlink"
+	width="5.7in" height="4.1in"
+	viewBox="735 224 6841 4883">
+<g style="stroke-width:.025in; fill:none">
+<!-- Line -->
+<polyline points="3075,1200
+4757,1480
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 3075 1200 - 4889 1502-->
+<polygon points="4749 1508
+4873 1499
+4759 1449
+4749 1508
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line -->
+<polyline points="4881,1761
+3198,2041
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 4881 1761 - 3066 2063-->
+<polygon points="3195 2010
+3082 2060
+3205 2069
+3195 2010
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line -->
+<polyline points="4883,2974
+3200,3254
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 4883 2974 - 3068 3276-->
+<polygon points="3197 3223
+3084 3273
+3207 3282
+3197 3223
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line -->
+<polyline points="3073,2412
+4755,2692
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 3073 2412 - 4887 2714-->
+<polygon points="4747 2720
+4871 2711
+4757 2661
+4747 2720
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line -->
+<polyline points="4883,4174
+3200,4454
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 4883 4174 - 3068 4476-->
+<polygon points="3197 4423
+3084 4473
+3207 4482
+3197 4423
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line -->
+<polyline points="3073,3612
+4755,3892
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 3073 3612 - 4887 3914-->
+<polygon points="4747 3920
+4871 3911
+4757 3861
+4747 3920
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line: box -->
+<rect x="3825" y="675" width="150" height="4125" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+stroke-dasharray:40 40;"/>
+<!-- Line -->
+<polyline points="3975,4950
+4155,4950
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 3975 4950 - 4290 4950-->
+<polygon points="4154 4980
+4274 4950
+4154 4920
+4154 4980
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line -->
+<polyline points="3825,4950
+3644,4950
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 3825 4950 - 3510 4950-->
+<polygon points="3646 4920
+3526 4950
+3646 4980
+3646 4920
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line: box -->
+<rect x="7500" y="225" width="75" height="150" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Text -->
+<text xml:space="preserve" x="4950" y="4125" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">EAP-Success</text>
+<!-- Text -->
+<text xml:space="preserve" x="4950" y="2925" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">EAP-MD5 challenge</text>
+<!-- Text -->
+<text xml:space="preserve" x="4950" y="1725" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">EAP-Identity request</text>
+<!-- Text -->
+<text xml:space="preserve" x="825" y="2325" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">EAP-Identity "bob"</text>
+<!-- Text -->
+<text xml:space="preserve" x="1725" y="1275" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">EAP-Start</text>
+<!-- Text -->
+<text xml:space="preserve" x="750" y="3525" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">EAP-MD5 response</text>
+<!-- Text -->
+<text xml:space="preserve" x="2925" y="5025" fill="#000000"  font-family="Times" font-style="italic" font-weight="bold" font-size="192" text-anchor="start">EAP</text>
+<!-- Text -->
+<text xml:space="preserve" x="4350" y="5025" fill="#000000"  font-family="Times" font-style="italic" font-weight="bold" font-size="192" text-anchor="start">RADIUS + EAP-Message</text>
+<!-- Text -->
+<text xml:space="preserve" x="1050" y="600" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="240" text-anchor="start">EAP client</text>
+<!-- Text -->
+<text xml:space="preserve" x="5025" y="600" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="240" text-anchor="start">RADIUS server</text>
+<!-- Text -->
+<text xml:space="preserve" x="3750" y="600" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="240" text-anchor="start">AP</text>
+</g>
+</svg>
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/eap-ttls.svg freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/eap-ttls.svg
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/eap-ttls.svg	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/eap-ttls.svg	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,78 @@
+<?xml version="1.0" standalone="no"?>
+<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
+"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
+<!-- Creator: fig2dev Version 3.2 Patchlevel 5e -->
+<!-- CreationDate: Mon Aug 11 20:51:55 2014 -->
+<!-- Magnification: 1.000 -->
+<svg	xmlns="http://www.w3.org/2000/svg"
+	xmlns:xlink="http://www.w3.org/1999/xlink"
+	width="4.0in" height="3.5in"
+	viewBox="1188 288 4824 4224">
+<g style="stroke-width:.025in; fill:none">
+<!-- Line -->
+<polyline points="1200,900
+6000,900
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1200,2100
+6000,2100
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1200,2700
+6000,2700
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1200,3300
+6000,3300
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3600,3300
+3600,4500
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1200,1500
+6000,1500
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3600,3900
+6000,3900
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="1200" y="300" width="4800" height="4200" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Text -->
+<text xml:space="preserve" x="1800" y="3825" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">PAP, CHAP,</text>
+<!-- Text -->
+<text xml:space="preserve" x="1800" y="4050" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">MS-CHAP, etc.</text>
+<!-- Text -->
+<text xml:space="preserve" x="1575" y="675" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">Carrier Protocol (PPP, EAPOL, RADIUS, Diameter, etc</text>
+<!-- Text -->
+<text xml:space="preserve" x="3300" y="1275" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">EAP</text>
+<!-- Text -->
+<text xml:space="preserve" x="3300" y="2400" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">TLS</text>
+<!-- Text -->
+<text xml:space="preserve" x="3075" y="1875" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">EAP-TTLS</text>
+<!-- Text -->
+<text xml:space="preserve" x="2700" y="3075" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">Diameter-style attributes</text>
+<!-- Text -->
+<text xml:space="preserve" x="4575" y="3675" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">EAP</text>
+<!-- Text -->
+<text xml:space="preserve" x="4350" y="4275" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">EAP-MD5, etc.</text>
+</g>
+</svg>
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/login.svg freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/login.svg
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/login.svg	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/login.svg	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,1656 @@
+<?xml version="1.0" standalone="no"?>
+<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
+"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
+<!-- Creator: fig2dev Version 3.2 Patchlevel 5e -->
+<!-- CreationDate: Mon Aug 11 20:51:55 2014 -->
+<!-- Magnification: 1.000 -->
+<svg	xmlns="http://www.w3.org/2000/svg"
+	xmlns:xlink="http://www.w3.org/1999/xlink"
+	width="6.3in" height="3.0in"
+	viewBox="288 288 7536 3624">
+<g style="stroke-width:.025in; fill:none">
+<!-- Line -->
+<polygon points="1784,1215
+1515,1408
+1515,1561
+2283,1638
+2283,1484
+2437,1254
+1784,1215
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:round; stroke-linecap:butt;
+fill:#aaaaaa;
+"/>
+<!-- Line: box -->
+<rect x="1899" y="1484" width="231" height="62" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line: box -->
+<rect x="1554" y="1488" width="38" height="23" rx="0" 
+style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line -->
+<polygon points="2283,1484
+2283,1638
+2437,1369
+2437,1254
+2283,1484
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:round; stroke-linecap:butt;
+fill:#555555;
+"/>
+<!-- Line -->
+<polyline points="2283,1599
+1515,1523
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2245,1596
+2245,1519
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1784,1550
+1784,1473
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2245,1557
+1784,1511
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="1535" y="1448" width="77" height="46" rx="0" 
+style="stroke:#ff0000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#ff0000;
+"/>
+<!-- Line: box -->
+<rect x="2168" y="1511" width="58" height="25" rx="0" 
+style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#555555;
+"/>
+<!-- Line -->
+<polyline points="2206,1592
+2206,1553
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2168,1588
+2168,1550
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1515,1408
+2283,1484
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1544,1410
+1808,1217
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1572,1413
+1833,1218
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1601,1416
+1857,1220
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1629,1419
+1881,1221
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1658,1422
+1905,1222
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1686,1425
+1929,1224
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1715,1427
+1953,1226
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1743,1430
+1977,1227
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1771,1433
+2002,1228
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1800,1436
+2026,1230
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1828,1439
+2050,1231
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1857,1442
+2074,1232
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1885,1444
+2098,1234
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1914,1447
+2122,1235
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1942,1450
+2147,1237
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1970,1453
+2171,1238
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1999,1456
+2195,1239
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2027,1459
+2219,1241
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2056,1461
+2243,1243
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2084,1464
+2267,1244
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2113,1467
+2292,1245
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2141,1470
+2316,1247
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2170,1473
+2340,1248
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2198,1476
+2365,1250
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2226,1478
+2388,1251
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2255,1482
+2412,1252
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1546,1526
+1546,1564
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1577,1529
+1577,1567
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1608,1531
+1608,1570
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1639,1535
+1639,1573
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1669,1538
+1669,1577
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1700,1541
+1700,1579
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1731,1544
+1731,1582
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1761,1547
+1761,1586
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1792,1550
+1792,1588
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1823,1553
+1823,1592
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1853,1556
+1853,1595
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1884,1560
+1884,1598
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1915,1562
+1915,1601
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1946,1565
+1946,1604
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1976,1569
+1976,1607
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2007,1572
+2007,1610
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2038,1575
+2038,1613
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2068,1578
+2068,1616
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2099,1581
+2099,1619
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2130,1584
+2130,1622
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2161,1587
+2161,1625
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2191,1590
+2191,1629
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2222,1593
+2222,1631
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2253,1596
+2253,1634
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2283,1523
+1515,1446
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="3600" y="900" width="1215" height="900" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#e7e7e7;
+"/>
+<!-- Line -->
+<polyline points="1200,1275
+1800,1275
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polygon points="6525,375
+6560,368
+6590,361
+6611,353
+6623,347
+6630,341
+6631,335
+6631,330
+6631,325
+6633,319
+6640,314
+6654,309
+6677,305
+6710,301
+6750,300
+6784,301
+6816,303
+6844,306
+6868,310
+6887,314
+6902,318
+6914,323
+6923,327
+6931,331
+6940,336
+6949,340
+6961,345
+6977,350
+6997,355
+7022,360
+7053,365
+7088,370
+7125,375
+7166,379
+7202,381
+7231,381
+7253,380
+7269,377
+7280,373
+7288,368
+7294,363
+7299,357
+7306,353
+7316,350
+7329,349
+7347,350
+7370,355
+7396,363
+7425,375
+7451,390
+7473,406
+7489,421
+7500,434
+7506,445
+7508,454
+7508,462
+7506,469
+7505,476
+7504,485
+7506,495
+7511,509
+7520,526
+7534,547
+7553,572
+7575,600
+7599,628
+7621,652
+7641,671
+7659,686
+7673,695
+7686,701
+7696,704
+7706,706
+7716,708
+7726,712
+7737,718
+7748,729
+7762,744
+7775,766
+7789,793
+7800,825
+7807,854
+7810,882
+7812,906
+7812,926
+7812,942
+7811,955
+7810,966
+7808,974
+7806,981
+7804,989
+7801,997
+7797,1006
+7791,1019
+7783,1034
+7773,1053
+7760,1075
+7744,1100
+7725,1125
+7703,1149
+7682,1169
+7661,1185
+7644,1197
+7630,1205
+7618,1210
+7609,1212
+7601,1213
+7594,1212
+7586,1212
+7578,1212
+7567,1214
+7554,1217
+7536,1223
+7514,1232
+7488,1244
+7458,1259
+7425,1275
+7392,1291
+7362,1307
+7337,1320
+7317,1331
+7302,1340
+7291,1347
+7284,1353
+7279,1358
+7275,1363
+7271,1367
+7266,1371
+7259,1376
+7248,1382
+7233,1389
+7213,1397
+7188,1406
+7158,1416
+7125,1425
+7088,1433
+7056,1439
+7029,1443
+7009,1445
+6995,1446
+6986,1446
+6979,1445
+6975,1444
+6971,1442
+6964,1441
+6955,1439
+6941,1437
+6921,1435
+6894,1432
+6862,1429
+6825,1425
+6788,1420
+6756,1414
+6730,1409
+6710,1404
+6697,1399
+6689,1395
+6684,1391
+6681,1388
+6678,1384
+6673,1380
+6664,1376
+6650,1371
+6630,1366
+6601,1361
+6566,1355
+6525,1350
+6488,1346
+6453,1344
+6422,1343
+6397,1344
+6377,1346
+6361,1349
+6349,1353
+6340,1358
+6331,1363
+6323,1367
+6314,1371
+6302,1374
+6287,1376
+6268,1376
+6244,1374
+6216,1369
+6184,1361
+6150,1350
+6118,1336
+6090,1322
+6066,1308
+6047,1296
+6032,1285
+6020,1276
+6012,1268
+6005,1261
+6000,1255
+5995,1248
+5989,1241
+5983,1232
+5976,1221
+5967,1207
+5957,1190
+5946,1171
+5935,1149
+5925,1125
+5918,1095
+5916,1070
+5918,1051
+5924,1039
+5932,1032
+5942,1029
+5952,1028
+5962,1026
+5973,1023
+5982,1015
+5991,1002
+5998,981
+6002,952
+6004,918
+6003,886
+6000,856
+5996,831
+5990,809
+5983,792
+5976,779
+5968,768
+5961,759
+5953,749
+5946,738
+5940,726
+5934,710
+5929,691
+5927,669
+5926,644
+5929,618
+5936,593
+5945,573
+5954,561
+5962,555
+5970,553
+5976,554
+5983,558
+5990,561
+5998,563
+6007,563
+6020,560
+6035,552
+6054,540
+6075,525
+6096,509
+6113,494
+6126,482
+6134,472
+6138,464
+6140,458
+6139,453
+6140,448
+6142,442
+6147,435
+6158,426
+6175,416
+6199,404
+6229,393
+6258,385
+6285,379
+6308,375
+6327,373
+6342,373
+6354,374
+6363,377
+6371,379
+6379,382
+6389,384
+6401,386
+6417,387
+6437,386
+6463,384
+6493,380
+6525,375
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4800,1350
+5250,1350
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="5250,375
+5250,3900
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="5250,3000
+5700,3000
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="5250,900
+6000,900
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4200,1950
+5025,1950
+5025,3300
+5385,3300
+" style="stroke:#0000d1;stroke-width:15;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 5025 3300 - 5655 3300-->
+<polygon points="5383 3360
+5623 3300
+5383 3240
+5383 3360
+
+" style="stroke:#0000d1;stroke-width:15;stroke-miterlimit:8;
+fill:#0000d1;"/>
+<!-- Line -->
+<polyline points="750,1950
+3360,1950
+" style="stroke:#0000d1;stroke-width:15;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 750 1950 - 3630 1950-->
+<polygon points="3358 2010
+3598 1950
+3358 1890
+3358 2010
+
+" style="stroke:#0000d1;stroke-width:15;stroke-miterlimit:8;
+fill:#0000d1;"/>
+<!-- Line -->
+<polyline points="2325,1500
+2775,1500
+2850,1275
+3000,1725
+3075,1500
+3600,1500
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Text -->
+<text xml:space="preserve" x="6225" y="975" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">Internet</text>
+<!-- Text -->
+<text xml:space="preserve" x="3825" y="750" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">NAS</text>
+<!-- Text -->
+<text xml:space="preserve" x="5700" y="1950" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">Server</text>
+<!-- Text -->
+<text xml:space="preserve" x="3525" y="2475" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">RADIUS</text>
+<!-- Text -->
+<text xml:space="preserve" x="2100" y="2475" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">PPP</text>
+<!-- Text -->
+<text xml:space="preserve" x="1650" y="2925" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">Username "bob"</text>
+<!-- Text -->
+<text xml:space="preserve" x="1650" y="3225" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">Password "bob"</text>
+<!-- Line: box -->
+<rect x="652" y="1082" width="391" height="39" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#808080;
+"/>
+<!-- Line: box -->
+<rect x="613" y="1121" width="469" height="39" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#808080;
+"/>
+<!-- Line: box -->
+<rect x="378" y="300" width="939" height="782" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#e0e0e0;
+"/>
+<!-- Line -->
+<polygon points="417,1433
+1278,1433
+1395,1629
+1395,1668
+300,1668
+300,1629
+417,1433
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="398" y="1374" width="117" height="20" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="1180" y="1374" width="117" height="20" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="398" y="1160" width="899" height="216" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#e0e0e0;
+"/>
+<!-- Line -->
+<polyline points="3600,999
+4810,999
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3600,990
+4810,990
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3600,1007
+4810,1007
+" style="stroke:#c7c7c7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3600,1652
+4810,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3600,1642
+4810,1642
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3600,1659
+4810,1659
+" style="stroke:#c7c7c7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3901,995
+3901,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3910,995
+3910,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3893,995
+3893,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3831,995
+3831,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3840,995
+3840,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3823,995
+3823,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4129,995
+4129,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4139,995
+4139,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4122,995
+4122,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4060,995
+4060,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4069,995
+4069,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4052,995
+4052,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4351,995
+4351,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4361,995
+4361,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4343,995
+4343,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4281,995
+4281,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4290,995
+4290,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4274,995
+4274,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4576,995
+4576,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4585,995
+4585,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4569,995
+4569,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4506,995
+4506,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4515,995
+4515,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4498,995
+4498,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4781,995
+4781,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4789,995
+4789,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4773,995
+4773,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4711,995
+4711,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4720,995
+4720,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4702,995
+4702,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4131,995
+4131,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="5700" y="2100" width="900" height="1569" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polyline points="300,1629
+300,1668
+1395,1668
+1395,1629
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polygon points="456,1473
+378,1590
+1082,1590
+1043,1473
+456,1473
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#ffffff;
+"/>
+<!-- Line -->
+<polygon points="1239,1473
+1082,1473
+1121,1590
+1317,1590
+1239,1473
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#ffffff;
+"/>
+<!-- Line -->
+<polyline points="976,1240
+976,1220
+1061,1220
+1061,1201
+1166,1201
+" style="stroke:#808080;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1061,1279
+1061,1240
+1166,1240
+" style="stroke:#808080;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1166,1220
+1250,1220
+" style="stroke:#808080;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1166,1201
+1166,1220
+" style="stroke:#ffffff;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="976,1240
+1061,1240
+" style="stroke:#ffffff;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1061,1279
+1166,1279
+1166,1240
+1250,1240
+1250,1220
+" style="stroke:#ffffff;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1187,1279
+1229,1279
+1229,1259
+" style="stroke:#808080;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1187,1279
+1187,1259
+1229,1259
+" style="stroke:#ffffff;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="2701" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="2668" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="2801" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="2768" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="2901" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="2868" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="3001" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="2968" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="3101" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="3068" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="3203" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="3168" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="3301" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="3269" width="700" height="32" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="3402" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="3369" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="2468" width="700" height="32" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="2433" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="2367" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="2333" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="2267" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="2233" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="5700" y="3536" width="900" height="133" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line -->
+<polyline points="5700,2566
+6600,2566
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polygon points="456,1004
+457,1003
+464,996
+476,984
+488,972
+495,965
+496,964
+496,961
+496,955
+496,943
+496,925
+496,900
+496,869
+496,831
+496,787
+496,740
+496,690
+496,641
+496,594
+496,550
+496,512
+496,481
+496,456
+496,438
+496,426
+496,420
+496,417
+495,416
+488,409
+476,397
+464,386
+457,379
+456,378
+456,381
+456,386
+456,397
+456,413
+456,436
+456,465
+456,501
+456,543
+456,589
+456,639
+456,691
+456,743
+456,793
+456,839
+456,881
+456,917
+456,946
+456,969
+456,985
+456,996
+456,1001
+456,1004
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polygon points="1239,1004
+1238,1003
+1231,996
+1219,984
+1207,972
+1200,965
+1199,964
+1199,961
+1199,955
+1199,943
+1199,925
+1199,900
+1199,869
+1199,831
+1199,787
+1199,740
+1199,690
+1199,641
+1199,594
+1199,550
+1199,512
+1199,481
+1199,456
+1199,438
+1199,426
+1199,420
+1199,417
+1200,416
+1207,409
+1219,397
+1231,386
+1238,379
+1239,378
+1239,381
+1239,386
+1239,397
+1239,413
+1239,436
+1239,465
+1239,501
+1239,543
+1239,589
+1239,639
+1239,691
+1239,743
+1239,793
+1239,839
+1239,881
+1239,917
+1239,946
+1239,969
+1239,985
+1239,996
+1239,1001
+1239,1004
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polygon points="496,417
+498,417
+502,417
+508,416
+518,415
+532,414
+548,413
+567,412
+587,410
+609,409
+633,408
+658,406
+685,405
+714,404
+745,403
+779,403
+816,402
+855,402
+894,402
+930,403
+963,403
+994,404
+1022,405
+1047,406
+1071,408
+1094,409
+1114,410
+1134,412
+1151,413
+1166,414
+1178,415
+1188,416
+1194,417
+1197,417
+1199,417
+1200,416
+1207,409
+1219,397
+1231,386
+1238,379
+1239,378
+1236,378
+1231,378
+1220,378
+1204,378
+1181,378
+1151,378
+1114,378
+1070,378
+1020,378
+966,378
+907,378
+847,378
+788,378
+729,378
+675,378
+625,378
+581,378
+544,378
+514,378
+491,378
+475,378
+464,378
+459,378
+456,378
+457,379
+464,386
+476,398
+488,409
+495,416
+496,417
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#808080;
+"/>
+<!-- Line -->
+<polygon points="496,964
+498,964
+502,964
+508,965
+518,966
+532,967
+548,968
+567,970
+587,971
+609,972
+633,974
+658,975
+685,976
+714,978
+745,979
+779,979
+816,980
+855,980
+894,980
+930,979
+963,979
+994,978
+1022,976
+1047,975
+1071,974
+1094,972
+1114,971
+1134,970
+1151,968
+1166,967
+1178,966
+1188,965
+1194,964
+1197,964
+1199,964
+1200,965
+1207,972
+1219,984
+1231,996
+1238,1003
+1239,1004
+1236,1004
+1231,1004
+1220,1004
+1204,1004
+1181,1004
+1151,1004
+1114,1004
+1070,1004
+1020,1004
+966,1004
+907,1004
+847,1004
+788,1004
+729,1004
+675,1004
+625,1004
+581,1004
+544,1004
+514,1004
+491,1004
+475,1004
+464,1004
+459,1004
+456,1004
+457,1003
+464,996
+476,984
+488,972
+495,965
+496,964
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#ffffff;
+"/>
+<!-- Line: box -->
+<rect x="378" y="1590" width="704" height="14" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#808080;
+"/>
+<!-- Line -->
+<polygon points="442,1473
+378,1590
+496,1590
+512,1551
+485,1551
+500,1512
+475,1512
+496,1473
+442,1473
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polygon points="1082,1590
+965,1590
+965,1550
+990,1551
+986,1512
+1004,1512
+1010,1512
+1002,1473
+1050,1473
+1082,1590
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polygon points="1317,1590
+1281,1590
+1239,1496
+1089,1496
+1082,1473
+1255,1473
+1317,1590
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#c0c0c0;
+"/>
+<!-- Line: box -->
+<rect x="1121" y="1590" width="196" height="13" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#808080;
+"/>
+<!-- Line -->
+<polygon points="1121,1590
+1121,1604
+1081,1484
+1082,1473
+1121,1590
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#808080;
+"/>
+<!-- Line -->
+<polyline points="3645,1170
+3645,1260
+3738,1260
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#c7c7c7;
+"/>
+<!-- Line -->
+<polyline points="3640,1170
+3735,1170
+3735,1259
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#c7c7c7;
+"/>
+<!-- Line -->
+<polyline points="3649,1185
+3730,1186
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:round; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line -->
+<polyline points="3649,1222
+3730,1222
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:round; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line: box -->
+<rect x="3645" y="1193" width="81" height="21" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#000000;
+"/>
+</g>
+</svg>
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/login_net_access.svg freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/login_net_access.svg
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/login_net_access.svg	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/login_net_access.svg	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,1650 @@
+<?xml version="1.0" standalone="no"?>
+<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
+"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
+<!-- Creator: fig2dev Version 3.2 Patchlevel 5e -->
+<!-- CreationDate: Mon Aug 11 20:51:55 2014 -->
+<!-- Magnification: 1.000 -->
+<svg	xmlns="http://www.w3.org/2000/svg"
+	xmlns:xlink="http://www.w3.org/1999/xlink"
+	width="6.3in" height="3.0in"
+	viewBox="288 288 7536 3624">
+<g style="stroke-width:.025in; fill:none">
+<!-- Line -->
+<polygon points="1784,1215
+1515,1408
+1515,1561
+2283,1638
+2283,1484
+2437,1254
+1784,1215
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:round; stroke-linecap:butt;
+fill:#aaaaaa;
+"/>
+<!-- Line: box -->
+<rect x="1899" y="1484" width="231" height="62" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line: box -->
+<rect x="1554" y="1488" width="38" height="23" rx="0" 
+style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line -->
+<polygon points="2283,1484
+2283,1638
+2437,1369
+2437,1254
+2283,1484
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:round; stroke-linecap:butt;
+fill:#555555;
+"/>
+<!-- Line -->
+<polyline points="2283,1599
+1515,1523
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2245,1596
+2245,1519
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1784,1550
+1784,1473
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2245,1557
+1784,1511
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="1535" y="1448" width="77" height="46" rx="0" 
+style="stroke:#ff0000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#ff0000;
+"/>
+<!-- Line: box -->
+<rect x="2168" y="1511" width="58" height="25" rx="0" 
+style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#555555;
+"/>
+<!-- Line -->
+<polyline points="2206,1592
+2206,1553
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2168,1588
+2168,1550
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1515,1408
+2283,1484
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1544,1410
+1808,1217
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1572,1413
+1833,1218
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1601,1416
+1857,1220
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1629,1419
+1881,1221
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1658,1422
+1905,1222
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1686,1425
+1929,1224
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1715,1427
+1953,1226
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1743,1430
+1977,1227
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1771,1433
+2002,1228
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1800,1436
+2026,1230
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1828,1439
+2050,1231
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1857,1442
+2074,1232
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1885,1444
+2098,1234
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1914,1447
+2122,1235
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1942,1450
+2147,1237
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1970,1453
+2171,1238
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1999,1456
+2195,1239
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2027,1459
+2219,1241
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2056,1461
+2243,1243
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2084,1464
+2267,1244
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2113,1467
+2292,1245
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2141,1470
+2316,1247
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2170,1473
+2340,1248
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2198,1476
+2365,1250
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2226,1478
+2388,1251
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2255,1482
+2412,1252
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1546,1526
+1546,1564
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1577,1529
+1577,1567
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1608,1531
+1608,1570
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1639,1535
+1639,1573
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1669,1538
+1669,1577
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1700,1541
+1700,1579
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1731,1544
+1731,1582
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1761,1547
+1761,1586
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1792,1550
+1792,1588
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1823,1553
+1823,1592
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1853,1556
+1853,1595
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1884,1560
+1884,1598
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1915,1562
+1915,1601
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1946,1565
+1946,1604
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1976,1569
+1976,1607
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2007,1572
+2007,1610
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2038,1575
+2038,1613
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2068,1578
+2068,1616
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2099,1581
+2099,1619
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2130,1584
+2130,1622
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2161,1587
+2161,1625
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2191,1590
+2191,1629
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2222,1593
+2222,1631
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2253,1596
+2253,1634
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2283,1523
+1515,1446
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Text -->
+<text xml:space="preserve" x="1950" y="2475" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">Accessing  the network</text>
+<!-- Line: box -->
+<rect x="3600" y="900" width="1215" height="900" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#e7e7e7;
+"/>
+<!-- Line -->
+<polyline points="1200,1275
+1800,1275
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polygon points="6525,375
+6560,368
+6590,361
+6611,353
+6623,347
+6630,341
+6631,335
+6631,330
+6631,325
+6633,319
+6640,314
+6654,309
+6677,305
+6710,301
+6750,300
+6784,301
+6816,303
+6844,306
+6868,310
+6887,314
+6902,318
+6914,323
+6923,327
+6931,331
+6940,336
+6949,340
+6961,345
+6977,350
+6997,355
+7022,360
+7053,365
+7088,370
+7125,375
+7166,379
+7202,381
+7231,381
+7253,380
+7269,377
+7280,373
+7288,368
+7294,363
+7299,357
+7306,353
+7316,350
+7329,349
+7347,350
+7370,355
+7396,363
+7425,375
+7451,390
+7473,406
+7489,421
+7500,434
+7506,445
+7508,454
+7508,462
+7506,469
+7505,476
+7504,485
+7506,495
+7511,509
+7520,526
+7534,547
+7553,572
+7575,600
+7599,628
+7621,652
+7641,671
+7659,686
+7673,695
+7686,701
+7696,704
+7706,706
+7716,708
+7726,712
+7737,718
+7748,729
+7762,744
+7775,766
+7789,793
+7800,825
+7807,854
+7810,882
+7812,906
+7812,926
+7812,942
+7811,955
+7810,966
+7808,974
+7806,981
+7804,989
+7801,997
+7797,1006
+7791,1019
+7783,1034
+7773,1053
+7760,1075
+7744,1100
+7725,1125
+7703,1149
+7682,1169
+7661,1185
+7644,1197
+7630,1205
+7618,1210
+7609,1212
+7601,1213
+7594,1212
+7586,1212
+7578,1212
+7567,1214
+7554,1217
+7536,1223
+7514,1232
+7488,1244
+7458,1259
+7425,1275
+7392,1291
+7362,1307
+7337,1320
+7317,1331
+7302,1340
+7291,1347
+7284,1353
+7279,1358
+7275,1363
+7271,1367
+7266,1371
+7259,1376
+7248,1382
+7233,1389
+7213,1397
+7188,1406
+7158,1416
+7125,1425
+7088,1433
+7056,1439
+7029,1443
+7009,1445
+6995,1446
+6986,1446
+6979,1445
+6975,1444
+6971,1442
+6964,1441
+6955,1439
+6941,1437
+6921,1435
+6894,1432
+6862,1429
+6825,1425
+6788,1420
+6756,1414
+6730,1409
+6710,1404
+6697,1399
+6689,1395
+6684,1391
+6681,1388
+6678,1384
+6673,1380
+6664,1376
+6650,1371
+6630,1366
+6601,1361
+6566,1355
+6525,1350
+6488,1346
+6453,1344
+6422,1343
+6397,1344
+6377,1346
+6361,1349
+6349,1353
+6340,1358
+6331,1363
+6323,1367
+6314,1371
+6302,1374
+6287,1376
+6268,1376
+6244,1374
+6216,1369
+6184,1361
+6150,1350
+6118,1336
+6090,1322
+6066,1308
+6047,1296
+6032,1285
+6020,1276
+6012,1268
+6005,1261
+6000,1255
+5995,1248
+5989,1241
+5983,1232
+5976,1221
+5967,1207
+5957,1190
+5946,1171
+5935,1149
+5925,1125
+5918,1095
+5916,1070
+5918,1051
+5924,1039
+5932,1032
+5942,1029
+5952,1028
+5962,1026
+5973,1023
+5982,1015
+5991,1002
+5998,981
+6002,952
+6004,918
+6003,886
+6000,856
+5996,831
+5990,809
+5983,792
+5976,779
+5968,768
+5961,759
+5953,749
+5946,738
+5940,726
+5934,710
+5929,691
+5927,669
+5926,644
+5929,618
+5936,593
+5945,573
+5954,561
+5962,555
+5970,553
+5976,554
+5983,558
+5990,561
+5998,563
+6007,563
+6020,560
+6035,552
+6054,540
+6075,525
+6096,509
+6113,494
+6126,482
+6134,472
+6138,464
+6140,458
+6139,453
+6140,448
+6142,442
+6147,435
+6158,426
+6175,416
+6199,404
+6229,393
+6258,385
+6285,379
+6308,375
+6327,373
+6342,373
+6354,374
+6363,377
+6371,379
+6379,382
+6389,384
+6401,386
+6417,387
+6437,386
+6463,384
+6493,380
+6525,375
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="750,1950
+3360,1950
+" style="stroke:#0000d1;stroke-width:15;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 750 1950 - 3630 1950-->
+<polygon points="3358 2010
+3598 1950
+3358 1890
+3358 2010
+
+" style="stroke:#0000d1;stroke-width:15;stroke-miterlimit:8;
+fill:#0000d1;"/>
+<!-- Line -->
+<polyline points="2325,1500
+2775,1500
+2850,1275
+3000,1725
+3075,1500
+3600,1500
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4800,1350
+5250,1350
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="5250,375
+5250,3900
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="5250,3000
+5700,3000
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="5250,900
+6000,900
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3900,1950
+5025,1950
+5025,1050
+5610,1050
+" style="stroke:#0000d1;stroke-width:15;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 5025 1050 - 5880 1050-->
+<polygon points="5608 1110
+5848 1050
+5608 990
+5608 1110
+
+" style="stroke:#0000d1;stroke-width:15;stroke-miterlimit:8;
+fill:#0000d1;"/>
+<!-- Text -->
+<text xml:space="preserve" x="6225" y="975" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">Internet</text>
+<!-- Text -->
+<text xml:space="preserve" x="3825" y="750" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">NAS</text>
+<!-- Text -->
+<text xml:space="preserve" x="5700" y="1950" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">Server</text>
+<!-- Line: box -->
+<rect x="652" y="1082" width="391" height="39" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#808080;
+"/>
+<!-- Line: box -->
+<rect x="613" y="1121" width="469" height="39" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#808080;
+"/>
+<!-- Line: box -->
+<rect x="378" y="300" width="939" height="782" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#e0e0e0;
+"/>
+<!-- Line -->
+<polygon points="417,1433
+1278,1433
+1395,1629
+1395,1668
+300,1668
+300,1629
+417,1433
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="398" y="1374" width="117" height="20" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="1180" y="1374" width="117" height="20" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="398" y="1160" width="899" height="216" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#e0e0e0;
+"/>
+<!-- Line -->
+<polyline points="3600,999
+4810,999
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3600,990
+4810,990
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3600,1007
+4810,1007
+" style="stroke:#c7c7c7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3600,1652
+4810,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3600,1642
+4810,1642
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3600,1659
+4810,1659
+" style="stroke:#c7c7c7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3901,995
+3901,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3910,995
+3910,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3893,995
+3893,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3831,995
+3831,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3840,995
+3840,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3823,995
+3823,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4129,995
+4129,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4139,995
+4139,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4122,995
+4122,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4060,995
+4060,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4069,995
+4069,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4052,995
+4052,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4351,995
+4351,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4361,995
+4361,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4343,995
+4343,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4281,995
+4281,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4290,995
+4290,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4274,995
+4274,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4576,995
+4576,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4585,995
+4585,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4569,995
+4569,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4506,995
+4506,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4515,995
+4515,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4498,995
+4498,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4781,995
+4781,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4789,995
+4789,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4773,995
+4773,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4711,995
+4711,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4720,995
+4720,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4702,995
+4702,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4131,995
+4131,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="5700" y="2100" width="900" height="1569" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polyline points="300,1629
+300,1668
+1395,1668
+1395,1629
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polygon points="456,1473
+378,1590
+1082,1590
+1043,1473
+456,1473
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#ffffff;
+"/>
+<!-- Line -->
+<polygon points="1239,1473
+1082,1473
+1121,1590
+1317,1590
+1239,1473
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#ffffff;
+"/>
+<!-- Line -->
+<polyline points="976,1240
+976,1220
+1061,1220
+1061,1201
+1166,1201
+" style="stroke:#808080;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1061,1279
+1061,1240
+1166,1240
+" style="stroke:#808080;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1166,1220
+1250,1220
+" style="stroke:#808080;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1166,1201
+1166,1220
+" style="stroke:#ffffff;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="976,1240
+1061,1240
+" style="stroke:#ffffff;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1061,1279
+1166,1279
+1166,1240
+1250,1240
+1250,1220
+" style="stroke:#ffffff;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1187,1279
+1229,1279
+1229,1259
+" style="stroke:#808080;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1187,1279
+1187,1259
+1229,1259
+" style="stroke:#ffffff;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="2701" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="2668" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="2801" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="2768" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="2901" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="2868" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="3001" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="2968" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="3101" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="3068" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="3203" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="3168" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="3301" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="3269" width="700" height="32" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="3402" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="3369" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="2468" width="700" height="32" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="2433" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="2367" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="2333" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="2267" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="2233" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="5700" y="3536" width="900" height="133" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line -->
+<polyline points="5700,2566
+6600,2566
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polygon points="456,1004
+457,1003
+464,996
+476,984
+488,972
+495,965
+496,964
+496,961
+496,955
+496,943
+496,925
+496,900
+496,869
+496,831
+496,787
+496,740
+496,690
+496,641
+496,594
+496,550
+496,512
+496,481
+496,456
+496,438
+496,426
+496,420
+496,417
+495,416
+488,409
+476,397
+464,386
+457,379
+456,378
+456,381
+456,386
+456,397
+456,413
+456,436
+456,465
+456,501
+456,543
+456,589
+456,639
+456,691
+456,743
+456,793
+456,839
+456,881
+456,917
+456,946
+456,969
+456,985
+456,996
+456,1001
+456,1004
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polygon points="1239,1004
+1238,1003
+1231,996
+1219,984
+1207,972
+1200,965
+1199,964
+1199,961
+1199,955
+1199,943
+1199,925
+1199,900
+1199,869
+1199,831
+1199,787
+1199,740
+1199,690
+1199,641
+1199,594
+1199,550
+1199,512
+1199,481
+1199,456
+1199,438
+1199,426
+1199,420
+1199,417
+1200,416
+1207,409
+1219,397
+1231,386
+1238,379
+1239,378
+1239,381
+1239,386
+1239,397
+1239,413
+1239,436
+1239,465
+1239,501
+1239,543
+1239,589
+1239,639
+1239,691
+1239,743
+1239,793
+1239,839
+1239,881
+1239,917
+1239,946
+1239,969
+1239,985
+1239,996
+1239,1001
+1239,1004
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polygon points="496,417
+498,417
+502,417
+508,416
+518,415
+532,414
+548,413
+567,412
+587,410
+609,409
+633,408
+658,406
+685,405
+714,404
+745,403
+779,403
+816,402
+855,402
+894,402
+930,403
+963,403
+994,404
+1022,405
+1047,406
+1071,408
+1094,409
+1114,410
+1134,412
+1151,413
+1166,414
+1178,415
+1188,416
+1194,417
+1197,417
+1199,417
+1200,416
+1207,409
+1219,397
+1231,386
+1238,379
+1239,378
+1236,378
+1231,378
+1220,378
+1204,378
+1181,378
+1151,378
+1114,378
+1070,378
+1020,378
+966,378
+907,378
+847,378
+788,378
+729,378
+675,378
+625,378
+581,378
+544,378
+514,378
+491,378
+475,378
+464,378
+459,378
+456,378
+457,379
+464,386
+476,398
+488,409
+495,416
+496,417
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#808080;
+"/>
+<!-- Line -->
+<polygon points="496,964
+498,964
+502,964
+508,965
+518,966
+532,967
+548,968
+567,970
+587,971
+609,972
+633,974
+658,975
+685,976
+714,978
+745,979
+779,979
+816,980
+855,980
+894,980
+930,979
+963,979
+994,978
+1022,976
+1047,975
+1071,974
+1094,972
+1114,971
+1134,970
+1151,968
+1166,967
+1178,966
+1188,965
+1194,964
+1197,964
+1199,964
+1200,965
+1207,972
+1219,984
+1231,996
+1238,1003
+1239,1004
+1236,1004
+1231,1004
+1220,1004
+1204,1004
+1181,1004
+1151,1004
+1114,1004
+1070,1004
+1020,1004
+966,1004
+907,1004
+847,1004
+788,1004
+729,1004
+675,1004
+625,1004
+581,1004
+544,1004
+514,1004
+491,1004
+475,1004
+464,1004
+459,1004
+456,1004
+457,1003
+464,996
+476,984
+488,972
+495,965
+496,964
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#ffffff;
+"/>
+<!-- Line: box -->
+<rect x="378" y="1590" width="704" height="14" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#808080;
+"/>
+<!-- Line -->
+<polygon points="442,1473
+378,1590
+496,1590
+512,1551
+485,1551
+500,1512
+475,1512
+496,1473
+442,1473
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polygon points="1082,1590
+965,1590
+965,1550
+990,1551
+986,1512
+1004,1512
+1010,1512
+1002,1473
+1050,1473
+1082,1590
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polygon points="1317,1590
+1281,1590
+1239,1496
+1089,1496
+1082,1473
+1255,1473
+1317,1590
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#c0c0c0;
+"/>
+<!-- Line: box -->
+<rect x="1121" y="1590" width="196" height="13" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#808080;
+"/>
+<!-- Line -->
+<polygon points="1121,1590
+1121,1604
+1081,1484
+1082,1473
+1121,1590
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#808080;
+"/>
+<!-- Line -->
+<polyline points="3645,1170
+3645,1260
+3738,1260
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#c7c7c7;
+"/>
+<!-- Line -->
+<polyline points="3640,1170
+3735,1170
+3735,1259
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#c7c7c7;
+"/>
+<!-- Line -->
+<polyline points="3649,1185
+3730,1186
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:round; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line -->
+<polyline points="3649,1222
+3730,1222
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:round; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line: box -->
+<rect x="3645" y="1193" width="81" height="21" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#000000;
+"/>
+</g>
+</svg>
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/login_ok.svg freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/login_ok.svg
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/login_ok.svg	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/login_ok.svg	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,1656 @@
+<?xml version="1.0" standalone="no"?>
+<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
+"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
+<!-- Creator: fig2dev Version 3.2 Patchlevel 5e -->
+<!-- CreationDate: Mon Aug 11 20:51:55 2014 -->
+<!-- Magnification: 1.000 -->
+<svg	xmlns="http://www.w3.org/2000/svg"
+	xmlns:xlink="http://www.w3.org/1999/xlink"
+	width="6.3in" height="3.0in"
+	viewBox="288 288 7536 3624">
+<g style="stroke-width:.025in; fill:none">
+<!-- Line -->
+<polygon points="1784,1215
+1515,1408
+1515,1561
+2283,1638
+2283,1484
+2437,1254
+1784,1215
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:round; stroke-linecap:butt;
+fill:#aaaaaa;
+"/>
+<!-- Line: box -->
+<rect x="1899" y="1484" width="231" height="62" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line: box -->
+<rect x="1554" y="1488" width="38" height="23" rx="0" 
+style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line -->
+<polygon points="2283,1484
+2283,1638
+2437,1369
+2437,1254
+2283,1484
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:round; stroke-linecap:butt;
+fill:#555555;
+"/>
+<!-- Line -->
+<polyline points="2283,1599
+1515,1523
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2245,1596
+2245,1519
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1784,1550
+1784,1473
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2245,1557
+1784,1511
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="1535" y="1448" width="77" height="46" rx="0" 
+style="stroke:#ff0000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#ff0000;
+"/>
+<!-- Line: box -->
+<rect x="2168" y="1511" width="58" height="25" rx="0" 
+style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#555555;
+"/>
+<!-- Line -->
+<polyline points="2206,1592
+2206,1553
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2168,1588
+2168,1550
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1515,1408
+2283,1484
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1544,1410
+1808,1217
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1572,1413
+1833,1218
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1601,1416
+1857,1220
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1629,1419
+1881,1221
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1658,1422
+1905,1222
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1686,1425
+1929,1224
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1715,1427
+1953,1226
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1743,1430
+1977,1227
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1771,1433
+2002,1228
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1800,1436
+2026,1230
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1828,1439
+2050,1231
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1857,1442
+2074,1232
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1885,1444
+2098,1234
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1914,1447
+2122,1235
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1942,1450
+2147,1237
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1970,1453
+2171,1238
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1999,1456
+2195,1239
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2027,1459
+2219,1241
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2056,1461
+2243,1243
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2084,1464
+2267,1244
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2113,1467
+2292,1245
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2141,1470
+2316,1247
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2170,1473
+2340,1248
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2198,1476
+2365,1250
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2226,1478
+2388,1251
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2255,1482
+2412,1252
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1546,1526
+1546,1564
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1577,1529
+1577,1567
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1608,1531
+1608,1570
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1639,1535
+1639,1573
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1669,1538
+1669,1577
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1700,1541
+1700,1579
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1731,1544
+1731,1582
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1761,1547
+1761,1586
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1792,1550
+1792,1588
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1823,1553
+1823,1592
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1853,1556
+1853,1595
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1884,1560
+1884,1598
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1915,1562
+1915,1601
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1946,1565
+1946,1604
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1976,1569
+1976,1607
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2007,1572
+2007,1610
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2038,1575
+2038,1613
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2068,1578
+2068,1616
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2099,1581
+2099,1619
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2130,1584
+2130,1622
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2161,1587
+2161,1625
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2191,1590
+2191,1629
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2222,1593
+2222,1631
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2253,1596
+2253,1634
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2283,1523
+1515,1446
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="3600" y="900" width="1215" height="900" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#e7e7e7;
+"/>
+<!-- Line -->
+<polyline points="1200,1275
+1800,1275
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polygon points="6525,375
+6560,368
+6590,361
+6611,353
+6623,347
+6630,341
+6631,335
+6631,330
+6631,325
+6633,319
+6640,314
+6654,309
+6677,305
+6710,301
+6750,300
+6784,301
+6816,303
+6844,306
+6868,310
+6887,314
+6902,318
+6914,323
+6923,327
+6931,331
+6940,336
+6949,340
+6961,345
+6977,350
+6997,355
+7022,360
+7053,365
+7088,370
+7125,375
+7166,379
+7202,381
+7231,381
+7253,380
+7269,377
+7280,373
+7288,368
+7294,363
+7299,357
+7306,353
+7316,350
+7329,349
+7347,350
+7370,355
+7396,363
+7425,375
+7451,390
+7473,406
+7489,421
+7500,434
+7506,445
+7508,454
+7508,462
+7506,469
+7505,476
+7504,485
+7506,495
+7511,509
+7520,526
+7534,547
+7553,572
+7575,600
+7599,628
+7621,652
+7641,671
+7659,686
+7673,695
+7686,701
+7696,704
+7706,706
+7716,708
+7726,712
+7737,718
+7748,729
+7762,744
+7775,766
+7789,793
+7800,825
+7807,854
+7810,882
+7812,906
+7812,926
+7812,942
+7811,955
+7810,966
+7808,974
+7806,981
+7804,989
+7801,997
+7797,1006
+7791,1019
+7783,1034
+7773,1053
+7760,1075
+7744,1100
+7725,1125
+7703,1149
+7682,1169
+7661,1185
+7644,1197
+7630,1205
+7618,1210
+7609,1212
+7601,1213
+7594,1212
+7586,1212
+7578,1212
+7567,1214
+7554,1217
+7536,1223
+7514,1232
+7488,1244
+7458,1259
+7425,1275
+7392,1291
+7362,1307
+7337,1320
+7317,1331
+7302,1340
+7291,1347
+7284,1353
+7279,1358
+7275,1363
+7271,1367
+7266,1371
+7259,1376
+7248,1382
+7233,1389
+7213,1397
+7188,1406
+7158,1416
+7125,1425
+7088,1433
+7056,1439
+7029,1443
+7009,1445
+6995,1446
+6986,1446
+6979,1445
+6975,1444
+6971,1442
+6964,1441
+6955,1439
+6941,1437
+6921,1435
+6894,1432
+6862,1429
+6825,1425
+6788,1420
+6756,1414
+6730,1409
+6710,1404
+6697,1399
+6689,1395
+6684,1391
+6681,1388
+6678,1384
+6673,1380
+6664,1376
+6650,1371
+6630,1366
+6601,1361
+6566,1355
+6525,1350
+6488,1346
+6453,1344
+6422,1343
+6397,1344
+6377,1346
+6361,1349
+6349,1353
+6340,1358
+6331,1363
+6323,1367
+6314,1371
+6302,1374
+6287,1376
+6268,1376
+6244,1374
+6216,1369
+6184,1361
+6150,1350
+6118,1336
+6090,1322
+6066,1308
+6047,1296
+6032,1285
+6020,1276
+6012,1268
+6005,1261
+6000,1255
+5995,1248
+5989,1241
+5983,1232
+5976,1221
+5967,1207
+5957,1190
+5946,1171
+5935,1149
+5925,1125
+5918,1095
+5916,1070
+5918,1051
+5924,1039
+5932,1032
+5942,1029
+5952,1028
+5962,1026
+5973,1023
+5982,1015
+5991,1002
+5998,981
+6002,952
+6004,918
+6003,886
+6000,856
+5996,831
+5990,809
+5983,792
+5976,779
+5968,768
+5961,759
+5953,749
+5946,738
+5940,726
+5934,710
+5929,691
+5927,669
+5926,644
+5929,618
+5936,593
+5945,573
+5954,561
+5962,555
+5970,553
+5976,554
+5983,558
+5990,561
+5998,563
+6007,563
+6020,560
+6035,552
+6054,540
+6075,525
+6096,509
+6113,494
+6126,482
+6134,472
+6138,464
+6140,458
+6139,453
+6140,448
+6142,442
+6147,435
+6158,426
+6175,416
+6199,404
+6229,393
+6258,385
+6285,379
+6308,375
+6327,373
+6342,373
+6354,374
+6363,377
+6371,379
+6379,382
+6389,384
+6401,386
+6417,387
+6437,386
+6463,384
+6493,380
+6525,375
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="990,1950
+3600,1950
+" style="stroke:#0000d1;stroke-width:15;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 3600 1950 - 720 1950-->
+<polygon points="992 1890
+752 1950
+992 2010
+992 1890
+
+" style="stroke:#0000d1;stroke-width:15;stroke-miterlimit:8;
+fill:#0000d1;"/>
+<!-- Line -->
+<polyline points="4800,1350
+5250,1350
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="5250,375
+5250,3900
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="5250,3000
+5700,3000
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="5250,900
+6000,900
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4440,1950
+5025,1950
+5025,3300
+5550,3300
+" style="stroke:#0000d1;stroke-width:15;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 5025 1950 - 4170 1950-->
+<polygon points="4442 1890
+4202 1950
+4442 2010
+4442 1890
+
+" style="stroke:#0000d1;stroke-width:15;stroke-miterlimit:8;
+fill:#0000d1;"/>
+<!-- Line -->
+<polyline points="2325,1500
+2775,1500
+2850,1275
+3000,1725
+3075,1500
+3600,1500
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Text -->
+<text xml:space="preserve" x="6225" y="975" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">Internet</text>
+<!-- Text -->
+<text xml:space="preserve" x="2100" y="2475" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">PPP</text>
+<!-- Text -->
+<text xml:space="preserve" x="3825" y="750" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">NAS</text>
+<!-- Text -->
+<text xml:space="preserve" x="5700" y="1950" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">Server</text>
+<!-- Text -->
+<text xml:space="preserve" x="3525" y="2475" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">RADIUS</text>
+<!-- Text -->
+<text xml:space="preserve" x="2700" y="2925" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">Authentication OK</text>
+<!-- Text -->
+<text xml:space="preserve" x="2700" y="3225" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">IP 192.168.10.12</text>
+<!-- Line: box -->
+<rect x="652" y="1082" width="391" height="39" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#808080;
+"/>
+<!-- Line: box -->
+<rect x="613" y="1121" width="469" height="39" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#808080;
+"/>
+<!-- Line: box -->
+<rect x="378" y="300" width="939" height="782" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#e0e0e0;
+"/>
+<!-- Line -->
+<polygon points="417,1433
+1278,1433
+1395,1629
+1395,1668
+300,1668
+300,1629
+417,1433
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="398" y="1374" width="117" height="20" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="1180" y="1374" width="117" height="20" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="398" y="1160" width="899" height="216" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#e0e0e0;
+"/>
+<!-- Line -->
+<polyline points="3600,999
+4810,999
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3600,990
+4810,990
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3600,1007
+4810,1007
+" style="stroke:#c7c7c7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3600,1652
+4810,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3600,1642
+4810,1642
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3600,1659
+4810,1659
+" style="stroke:#c7c7c7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3901,995
+3901,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3910,995
+3910,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3893,995
+3893,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3831,995
+3831,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3840,995
+3840,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3823,995
+3823,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4129,995
+4129,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4139,995
+4139,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4122,995
+4122,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4060,995
+4060,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4069,995
+4069,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4052,995
+4052,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4351,995
+4351,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4361,995
+4361,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4343,995
+4343,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4281,995
+4281,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4290,995
+4290,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4274,995
+4274,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4576,995
+4576,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4585,995
+4585,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4569,995
+4569,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4506,995
+4506,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4515,995
+4515,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4498,995
+4498,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4781,995
+4781,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4789,995
+4789,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4773,995
+4773,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4711,995
+4711,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4720,995
+4720,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4702,995
+4702,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4131,995
+4131,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="5700" y="2100" width="900" height="1569" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polyline points="300,1629
+300,1668
+1395,1668
+1395,1629
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polygon points="456,1473
+378,1590
+1082,1590
+1043,1473
+456,1473
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#ffffff;
+"/>
+<!-- Line -->
+<polygon points="1239,1473
+1082,1473
+1121,1590
+1317,1590
+1239,1473
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#ffffff;
+"/>
+<!-- Line -->
+<polyline points="976,1240
+976,1220
+1061,1220
+1061,1201
+1166,1201
+" style="stroke:#808080;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1061,1279
+1061,1240
+1166,1240
+" style="stroke:#808080;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1166,1220
+1250,1220
+" style="stroke:#808080;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1166,1201
+1166,1220
+" style="stroke:#ffffff;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="976,1240
+1061,1240
+" style="stroke:#ffffff;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1061,1279
+1166,1279
+1166,1240
+1250,1240
+1250,1220
+" style="stroke:#ffffff;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1187,1279
+1229,1279
+1229,1259
+" style="stroke:#808080;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1187,1279
+1187,1259
+1229,1259
+" style="stroke:#ffffff;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="2701" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="2668" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="2801" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="2768" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="2901" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="2868" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="3001" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="2968" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="3101" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="3068" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="3203" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="3168" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="3301" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="3269" width="700" height="32" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="3402" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="3369" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="2468" width="700" height="32" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="2433" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="2367" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="2333" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="2267" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="5800" y="2233" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="5700" y="3536" width="900" height="133" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line -->
+<polyline points="5700,2566
+6600,2566
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polygon points="456,1004
+457,1003
+464,996
+476,984
+488,972
+495,965
+496,964
+496,961
+496,955
+496,943
+496,925
+496,900
+496,869
+496,831
+496,787
+496,740
+496,690
+496,641
+496,594
+496,550
+496,512
+496,481
+496,456
+496,438
+496,426
+496,420
+496,417
+495,416
+488,409
+476,397
+464,386
+457,379
+456,378
+456,381
+456,386
+456,397
+456,413
+456,436
+456,465
+456,501
+456,543
+456,589
+456,639
+456,691
+456,743
+456,793
+456,839
+456,881
+456,917
+456,946
+456,969
+456,985
+456,996
+456,1001
+456,1004
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polygon points="1239,1004
+1238,1003
+1231,996
+1219,984
+1207,972
+1200,965
+1199,964
+1199,961
+1199,955
+1199,943
+1199,925
+1199,900
+1199,869
+1199,831
+1199,787
+1199,740
+1199,690
+1199,641
+1199,594
+1199,550
+1199,512
+1199,481
+1199,456
+1199,438
+1199,426
+1199,420
+1199,417
+1200,416
+1207,409
+1219,397
+1231,386
+1238,379
+1239,378
+1239,381
+1239,386
+1239,397
+1239,413
+1239,436
+1239,465
+1239,501
+1239,543
+1239,589
+1239,639
+1239,691
+1239,743
+1239,793
+1239,839
+1239,881
+1239,917
+1239,946
+1239,969
+1239,985
+1239,996
+1239,1001
+1239,1004
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polygon points="496,417
+498,417
+502,417
+508,416
+518,415
+532,414
+548,413
+567,412
+587,410
+609,409
+633,408
+658,406
+685,405
+714,404
+745,403
+779,403
+816,402
+855,402
+894,402
+930,403
+963,403
+994,404
+1022,405
+1047,406
+1071,408
+1094,409
+1114,410
+1134,412
+1151,413
+1166,414
+1178,415
+1188,416
+1194,417
+1197,417
+1199,417
+1200,416
+1207,409
+1219,397
+1231,386
+1238,379
+1239,378
+1236,378
+1231,378
+1220,378
+1204,378
+1181,378
+1151,378
+1114,378
+1070,378
+1020,378
+966,378
+907,378
+847,378
+788,378
+729,378
+675,378
+625,378
+581,378
+544,378
+514,378
+491,378
+475,378
+464,378
+459,378
+456,378
+457,379
+464,386
+476,398
+488,409
+495,416
+496,417
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#808080;
+"/>
+<!-- Line -->
+<polygon points="496,964
+498,964
+502,964
+508,965
+518,966
+532,967
+548,968
+567,970
+587,971
+609,972
+633,974
+658,975
+685,976
+714,978
+745,979
+779,979
+816,980
+855,980
+894,980
+930,979
+963,979
+994,978
+1022,976
+1047,975
+1071,974
+1094,972
+1114,971
+1134,970
+1151,968
+1166,967
+1178,966
+1188,965
+1194,964
+1197,964
+1199,964
+1200,965
+1207,972
+1219,984
+1231,996
+1238,1003
+1239,1004
+1236,1004
+1231,1004
+1220,1004
+1204,1004
+1181,1004
+1151,1004
+1114,1004
+1070,1004
+1020,1004
+966,1004
+907,1004
+847,1004
+788,1004
+729,1004
+675,1004
+625,1004
+581,1004
+544,1004
+514,1004
+491,1004
+475,1004
+464,1004
+459,1004
+456,1004
+457,1003
+464,996
+476,984
+488,972
+495,965
+496,964
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#ffffff;
+"/>
+<!-- Line: box -->
+<rect x="378" y="1590" width="704" height="14" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#808080;
+"/>
+<!-- Line -->
+<polygon points="442,1473
+378,1590
+496,1590
+512,1551
+485,1551
+500,1512
+475,1512
+496,1473
+442,1473
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polygon points="1082,1590
+965,1590
+965,1550
+990,1551
+986,1512
+1004,1512
+1010,1512
+1002,1473
+1050,1473
+1082,1590
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polygon points="1317,1590
+1281,1590
+1239,1496
+1089,1496
+1082,1473
+1255,1473
+1317,1590
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#c0c0c0;
+"/>
+<!-- Line: box -->
+<rect x="1121" y="1590" width="196" height="13" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#808080;
+"/>
+<!-- Line -->
+<polygon points="1121,1590
+1121,1604
+1081,1484
+1082,1473
+1121,1590
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#808080;
+"/>
+<!-- Line -->
+<polyline points="3645,1170
+3645,1260
+3738,1260
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#c7c7c7;
+"/>
+<!-- Line -->
+<polyline points="3640,1170
+3735,1170
+3735,1259
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#c7c7c7;
+"/>
+<!-- Line -->
+<polyline points="3649,1185
+3730,1186
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:round; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line -->
+<polyline points="3649,1222
+3730,1222
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:round; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line: box -->
+<rect x="3645" y="1193" width="81" height="21" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#000000;
+"/>
+</g>
+</svg>
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/nas_backup_server.svg freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/nas_backup_server.svg
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/nas_backup_server.svg	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/nas_backup_server.svg	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,1822 @@
+<?xml version="1.0" standalone="no"?>
+<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
+"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
+<!-- Creator: fig2dev Version 3.2 Patchlevel 5e -->
+<!-- CreationDate: Mon Aug 11 20:51:55 2014 -->
+<!-- Magnification: 1.000 -->
+<svg	xmlns="http://www.w3.org/2000/svg"
+	xmlns:xlink="http://www.w3.org/1999/xlink"
+	width="6.3in" height="4.8in"
+	viewBox="288 288 7536 5799">
+<g style="stroke-width:.025in; fill:none">
+<!-- Line -->
+<polygon points="1784,1215
+1515,1408
+1515,1561
+2283,1638
+2283,1484
+2437,1254
+1784,1215
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:round; stroke-linecap:butt;
+fill:#aaaaaa;
+"/>
+<!-- Line: box -->
+<rect x="1899" y="1484" width="231" height="62" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line: box -->
+<rect x="1554" y="1488" width="38" height="23" rx="0" 
+style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line -->
+<polygon points="2283,1484
+2283,1638
+2437,1369
+2437,1254
+2283,1484
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:round; stroke-linecap:butt;
+fill:#555555;
+"/>
+<!-- Line -->
+<polyline points="2283,1599
+1515,1523
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2245,1596
+2245,1519
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1784,1550
+1784,1473
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2245,1557
+1784,1511
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="1535" y="1448" width="77" height="46" rx="0" 
+style="stroke:#ff0000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#ff0000;
+"/>
+<!-- Line: box -->
+<rect x="2168" y="1511" width="58" height="25" rx="0" 
+style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#555555;
+"/>
+<!-- Line -->
+<polyline points="2206,1592
+2206,1553
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2168,1588
+2168,1550
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1515,1408
+2283,1484
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1544,1410
+1808,1217
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1572,1413
+1833,1218
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1601,1416
+1857,1220
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1629,1419
+1881,1221
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1658,1422
+1905,1222
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1686,1425
+1929,1224
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1715,1427
+1953,1226
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1743,1430
+1977,1227
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1771,1433
+2002,1228
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1800,1436
+2026,1230
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1828,1439
+2050,1231
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1857,1442
+2074,1232
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1885,1444
+2098,1234
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1914,1447
+2122,1235
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1942,1450
+2147,1237
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1970,1453
+2171,1238
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1999,1456
+2195,1239
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2027,1459
+2219,1241
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2056,1461
+2243,1243
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2084,1464
+2267,1244
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2113,1467
+2292,1245
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2141,1470
+2316,1247
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2170,1473
+2340,1248
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2198,1476
+2365,1250
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2226,1478
+2388,1251
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2255,1482
+2412,1252
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1546,1526
+1546,1564
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1577,1529
+1577,1567
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1608,1531
+1608,1570
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1639,1535
+1639,1573
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1669,1538
+1669,1577
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1700,1541
+1700,1579
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1731,1544
+1731,1582
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1761,1547
+1761,1586
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1792,1550
+1792,1588
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1823,1553
+1823,1592
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1853,1556
+1853,1595
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1884,1560
+1884,1598
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1915,1562
+1915,1601
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1946,1565
+1946,1604
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1976,1569
+1976,1607
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2007,1572
+2007,1610
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2038,1575
+2038,1613
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2068,1578
+2068,1616
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2099,1581
+2099,1619
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2130,1584
+2130,1622
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2161,1587
+2161,1625
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2191,1590
+2191,1629
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2222,1593
+2222,1631
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2253,1596
+2253,1634
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2283,1523
+1515,1446
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="3600" y="900" width="1215" height="900" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#e7e7e7;
+"/>
+<!-- Line -->
+<polyline points="1200,1275
+1800,1275
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4800,1350
+5250,1350
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polygon points="6525,375
+6560,368
+6590,361
+6611,353
+6623,347
+6630,341
+6631,335
+6631,330
+6631,325
+6633,319
+6640,314
+6654,309
+6677,305
+6710,301
+6750,300
+6784,301
+6816,303
+6844,306
+6868,310
+6887,314
+6902,318
+6914,323
+6923,327
+6931,331
+6940,336
+6949,340
+6961,345
+6977,350
+6997,355
+7022,360
+7053,365
+7088,370
+7125,375
+7166,379
+7202,381
+7231,381
+7253,380
+7269,377
+7280,373
+7288,368
+7294,363
+7299,357
+7306,353
+7316,350
+7329,349
+7347,350
+7370,355
+7396,363
+7425,375
+7451,390
+7473,406
+7489,421
+7500,434
+7506,445
+7508,454
+7508,462
+7506,469
+7505,476
+7504,485
+7506,495
+7511,509
+7520,526
+7534,547
+7553,572
+7575,600
+7599,628
+7621,652
+7641,671
+7659,686
+7673,695
+7686,701
+7696,704
+7706,706
+7716,708
+7726,712
+7737,718
+7748,729
+7762,744
+7775,766
+7789,793
+7800,825
+7807,854
+7810,882
+7812,906
+7812,926
+7812,942
+7811,955
+7810,966
+7808,974
+7806,981
+7804,989
+7801,997
+7797,1006
+7791,1019
+7783,1034
+7773,1053
+7760,1075
+7744,1100
+7725,1125
+7703,1149
+7682,1169
+7661,1185
+7644,1197
+7630,1205
+7618,1210
+7609,1212
+7601,1213
+7594,1212
+7586,1212
+7578,1212
+7567,1214
+7554,1217
+7536,1223
+7514,1232
+7488,1244
+7458,1259
+7425,1275
+7392,1291
+7362,1307
+7337,1320
+7317,1331
+7302,1340
+7291,1347
+7284,1353
+7279,1358
+7275,1363
+7271,1367
+7266,1371
+7259,1376
+7248,1382
+7233,1389
+7213,1397
+7188,1406
+7158,1416
+7125,1425
+7088,1433
+7056,1439
+7029,1443
+7009,1445
+6995,1446
+6986,1446
+6979,1445
+6975,1444
+6971,1442
+6964,1441
+6955,1439
+6941,1437
+6921,1435
+6894,1432
+6862,1429
+6825,1425
+6788,1420
+6756,1414
+6730,1409
+6710,1404
+6697,1399
+6689,1395
+6684,1391
+6681,1388
+6678,1384
+6673,1380
+6664,1376
+6650,1371
+6630,1366
+6601,1361
+6566,1355
+6525,1350
+6488,1346
+6453,1344
+6422,1343
+6397,1344
+6377,1346
+6361,1349
+6349,1353
+6340,1358
+6331,1363
+6323,1367
+6314,1371
+6302,1374
+6287,1376
+6268,1376
+6244,1374
+6216,1369
+6184,1361
+6150,1350
+6118,1336
+6090,1322
+6066,1308
+6047,1296
+6032,1285
+6020,1276
+6012,1268
+6005,1261
+6000,1255
+5995,1248
+5989,1241
+5983,1232
+5976,1221
+5967,1207
+5957,1190
+5946,1171
+5935,1149
+5925,1125
+5918,1095
+5916,1070
+5918,1051
+5924,1039
+5932,1032
+5942,1029
+5952,1028
+5962,1026
+5973,1023
+5982,1015
+5991,1002
+5998,981
+6002,952
+6004,918
+6003,886
+6000,856
+5996,831
+5990,809
+5983,792
+5976,779
+5968,768
+5961,759
+5953,749
+5946,738
+5940,726
+5934,710
+5929,691
+5927,669
+5926,644
+5929,618
+5936,593
+5945,573
+5954,561
+5962,555
+5970,553
+5976,554
+5983,558
+5990,561
+5998,563
+6007,563
+6020,560
+6035,552
+6054,540
+6075,525
+6096,509
+6113,494
+6126,482
+6134,472
+6138,464
+6140,458
+6139,453
+6140,448
+6142,442
+6147,435
+6158,426
+6175,416
+6199,404
+6229,393
+6258,385
+6285,379
+6308,375
+6327,373
+6342,373
+6354,374
+6363,377
+6371,379
+6379,382
+6389,384
+6401,386
+6417,387
+6437,386
+6463,384
+6493,380
+6525,375
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="5250,900
+6000,900
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="5250,5325
+6300,5325
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="5250,3000
+6300,3000
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4200,1950
+5625,1950
+5625,2850
+5985,2850
+" style="stroke:#0000d1;stroke-width:15;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 5625 2850 - 6255 2850-->
+<polygon points="5983 2910
+6223 2850
+5983 2790
+5983 2910
+
+" style="stroke:#0000d1;stroke-width:15;stroke-miterlimit:8;
+fill:#0000d1;"/>
+<!-- Line -->
+<polyline points="5250,450
+5250,6075
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="750,1950
+3510,1950
+" style="stroke:#0000d1;stroke-width:15;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 750 1950 - 3780 1950-->
+<polygon points="3508 2010
+3748 1950
+3508 1890
+3508 2010
+
+" style="stroke:#0000d1;stroke-width:15;stroke-miterlimit:8;
+fill:#0000d1;"/>
+<!-- Line -->
+<polyline points="2325,1500
+2850,1500
+2925,1275
+3075,1725
+3150,1500
+3600,1500
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Text -->
+<text xml:space="preserve" x="3825" y="750" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">NAS</text>
+<!-- Text -->
+<text xml:space="preserve" x="6225" y="975" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">Internet</text>
+<!-- Text -->
+<text xml:space="preserve" x="6150" y="1950" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">Primary</text>
+<!-- Text -->
+<text xml:space="preserve" x="6225" y="4275" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">Backup</text>
+<!-- Line: box -->
+<rect x="652" y="1082" width="391" height="39" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#808080;
+"/>
+<!-- Line: box -->
+<rect x="613" y="1121" width="469" height="39" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#808080;
+"/>
+<!-- Line: box -->
+<rect x="378" y="300" width="939" height="782" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#e0e0e0;
+"/>
+<!-- Line -->
+<polygon points="417,1433
+1278,1433
+1395,1629
+1395,1668
+300,1668
+300,1629
+417,1433
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="398" y="1374" width="117" height="20" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="1180" y="1374" width="117" height="20" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="398" y="1160" width="899" height="216" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#e0e0e0;
+"/>
+<!-- Line -->
+<polyline points="3600,999
+4810,999
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3600,990
+4810,990
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3600,1007
+4810,1007
+" style="stroke:#c7c7c7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3600,1652
+4810,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3600,1642
+4810,1642
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3600,1659
+4810,1659
+" style="stroke:#c7c7c7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3901,995
+3901,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3910,995
+3910,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3893,995
+3893,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3831,995
+3831,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3840,995
+3840,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3823,995
+3823,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4129,995
+4129,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4139,995
+4139,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4122,995
+4122,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4060,995
+4060,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4069,995
+4069,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4052,995
+4052,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4351,995
+4351,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4361,995
+4361,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4343,995
+4343,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4281,995
+4281,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4290,995
+4290,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4274,995
+4274,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4576,995
+4576,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4585,995
+4585,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4569,995
+4569,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4506,995
+4506,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4515,995
+4515,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4498,995
+4498,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4781,995
+4781,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4789,995
+4789,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4773,995
+4773,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4711,995
+4711,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4720,995
+4720,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4702,995
+4702,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4131,995
+4131,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="6300" y="2100" width="900" height="1569" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Line: box -->
+<rect x="6300" y="4425" width="900" height="1569" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polyline points="300,1629
+300,1668
+1395,1668
+1395,1629
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polygon points="456,1473
+378,1590
+1082,1590
+1043,1473
+456,1473
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#ffffff;
+"/>
+<!-- Line -->
+<polygon points="1239,1473
+1082,1473
+1121,1590
+1317,1590
+1239,1473
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#ffffff;
+"/>
+<!-- Line -->
+<polyline points="976,1240
+976,1220
+1061,1220
+1061,1201
+1166,1201
+" style="stroke:#808080;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1061,1279
+1061,1240
+1166,1240
+" style="stroke:#808080;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1166,1220
+1250,1220
+" style="stroke:#808080;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1166,1201
+1166,1220
+" style="stroke:#ffffff;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="976,1240
+1061,1240
+" style="stroke:#ffffff;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1061,1279
+1166,1279
+1166,1240
+1250,1240
+1250,1220
+" style="stroke:#ffffff;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1187,1279
+1229,1279
+1229,1259
+" style="stroke:#808080;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1187,1279
+1187,1259
+1229,1259
+" style="stroke:#ffffff;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="2701" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="2668" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="2801" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="2768" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="2901" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="2868" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="3001" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="2968" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="3101" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="3068" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="3203" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="3168" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="3301" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="3269" width="700" height="32" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="3402" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="3369" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="2468" width="700" height="32" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="2433" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="2367" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="2333" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="2267" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="2233" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6300" y="3536" width="900" height="133" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line -->
+<polyline points="6300,2566
+7200,2566
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5026" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="4993" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5126" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5093" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5226" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5193" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5326" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5293" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5426" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5393" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5528" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5493" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5626" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5594" width="700" height="32" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5727" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5694" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="4793" width="700" height="32" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="4758" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="4692" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="4658" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="4592" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="4558" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6300" y="5861" width="900" height="133" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line -->
+<polyline points="6300,4891
+7200,4891
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polygon points="456,1004
+457,1003
+464,996
+476,984
+488,972
+495,965
+496,964
+496,961
+496,955
+496,943
+496,925
+496,900
+496,869
+496,831
+496,787
+496,740
+496,690
+496,641
+496,594
+496,550
+496,512
+496,481
+496,456
+496,438
+496,426
+496,420
+496,417
+495,416
+488,409
+476,397
+464,386
+457,379
+456,378
+456,381
+456,386
+456,397
+456,413
+456,436
+456,465
+456,501
+456,543
+456,589
+456,639
+456,691
+456,743
+456,793
+456,839
+456,881
+456,917
+456,946
+456,969
+456,985
+456,996
+456,1001
+456,1004
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polygon points="1239,1004
+1238,1003
+1231,996
+1219,984
+1207,972
+1200,965
+1199,964
+1199,961
+1199,955
+1199,943
+1199,925
+1199,900
+1199,869
+1199,831
+1199,787
+1199,740
+1199,690
+1199,641
+1199,594
+1199,550
+1199,512
+1199,481
+1199,456
+1199,438
+1199,426
+1199,420
+1199,417
+1200,416
+1207,409
+1219,397
+1231,386
+1238,379
+1239,378
+1239,381
+1239,386
+1239,397
+1239,413
+1239,436
+1239,465
+1239,501
+1239,543
+1239,589
+1239,639
+1239,691
+1239,743
+1239,793
+1239,839
+1239,881
+1239,917
+1239,946
+1239,969
+1239,985
+1239,996
+1239,1001
+1239,1004
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polygon points="496,417
+498,417
+502,417
+508,416
+518,415
+532,414
+548,413
+567,412
+587,410
+609,409
+633,408
+658,406
+685,405
+714,404
+745,403
+779,403
+816,402
+855,402
+894,402
+930,403
+963,403
+994,404
+1022,405
+1047,406
+1071,408
+1094,409
+1114,410
+1134,412
+1151,413
+1166,414
+1178,415
+1188,416
+1194,417
+1197,417
+1199,417
+1200,416
+1207,409
+1219,397
+1231,386
+1238,379
+1239,378
+1236,378
+1231,378
+1220,378
+1204,378
+1181,378
+1151,378
+1114,378
+1070,378
+1020,378
+966,378
+907,378
+847,378
+788,378
+729,378
+675,378
+625,378
+581,378
+544,378
+514,378
+491,378
+475,378
+464,378
+459,378
+456,378
+457,379
+464,386
+476,398
+488,409
+495,416
+496,417
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#808080;
+"/>
+<!-- Line -->
+<polygon points="496,964
+498,964
+502,964
+508,965
+518,966
+532,967
+548,968
+567,970
+587,971
+609,972
+633,974
+658,975
+685,976
+714,978
+745,979
+779,979
+816,980
+855,980
+894,980
+930,979
+963,979
+994,978
+1022,976
+1047,975
+1071,974
+1094,972
+1114,971
+1134,970
+1151,968
+1166,967
+1178,966
+1188,965
+1194,964
+1197,964
+1199,964
+1200,965
+1207,972
+1219,984
+1231,996
+1238,1003
+1239,1004
+1236,1004
+1231,1004
+1220,1004
+1204,1004
+1181,1004
+1151,1004
+1114,1004
+1070,1004
+1020,1004
+966,1004
+907,1004
+847,1004
+788,1004
+729,1004
+675,1004
+625,1004
+581,1004
+544,1004
+514,1004
+491,1004
+475,1004
+464,1004
+459,1004
+456,1004
+457,1003
+464,996
+476,984
+488,972
+495,965
+496,964
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#ffffff;
+"/>
+<!-- Line: box -->
+<rect x="378" y="1590" width="704" height="14" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#808080;
+"/>
+<!-- Line -->
+<polygon points="442,1473
+378,1590
+496,1590
+512,1551
+485,1551
+500,1512
+475,1512
+496,1473
+442,1473
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polygon points="1082,1590
+965,1590
+965,1550
+990,1551
+986,1512
+1004,1512
+1010,1512
+1002,1473
+1050,1473
+1082,1590
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polygon points="1317,1590
+1281,1590
+1239,1496
+1089,1496
+1082,1473
+1255,1473
+1317,1590
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#c0c0c0;
+"/>
+<!-- Line: box -->
+<rect x="1121" y="1590" width="196" height="13" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#808080;
+"/>
+<!-- Line -->
+<polygon points="1121,1590
+1121,1604
+1081,1484
+1082,1473
+1121,1590
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#808080;
+"/>
+<!-- Line -->
+<polyline points="3645,1170
+3645,1260
+3738,1260
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#c7c7c7;
+"/>
+<!-- Line -->
+<polyline points="3640,1170
+3735,1170
+3735,1259
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#c7c7c7;
+"/>
+<!-- Line -->
+<polyline points="3649,1185
+3730,1186
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:round; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line -->
+<polyline points="3649,1222
+3730,1222
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:round; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line -->
+<polyline points="5100,1950
+5100,5100
+5910,5100
+" style="stroke:#0000b0;stroke-width:15;
+stroke-linejoin:miter; stroke-linecap:butt;
+stroke-dasharray:60 60;"/>
+<!-- Arrowhead on XXXpoint 5100 5100 - 6180 5100-->
+<polygon points="5908 5160
+6148 5100
+5908 5040
+5908 5160
+
+" style="stroke:#0000b0;stroke-width:15;stroke-miterlimit:8;
+fill:#0000b0;"/>
+<!-- Line: box -->
+<rect x="3645" y="1193" width="81" height="21" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#000000;
+"/>
+</g>
+</svg>
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/nas_backup_server_failover.svg freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/nas_backup_server_failover.svg
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/nas_backup_server_failover.svg	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/nas_backup_server_failover.svg	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,1819 @@
+<?xml version="1.0" standalone="no"?>
+<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
+"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
+<!-- Creator: fig2dev Version 3.2 Patchlevel 5e -->
+<!-- CreationDate: Mon Aug 11 20:51:55 2014 -->
+<!-- Magnification: 1.000 -->
+<svg	xmlns="http://www.w3.org/2000/svg"
+	xmlns:xlink="http://www.w3.org/1999/xlink"
+	width="6.3in" height="4.8in"
+	viewBox="288 288 7536 5799">
+<g style="stroke-width:.025in; fill:none">
+<!-- Line -->
+<polygon points="1784,1215
+1515,1408
+1515,1561
+2283,1638
+2283,1484
+2437,1254
+1784,1215
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:round; stroke-linecap:butt;
+fill:#aaaaaa;
+"/>
+<!-- Line: box -->
+<rect x="1899" y="1484" width="231" height="62" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line: box -->
+<rect x="1554" y="1488" width="38" height="23" rx="0" 
+style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line -->
+<polygon points="2283,1484
+2283,1638
+2437,1369
+2437,1254
+2283,1484
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:round; stroke-linecap:butt;
+fill:#555555;
+"/>
+<!-- Line -->
+<polyline points="2283,1599
+1515,1523
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2245,1596
+2245,1519
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1784,1550
+1784,1473
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2245,1557
+1784,1511
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="1535" y="1448" width="77" height="46" rx="0" 
+style="stroke:#ff0000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#ff0000;
+"/>
+<!-- Line: box -->
+<rect x="2168" y="1511" width="58" height="25" rx="0" 
+style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#555555;
+"/>
+<!-- Line -->
+<polyline points="2206,1592
+2206,1553
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2168,1588
+2168,1550
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1515,1408
+2283,1484
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1544,1410
+1808,1217
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1572,1413
+1833,1218
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1601,1416
+1857,1220
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1629,1419
+1881,1221
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1658,1422
+1905,1222
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1686,1425
+1929,1224
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1715,1427
+1953,1226
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1743,1430
+1977,1227
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1771,1433
+2002,1228
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1800,1436
+2026,1230
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1828,1439
+2050,1231
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1857,1442
+2074,1232
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1885,1444
+2098,1234
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1914,1447
+2122,1235
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1942,1450
+2147,1237
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1970,1453
+2171,1238
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1999,1456
+2195,1239
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2027,1459
+2219,1241
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2056,1461
+2243,1243
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2084,1464
+2267,1244
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2113,1467
+2292,1245
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2141,1470
+2316,1247
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2170,1473
+2340,1248
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2198,1476
+2365,1250
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2226,1478
+2388,1251
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2255,1482
+2412,1252
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1546,1526
+1546,1564
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1577,1529
+1577,1567
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1608,1531
+1608,1570
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1639,1535
+1639,1573
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1669,1538
+1669,1577
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1700,1541
+1700,1579
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1731,1544
+1731,1582
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1761,1547
+1761,1586
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1792,1550
+1792,1588
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1823,1553
+1823,1592
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1853,1556
+1853,1595
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1884,1560
+1884,1598
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1915,1562
+1915,1601
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1946,1565
+1946,1604
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1976,1569
+1976,1607
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2007,1572
+2007,1610
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2038,1575
+2038,1613
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2068,1578
+2068,1616
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2099,1581
+2099,1619
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2130,1584
+2130,1622
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2161,1587
+2161,1625
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2191,1590
+2191,1629
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2222,1593
+2222,1631
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2253,1596
+2253,1634
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2283,1523
+1515,1446
+" style="stroke:#555555;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="3600" y="900" width="1215" height="900" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#e7e7e7;
+"/>
+<!-- Line -->
+<polyline points="1200,1275
+1800,1275
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4800,1350
+5250,1350
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polygon points="6525,375
+6560,368
+6590,361
+6611,353
+6623,347
+6630,341
+6631,335
+6631,330
+6631,325
+6633,319
+6640,314
+6654,309
+6677,305
+6710,301
+6750,300
+6784,301
+6816,303
+6844,306
+6868,310
+6887,314
+6902,318
+6914,323
+6923,327
+6931,331
+6940,336
+6949,340
+6961,345
+6977,350
+6997,355
+7022,360
+7053,365
+7088,370
+7125,375
+7166,379
+7202,381
+7231,381
+7253,380
+7269,377
+7280,373
+7288,368
+7294,363
+7299,357
+7306,353
+7316,350
+7329,349
+7347,350
+7370,355
+7396,363
+7425,375
+7451,390
+7473,406
+7489,421
+7500,434
+7506,445
+7508,454
+7508,462
+7506,469
+7505,476
+7504,485
+7506,495
+7511,509
+7520,526
+7534,547
+7553,572
+7575,600
+7599,628
+7621,652
+7641,671
+7659,686
+7673,695
+7686,701
+7696,704
+7706,706
+7716,708
+7726,712
+7737,718
+7748,729
+7762,744
+7775,766
+7789,793
+7800,825
+7807,854
+7810,882
+7812,906
+7812,926
+7812,942
+7811,955
+7810,966
+7808,974
+7806,981
+7804,989
+7801,997
+7797,1006
+7791,1019
+7783,1034
+7773,1053
+7760,1075
+7744,1100
+7725,1125
+7703,1149
+7682,1169
+7661,1185
+7644,1197
+7630,1205
+7618,1210
+7609,1212
+7601,1213
+7594,1212
+7586,1212
+7578,1212
+7567,1214
+7554,1217
+7536,1223
+7514,1232
+7488,1244
+7458,1259
+7425,1275
+7392,1291
+7362,1307
+7337,1320
+7317,1331
+7302,1340
+7291,1347
+7284,1353
+7279,1358
+7275,1363
+7271,1367
+7266,1371
+7259,1376
+7248,1382
+7233,1389
+7213,1397
+7188,1406
+7158,1416
+7125,1425
+7088,1433
+7056,1439
+7029,1443
+7009,1445
+6995,1446
+6986,1446
+6979,1445
+6975,1444
+6971,1442
+6964,1441
+6955,1439
+6941,1437
+6921,1435
+6894,1432
+6862,1429
+6825,1425
+6788,1420
+6756,1414
+6730,1409
+6710,1404
+6697,1399
+6689,1395
+6684,1391
+6681,1388
+6678,1384
+6673,1380
+6664,1376
+6650,1371
+6630,1366
+6601,1361
+6566,1355
+6525,1350
+6488,1346
+6453,1344
+6422,1343
+6397,1344
+6377,1346
+6361,1349
+6349,1353
+6340,1358
+6331,1363
+6323,1367
+6314,1371
+6302,1374
+6287,1376
+6268,1376
+6244,1374
+6216,1369
+6184,1361
+6150,1350
+6118,1336
+6090,1322
+6066,1308
+6047,1296
+6032,1285
+6020,1276
+6012,1268
+6005,1261
+6000,1255
+5995,1248
+5989,1241
+5983,1232
+5976,1221
+5967,1207
+5957,1190
+5946,1171
+5935,1149
+5925,1125
+5918,1095
+5916,1070
+5918,1051
+5924,1039
+5932,1032
+5942,1029
+5952,1028
+5962,1026
+5973,1023
+5982,1015
+5991,1002
+5998,981
+6002,952
+6004,918
+6003,886
+6000,856
+5996,831
+5990,809
+5983,792
+5976,779
+5968,768
+5961,759
+5953,749
+5946,738
+5940,726
+5934,710
+5929,691
+5927,669
+5926,644
+5929,618
+5936,593
+5945,573
+5954,561
+5962,555
+5970,553
+5976,554
+5983,558
+5990,561
+5998,563
+6007,563
+6020,560
+6035,552
+6054,540
+6075,525
+6096,509
+6113,494
+6126,482
+6134,472
+6138,464
+6140,458
+6139,453
+6140,448
+6142,442
+6147,435
+6158,426
+6175,416
+6199,404
+6229,393
+6258,385
+6285,379
+6308,375
+6327,373
+6342,373
+6354,374
+6363,377
+6371,379
+6379,382
+6389,384
+6401,386
+6417,387
+6437,386
+6463,384
+6493,380
+6525,375
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="750,1950
+3510,1950
+" style="stroke:#0000d1;stroke-width:15;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 750 1950 - 3780 1950-->
+<polygon points="3508 2010
+3748 1950
+3508 1890
+3508 2010
+
+" style="stroke:#0000d1;stroke-width:15;stroke-miterlimit:8;
+fill:#0000d1;"/>
+<!-- Line -->
+<polyline points="5250,900
+6000,900
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="5250,5325
+6300,5325
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="5250,3000
+6300,3000
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="5250,450
+5250,6075
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2325,1500
+2850,1500
+2925,1275
+3075,1725
+3150,1500
+3600,1500
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Text -->
+<text xml:space="preserve" x="3825" y="750" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">NAS</text>
+<!-- Text -->
+<text xml:space="preserve" x="6225" y="975" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">Internet</text>
+<!-- Text -->
+<text xml:space="preserve" x="6150" y="4275" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">Backup</text>
+<!-- Text -->
+<text xml:space="preserve" x="6150" y="1950" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">Primary</text>
+<!-- Line: box -->
+<rect x="652" y="1082" width="391" height="39" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#808080;
+"/>
+<!-- Line: box -->
+<rect x="613" y="1121" width="469" height="39" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#808080;
+"/>
+<!-- Line: box -->
+<rect x="378" y="300" width="939" height="782" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#e0e0e0;
+"/>
+<!-- Line -->
+<polygon points="417,1433
+1278,1433
+1395,1629
+1395,1668
+300,1668
+300,1629
+417,1433
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="398" y="1374" width="117" height="20" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="1180" y="1374" width="117" height="20" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="398" y="1160" width="899" height="216" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#e0e0e0;
+"/>
+<!-- Line -->
+<polyline points="3600,999
+4810,999
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3600,990
+4810,990
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3600,1007
+4810,1007
+" style="stroke:#c7c7c7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3600,1652
+4810,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3600,1642
+4810,1642
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3600,1659
+4810,1659
+" style="stroke:#c7c7c7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3901,995
+3901,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3910,995
+3910,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3893,995
+3893,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3831,995
+3831,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3840,995
+3840,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3823,995
+3823,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4129,995
+4129,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4139,995
+4139,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4122,995
+4122,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4060,995
+4060,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4069,995
+4069,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4052,995
+4052,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4351,995
+4351,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4361,995
+4361,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4343,995
+4343,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4281,995
+4281,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4290,995
+4290,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4274,995
+4274,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4576,995
+4576,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4585,995
+4585,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4569,995
+4569,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4506,995
+4506,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4515,995
+4515,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4498,995
+4498,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4781,995
+4781,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4789,995
+4789,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4773,995
+4773,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4711,995
+4711,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4720,995
+4720,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4702,995
+4702,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4131,995
+4131,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="6300" y="2100" width="900" height="1569" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Line: box -->
+<rect x="6300" y="4425" width="900" height="1569" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polyline points="300,1629
+300,1668
+1395,1668
+1395,1629
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polygon points="456,1473
+378,1590
+1082,1590
+1043,1473
+456,1473
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#ffffff;
+"/>
+<!-- Line -->
+<polygon points="1239,1473
+1082,1473
+1121,1590
+1317,1590
+1239,1473
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#ffffff;
+"/>
+<!-- Line -->
+<polyline points="976,1240
+976,1220
+1061,1220
+1061,1201
+1166,1201
+" style="stroke:#808080;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1061,1279
+1061,1240
+1166,1240
+" style="stroke:#808080;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1166,1220
+1250,1220
+" style="stroke:#808080;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1166,1201
+1166,1220
+" style="stroke:#ffffff;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="976,1240
+1061,1240
+" style="stroke:#ffffff;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1061,1279
+1166,1279
+1166,1240
+1250,1240
+1250,1220
+" style="stroke:#ffffff;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1187,1279
+1229,1279
+1229,1259
+" style="stroke:#808080;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1187,1279
+1187,1259
+1229,1259
+" style="stroke:#ffffff;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="2701" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="2668" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="2801" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="2768" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="2901" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="2868" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="3001" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="2968" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="3101" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="3068" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="3203" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="3168" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="3301" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="3269" width="700" height="32" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="3402" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="3369" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="2468" width="700" height="32" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="2433" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="2367" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="2333" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="2267" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="2233" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6300" y="3536" width="900" height="133" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line -->
+<polyline points="6300,2566
+7200,2566
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5026" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="4993" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5126" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5093" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5226" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5193" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5326" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5293" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5426" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5393" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5528" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5493" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5626" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5594" width="700" height="32" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5727" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="5694" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="4793" width="700" height="32" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="4758" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="4692" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="4658" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="4592" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="6400" y="4558" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="6300" y="5861" width="900" height="133" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line -->
+<polyline points="6300,4891
+7200,4891
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polygon points="456,1004
+457,1003
+464,996
+476,984
+488,972
+495,965
+496,964
+496,961
+496,955
+496,943
+496,925
+496,900
+496,869
+496,831
+496,787
+496,740
+496,690
+496,641
+496,594
+496,550
+496,512
+496,481
+496,456
+496,438
+496,426
+496,420
+496,417
+495,416
+488,409
+476,397
+464,386
+457,379
+456,378
+456,381
+456,386
+456,397
+456,413
+456,436
+456,465
+456,501
+456,543
+456,589
+456,639
+456,691
+456,743
+456,793
+456,839
+456,881
+456,917
+456,946
+456,969
+456,985
+456,996
+456,1001
+456,1004
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polygon points="1239,1004
+1238,1003
+1231,996
+1219,984
+1207,972
+1200,965
+1199,964
+1199,961
+1199,955
+1199,943
+1199,925
+1199,900
+1199,869
+1199,831
+1199,787
+1199,740
+1199,690
+1199,641
+1199,594
+1199,550
+1199,512
+1199,481
+1199,456
+1199,438
+1199,426
+1199,420
+1199,417
+1200,416
+1207,409
+1219,397
+1231,386
+1238,379
+1239,378
+1239,381
+1239,386
+1239,397
+1239,413
+1239,436
+1239,465
+1239,501
+1239,543
+1239,589
+1239,639
+1239,691
+1239,743
+1239,793
+1239,839
+1239,881
+1239,917
+1239,946
+1239,969
+1239,985
+1239,996
+1239,1001
+1239,1004
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polygon points="496,417
+498,417
+502,417
+508,416
+518,415
+532,414
+548,413
+567,412
+587,410
+609,409
+633,408
+658,406
+685,405
+714,404
+745,403
+779,403
+816,402
+855,402
+894,402
+930,403
+963,403
+994,404
+1022,405
+1047,406
+1071,408
+1094,409
+1114,410
+1134,412
+1151,413
+1166,414
+1178,415
+1188,416
+1194,417
+1197,417
+1199,417
+1200,416
+1207,409
+1219,397
+1231,386
+1238,379
+1239,378
+1236,378
+1231,378
+1220,378
+1204,378
+1181,378
+1151,378
+1114,378
+1070,378
+1020,378
+966,378
+907,378
+847,378
+788,378
+729,378
+675,378
+625,378
+581,378
+544,378
+514,378
+491,378
+475,378
+464,378
+459,378
+456,378
+457,379
+464,386
+476,398
+488,409
+495,416
+496,417
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#808080;
+"/>
+<!-- Line -->
+<polygon points="496,964
+498,964
+502,964
+508,965
+518,966
+532,967
+548,968
+567,970
+587,971
+609,972
+633,974
+658,975
+685,976
+714,978
+745,979
+779,979
+816,980
+855,980
+894,980
+930,979
+963,979
+994,978
+1022,976
+1047,975
+1071,974
+1094,972
+1114,971
+1134,970
+1151,968
+1166,967
+1178,966
+1188,965
+1194,964
+1197,964
+1199,964
+1200,965
+1207,972
+1219,984
+1231,996
+1238,1003
+1239,1004
+1236,1004
+1231,1004
+1220,1004
+1204,1004
+1181,1004
+1151,1004
+1114,1004
+1070,1004
+1020,1004
+966,1004
+907,1004
+847,1004
+788,1004
+729,1004
+675,1004
+625,1004
+581,1004
+544,1004
+514,1004
+491,1004
+475,1004
+464,1004
+459,1004
+456,1004
+457,1003
+464,996
+476,984
+488,972
+495,965
+496,964
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#ffffff;
+"/>
+<!-- Line: box -->
+<rect x="378" y="1590" width="704" height="14" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#808080;
+"/>
+<!-- Line -->
+<polygon points="442,1473
+378,1590
+496,1590
+512,1551
+485,1551
+500,1512
+475,1512
+496,1473
+442,1473
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polygon points="1082,1590
+965,1590
+965,1550
+990,1551
+986,1512
+1004,1512
+1010,1512
+1002,1473
+1050,1473
+1082,1590
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polygon points="1317,1590
+1281,1590
+1239,1496
+1089,1496
+1082,1473
+1255,1473
+1317,1590
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#c0c0c0;
+"/>
+<!-- Line: box -->
+<rect x="1121" y="1590" width="196" height="13" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#808080;
+"/>
+<!-- Line -->
+<polygon points="1121,1590
+1121,1604
+1081,1484
+1082,1473
+1121,1590
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#808080;
+"/>
+<!-- Line -->
+<polyline points="3645,1170
+3645,1260
+3738,1260
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#c7c7c7;
+"/>
+<!-- Line -->
+<polyline points="3640,1170
+3735,1170
+3735,1259
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#c7c7c7;
+"/>
+<!-- Line -->
+<polyline points="3649,1185
+3730,1186
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:round; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line -->
+<polyline points="3649,1222
+3730,1222
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:round; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line -->
+<polyline points="4200,1950
+5100,1950
+5100,5100
+5910,5100
+" style="stroke:#0000b0;stroke-width:15;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 5100 5100 - 6180 5100-->
+<polygon points="5908 5160
+6148 5100
+5908 5040
+5908 5160
+
+" style="stroke:#0000b0;stroke-width:15;stroke-miterlimit:8;
+fill:#0000b0;"/>
+<!-- Line -->
+<polyline points="6000,3750
+7500,1800
+" style="stroke:#ff0000;stroke-width:30;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="6000,1800
+7500,3750
+" style="stroke:#ff0000;stroke-width:30;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="3645" y="1193" width="81" height="21" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#000000;
+"/>
+</g>
+</svg>
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/peap_packet.svg freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/peap_packet.svg
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/peap_packet.svg	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/peap_packet.svg	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,72 @@
+<?xml version="1.0" standalone="no"?>
+<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
+"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
+<!-- Creator: fig2dev Version 3.2 Patchlevel 5e -->
+<!-- CreationDate: Mon Aug 11 20:51:55 2014 -->
+<!-- Magnification: 1.000 -->
+<svg	xmlns="http://www.w3.org/2000/svg"
+	xmlns:xlink="http://www.w3.org/1999/xlink"
+	width="4.0in" height="3.3in"
+	viewBox="1188 288 4824 3924">
+<g style="stroke-width:.025in; fill:none">
+<!-- Line -->
+<polyline points="1200,900
+6000,900
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1200,2100
+6000,2100
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1200,2700
+6000,2700
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1200,3300
+6000,3300
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1200,1500
+6000,1500
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3600,3300
+3600,4200
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="1200" y="300" width="4800" height="3900" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Text -->
+<text xml:space="preserve" x="4125" y="3675" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">EAP-MSCHAPv2</text>
+<!-- Text -->
+<text xml:space="preserve" x="4125" y="3900" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">(Microsoft)</text>
+<!-- Text -->
+<text xml:space="preserve" x="2025" y="3675" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">EAP-GTC</text>
+<!-- Text -->
+<text xml:space="preserve" x="2025" y="3900" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">(Cisco)</text>
+<!-- Text -->
+<text xml:space="preserve" x="1575" y="675" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">Carrier Protocol (PPP, EAPOL, RADIUS, Diameter, etc</text>
+<!-- Text -->
+<text xml:space="preserve" x="3300" y="1275" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">EAP</text>
+<!-- Text -->
+<text xml:space="preserve" x="3075" y="1875" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">EAP-PEAP</text>
+<!-- Text -->
+<text xml:space="preserve" x="2700" y="2475" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">TLS (with modifications)</text>
+<!-- Text -->
+<text xml:space="preserve" x="2700" y="3075" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">EAP (with modifications)</text>
+</g>
+</svg>
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/proxy.svg freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/proxy.svg
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/proxy.svg	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/proxy.svg	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,1231 @@
+<?xml version="1.0" standalone="no"?>
+<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
+"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
+<!-- Creator: fig2dev Version 3.2 Patchlevel 5e -->
+<!-- CreationDate: Mon Aug 11 20:51:55 2014 -->
+<!-- Magnification: 1.000 -->
+<svg	xmlns="http://www.w3.org/2000/svg"
+	xmlns:xlink="http://www.w3.org/1999/xlink"
+	width="6.4in" height="3.0in"
+	viewBox="288 288 7689 3624">
+<g style="stroke-width:.025in; fill:none">
+<!-- Line -->
+<polyline points="675,1950
+1725,1950
+1725,3225
+2310,3225
+" style="stroke:#0000ff;stroke-width:15;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 1725 3225 - 2580 3225-->
+<polygon points="2308 3285
+2548 3225
+2308 3165
+2308 3285
+
+" style="stroke:#0000ff;stroke-width:15;stroke-miterlimit:8;
+fill:#0000ff;"/>
+<!-- Line -->
+<polyline points="4800,900
+6300,900
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="5550,3000
+6300,3000
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="6300,1350
+6750,1350
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2550,2625
+2100,2625
+2100,1125
+6150,1125
+6150,2550
+5939,2550
+" style="stroke:#0000ff;stroke-width:15;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 6150 2550 - 5670 2550-->
+<polygon points="5942 2490
+5702 2550
+5942 2610
+5942 2490
+
+" style="stroke:#0000ff;stroke-width:15;stroke-miterlimit:8;
+fill:#0000ff;"/>
+<!-- Line: box -->
+<rect x="300" y="900" width="1215" height="900" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#e7e7e7;
+"/>
+<!-- Line: box -->
+<rect x="6750" y="900" width="1215" height="900" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#e7e7e7;
+"/>
+<!-- Line -->
+<polyline points="1500,1350
+1950,1350
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1950,375
+1950,3900
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1950,3000
+2625,3000
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1950,900
+3300,900
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="6300,300
+6300,3825
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polygon points="3825,375
+3860,368
+3890,361
+3911,353
+3923,347
+3930,341
+3931,335
+3931,330
+3931,325
+3933,319
+3940,314
+3954,309
+3977,305
+4010,301
+4050,300
+4084,301
+4116,303
+4144,306
+4168,310
+4187,314
+4202,318
+4214,323
+4223,327
+4231,331
+4240,336
+4249,340
+4261,345
+4277,350
+4297,355
+4322,360
+4353,365
+4388,370
+4425,375
+4466,379
+4502,381
+4531,381
+4553,380
+4569,377
+4580,373
+4588,368
+4594,363
+4599,357
+4606,353
+4616,350
+4629,349
+4647,350
+4670,355
+4696,363
+4725,375
+4751,390
+4773,406
+4789,421
+4800,434
+4806,445
+4808,454
+4808,462
+4806,469
+4805,476
+4804,485
+4806,495
+4811,509
+4820,526
+4834,547
+4853,572
+4875,600
+4899,628
+4921,652
+4941,671
+4959,686
+4973,695
+4986,701
+4996,704
+5006,706
+5016,708
+5026,712
+5037,718
+5048,729
+5062,744
+5075,766
+5089,793
+5100,825
+5107,854
+5110,882
+5112,906
+5112,926
+5112,942
+5111,955
+5110,966
+5108,974
+5106,981
+5104,989
+5101,997
+5097,1006
+5091,1019
+5083,1034
+5073,1053
+5060,1075
+5044,1100
+5025,1125
+5003,1149
+4982,1169
+4961,1185
+4944,1197
+4930,1205
+4918,1210
+4909,1212
+4901,1213
+4894,1212
+4886,1212
+4878,1212
+4867,1214
+4854,1217
+4836,1223
+4814,1232
+4788,1244
+4758,1259
+4725,1275
+4692,1291
+4662,1307
+4637,1320
+4617,1331
+4602,1340
+4591,1347
+4584,1353
+4579,1358
+4575,1363
+4571,1367
+4566,1371
+4559,1376
+4548,1382
+4533,1389
+4513,1397
+4488,1406
+4458,1416
+4425,1425
+4388,1433
+4356,1439
+4329,1443
+4309,1445
+4295,1446
+4286,1446
+4279,1445
+4275,1444
+4271,1442
+4264,1441
+4255,1439
+4241,1437
+4221,1435
+4194,1432
+4162,1429
+4125,1425
+4088,1420
+4056,1414
+4030,1409
+4010,1404
+3997,1399
+3989,1395
+3984,1391
+3981,1388
+3978,1384
+3973,1380
+3964,1376
+3950,1371
+3930,1366
+3901,1361
+3866,1355
+3825,1350
+3788,1346
+3753,1344
+3722,1343
+3697,1344
+3677,1346
+3661,1349
+3649,1353
+3640,1358
+3631,1363
+3623,1367
+3614,1371
+3602,1374
+3587,1376
+3568,1376
+3544,1374
+3516,1369
+3484,1361
+3450,1350
+3418,1336
+3390,1322
+3366,1308
+3347,1296
+3332,1285
+3320,1276
+3312,1268
+3305,1261
+3300,1255
+3295,1248
+3289,1241
+3283,1232
+3276,1221
+3267,1207
+3257,1190
+3246,1171
+3235,1149
+3225,1125
+3218,1095
+3216,1070
+3218,1051
+3224,1039
+3232,1032
+3242,1029
+3252,1028
+3262,1026
+3273,1023
+3282,1015
+3291,1002
+3298,981
+3302,952
+3304,918
+3303,886
+3300,856
+3296,831
+3290,809
+3283,792
+3276,779
+3268,768
+3261,759
+3253,749
+3246,738
+3240,726
+3234,710
+3229,691
+3227,669
+3226,644
+3229,618
+3236,593
+3245,573
+3254,561
+3262,555
+3270,553
+3276,554
+3283,558
+3290,561
+3298,563
+3307,563
+3320,560
+3335,552
+3354,540
+3375,525
+3396,509
+3413,494
+3426,482
+3434,472
+3438,464
+3440,458
+3439,453
+3440,448
+3442,442
+3447,435
+3458,426
+3475,416
+3499,404
+3529,393
+3558,385
+3585,379
+3608,375
+3627,373
+3642,373
+3654,374
+3663,377
+3671,379
+3679,382
+3689,384
+3701,386
+3717,387
+3737,386
+3763,384
+3793,380
+3825,375
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#ffffff;
+"/>
+<!-- Text -->
+<text xml:space="preserve" x="525" y="750" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">NAS</text>
+<!-- Text -->
+<text xml:space="preserve" x="6975" y="750" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">NAS</text>
+<!-- Text -->
+<text xml:space="preserve" x="4725" y="1950" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">Home</text>
+<!-- Text -->
+<text xml:space="preserve" x="2625" y="1950" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">Proxy</text>
+<!-- Line -->
+<polyline points="300,999
+1510,999
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="300,990
+1510,990
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="300,1007
+1510,1007
+" style="stroke:#c7c7c7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="300,1652
+1510,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="300,1642
+1510,1642
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="300,1659
+1510,1659
+" style="stroke:#c7c7c7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="601,995
+601,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="610,995
+610,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="593,995
+593,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="531,995
+531,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="540,995
+540,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="523,995
+523,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="829,995
+829,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="839,995
+839,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="822,995
+822,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="760,995
+760,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="769,995
+769,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="752,995
+752,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1051,995
+1051,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1061,995
+1061,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1043,995
+1043,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="981,995
+981,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="990,995
+990,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="974,995
+974,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1276,995
+1276,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1285,995
+1285,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1269,995
+1269,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1206,995
+1206,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1215,995
+1215,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1198,995
+1198,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1481,995
+1481,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1489,995
+1489,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1473,995
+1473,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1411,995
+1411,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1420,995
+1420,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1402,995
+1402,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="831,995
+831,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="2625" y="2100" width="900" height="1569" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polyline points="6750,999
+7960,999
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="6750,990
+7960,990
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="6750,1007
+7960,1007
+" style="stroke:#c7c7c7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="6750,1652
+7960,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="6750,1642
+7960,1642
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="6750,1659
+7960,1659
+" style="stroke:#c7c7c7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="7051,995
+7051,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="7060,995
+7060,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="7043,995
+7043,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="6981,995
+6981,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="6990,995
+6990,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="6973,995
+6973,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="7279,995
+7279,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="7289,995
+7289,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="7272,995
+7272,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="7210,995
+7210,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="7219,995
+7219,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="7202,995
+7202,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="7501,995
+7501,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="7511,995
+7511,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="7493,995
+7493,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="7431,995
+7431,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="7440,995
+7440,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="7424,995
+7424,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="7726,995
+7726,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="7735,995
+7735,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="7719,995
+7719,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="7656,995
+7656,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="7665,995
+7665,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="7648,995
+7648,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="7931,995
+7931,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="7939,995
+7939,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="7923,995
+7923,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="7861,995
+7861,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="7870,995
+7870,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="7852,995
+7852,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="7281,995
+7281,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="4725" y="2100" width="900" height="1569" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Text -->
+<text xml:space="preserve" x="3600" y="975" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">Internet</text>
+<!-- Line: box -->
+<rect x="2725" y="2701" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="2668" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="2801" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="2768" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="2901" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="2868" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="3001" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="2968" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="3101" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="3068" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="3203" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="3168" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="3301" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="3269" width="700" height="32" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="3402" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="3369" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="2468" width="700" height="32" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="2433" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="2367" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="2333" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="2267" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="2233" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="2625" y="3536" width="900" height="133" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line -->
+<polyline points="2625,2566
+3525,2566
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Line: box -->
+<rect x="4825" y="2701" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="4825" y="2668" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="4825" y="2801" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="4825" y="2768" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="4825" y="2901" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="4825" y="2868" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="4825" y="3001" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="4825" y="2968" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="4825" y="3101" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="4825" y="3068" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="4825" y="3203" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="4825" y="3168" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="4825" y="3301" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="4825" y="3269" width="700" height="32" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="4825" y="3402" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="4825" y="3369" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="4825" y="2468" width="700" height="32" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="4825" y="2433" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="4825" y="2367" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="4825" y="2333" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="4825" y="2267" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="4825" y="2233" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="4725" y="3536" width="900" height="133" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line -->
+<polyline points="4725,2566
+5625,2566
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polyline points="345,1170
+345,1260
+438,1260
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#c7c7c7;
+"/>
+<!-- Line -->
+<polyline points="340,1170
+435,1170
+435,1259
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#c7c7c7;
+"/>
+<!-- Line -->
+<polyline points="6795,1170
+6795,1260
+6888,1260
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#c7c7c7;
+"/>
+<!-- Line -->
+<polyline points="6790,1170
+6885,1170
+6885,1259
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#c7c7c7;
+"/>
+<!-- Line -->
+<polyline points="349,1185
+430,1186
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:round; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line -->
+<polyline points="349,1222
+430,1222
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:round; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line -->
+<polyline points="6799,1185
+6880,1186
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:round; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line -->
+<polyline points="6799,1222
+6880,1222
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:round; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line -->
+<polyline points="2100,2625
+2100,2039
+" style="stroke:#0000ff;stroke-width:15;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 2100 2625 - 2100 1770-->
+<polygon points="2160 2042
+2100 1802
+2040 2042
+2160 2042
+
+" style="stroke:#0000ff;stroke-width:15;stroke-miterlimit:8;
+fill:#0000ff;"/>
+<!-- Line: box -->
+<rect x="345" y="1193" width="81" height="21" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line: box -->
+<rect x="6795" y="1193" width="81" height="21" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#000000;
+"/>
+</g>
+</svg>
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/proxy_backup_server.svg freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/proxy_backup_server.svg
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/proxy_backup_server.svg	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/proxy_backup_server.svg	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,1135 @@
+<?xml version="1.0" standalone="no"?>
+<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
+"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
+<!-- Creator: fig2dev Version 3.2 Patchlevel 5e -->
+<!-- CreationDate: Mon Aug 11 20:51:55 2014 -->
+<!-- Magnification: 1.000 -->
+<svg	xmlns="http://www.w3.org/2000/svg"
+	xmlns:xlink="http://www.w3.org/1999/xlink"
+	width="6.5in" height="3.0in"
+	viewBox="288 288 7855 3624">
+<g style="stroke-width:.025in; fill:none">
+<!-- Line -->
+<polyline points="675,1950
+1725,1950
+1725,3225
+2310,3225
+" style="stroke:#0000ff;stroke-width:15;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 1725 3225 - 2580 3225-->
+<polygon points="2308 3285
+2548 3225
+2308 3165
+2308 3285
+
+" style="stroke:#0000ff;stroke-width:15;stroke-miterlimit:8;
+fill:#0000ff;"/>
+<!-- Line -->
+<polyline points="2550,2625
+2100,2625
+2100,1125
+6225,1125
+6225,2550
+6014,2550
+" style="stroke:#0000ff;stroke-width:15;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 6225 2550 - 5745 2550-->
+<polygon points="6017 2490
+5777 2550
+6017 2610
+6017 2490
+
+" style="stroke:#0000ff;stroke-width:15;stroke-miterlimit:8;
+fill:#0000ff;"/>
+<!-- Line -->
+<polyline points="2100,2175
+2100,675
+6750,675
+6750,1125
+6960,1125
+" style="stroke:#0000ff;stroke-width:15;
+stroke-linejoin:miter; stroke-linecap:butt;
+stroke-dasharray:60 60;"/>
+<!-- Arrowhead on XXXpoint 6750 1125 - 7230 1125-->
+<polygon points="6958 1185
+7198 1125
+6958 1065
+6958 1185
+
+" style="stroke:#0000ff;stroke-width:15;stroke-miterlimit:8;
+fill:#0000ff;"/>
+<!-- Line -->
+<polyline points="4875,900
+6375,900
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="5625,3000
+6375,3000
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="6375,1350
+7050,1350
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="300" y="900" width="1215" height="900" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#e7e7e7;
+"/>
+<!-- Line -->
+<polyline points="1500,1350
+1950,1350
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1950,375
+1950,3900
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1950,3000
+2625,3000
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1950,900
+3300,900
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="6375,300
+6375,3825
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polygon points="3825,375
+3860,368
+3890,361
+3911,353
+3923,347
+3930,341
+3931,335
+3931,330
+3931,325
+3933,319
+3940,314
+3954,309
+3977,305
+4010,301
+4050,300
+4084,301
+4116,303
+4144,306
+4168,310
+4187,314
+4202,318
+4214,323
+4223,327
+4231,331
+4240,336
+4249,340
+4261,345
+4277,350
+4297,355
+4322,360
+4353,365
+4388,370
+4425,375
+4466,379
+4502,381
+4531,381
+4553,380
+4569,377
+4580,373
+4588,368
+4594,363
+4599,357
+4606,353
+4616,350
+4629,349
+4647,350
+4670,355
+4696,363
+4725,375
+4751,390
+4773,406
+4789,421
+4800,434
+4806,445
+4808,454
+4808,462
+4806,469
+4805,476
+4804,485
+4806,495
+4811,509
+4820,526
+4834,547
+4853,572
+4875,600
+4899,628
+4921,652
+4941,671
+4959,686
+4973,695
+4986,701
+4996,704
+5006,706
+5016,708
+5026,712
+5037,718
+5048,729
+5062,744
+5075,766
+5089,793
+5100,825
+5107,854
+5110,882
+5112,906
+5112,926
+5112,942
+5111,955
+5110,966
+5108,974
+5106,981
+5104,989
+5101,997
+5097,1006
+5091,1019
+5083,1034
+5073,1053
+5060,1075
+5044,1100
+5025,1125
+5003,1149
+4982,1169
+4961,1185
+4944,1197
+4930,1205
+4918,1210
+4909,1212
+4901,1213
+4894,1212
+4886,1212
+4878,1212
+4867,1214
+4854,1217
+4836,1223
+4814,1232
+4788,1244
+4758,1259
+4725,1275
+4692,1291
+4662,1307
+4637,1320
+4617,1331
+4602,1340
+4591,1347
+4584,1353
+4579,1358
+4575,1363
+4571,1367
+4566,1371
+4559,1376
+4548,1382
+4533,1389
+4513,1397
+4488,1406
+4458,1416
+4425,1425
+4388,1433
+4356,1439
+4329,1443
+4309,1445
+4295,1446
+4286,1446
+4279,1445
+4275,1444
+4271,1442
+4264,1441
+4255,1439
+4241,1437
+4221,1435
+4194,1432
+4162,1429
+4125,1425
+4088,1420
+4056,1414
+4030,1409
+4010,1404
+3997,1399
+3989,1395
+3984,1391
+3981,1388
+3978,1384
+3973,1380
+3964,1376
+3950,1371
+3930,1366
+3901,1361
+3866,1355
+3825,1350
+3788,1346
+3753,1344
+3722,1343
+3697,1344
+3677,1346
+3661,1349
+3649,1353
+3640,1358
+3631,1363
+3623,1367
+3614,1371
+3602,1374
+3587,1376
+3568,1376
+3544,1374
+3516,1369
+3484,1361
+3450,1350
+3418,1336
+3390,1322
+3366,1308
+3347,1296
+3332,1285
+3320,1276
+3312,1268
+3305,1261
+3300,1255
+3295,1248
+3289,1241
+3283,1232
+3276,1221
+3267,1207
+3257,1190
+3246,1171
+3235,1149
+3225,1125
+3218,1095
+3216,1070
+3218,1051
+3224,1039
+3232,1032
+3242,1029
+3252,1028
+3262,1026
+3273,1023
+3282,1015
+3291,1002
+3298,981
+3302,952
+3304,918
+3303,886
+3300,856
+3296,831
+3290,809
+3283,792
+3276,779
+3268,768
+3261,759
+3253,749
+3246,738
+3240,726
+3234,710
+3229,691
+3227,669
+3226,644
+3229,618
+3236,593
+3245,573
+3254,561
+3262,555
+3270,553
+3276,554
+3283,558
+3290,561
+3298,563
+3307,563
+3320,560
+3335,552
+3354,540
+3375,525
+3396,509
+3413,494
+3426,482
+3434,472
+3438,464
+3440,458
+3439,453
+3440,448
+3442,442
+3447,435
+3458,426
+3475,416
+3499,404
+3529,393
+3558,385
+3585,379
+3608,375
+3627,373
+3642,373
+3654,374
+3663,377
+3671,379
+3679,382
+3689,384
+3701,386
+3717,387
+3737,386
+3763,384
+3793,380
+3825,375
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#ffffff;
+"/>
+<!-- Text -->
+<text xml:space="preserve" x="525" y="750" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">NAS</text>
+<!-- Text -->
+<text xml:space="preserve" x="2625" y="1950" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">Proxy</text>
+<!-- Text -->
+<text xml:space="preserve" x="4650" y="1950" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">Primary</text>
+<!-- Text -->
+<text xml:space="preserve" x="6975" y="600" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">Backup</text>
+<!-- Line -->
+<polyline points="300,999
+1510,999
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="300,990
+1510,990
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="300,1007
+1510,1007
+" style="stroke:#c7c7c7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="300,1652
+1510,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="300,1642
+1510,1642
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="300,1659
+1510,1659
+" style="stroke:#c7c7c7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="601,995
+601,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="610,995
+610,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="593,995
+593,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="531,995
+531,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="540,995
+540,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="523,995
+523,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="829,995
+829,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="839,995
+839,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="822,995
+822,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="760,995
+760,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="769,995
+769,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="752,995
+752,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1051,995
+1051,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1061,995
+1061,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1043,995
+1043,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="981,995
+981,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="990,995
+990,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="974,995
+974,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1276,995
+1276,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1285,995
+1285,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1269,995
+1269,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1206,995
+1206,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1215,995
+1215,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1198,995
+1198,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1481,995
+1481,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1489,995
+1489,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1473,995
+1473,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1411,995
+1411,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1420,995
+1420,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1402,995
+1402,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="831,995
+831,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="2625" y="2100" width="900" height="1569" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Line: box -->
+<rect x="4800" y="2100" width="900" height="1569" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Line: box -->
+<rect x="7050" y="750" width="900" height="1569" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Text -->
+<text xml:space="preserve" x="3600" y="975" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">Internet</text>
+<!-- Line: box -->
+<rect x="2725" y="2701" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="2668" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="2801" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="2768" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="2901" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="2868" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="3001" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="2968" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="3101" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="3068" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="3203" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="3168" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="3301" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="3269" width="700" height="32" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="3402" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="3369" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="2468" width="700" height="32" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="2433" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="2367" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="2333" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="2267" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="2233" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="2625" y="3536" width="900" height="133" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line -->
+<polyline points="2625,2566
+3525,2566
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Line: box -->
+<rect x="4900" y="2701" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="4900" y="2668" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="4900" y="2801" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="4900" y="2768" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="4900" y="2901" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="4900" y="2868" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="4900" y="3001" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="4900" y="2968" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="4900" y="3101" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="4900" y="3068" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="4900" y="3203" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="4900" y="3168" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="4900" y="3301" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="4900" y="3269" width="700" height="32" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="4900" y="3402" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="4900" y="3369" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="4900" y="2468" width="700" height="32" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="4900" y="2433" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="4900" y="2367" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="4900" y="2333" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="4900" y="2267" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="4900" y="2233" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="4800" y="3536" width="900" height="133" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line -->
+<polyline points="4800,2566
+5700,2566
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Line: box -->
+<rect x="7150" y="1351" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="7150" y="1318" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="7150" y="1451" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="7150" y="1418" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="7150" y="1551" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="7150" y="1518" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="7150" y="1651" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="7150" y="1618" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="7150" y="1751" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="7150" y="1718" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="7150" y="1853" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="7150" y="1818" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="7150" y="1951" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="7150" y="1919" width="700" height="32" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="7150" y="2052" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="7150" y="2019" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="7150" y="1118" width="700" height="32" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="7150" y="1083" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="7150" y="1017" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="7150" y="983" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="7150" y="917" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="7150" y="883" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="7050" y="2186" width="900" height="133" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line -->
+<polyline points="7050,1216
+7950,1216
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polyline points="345,1170
+345,1260
+438,1260
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#c7c7c7;
+"/>
+<!-- Line -->
+<polyline points="340,1170
+435,1170
+435,1259
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#c7c7c7;
+"/>
+<!-- Line -->
+<polyline points="349,1185
+430,1186
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:round; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line -->
+<polyline points="349,1222
+430,1222
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:round; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line -->
+<polyline points="2100,2625
+2100,2039
+" style="stroke:#0000ff;stroke-width:15;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 2100 2625 - 2100 1770-->
+<polygon points="2160 2042
+2100 1802
+2040 2042
+2160 2042
+
+" style="stroke:#0000ff;stroke-width:15;stroke-miterlimit:8;
+fill:#0000ff;"/>
+<!-- Line: box -->
+<rect x="345" y="1193" width="81" height="21" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#000000;
+"/>
+</g>
+</svg>
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/proxy_load_balance.svg freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/proxy_load_balance.svg
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/proxy_load_balance.svg	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/proxy_load_balance.svg	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,1311 @@
+<?xml version="1.0" standalone="no"?>
+<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
+"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
+<!-- Creator: fig2dev Version 3.2 Patchlevel 5e -->
+<!-- CreationDate: Mon Aug 11 20:51:55 2014 -->
+<!-- Magnification: 1.000 -->
+<svg	xmlns="http://www.w3.org/2000/svg"
+	xmlns:xlink="http://www.w3.org/1999/xlink"
+	width="6.5in" height="3.7in"
+	viewBox="288 288 7759 4443">
+<g style="stroke-width:.025in; fill:none">
+<!-- Line -->
+<polyline points="675,1950
+1725,1950
+1725,3225
+2310,3225
+" style="stroke:#0000ff;stroke-width:15;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 1725 3225 - 2580 3225-->
+<polygon points="2308 3285
+2548 3225
+2308 3165
+2308 3285
+
+" style="stroke:#0000ff;stroke-width:15;stroke-miterlimit:8;
+fill:#0000ff;"/>
+<!-- Line -->
+<polyline points="2550,2625
+2100,2625
+2100,1125
+6300,1125
+6300,2550
+" style="stroke:#0000ff;stroke-width:30;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4875,900
+6450,900
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="5625,3000
+6375,3000
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="6450,1350
+7125,1350
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="6450,3900
+7125,3900
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="300" y="900" width="1215" height="900" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#e7e7e7;
+"/>
+<!-- Line -->
+<polyline points="1500,1350
+1950,1350
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1950,375
+1950,3900
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1950,3000
+2625,3000
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1950,900
+3300,900
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="6450,300
+6450,4200
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polygon points="3825,375
+3860,368
+3890,361
+3911,353
+3923,347
+3930,341
+3931,335
+3931,330
+3931,325
+3933,319
+3940,314
+3954,309
+3977,305
+4010,301
+4050,300
+4084,301
+4116,303
+4144,306
+4168,310
+4187,314
+4202,318
+4214,323
+4223,327
+4231,331
+4240,336
+4249,340
+4261,345
+4277,350
+4297,355
+4322,360
+4353,365
+4388,370
+4425,375
+4466,379
+4502,381
+4531,381
+4553,380
+4569,377
+4580,373
+4588,368
+4594,363
+4599,357
+4606,353
+4616,350
+4629,349
+4647,350
+4670,355
+4696,363
+4725,375
+4751,390
+4773,406
+4789,421
+4800,434
+4806,445
+4808,454
+4808,462
+4806,469
+4805,476
+4804,485
+4806,495
+4811,509
+4820,526
+4834,547
+4853,572
+4875,600
+4899,628
+4921,652
+4941,671
+4959,686
+4973,695
+4986,701
+4996,704
+5006,706
+5016,708
+5026,712
+5037,718
+5048,729
+5062,744
+5075,766
+5089,793
+5100,825
+5107,854
+5110,882
+5112,906
+5112,926
+5112,942
+5111,955
+5110,966
+5108,974
+5106,981
+5104,989
+5101,997
+5097,1006
+5091,1019
+5083,1034
+5073,1053
+5060,1075
+5044,1100
+5025,1125
+5003,1149
+4982,1169
+4961,1185
+4944,1197
+4930,1205
+4918,1210
+4909,1212
+4901,1213
+4894,1212
+4886,1212
+4878,1212
+4867,1214
+4854,1217
+4836,1223
+4814,1232
+4788,1244
+4758,1259
+4725,1275
+4692,1291
+4662,1307
+4637,1320
+4617,1331
+4602,1340
+4591,1347
+4584,1353
+4579,1358
+4575,1363
+4571,1367
+4566,1371
+4559,1376
+4548,1382
+4533,1389
+4513,1397
+4488,1406
+4458,1416
+4425,1425
+4388,1433
+4356,1439
+4329,1443
+4309,1445
+4295,1446
+4286,1446
+4279,1445
+4275,1444
+4271,1442
+4264,1441
+4255,1439
+4241,1437
+4221,1435
+4194,1432
+4162,1429
+4125,1425
+4088,1420
+4056,1414
+4030,1409
+4010,1404
+3997,1399
+3989,1395
+3984,1391
+3981,1388
+3978,1384
+3973,1380
+3964,1376
+3950,1371
+3930,1366
+3901,1361
+3866,1355
+3825,1350
+3788,1346
+3753,1344
+3722,1343
+3697,1344
+3677,1346
+3661,1349
+3649,1353
+3640,1358
+3631,1363
+3623,1367
+3614,1371
+3602,1374
+3587,1376
+3568,1376
+3544,1374
+3516,1369
+3484,1361
+3450,1350
+3418,1336
+3390,1322
+3366,1308
+3347,1296
+3332,1285
+3320,1276
+3312,1268
+3305,1261
+3300,1255
+3295,1248
+3289,1241
+3283,1232
+3276,1221
+3267,1207
+3257,1190
+3246,1171
+3235,1149
+3225,1125
+3218,1095
+3216,1070
+3218,1051
+3224,1039
+3232,1032
+3242,1029
+3252,1028
+3262,1026
+3273,1023
+3282,1015
+3291,1002
+3298,981
+3302,952
+3304,918
+3303,886
+3300,856
+3296,831
+3290,809
+3283,792
+3276,779
+3268,768
+3261,759
+3253,749
+3246,738
+3240,726
+3234,710
+3229,691
+3227,669
+3226,644
+3229,618
+3236,593
+3245,573
+3254,561
+3262,555
+3270,553
+3276,554
+3283,558
+3290,561
+3298,563
+3307,563
+3320,560
+3335,552
+3354,540
+3375,525
+3396,509
+3413,494
+3426,482
+3434,472
+3438,464
+3440,458
+3439,453
+3440,448
+3442,442
+3447,435
+3458,426
+3475,416
+3499,404
+3529,393
+3558,385
+3585,379
+3608,375
+3627,373
+3642,373
+3654,374
+3663,377
+3671,379
+3679,382
+3689,384
+3701,386
+3717,387
+3737,386
+3763,384
+3793,380
+3825,375
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+fill:#ffffff;
+"/>
+<!-- Text -->
+<text xml:space="preserve" x="525" y="750" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">NAS</text>
+<!-- Text -->
+<text xml:space="preserve" x="2625" y="1950" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">Proxy</text>
+<!-- Text -->
+<text xml:space="preserve" x="4800" y="1950" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">Two</text>
+<!-- Text -->
+<text xml:space="preserve" x="7125" y="600" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">One</text>
+<!-- Text -->
+<text xml:space="preserve" x="7125" y="3000" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">Three</text>
+<!-- Line -->
+<polyline points="300,999
+1510,999
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="300,990
+1510,990
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="300,1007
+1510,1007
+" style="stroke:#c7c7c7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="300,1652
+1510,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="300,1642
+1510,1642
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="300,1659
+1510,1659
+" style="stroke:#c7c7c7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="601,995
+601,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="610,995
+610,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="593,995
+593,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="531,995
+531,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="540,995
+540,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="523,995
+523,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="829,995
+829,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="839,995
+839,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="822,995
+822,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="760,995
+760,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="769,995
+769,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="752,995
+752,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1051,995
+1051,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1061,995
+1061,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1043,995
+1043,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="981,995
+981,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="990,995
+990,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="974,995
+974,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1276,995
+1276,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1285,995
+1285,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1269,995
+1269,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1206,995
+1206,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1215,995
+1215,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1198,995
+1198,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1481,995
+1481,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1489,995
+1489,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1473,995
+1473,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1411,995
+1411,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1420,995
+1420,1652
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1402,995
+1402,1652
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="831,995
+831,1652
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="2625" y="2100" width="900" height="1569" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Line: box -->
+<rect x="4800" y="2100" width="900" height="1569" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Line: box -->
+<rect x="7125" y="750" width="900" height="1569" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Line: box -->
+<rect x="7125" y="3150" width="900" height="1569" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Text -->
+<text xml:space="preserve" x="3600" y="975" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">Internet</text>
+<!-- Line: box -->
+<rect x="2725" y="2701" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="2668" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="2801" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="2768" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="2901" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="2868" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="3001" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="2968" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="3101" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="3068" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="3203" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="3168" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="3301" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="3269" width="700" height="32" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="3402" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="3369" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="2468" width="700" height="32" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="2433" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="2367" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="2333" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="2267" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="2725" y="2233" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="2625" y="3536" width="900" height="133" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line -->
+<polyline points="2625,2566
+3525,2566
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Line: box -->
+<rect x="4900" y="2701" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="4900" y="2668" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="4900" y="2801" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="4900" y="2768" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="4900" y="2901" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="4900" y="2868" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="4900" y="3001" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="4900" y="2968" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="4900" y="3101" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="4900" y="3068" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="4900" y="3203" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="4900" y="3168" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="4900" y="3301" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="4900" y="3269" width="700" height="32" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="4900" y="3402" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="4900" y="3369" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="4900" y="2468" width="700" height="32" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="4900" y="2433" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="4900" y="2367" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="4900" y="2333" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="4900" y="2267" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="4900" y="2233" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="4800" y="3536" width="900" height="133" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line -->
+<polyline points="4800,2566
+5700,2566
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Line: box -->
+<rect x="7225" y="1351" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="7225" y="1318" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="7225" y="1451" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="7225" y="1418" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="7225" y="1551" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="7225" y="1518" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="7225" y="1651" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="7225" y="1618" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="7225" y="1751" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="7225" y="1718" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="7225" y="1853" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="7225" y="1818" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="7225" y="1951" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="7225" y="1919" width="700" height="32" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="7225" y="2052" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="7225" y="2019" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="7225" y="1118" width="700" height="32" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="7225" y="1083" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="7225" y="1017" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="7225" y="983" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="7225" y="917" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="7225" y="883" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="7125" y="2186" width="900" height="133" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line -->
+<polyline points="7125,1216
+8025,1216
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Line: box -->
+<rect x="7225" y="3751" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="7225" y="3718" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="7225" y="3851" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="7225" y="3818" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="7225" y="3951" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="7225" y="3918" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="7225" y="4051" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="7225" y="4018" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="7225" y="4151" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="7225" y="4118" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="7225" y="4253" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="7225" y="4218" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="7225" y="4351" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="7225" y="4319" width="700" height="32" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="7225" y="4452" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="7225" y="4419" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="7225" y="3518" width="700" height="32" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="7225" y="3483" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="7225" y="3417" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="7225" y="3383" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="7225" y="3317" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#e0e0e0;
+"/>
+<!-- Line: box -->
+<rect x="7225" y="3283" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line: box -->
+<rect x="7125" y="4586" width="900" height="133" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#404040;
+"/>
+<!-- Line -->
+<polyline points="7125,3616
+8025,3616
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#c0c0c0;
+"/>
+<!-- Line -->
+<polyline points="345,1170
+345,1260
+438,1260
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#c7c7c7;
+"/>
+<!-- Line -->
+<polyline points="340,1170
+435,1170
+435,1259
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#c7c7c7;
+"/>
+<!-- Line -->
+<polyline points="349,1185
+430,1186
+" style="stroke:#f7f7f7;stroke-width:7;
+stroke-linejoin:round; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line -->
+<polyline points="349,1222
+430,1222
+" style="stroke:#868686;stroke-width:7;
+stroke-linejoin:round; stroke-linecap:butt;
+fill:#000000;
+"/>
+<!-- Line -->
+<polyline points="2100,2625
+2100,2039
+" style="stroke:#0000ff;stroke-width:15;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 2100 2625 - 2100 1770-->
+<polygon points="2160 2042
+2100 1802
+2040 2042
+2160 2042
+
+" style="stroke:#0000ff;stroke-width:15;stroke-miterlimit:8;
+fill:#0000ff;"/>
+<!-- Line -->
+<polyline points="5700,1125
+6810,1125
+" style="stroke:#0000ff;stroke-width:15;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 5700 1125 - 7080 1125-->
+<polygon points="6808 1185
+7048 1125
+6808 1065
+6808 1185
+
+" style="stroke:#0000ff;stroke-width:15;stroke-miterlimit:8;
+fill:#0000ff;"/>
+<!-- Line -->
+<polyline points="6300,2550
+6300,3750
+6735,3750
+" style="stroke:#0000ff;stroke-width:15;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 6300 3750 - 7005 3750-->
+<polygon points="6733 3810
+6973 3750
+6733 3690
+6733 3810
+
+" style="stroke:#0000ff;stroke-width:15;stroke-miterlimit:8;
+fill:#0000ff;"/>
+<!-- Line -->
+<polyline points="6300,2550
+6014,2550
+" style="stroke:#0000ff;stroke-width:15;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 6300 2550 - 5745 2550-->
+<polygon points="6017 2490
+5777 2550
+6017 2610
+6017 2490
+
+" style="stroke:#0000ff;stroke-width:15;stroke-miterlimit:8;
+fill:#0000ff;"/>
+<!-- Line: box -->
+<rect x="345" y="1193" width="81" height="21" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+fill:#000000;
+"/>
+</g>
+</svg>
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/radius_packet.svg freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/radius_packet.svg
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/radius_packet.svg	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/radius_packet.svg	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,438 @@
+<?xml version="1.0" standalone="no"?>
+<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
+"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
+<!-- Creator: fig2dev Version 3.2 Patchlevel 5e -->
+<!-- CreationDate: Mon Aug 11 20:51:55 2014 -->
+<!-- Magnification: 1.000 -->
+<svg	xmlns="http://www.w3.org/2000/svg"
+	xmlns:xlink="http://www.w3.org/1999/xlink"
+	width="5.3in" height="4.1in"
+	viewBox="288 149 6313 4963">
+<g style="stroke-width:.025in; fill:none">
+<!-- Line -->
+<polyline points="3300,1500
+3300,1501
+3300,1506
+3301,1518
+3301,1538
+3303,1564
+3304,1593
+3306,1622
+3309,1649
+3312,1674
+3316,1695
+3320,1712
+3325,1727
+3331,1739
+3338,1750
+3347,1761
+3358,1769
+3372,1776
+3389,1782
+3410,1787
+3433,1791
+3459,1795
+3484,1797
+3505,1799
+3518,1800
+3524,1800
+3525,1800
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3525,1800
+3524,1800
+3518,1800
+3505,1801
+3484,1803
+3459,1805
+3433,1809
+3410,1813
+3389,1818
+3372,1824
+3358,1831
+3347,1839
+3338,1850
+3331,1861
+3325,1873
+3320,1888
+3316,1905
+3312,1926
+3309,1951
+3306,1978
+3304,2007
+3303,2036
+3301,2062
+3301,2082
+3300,2094
+3300,2099
+3300,2100
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3300,3900
+3300,3901
+3300,3906
+3301,3918
+3301,3938
+3303,3964
+3304,3993
+3306,4022
+3309,4049
+3312,4074
+3316,4095
+3320,4112
+3325,4127
+3331,4139
+3338,4150
+3347,4161
+3358,4169
+3372,4176
+3389,4182
+3410,4187
+3433,4191
+3459,4195
+3484,4197
+3505,4199
+3518,4200
+3524,4200
+3525,4200
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3525,4200
+3524,4200
+3518,4200
+3505,4201
+3484,4203
+3459,4205
+3433,4209
+3410,4213
+3389,4218
+3372,4224
+3358,4231
+3347,4239
+3338,4250
+3331,4261
+3325,4273
+3320,4288
+3316,4305
+3312,4326
+3309,4351
+3306,4378
+3304,4407
+3303,4436
+3301,4462
+3301,4482
+3300,4494
+3300,4499
+3300,4500
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1500,300
+1500,900
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="900,300
+900,900
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="300,900
+2700,900
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="300,1500
+2700,1500
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+stroke-dasharray:40 40;"/>
+<!-- Line -->
+<polyline points="300,2100
+2700,2100
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+stroke-dasharray:40 40;"/>
+<!-- Line -->
+<polyline points="300,2700
+2700,2700
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+stroke-dasharray:40 40;"/>
+<!-- Line -->
+<polyline points="900,3300
+900,3900
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1500,3300
+1500,3900
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="300,3900
+1500,3900
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1500,3900
+1500,4500
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2100,3900
+2100,4500
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1500,1950
+1500,2880
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 1500 1950 - 1500 3015-->
+<polygon points="1470 2879
+1500 2999
+1530 2879
+1470 2879
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line -->
+<polyline points="1500,3900
+2700,3900
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="300,4500
+300,5100
+2100,5100
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="2100,5100
+2700,5100
+2700,4500
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+stroke-dasharray:40 40;"/>
+<!-- Line: box -->
+<rect x="300" y="300" width="2400" height="4200" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3300,600
+3300,1500
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3300,2100
+3300,3000
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3300,3600
+3300,3900
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3300,4500
+3300,4800
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="300,3300
+2700,3300
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="6600,150
+6600,225
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3000,300
+3001,300
+3006,300
+3018,301
+3038,302
+3064,303
+3093,306
+3122,309
+3149,312
+3174,316
+3195,321
+3212,326
+3227,333
+3239,341
+3250,350
+3259,361
+3267,373
+3274,388
+3279,405
+3284,426
+3288,451
+3291,478
+3294,507
+3297,536
+3298,562
+3299,582
+3300,594
+3300,599
+3300,600
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3000,3300
+3001,3300
+3006,3300
+3018,3301
+3038,3302
+3064,3303
+3093,3306
+3122,3309
+3149,3312
+3174,3316
+3195,3321
+3212,3326
+3227,3333
+3239,3341
+3250,3350
+3259,3361
+3267,3373
+3274,3388
+3279,3405
+3284,3426
+3288,3451
+3291,3478
+3294,3507
+3297,3536
+3298,3562
+3299,3582
+3300,3594
+3300,3599
+3300,3600
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3300,3000
+3300,3001
+3300,3006
+3299,3018
+3298,3038
+3297,3064
+3294,3093
+3291,3122
+3288,3149
+3284,3174
+3279,3195
+3274,3212
+3267,3227
+3259,3239
+3250,3250
+3239,3259
+3227,3267
+3212,3274
+3195,3279
+3174,3284
+3149,3288
+3122,3291
+3093,3294
+3064,3297
+3038,3298
+3018,3299
+3006,3300
+3001,3300
+3000,3300
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3300,4800
+3300,4801
+3300,4806
+3299,4818
+3298,4838
+3297,4864
+3294,4893
+3291,4922
+3288,4949
+3284,4974
+3279,4995
+3274,5012
+3267,5027
+3259,5039
+3250,5050
+3239,5059
+3227,5067
+3212,5074
+3195,5079
+3174,5084
+3149,5088
+3122,5091
+3093,5094
+3064,5097
+3038,5098
+3018,5099
+3006,5100
+3001,5100
+3000,5100
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Text -->
+<text xml:space="preserve" x="525" y="3675" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">attr</text>
+<!-- Text -->
+<text xml:space="preserve" x="450" y="675" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">Code</text>
+<!-- Text -->
+<text xml:space="preserve" x="1200" y="675" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">Id</text>
+<!-- Text -->
+<text xml:space="preserve" x="1875" y="675" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">Length</text>
+<!-- Text -->
+<text xml:space="preserve" x="975" y="1275" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">authentication</text>
+<!-- Text -->
+<text xml:space="preserve" x="1200" y="1875" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">vector</text>
+<!-- Text -->
+<text xml:space="preserve" x="1875" y="3675" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">data...</text>
+<!-- Text -->
+<text xml:space="preserve" x="1125" y="3675" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">len</text>
+<!-- Text -->
+<text xml:space="preserve" x="525" y="4275" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">more data...</text>
+<!-- Text -->
+<text xml:space="preserve" x="1650" y="4275" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">attr</text>
+<!-- Text -->
+<text xml:space="preserve" x="2325" y="4275" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">len</text>
+<!-- Text -->
+<text xml:space="preserve" x="1050" y="4875" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">data...</text>
+<!-- Text -->
+<text xml:space="preserve" x="3675" y="1875" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">RADIUS packet header</text>
+<!-- Text -->
+<text xml:space="preserve" x="3675" y="4275" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">List of attributes</text>
+</g>
+</svg>
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/request_files.svg freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/request_files.svg
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/request_files.svg	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/request_files.svg	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,131 @@
+<?xml version="1.0" standalone="no"?>
+<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
+"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
+<!-- Creator: fig2dev Version 3.2 Patchlevel 5e -->
+<!-- CreationDate: Mon Aug 11 20:51:55 2014 -->
+<!-- Magnification: 1.000 -->
+<svg	xmlns="http://www.w3.org/2000/svg"
+	xmlns:xlink="http://www.w3.org/1999/xlink"
+	width="6.1in" height="3.5in"
+	viewBox="285 149 7345 4142">
+<g style="stroke-width:.025in; fill:none">
+<!-- Line -->
+<polyline points="1350,675
+1350,780
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 1350 675 - 1350 915-->
+<polygon points="1320 779
+1350 899
+1380 779
+1320 779
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line -->
+<polyline points="1350,1275
+1350,1380
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 1350 1275 - 1350 1515-->
+<polygon points="1320 1379
+1350 1499
+1380 1379
+1320 1379
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line -->
+<polyline points="1350,1875
+1350,1980
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 1350 1875 - 1350 2115-->
+<polygon points="1320 1979
+1350 2099
+1380 1979
+1320 1979
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line -->
+<polyline points="1350,2475
+1350,2580
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 1350 2475 - 1350 2715-->
+<polygon points="1320 2579
+1350 2699
+1380 2579
+1320 2579
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line -->
+<polyline points="1350,3675
+1350,3780
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 1350 3675 - 1350 3915-->
+<polygon points="1320 3779
+1350 3899
+1380 3779
+1320 3779
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line -->
+<polyline points="1350,3075
+1350,3180
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 1350 3075 - 1350 3315-->
+<polygon points="1320 3179
+1350 3299
+1380 3179
+1320 3179
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line -->
+<polyline points="7500,150
+7500,300
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Text -->
+<text xml:space="preserve" x="300" y="1200" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">clients (clients.conf)</text>
+<!-- Text -->
+<text xml:space="preserve" x="1050" y="1800" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">hints</text>
+<!-- Text -->
+<text xml:space="preserve" x="825" y="2400" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">huntgroups</text>
+<!-- Text -->
+<text xml:space="preserve" x="450" y="3000" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">realms (proxy.conf)</text>
+<!-- Text -->
+<text xml:space="preserve" x="1125" y="3600" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">users</text>
+<!-- Text -->
+<text xml:space="preserve" x="600" y="4200" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">Access-Accept</text>
+<!-- Text -->
+<text xml:space="preserve" x="525" y="600" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">Access-Request</text>
+<!-- Text -->
+<text xml:space="preserve" x="3000" y="4200" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">accept or reject the user, and respond with policy attributes</text>
+<!-- Text -->
+<text xml:space="preserve" x="3000" y="3000" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">check if the user is associated with an organization </text>
+<!-- Text -->
+<text xml:space="preserve" x="3000" y="2400" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">group users by NAS and NAS-Port</text>
+<!-- Text -->
+<text xml:space="preserve" x="3000" y="1800" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">check if the user has requested a specific protocol</text>
+<!-- Text -->
+<text xml:space="preserve" x="3000" y="1200" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">match request to a known client</text>
+<!-- Text -->
+<text xml:space="preserve" x="3000" y="600" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">contains user, password, and requested policy</text>
+<!-- Text -->
+<text xml:space="preserve" x="3000" y="3600" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">match requests to server policy, and configure the reply</text>
+</g>
+</svg>
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/request_handoff.svg freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/request_handoff.svg
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/request_handoff.svg	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/request_handoff.svg	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,480 @@
+<?xml version="1.0" standalone="no"?>
+<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
+"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
+<!-- Creator: fig2dev Version 3.2 Patchlevel 5e -->
+<!-- CreationDate: Mon Aug 11 20:51:55 2014 -->
+<!-- Magnification: 1.000 -->
+<svg	xmlns="http://www.w3.org/2000/svg"
+	xmlns:xlink="http://www.w3.org/1999/xlink"
+	width="6.2in" height="2.7in"
+	viewBox="396 315 7440 3222">
+<g style="stroke-width:.025in; fill:none">
+<!-- Line -->
+<polyline points="5700,75
+6075,75
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 5700 75 - 6075 75-->
+<polygon points="-2147483648 -2147483648
+-2147483648 -2147483648
+-2147483648 -2147483648
+-2147483648 -2147483648
+
+" style="stroke:#000000;stroke-width:0;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line: box -->
+<rect x="6075" y="2925" width="975" height="600" rx="0" 
+style="stroke:#0000d1;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="3525" y="2925" width="975" height="600" rx="0" 
+style="stroke:#0000d1;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="4800" y="2925" width="975" height="600" rx="0" 
+style="stroke:#0000d1;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="5400,2475
+5399,2475
+5397,2476
+5393,2478
+5387,2480
+5379,2483
+5368,2487
+5354,2492
+5338,2497
+5319,2503
+5298,2509
+5275,2516
+5250,2522
+5224,2528
+5196,2534
+5168,2538
+5139,2542
+5110,2544
+5081,2544
+5052,2543
+5022,2539
+4993,2533
+4964,2524
+4936,2511
+4907,2495
+4879,2475
+4851,2451
+4824,2422
+4797,2387
+4772,2347
+4747,2301
+4725,2250
+4708,2203
+4693,2154
+4680,2104
+4669,2053
+4659,2003
+4650,1954
+4643,1907
+4637,1862
+4632,1819
+4628,1778
+4625,1739
+4623,1702
+4621,1667
+4620,1633
+4619,1601
+4618,1570
+4618,1540
+4618,1510
+4619,1481
+4619,1452
+4620,1423
+4622,1393
+4623,1362
+4625,1331
+4627,1298
+4630,1263
+4633,1227
+4636,1190
+4640,1150
+4645,1108
+4651,1065
+4658,1021
+4666,975
+4675,928
+4685,881
+4697,836
+4710,791
+4725,750
+4745,706
+4766,668
+4789,637
+4813,611
+4837,591
+4862,576
+4887,565
+4912,559
+4938,556
+4964,557
+4989,560
+5015,566
+5041,574
+5067,585
+5093,596
+5119,609
+5144,623
+5168,638
+5192,653
+5214,667
+5234,682
+5253,695
+5270,707
+5284,718
+5296,727
+5306,735
+5314,741
+5139,598
+" style="stroke:#000000;stroke-width:15;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 5314 741 - 5348 768-->
+<polygon points="5097 645
+5323 748
+5172 551
+5097 645
+
+" style="stroke:#000000;stroke-width:15;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line -->
+<polyline points="1200,2475
+1199,2475
+1197,2476
+1193,2478
+1187,2480
+1179,2483
+1168,2487
+1154,2492
+1138,2497
+1119,2503
+1098,2509
+1075,2516
+1050,2522
+1024,2528
+996,2534
+968,2538
+939,2542
+910,2544
+881,2544
+852,2543
+822,2539
+793,2533
+764,2524
+736,2511
+707,2495
+679,2475
+651,2451
+624,2422
+597,2387
+572,2347
+547,2301
+525,2250
+508,2203
+493,2154
+480,2104
+469,2053
+459,2003
+450,1954
+443,1907
+437,1862
+432,1819
+428,1778
+425,1739
+423,1702
+421,1667
+420,1633
+419,1601
+418,1570
+418,1540
+418,1510
+419,1481
+419,1452
+420,1423
+422,1393
+423,1362
+425,1331
+427,1298
+430,1263
+433,1227
+436,1190
+440,1150
+445,1108
+451,1065
+458,1021
+466,975
+475,928
+485,881
+497,836
+510,791
+525,750
+545,706
+566,668
+589,637
+613,611
+637,591
+662,576
+687,565
+712,559
+738,556
+764,557
+789,560
+815,566
+841,574
+867,585
+893,596
+919,609
+944,623
+968,638
+992,653
+1014,667
+1034,682
+1053,695
+1070,707
+1084,718
+1096,727
+1106,735
+1114,741
+939,598
+" style="stroke:#000000;stroke-width:15;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 1114 741 - 1148 768-->
+<polygon points="897 645
+1123 748
+972 551
+897 645
+
+" style="stroke:#000000;stroke-width:15;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line -->
+<polyline points="7314,3245
+7315,3244
+7318,3243
+7323,3240
+7330,3236
+7340,3230
+7353,3223
+7369,3214
+7387,3202
+7407,3190
+7429,3175
+7452,3159
+7476,3142
+7500,3123
+7525,3103
+7549,3081
+7574,3057
+7598,3032
+7621,3004
+7645,2973
+7667,2940
+7689,2903
+7710,2863
+7730,2819
+7748,2771
+7764,2720
+7776,2671
+7786,2623
+7793,2577
+7799,2534
+7804,2495
+7807,2459
+7810,2428
+7812,2400
+7813,2376
+7814,2355
+7814,2336
+7814,2319
+7814,2304
+7814,2289
+7813,2274
+7812,2259
+7810,2242
+7807,2224
+7804,2204
+7799,2181
+7793,2155
+7785,2126
+7775,2093
+7763,2058
+7749,2019
+7732,1978
+7712,1936
+7689,1895
+7662,1853
+7632,1816
+7602,1782
+7571,1753
+7539,1728
+7508,1706
+7476,1687
+7445,1671
+7413,1658
+7382,1646
+7350,1636
+7319,1628
+7288,1621
+7258,1615
+7230,1610
+7203,1606
+7178,1603
+7156,1600
+7136,1599
+7121,1597
+7108,1596
+7328,1607
+" style="stroke:#0000ff;stroke-width:15;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 7108 1596 - 7059 1593-->
+<polygon points="7334 1549
+7091 1595
+7326 1669
+7334 1549
+
+" style="stroke:#0000ff;stroke-width:15;stroke-miterlimit:8;
+fill:#0000ff;"/>
+<!-- Line -->
+<polyline points="3360,1620
+3361,1621
+3364,1622
+3370,1624
+3378,1628
+3389,1633
+3404,1640
+3421,1648
+3442,1658
+3464,1670
+3489,1683
+3514,1697
+3540,1712
+3567,1729
+3592,1746
+3617,1765
+3640,1784
+3662,1805
+3681,1826
+3697,1849
+3710,1874
+3720,1900
+3726,1928
+3727,1958
+3723,1991
+3714,2025
+3698,2062
+3675,2100
+3651,2132
+3624,2163
+3593,2193
+3561,2221
+3527,2247
+3492,2271
+3457,2292
+3421,2310
+3386,2327
+3352,2340
+3317,2352
+3284,2362
+3250,2371
+3217,2378
+3185,2385
+3152,2391
+3120,2396
+3088,2402
+3056,2408
+3024,2414
+2991,2422
+2959,2430
+2926,2441
+2894,2453
+2861,2467
+2829,2483
+2797,2502
+2765,2524
+2735,2548
+2707,2575
+2681,2604
+2658,2635
+2639,2667
+2625,2700
+2616,2737
+2615,2773
+2619,2808
+2630,2840
+2645,2871
+2665,2900
+2689,2927
+2716,2953
+2746,2977
+2779,3000
+2814,3022
+2851,3043
+2889,3063
+2929,3082
+2970,3101
+3010,3118
+3050,3135
+3089,3150
+3126,3164
+3161,3177
+3192,3188
+3220,3198
+3243,3206
+3262,3213
+3277,3218
+3070,3155
+" style="stroke:#0000ff;stroke-width:15;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 3277 3218 - 3328 3233-->
+<polygon points="3049 3213
+3297 3224
+3083 3098
+3049 3213
+
+" style="stroke:#0000ff;stroke-width:15;stroke-miterlimit:8;
+fill:#0000ff;"/>
+<!-- Text -->
+<text xml:space="preserve" x="6150" y="3300" fill="#0000d1"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">Request</text>
+<!-- Text -->
+<text xml:space="preserve" x="3600" y="3300" fill="#0000d1"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">Request</text>
+<!-- Text -->
+<text xml:space="preserve" x="4875" y="3300" fill="#0000d1"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">Request</text>
+<!-- Text -->
+<text xml:space="preserve" x="5100" y="1365" fill="#008f8f"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">lock request queue</text>
+<!-- Text -->
+<text xml:space="preserve" x="5100" y="1680" fill="#0000ff"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">pop a request</text>
+<!-- Text -->
+<text xml:space="preserve" x="5100" y="1995" fill="#008f8f"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">unlock request queue</text>
+<!-- Text -->
+<text xml:space="preserve" x="5100" y="2310" fill="#0000ff"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">process request</text>
+<!-- Text -->
+<text xml:space="preserve" x="5100" y="1050" fill="#00d100"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">Wait for semaphore</text>
+<!-- Text -->
+<text xml:space="preserve" x="5325" y="525" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="240" text-anchor="start">Thread</text>
+<!-- Text -->
+<text xml:space="preserve" x="900" y="2310" fill="#00d100"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">signal semaphore</text>
+<!-- Text -->
+<text xml:space="preserve" x="900" y="1050" fill="#0000ff"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">Receive a request</text>
+<!-- Text -->
+<text xml:space="preserve" x="900" y="1680" fill="#0000ff"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">push request onto queue</text>
+<!-- Text -->
+<text xml:space="preserve" x="900" y="1350" fill="#008f8f"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">lock request queue</text>
+<!-- Text -->
+<text xml:space="preserve" x="900" y="2025" fill="#008f8f"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">unlock request queue</text>
+<!-- Text -->
+<text xml:space="preserve" x="1200" y="525" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="240" text-anchor="start">Server core</text>
+</g>
+</svg>
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/request_processing.svg freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/request_processing.svg
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/request_processing.svg	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/request_processing.svg	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,73 @@
+<?xml version="1.0" standalone="no"?>
+<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
+"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
+<!-- Creator: fig2dev Version 3.2 Patchlevel 5e -->
+<!-- CreationDate: Mon Aug 11 20:51:55 2014 -->
+<!-- Magnification: 1.000 -->
+<svg	xmlns="http://www.w3.org/2000/svg"
+	xmlns:xlink="http://www.w3.org/1999/xlink"
+	width="4.2in" height="2.8in"
+	viewBox="360 299 5041 3383">
+<g style="stroke-width:.025in; fill:none">
+<!-- Line -->
+<polyline points="2550,750
+1294,1726
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 2550 750 - 1188 1809-->
+<polygon points="1277 1701
+1201 1799
+1314 1749
+1277 1701
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line -->
+<polyline points="2550,750
+3805,1726
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 2550 750 - 3911 1809-->
+<polygon points="3784 1748
+3898 1799
+3821 1701
+3784 1748
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line -->
+<polyline points="5400,300
+5400,450
+" style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Text -->
+<text xml:space="preserve" x="1575" y="525" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="240" text-anchor="start">Processing a request</text>
+<!-- Text -->
+<text xml:space="preserve" x="3525" y="1275" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="144" text-anchor="start">Accounting-Request</text>
+<!-- Text -->
+<text xml:space="preserve" x="375" y="1275" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="144" text-anchor="start">Access-Request</text>
+<!-- Text -->
+<text xml:space="preserve" x="750" y="2100" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">authorize</text>
+<!-- Text -->
+<text xml:space="preserve" x="750" y="2400" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">authenticate</text>
+<!-- Text -->
+<text xml:space="preserve" x="900" y="2700" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">pre-proxy</text>
+<!-- Text -->
+<text xml:space="preserve" x="900" y="3000" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">post-proxy</text>
+<!-- Text -->
+<text xml:space="preserve" x="900" y="3300" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">session</text>
+<!-- Text -->
+<text xml:space="preserve" x="3600" y="2100" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">preacct</text>
+<!-- Text -->
+<text xml:space="preserve" x="3600" y="2400" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">accounting</text>
+<!-- Text -->
+<text xml:space="preserve" x="3900" y="2700" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">pre-proxy</text>
+<!-- Text -->
+<text xml:space="preserve" x="3900" y="3000" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">post-proxy</text>
+<!-- Text -->
+<text xml:space="preserve" x="750" y="3600" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="192" text-anchor="start">post-auth</text>
+</g>
+</svg>
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/request_receive.svg freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/request_receive.svg
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/request_receive.svg	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/request_receive.svg	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,289 @@
+<?xml version="1.0" standalone="no"?>
+<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
+"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
+<!-- Creator: fig2dev Version 3.2 Patchlevel 5e -->
+<!-- CreationDate: Mon Aug 11 20:51:55 2014 -->
+<!-- Magnification: 1.000 -->
+<svg	xmlns="http://www.w3.org/2000/svg"
+	xmlns:xlink="http://www.w3.org/1999/xlink"
+	width="5.9in" height="3.1in"
+	viewBox="285 366 7066 3661">
+<g style="stroke-width:.025in; fill:none">
+<!-- Line: box -->
+<rect x="7200" y="1275" width="150" height="150" rx="0" 
+style="stroke:#ffffff;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1425,975
+1426,975
+1428,976
+1432,977
+1438,978
+1446,980
+1457,983
+1471,986
+1488,990
+1507,994
+1528,999
+1552,1003
+1578,1008
+1606,1013
+1636,1017
+1667,1021
+1700,1025
+1734,1028
+1770,1031
+1807,1032
+1847,1033
+1889,1033
+1933,1031
+1979,1029
+2029,1024
+2082,1018
+2139,1011
+2198,1001
+2261,989
+2325,975
+2386,960
+2446,944
+2503,927
+2556,909
+2606,891
+2650,873
+2690,855
+2726,838
+2757,820
+2784,803
+2808,786
+2829,770
+2847,754
+2864,738
+2879,722
+2894,706
+2908,691
+2923,676
+2939,660
+2956,645
+2975,630
+2997,616
+3021,601
+3049,588
+3080,574
+3115,562
+3153,551
+3194,541
+3237,533
+3283,527
+3329,524
+3375,525
+3424,530
+3469,539
+3509,553
+3544,569
+3575,588
+3602,609
+3626,632
+3646,656
+3663,682
+3678,710
+3691,738
+3702,768
+3712,797
+3720,827
+3726,857
+3732,886
+3736,914
+3740,941
+3743,965
+3745,986
+3747,1005
+3748,1020
+3749,1032
+3737,810
+" style="stroke:#0000d1;stroke-width:15;
+stroke-linejoin:bevel; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 3749 1032 - 3751 1079-->
+<polygon points="3679 809
+3750 1047
+3799 804
+3679 809
+
+" style="stroke:#0000d1;stroke-width:15;stroke-miterlimit:8;
+fill:#0000d1;"/>
+<!-- Text -->
+<text xml:space="preserve" x="2100" y="1425" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">Is the request a valid RADIUS packet?</text>
+<!-- Text -->
+<text xml:space="preserve" x="2100" y="1740" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">Is the request from a known client?</text>
+<!-- Text -->
+<text xml:space="preserve" x="2100" y="2055" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">Is the request a duplicate?</text>
+<!-- Text -->
+<text xml:space="preserve" x="2100" y="2370" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">    Do we already have a reply for that request?</text>
+<!-- Text -->
+<text xml:space="preserve" x="2100" y="2685" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">    Should we re-send a proxied request?</text>
+<!-- Text -->
+<text xml:space="preserve" x="2100" y="3000" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">    Are we currently processing the original?</text>
+<!-- Text -->
+<text xml:space="preserve" x="2100" y="3630" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">Add the request to the internal cache</text>
+<!-- Text -->
+<text xml:space="preserve" x="2100" y="3945" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">Give the request to a child to process</text>
+<!-- Text -->
+<text xml:space="preserve" x="3900" y="750" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="144" text-anchor="start">Accounting-Request</text>
+<!-- Text -->
+<text xml:space="preserve" x="3750" y="525" fill="#000000"  font-family="Times" font-style="italic" font-weight="normal" font-size="144" text-anchor="start">Access-Request</text>
+<!-- Text -->
+<text xml:space="preserve" x="300" y="600" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="240" text-anchor="start">Server</text>
+<!-- Line: box -->
+<rect x="300" y="750" width="900" height="1569" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#bdbebd;
+"/>
+<!-- Line: box -->
+<rect x="400" y="1351" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#dedfde;
+"/>
+<!-- Line: box -->
+<rect x="400" y="1318" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#424142;
+"/>
+<!-- Line: box -->
+<rect x="400" y="1451" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#dedfde;
+"/>
+<!-- Line: box -->
+<rect x="400" y="1418" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#424142;
+"/>
+<!-- Line: box -->
+<rect x="400" y="1551" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#dedfde;
+"/>
+<!-- Line: box -->
+<rect x="400" y="1518" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#424142;
+"/>
+<!-- Line: box -->
+<rect x="400" y="1651" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#dedfde;
+"/>
+<!-- Line: box -->
+<rect x="400" y="1618" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#424142;
+"/>
+<!-- Line: box -->
+<rect x="400" y="1751" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#dedfde;
+"/>
+<!-- Line: box -->
+<rect x="400" y="1718" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#424142;
+"/>
+<!-- Line: box -->
+<rect x="400" y="1853" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#dedfde;
+"/>
+<!-- Line: box -->
+<rect x="400" y="1818" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#424142;
+"/>
+<!-- Line: box -->
+<rect x="400" y="1951" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#dedfde;
+"/>
+<!-- Line: box -->
+<rect x="400" y="1919" width="700" height="32" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#424142;
+"/>
+<!-- Line: box -->
+<rect x="400" y="2052" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#dedfde;
+"/>
+<!-- Line: box -->
+<rect x="400" y="2019" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#424142;
+"/>
+<!-- Line: box -->
+<rect x="400" y="1118" width="700" height="32" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#dedfde;
+"/>
+<!-- Line: box -->
+<rect x="400" y="1083" width="700" height="35" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#424142;
+"/>
+<!-- Line: box -->
+<rect x="400" y="1017" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#dedfde;
+"/>
+<!-- Line: box -->
+<rect x="400" y="983" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#424142;
+"/>
+<!-- Line: box -->
+<rect x="400" y="917" width="700" height="33" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#dedfde;
+"/>
+<!-- Line: box -->
+<rect x="400" y="883" width="700" height="34" rx="0" 
+style="stroke:#000000;stroke-width:0;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#424142;
+"/>
+<!-- Line: box -->
+<rect x="300" y="2186" width="900" height="133" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#424142;
+"/>
+<!-- Line -->
+<polyline points="300,1216
+1200,1216
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:round;
+fill:#bdbebd;
+"/>
+</g>
+</svg>
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/server_schematic.svg freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/server_schematic.svg
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/server_schematic.svg	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/server_schematic.svg	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,508 @@
+<?xml version="1.0" standalone="no"?>
+<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
+"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
+<!-- Creator: fig2dev Version 3.2 Patchlevel 5e -->
+<!-- CreationDate: Mon Aug 11 20:51:55 2014 -->
+<!-- Magnification: 1.000 -->
+<svg	xmlns="http://www.w3.org/2000/svg"
+	xmlns:xlink="http://www.w3.org/1999/xlink"
+	width="6.0in" height="6.5in"
+	viewBox="578 288 7244 7824">
+<g style="stroke-width:.025in; fill:none">
+<!-- Line: box -->
+<rect x="600" y="300" width="900" height="600" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="1800" y="300" width="900" height="600" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="3000" y="300" width="900" height="600" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="6825" y="300" width="975" height="600" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="5475" y="300" width="975" height="600" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="2100" y="3000" width="1200" height="600" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="3600" y="3000" width="1200" height="600" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="5100" y="3000" width="1200" height="600" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="6600" y="3000" width="1200" height="600" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="600" y="4200" width="1200" height="300" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="600" y="4575" width="1200" height="300" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="600" y="4950" width="1200" height="300" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="600" y="5325" width="1200" height="300" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="600" y="5700" width="1200" height="300" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="600" y="6075" width="1200" height="300" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="4200" y="300" width="900" height="600" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1050,975
+1050,1605
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 1050 975 - 1050 1740-->
+<polygon points="1020 1604
+1050 1724
+1080 1604
+1020 1604
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line -->
+<polyline points="2250,975
+2250,1605
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 2250 975 - 2250 1740-->
+<polygon points="2220 1604
+2250 1724
+2280 1604
+2220 1604
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line -->
+<polyline points="3450,975
+3450,1605
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 3450 975 - 3450 1740-->
+<polygon points="3420 1604
+3450 1724
+3480 1604
+3420 1604
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line -->
+<polyline points="6000,975
+6000,1605
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 6000 975 - 6000 1740-->
+<polygon points="5970 1604
+6000 1724
+6030 1604
+5970 1604
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line -->
+<polyline points="7350,975
+7350,1605
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 7350 975 - 7350 1740-->
+<polygon points="7320 1604
+7350 1724
+7380 1604
+7320 1604
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line -->
+<polyline points="4200,2700
+4200,2880
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 4200 2700 - 4200 3015-->
+<polygon points="4170 2879
+4200 2999
+4230 2879
+4170 2879
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line -->
+<polyline points="4200,2700
+1918,2985
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 4200 2700 - 1785 3001-->
+<polygon points="1916 2954
+1801 2999
+1923 3013
+1916 2954
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line -->
+<polyline points="4200,2700
+3413,2962
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 4200 2700 - 3285 3004-->
+<polygon points="3404 2932
+3300 2999
+3423 2989
+3404 2932
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line -->
+<polyline points="4200,2700
+4986,2962
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 4200 2700 - 5114 3004-->
+<polygon points="4975 2989
+5099 2999
+4994 2932
+4975 2989
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line -->
+<polyline points="4200,2700
+6481,2985
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 4200 2700 - 6614 3001-->
+<polygon points="6475 3013
+6598 2999
+6482 2954
+6475 3013
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line: box -->
+<rect x="600" y="1800" width="7200" height="900" rx="0" 
+style="stroke:#000000;stroke-width:15;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1200,3675
+1200,3780
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 1200 3675 - 1200 3915-->
+<polygon points="1170 3779
+1200 3899
+1230 3779
+1170 3779
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line -->
+<polyline points="2700,3675
+2700,3780
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 2700 3675 - 2700 3915-->
+<polygon points="2670 3779
+2700 3899
+2730 3779
+2670 3779
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line -->
+<polyline points="4200,3675
+4200,3780
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 4200 3675 - 4200 3915-->
+<polygon points="4170 3779
+4200 3899
+4230 3779
+4170 3779
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line -->
+<polyline points="5700,3675
+5700,3780
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 5700 3675 - 5700 3915-->
+<polygon points="5670 3779
+5700 3899
+5730 3779
+5670 3779
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line -->
+<polyline points="7200,3675
+7200,3780
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 7200 3675 - 7200 3915-->
+<polygon points="7170 3779
+7200 3899
+7230 3779
+7170 3779
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line: box -->
+<rect x="3600" y="4200" width="1200" height="300" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="5100" y="4200" width="1200" height="300" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="5100" y="4575" width="1200" height="300" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="5100" y="4950" width="1200" height="300" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="5100" y="5325" width="1200" height="300" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="5100" y="5700" width="1200" height="300" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="5100" y="6075" width="1200" height="300" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="5700,6750
+5700,7305
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 5700 6750 - 5700 7440-->
+<polygon points="5670 7304
+5700 7424
+5730 7304
+5670 7304
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line: box -->
+<rect x="600" y="3000" width="1200" height="600" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="6600" y="4200" width="1200" height="300" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="6600" y="4575" width="1200" height="300" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="6600" y="4950" width="1200" height="300" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="6600" y="5700" width="1200" height="300" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="6600" y="6075" width="1200" height="300" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="6600" y="6450" width="1200" height="300" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="7200,5250
+7200,5355
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 7200 5250 - 7200 5490-->
+<polygon points="7170 5354
+7200 5474
+7230 5354
+7170 5354
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Line: box -->
+<rect x="6600" y="6825" width="1200" height="300" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="4875" y="7500" width="1650" height="600" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="4650,975
+4650,1605
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Arrowhead on XXXpoint 4650 975 - 4650 1740-->
+<polygon points="4620 1604
+4650 1724
+4680 1604
+4620 1604
+
+" style="stroke:#000000;stroke-width:7;stroke-miterlimit:8;
+fill:#000000;"/>
+<!-- Text -->
+<text xml:space="preserve" x="825" y="675" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">NAS</text>
+<!-- Text -->
+<text xml:space="preserve" x="2025" y="675" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">NAS</text>
+<!-- Text -->
+<text xml:space="preserve" x="3225" y="675" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">NAS</text>
+<!-- Text -->
+<text xml:space="preserve" x="7050" y="675" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">Proxy</text>
+<!-- Text -->
+<text xml:space="preserve" x="5700" y="675" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">Proxy</text>
+<!-- Text -->
+<text xml:space="preserve" x="2400" y="3375" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">thread</text>
+<!-- Text -->
+<text xml:space="preserve" x="3900" y="3375" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">thread</text>
+<!-- Text -->
+<text xml:space="preserve" x="5400" y="3375" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">thread</text>
+<!-- Text -->
+<text xml:space="preserve" x="6900" y="3375" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">thread</text>
+<!-- Text -->
+<text xml:space="preserve" x="675" y="4425" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">preprocess</text>
+<!-- Text -->
+<text xml:space="preserve" x="675" y="4800" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">chap</text>
+<!-- Text -->
+<text xml:space="preserve" x="675" y="5175" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">suffix</text>
+<!-- Text -->
+<text xml:space="preserve" x="675" y="5550" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">files</text>
+<!-- Text -->
+<text xml:space="preserve" x="675" y="5925" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">eap</text>
+<!-- Text -->
+<text xml:space="preserve" x="675" y="6300" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">sql</text>
+<!-- Text -->
+<text xml:space="preserve" x="750" y="4125" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">authorize</text>
+<!-- Text -->
+<text xml:space="preserve" x="4425" y="675" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">AP</text>
+<!-- Text -->
+<text xml:space="preserve" x="2625" y="2325" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="216" text-anchor="start">FreeRADIUS Server core</text>
+<!-- Text -->
+<text xml:space="preserve" x="2400" y="4125" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">waiting</text>
+<!-- Text -->
+<text xml:space="preserve" x="3750" y="4125" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">authenticate</text>
+<!-- Text -->
+<text xml:space="preserve" x="3675" y="4425" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">unix</text>
+<!-- Text -->
+<text xml:space="preserve" x="5175" y="4425" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">preprocess</text>
+<!-- Text -->
+<text xml:space="preserve" x="5175" y="4800" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">chap</text>
+<!-- Text -->
+<text xml:space="preserve" x="5175" y="5175" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">suffix</text>
+<!-- Text -->
+<text xml:space="preserve" x="5175" y="5550" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">files</text>
+<!-- Text -->
+<text xml:space="preserve" x="5175" y="5925" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">eap</text>
+<!-- Text -->
+<text xml:space="preserve" x="5175" y="6300" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">sql</text>
+<!-- Text -->
+<text xml:space="preserve" x="5175" y="6600" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">proxy to realm</text>
+<!-- Text -->
+<text xml:space="preserve" x="900" y="3375" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">thread</text>
+<!-- Text -->
+<text xml:space="preserve" x="6675" y="4425" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">preprocess</text>
+<!-- Text -->
+<text xml:space="preserve" x="6675" y="4800" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">suffix</text>
+<!-- Text -->
+<text xml:space="preserve" x="6675" y="5175" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">files</text>
+<!-- Text -->
+<text xml:space="preserve" x="6900" y="4125" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">preacct</text>
+<!-- Text -->
+<text xml:space="preserve" x="6750" y="5625" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">accounting</text>
+<!-- Text -->
+<text xml:space="preserve" x="6675" y="5925" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">act_unique</text>
+<!-- Text -->
+<text xml:space="preserve" x="6675" y="6300" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">detail</text>
+<!-- Text -->
+<text xml:space="preserve" x="6675" y="6675" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">unix</text>
+<!-- Text -->
+<text xml:space="preserve" x="5025" y="7875" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="192" text-anchor="start">Home server</text>
+<!-- Text -->
+<text xml:space="preserve" x="5250" y="4125" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">authorize</text>
+</g>
+</svg>
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/ttls_packet.svg freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/ttls_packet.svg
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/assets/images/ttls_packet.svg	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/assets/images/ttls_packet.svg	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,78 @@
+<?xml version="1.0" standalone="no"?>
+<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
+"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
+<!-- Creator: fig2dev Version 3.2 Patchlevel 5e -->
+<!-- CreationDate: Mon Aug 11 20:51:55 2014 -->
+<!-- Magnification: 1.000 -->
+<svg	xmlns="http://www.w3.org/2000/svg"
+	xmlns:xlink="http://www.w3.org/1999/xlink"
+	width="4.0in" height="3.5in"
+	viewBox="1188 288 4824 4224">
+<g style="stroke-width:.025in; fill:none">
+<!-- Line -->
+<polyline points="1200,900
+6000,900
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1200,2100
+6000,2100
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1200,2700
+6000,2700
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1200,3300
+6000,3300
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3600,3900
+6000,3900
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="3600,3300
+3600,4500
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line: box -->
+<rect x="1200" y="300" width="4800" height="4200" rx="0" 
+style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Line -->
+<polyline points="1200,1500
+6000,1500
+" style="stroke:#000000;stroke-width:7;
+stroke-linejoin:miter; stroke-linecap:butt;
+"/>
+<!-- Text -->
+<text xml:space="preserve" x="1875" y="3825" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">PAP, CHAP,</text>
+<!-- Text -->
+<text xml:space="preserve" x="1875" y="4050" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">MS-CHAP, etc.</text>
+<!-- Text -->
+<text xml:space="preserve" x="1575" y="675" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">Carrier Protocol (PPP, EAPOL, RADIUS, Diameter, etc</text>
+<!-- Text -->
+<text xml:space="preserve" x="3300" y="1275" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">EAP</text>
+<!-- Text -->
+<text xml:space="preserve" x="3300" y="2400" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">TLS</text>
+<!-- Text -->
+<text xml:space="preserve" x="3075" y="1875" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">EAP-TTLS</text>
+<!-- Text -->
+<text xml:space="preserve" x="3150" y="3075" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">Diameter</text>
+<!-- Text -->
+<text xml:space="preserve" x="4650" y="3675" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">EAP</text>
+<!-- Text -->
+<text xml:space="preserve" x="4350" y="4275" fill="#000000"  font-family="Times" font-style="normal" font-weight="normal" font-size="144" text-anchor="start">EAP-MD5, etc.</text>
+</g>
+</svg>
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/nav.adoc freeradius-server-3.2.8/doc/antora/modules/tutorials/nav.adoc
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/nav.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/nav.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,40 @@
+* Tutorials
+** xref:new_user.adoc[New User]
+** xref:matching_users.adoc[Matching Users]
+** xref:new_client.adoc[New Client]
+
+** xref:accounting.adoc[Accounting]
+*** xref:simultaneous_use.adoc[Simultaneous Use]
+
+** Unlang
+*** xref:unlang_update_blocks_and_conditions.adoc[Update blocks and conditions]
+*** xref:unlang_splitting_strings.adoc[Splitting strings]
+*** xref:unlang_policies.adoc[Policies]
+
+** xref:proxy.adoc[Proxying]
+*** xref:proxy_receive.adoc[Proxy Receive]
+*** xref:proxy_failover.adoc[Proxy Fail-Over]
+*** xref:proxy_load_balance.adoc[Proxy Load-Balance]
+
+** EAP
+*** xref:eap-md5.adoc[EAP-MD5]
+*** xref:eap-ttls.adoc[EAP-TTLS]
+*** xref:eap-peap.adoc[EAP-PEAP]
+*** xref:eap-tls.adoc[EAP-TLS]
+
+** xref:sql.adoc[SQL]
+*** xref:sql_user.adoc[SQL Users]
+
+** xref:variables.adoc[Variables]
+** xref:dynamic-translation.adoc[Dynamic-Translation]
+** xref:multiple_modules.adoc[Module instances]
+** xref:autz-type.adoc[Autz-Type]
+** xref:module_fail_over.adoc[Module-Fail-Over]
+** xref:prepaid.adoc[Prepaid]
+** xref:dictionary.adoc[Dictionary]
+** xref:virtual.adoc[Virtual]
+** xref:radmin.adoc[Radmin]
+
+
+// Copyright (C) 2025 Network RADIUS SAS.  Licenced under CC-by-NC 4.0.
+// This documentation was developed by Network RADIUS SAS.
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/accounting.adoc freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/accounting.adoc
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/accounting.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/accounting.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,124 @@
+= Accounting Requests
+
+*Goal*: To send the server accounting requests and to have the server
+log the accounting requests.
+
+*Time:* 20-30 minutes
+
+*Files:*
+
+- `/var/radacct/127.0.0.1/detail*`
+
+*Modules:* detail
+
+In addition to authorization and authentication, one of the primary roles of a
+RADIUS server is to record accounting information supplied by an NAS. In this
+exercise, you should create accounting requests to send to the server and see what
+the server does with those requests. This process simulates the actions taken by
+an NAS when a user logs in.
+
+Use the entry in the file from the exercise in
+xref:new_user.adoc[New User] for user "bob".
+
+You may create accounting packets by hand for this exercise, but we suggest that
+the follow test packets from the `exercises/packets` directory be used in this
+exercise:
+
+[source, bash]
+-----------------
+bob-login-one.sh
+bob-acct-start.sh
+bob-acct-stop.sh
+-----------------
+
+If you do create accounting packets by hand, then the attributes listed in the
+above scripts should be used as a guide.
+
+First, run the `bob-login-one.sh` script.
+
+Observe that the server has replied with an authentication accept to an
+authentication request for user "bob", who has logged in on a particular NAS
+port.
+
+If the server does not reply with an authentication accept, then check the
+attributes in the test packet and the file entry.
+
+You should now read the `man` pages for the `radwho` and `radlast` programs. Run
+each program in turn:
+
+[source, bash]
+---------
+$ radwho
+$ radlast
+---------
+
+Observe that both programs do not report user "bob" as being logged in.
+
+Now run the `bob-acct-start.sh` script, and observe the response of the server.
+You should see output containing lines similar to the following:
+
+-----------------------------------------------------------------------------------
+(0) Received Accounting-Request packet from host 127.0.0.1 port 57470, id=35, length=53
+(0) 	User-Name = 'bob'
+(0) 	Acct-Status-Type = Start
+(0) 	Acct-Session-Id = '01020304'
+(0) 	NAS-IP-Address = 127.0.0.1
+(0) 	NAS-Port = 501
+(0) # Executing section preacct from file /etc/raddb/sites-enabled/default
+(0)   preacct {
+(0)   [preprocess] = ok
+-----------------------------------------------------------------------------------
+
+Other modules that should be referenced for "accounting" are the
+"preprocess", "suffix", "detail", and "sql" modules. We
+will work through the operation of these modules in a moment.
+
+Now, run the `radwho` and `radlast` programs again:
+
+[source, bash]
+---------
+$ radwho
+$ radlast
+---------
+
+Observe that both programs now see "bob" as being logged in.
+
+To tell the server that user "bob" has logged out, run the `bob-acct-stop.sh`
+script. Observe the server output, and then run `radwho` and `radlast` again.
+
+The `radwho` program should not display any logged-in users. The `radlast`
+program should now display both the last login time and the last logout time for
+user "bob".
+
+Now run the `bob-acct-stop.sh` program again. Observe how the server's output
+differs from the previous accounting stop packet.
+
+You should now read the `man` pages for the rlm_unix, rlm_radutmp, and
+rlm_unix modules, along with their configuration entries in
+`raddb/mods-available/radutmp` and `raddb/mods-available/unix`.
+
+In short, the "unix" module manages the database used by the `radlast`
+command. The "radutmp" module manages a separate database, which is used by
+the `radwho` command.
+
+The "detail" module simply logs every accounting request to a file in a simple
+textual format.
+
+== Questions
+
+1.  Why do accounting messages require less configuration of the server
+than authentication methods?
+2.  Why is the "detail" module useful?
+3.  Where is the "detail" file located? Why is the "detail" file in this location? Where is it configured?
+4.  What parts of the servers manage user session information?
+5.  What module other than "radutmp" can manage user session
+information?
+6.  Why is it useful to record which users are currently logged in?
+7.  What attributes that are found in the accounting request are not found in the
+authentication request? Why?
+8.  Which attributes are required to be in an accounting request?
+9.  What error message is produced on the second accounting stop, and
+why is it produced?
+
+// Copyright (C) 2021 Network RADIUS SAS.  Licenced under CC-by-NC 4.0.
+// This documentation was developed by Network RADIUS SAS.
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/autz-type.adoc freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/autz-type.adoc
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/autz-type.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/autz-type.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,66 @@
+= Using the Autz-Type attribute
+
+*Goal:* To control which authorization modules are executed for an
+`Access-Request`
+
+*Time:* 10-20 minutes
+
+*Files:*
+
+- `etc/raddb/sites-available/default`
+- `etc/raddb/users`
+
+This exercise is a follow-up to the previous one in
+xref:multiple_modules.adoc[Multiple Modules], and it uses the `byname` and `bydate` modules
+configured there.
+
+Start off by deleting the old log files:
+
+[source, bash]
+-------------------------------------------------
+$ rm -f /var/log/radius/radacct/byname/*
+$ rm -f !/var/log/radius/radacct/bydate/*
+-------------------------------------------------
+
+Edit the file, and add the following text at the top:
+
+----------------------------
+DEFAULT  Autz-Type := byname
+         Fall-Through = 1
+----------------------------
+
+In the `raddb/sites-available/default` file, edit the `authorize` section entries for
+the `byname` and `bydate` modules to be as follows:
+
+----------------------
+Autz-Type byname {
+	byname
+}
+
+Autz-Type bydate {
+	bydate
+}
+----------------------
+
+Start the server, and send it a test packet (e.g., `bob.sh`).
+
+Use the debug messages from the server to verify that only one of the modules is
+called.
+
+Look in the log directory, and verify the existence of the files and their contents, as follows:
+
+[source, bash]
+--------------------------------------------------
+$ ls /var/log/radius/radacct/byname/
+$ more /var/log/radius/radacct/byname/bob
+
+$ ls /var/log/radius/radacct/bydate/
+--------------------------------------------------
+
+[[autz-type-questions]]
+== Questions
+
+// Copyright (C) 2021 Network RADIUS SAS.  Licenced under CC-by-NC 4.0.
+// This documentation was developed by Network RADIUS SAS.
+1.  Why is it useful to _not_ call certain modules for a request?
+2.  Why is it useful to control which modules get called for a request?
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/dictionary.adoc freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/dictionary.adoc
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/dictionary.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/dictionary.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,70 @@
+= Custom Dictionaries and Attributes
+
+*Goal:* To understand how the dictionaries affect the server and to create
+a new vendor-specific dictionary with a number of custom attributes; also, to test those attributes in the server.
+
+*Time:* 20-30 minutes
+
+*File:*
+
+- usr/share/freeradius/dictionary.*
+
+*`man` page:* dictionary
+
+The dictionary files used by FreeRADIUS form the basis for mapping protocol
+numbers to humanly readable text. These dictionary files are ASCII and may be
+edited to add, delete, or update entries. For this exercise, you will create a
+custom dictionary and will send the attributes to the server using a RADIUS test
+client.
+
+You should first familiarize yourself with the `man` page for the "dictionary"
+file.
+
+You should create a file called `dictionary.test` in the appropriate directory
+and populate it with a "test" vendor, using a vendor ID of 123456. This
+dictionary file should be referenced from the main dictionary file. You should
+verify that the server starts successfully with the new dictionary file, even
+when the new dictionary is empty.
+
+You should now stop the server and add a number of vendor specific attributes to
+the "test" dictionary, as follows:
+
+.Vendor Specific Attributes to add
+|============================================
+| Name               | Number | Type
+| Lunch time         | 1      | date
+| People to eat with | 2      | text string
+| Where to eat       | 3      | IP address
+| What to eat        | 4      | integer
+|============================================
+
+.Enumerated values for "What to eat" to add
+|======================
+| Name      | Number
+| Salad     | 1
+| Bread     | 2
+| Dessert   | 3
+| Beans     | 4
+|======================
+
+Once the attributes and values are added to the `dictionary.test` file, re-start
+the server. Using a RADIUS client, send the server an authentication request for
+user "bob", containing one of each attribute. Verify that the attributes are
+printed as names, not numbers.
+
+Edit the file, and update the entry for user "bob" to reply with the
+attributes and with four names for "people to eat with". Re-send the
+authentication request for user "bob", and verify that the access accept
+contains the expected attributes.
+
+[[dictionary-questions]]
+== Questions
+
+1.  What happens when the same attribute has multiple names, i.e.,
+multiple names for one number?
+2.  Why are many of the attributes in other vendor specific dictionaries
+prefixed with the vendor name?
+3.  Why are vendor specific attributes useful?
+
+// Copyright (C) 2021 Network RADIUS SAS.  Licenced under CC-by-NC 4.0.
+// This documentation was developed by Network RADIUS SAS.
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/dynamic-translation.adoc freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/dynamic-translation.adoc
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/dynamic-translation.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/dynamic-translation.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,127 @@
+= Further dynamic translation
+
+*Goal:* To use dynamic translation of strings to perform inter-module
+references.
+
+*Time:* 20-35 minutes.
+
+*Files:*
+
+- `etc/raddb/radiusd.conf`
+- `etc/raddb/users`
+
+Run-time variables in the server may include more than simple references to
+attributes in packets. The server supports the ability to perform complex
+inter-module queries, which significantly extends its usefulness. In this
+exercise, we will work through a number of different examples of configuring
+inter-module calls.
+
+To start, open `raddb/mods-available/exec` and read the sample configuration for
+the `exec` module. Then, edit the users file to add the following entry at the
+top:
+
+-------------------------------------------------------------------------------
+bob Password.Cleartext := "hello"
+    Callback-Id = "%exec('/bin/echo', "Hello, there")
+-------------------------------------------------------------------------------
+
+The `echo` program may be in `/usr/bin/echo`, depending on your local system. On
+many systems you can use the following command:
+
+[source, bash]
+------------
+$ which echo
+------------
+
+This will tell you the full pathname of the `echo` command. Use that pathname in
+the file entry.
+
+Start the server and send it a test packet for user `bob`. The debug output of
+the server should print messages similar to the following.
+
+-------------------------------------------------------------------------------
+(0)  files : users: Matched entry bob at line 1
+Executing: /bin/echo Hello, there:
+Program returned code (0) and output 'Hello, there'
+(0)  files : EXPAND %exec('/bin/echo', "Hello, there")
+(0)  files :    --> Hello, there
+(0)   [files] = ok
+-------------------------------------------------------------------------------
+
+These message indicate that the first entry in the file (at line 1) was used to
+match the incoming request.
+
+The `exec` xlat function was then used to perform the dynamic translation of the
+string, which resulted in a call to the `rlm_exec` module.
+
+That module called the `Exec-Program` function of the server to execute a
+program, and finally, the `exec` xlat function returned the string "Hello
+there".
+
+That text was then sent back to the RADIUS client in the `Callback-Id`
+attribute, which was not quoted above.
+
+// Copyright (C) 2021 Network RADIUS SAS.  Licenced under CC-by-NC 4.0.
+// This documentation was developed by Network RADIUS SAS.
+Another dynamic translation string function is the `expr` module. It performs
+some simple mathematical operations. The following sample file entry
+demonstrates how to use the `expr` module.
+
+-------------------------------------------------------------------------------
+bob	Password.Cleartext := "hello"
+	Session-Timeout = "%{60 * 60}"
+-------------------------------------------------------------------------------
+
+Dynamically translated strings may also be used as "check items" to match
+requests coming in to the server. The following examples show how those strings
+(or run-time variables) may be used to both match a request and to configure
+dynamic responses.
+
+You should use the `bob-login-one.sh` script to send a request to match the
+first entry and should send another request with a different NAS-Port.
+
+-------------------------------------------------------------------------------
+bob	Password.Cleartext := "hello", NAS-Port == "%exec('/usr/bin/id', '-u')"
+	Reply-Message = "Your port is very nice.",
+	Session-Timeout = "%{60 * 60}"
+
+bob	Password.Cleartext := "hello", NAS-Port != "%exec('/usr/bin/id', '-u')"
+        Reply-Message = "Your port is less nice.",
+        Session-Timeout = "%{60 * 2}"
+-------------------------------------------------------------------------------
+
+The run-time variables may be nested, too. The following file entry
+demonstrates this nesting.
+
+-------------------------------------------------------------------------------
+bob	Password.Cleartext := "hello"
+	Session-Timeout = "%{60 * %exec(/usr/bin/id -u})"
+-------------------------------------------------------------------------------
+
+In this case, the user "bob" is given one minute of access time,
+multiplied by the value of the "UID" of the RADIUS server.
+
+== Further considerations
+
+Run-time variables allow inter-module calling. The administrator may perform LDAP
+queries and SQL queries to use database information in other modules.
+
+Unfortunately, the format of the string is module-dependent. This limitation
+comes from the fact that each module has its own syntax for database queries.
+The syntax for querying LDAP databases is different than the syntax for querying
+SQL database. The administrator should consult the `man` pages for the relevant
+module for more information on the syntax for run-time dynamic translation of
+strings.
+
+Another limitation is that the query string can be only approximately 250
+characters long in the current version of the server. This limitation may be
+removed in a later version.
+
+== Questions
+
+1.  How would you perform an SQL query in a run-time variable, instead of
+executing a program?
+2.  Why is it useful for modules to be able to query information from other
+modules?
+3.  What is an example of conditional syntax for a run-time variable?
+
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/eap-md5.adoc freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/eap-md5.adoc
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/eap-md5.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/eap-md5.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,66 @@
+= Other protocols within RADIUS: EAP-MD5
+
+*Goal:* To configure the server to use the EAP-MD5 authentication
+protocol and to send and receive test packets.
+
+*Time:* 10-15 minutes.
+
+*File:*
+
+- `etc/raddb/mods-available/eap`
+
+*Diagram:*
+
+image::eap-md5.svg[Fig. EAP-MD5]
+
+*Programs*: radtest
+
+For this exercise, your are assumed to have previously worked
+through and be familiar with the exercise in xref:new_user.adoc[New User] for
+user "bob".
+
+While RADIUS is an authentication protocol in its own right, other
+authentication protocols are also used in the network. One such protocol
+is the Extensible Authentication Protocol (EAP). It originally was
+designed to be used in PPP, but has been more widely used in recent
+deployments.
+
+EAP is a protocol that is intended to carry other authentication
+protocols. It does not carry authorization information like RADIUS, so it
+therefore has a more limited application. One of the most common uses for
+EAP is for wireless authentication. In this exercise, we will configure
+and test the EAP-MD5 sub-type of EAP.
+
+`raddb/mods-available/eap` has a configuration section for the `eap`
+module. The EAP sub-types are configured inside of that section. By
+default, the server ships with the EAP-MD5 module enabled, and with the
+EAP module initiating EAP-MD5 for all RADIUS requests containing EAP.
+
+You should now read the appropriate section of the `raddb/mods-available/eap`
+file, to verify that the `eap` module is configured and that the `md5`
+sub-module of the `eap` module is configured.
+
+The sample packet `eap-md5.sh` may now be used to test EAP-MD5
+authentication. The server output should be examined to follow the
+EAP-MD5 authentication process, and that output should be compared to the
+schematic diagram
+
+image::eap-md5.svg[Fig. EAP-MD5]
+
+== Questions
+
+1.  In which of the following sections is the `eap` module used?
+authorize, authenticate, and accounting.
+2.  Which of those sections do not reference the `eap`
+module? Why?
+3.  What is the difference (if any) between the server output for this
+test and the diagram below? Why is there a difference?
+image::eap_md5.svg[Fig. EAP-MD5]
+4.  Why do we test EAP-MD5 before testing other EAP types?
+5.  How is the EAP protocol carried within a RADIUS packet?
+6.  Why is the Message-Authenticator attribute required when using EAP?
+7.  What security issues exist with EAP-MD5?
+8.  Why is EAP-MD5 disabled in newer operating systems?
+
+// Copyright (C) 2021 Network RADIUS SAS.  Licenced under CC-by-NC 4.0.
+// This documentation was developed by Network RADIUS SAS.
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/eap-peap.adoc freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/eap-peap.adoc
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/eap-peap.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/eap-peap.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,82 @@
+= EAP-PEAP: Tunneled authentication
+
+*Goal:* To configure the server to use the EAP-PEAP authentication
+protocol and to send and receive test packets.
+
+*Time:* 20-35 minutes.
+
+*File:*
+
+- `etc/raddb/mods-available/eap`
+
+*Diagram:*
+
+image::peap_packet.svg[Fig. PEAP Packet]
+
+When started with the `radiusd -X` command, the server automatically creates
+certificates for use with PEAP. In a normal installation, there should
+be little or no action required to enable PEAP.
+
+Start the server, and verify that the `peap` module was loaded and that
+the server is `Ready to process requests`.
+
+This exercise does not cover how to configure EAP-PEAP on the wireless
+client nor how to set up a wireless access point to perform EAP-PEAP.
+We suggest that you consults the documentation for your
+wireless client software for details on this process.
+
+For the initial testing of EAP-PEAP, we recommend using
+`EAP-MSCHAPv2` on the wireless client as the tunneled authentication
+protocol. You should check that the `mschap` module is configured in the
+`raddb/modules` directory. The `mschapv2` module performs EAP-MSCHAPv2
+authentication and is contained in the `eap` section of the
+`raddb/eap.conf`. While these authentication methods are similar, they
+are not identical. Both modules need to be configured for EAP-PEAP to
+work.
+
+Test PEAP ``inner tunnel'' authentication via the following command:
+
+[source, bash]
+--------------------------------------------------------------
+$ radtest -t mschap 127.0.0.1:18120 USER PASSWORD 0 testing123
+--------------------------------------------------------------
+
+Once the wireless client has been configured to enable EAP-PEAP,
+you should perform a test authentication to the server. If all goes well,
+the server, AP, and wireless client should exchange multiple RADIUS
+`Access-Request` and `Access-Challenge` packets. This process should take
+a few seconds, and you should wait until it is done. If all goes well,
+the final packet from the server should be an `Access-Accept` and should
+contain the `MS-MPPE-Recv-Key` and `MS-MPPE-Send-Key` attributes.
+
+Verify that the authentication succeeded by using the `ping` command to
+see if the wireless client now has network access.
+
+== Further Considerations
+
+Different wireless clients may implement different tunneled
+authentication protocols inside of EAP-PEAP. These clients may not be
+compatible with all RADIUS servers. FreeRADIUS has only been tested
+using EAP-MSCHAPv2 as the tunneled authentication protocol. Other
+protocols may require source code changes to work.
+
+If there are issues getting EAP-PEAP to work on Windows, the following
+registry setting may be useful
+
+------------------------------------------------------------------
+HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Tracing\RASTLS\EnableTracing
+------------------------------------------------------------------
+
+Set the above key to value ``1''. A file `RASTLS.LOG` will be created
+and will contain the requested tracing information.
+
+== Questions
+
+1.  How does EAP-PEAP compare with EAP-TTLS?
+2.  What authentication protocols may be carried inside of the TLS
+tunnel for EAP-PEAP?
+3.  Would you use EAP-PEAP in a large deployment? If so, why? If not,
+why not?
+
+// Copyright (C) 2021 Network RADIUS SAS.  Licenced under CC-by-NC 4.0.
+// This documentation was developed by Network RADIUS SAS.
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/eap-tls.adoc freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/eap-tls.adoc
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/eap-tls.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/eap-tls.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,110 @@
+= EAP-TLS: Certificate-based authentication
+
+*Goal:* To configure the server to use the EAP-TLS authentication
+protocol and to send and receive test packets.
+
+*Time:* 20-35 minutes.
+
+*Files:*
+
+- `etc/raddb/mods-available/eap`
+- `scripts/certs.sh`
+- `etc/raddb/certs/`
+
+EAP-TLS is an authentication protocol that uses a TLS session, along
+with client and server certificates, to authenticate a user. You
+should now verify that the `rlm_eap_tls` module was built and installed
+by executing:
+
+[source, bash]
+--------------------------------------
+$ ls -l usr/lib64/freeradius/rlm_eap*
+--------------------------------------
+
+Use the directory where the FreeRADIUS libraries were installed.
+
+You should see not only files like `rlm_eap.so`, but also
+`rlm_eap_md5.so` and `rlm_eap_tls.so`. If you do not see those files,
+you will have to install them now. If necessary, you may have to
+re-build the server, as follows:
+
+[source, bash]
+---------------------------------------------------------------
+$ ./configure --prefix=$HOME/freeradius/ \
+              --with-openssl-include-dir=/usr/local/ssl/include \
+              --with-openssl-lib-dir=/usr/local/ssl/lib
+$ make
+$ make install
+---------------------------------------------------------------
+
+This exercise has insufficient room to describe how to debug any
+configuration, build, or installation problems with the `rlm_eap_tls`
+module. For the remainder of this exercise, we will assume that the
+driver is installed in the appropriate library directory.
+
+By default, the server creates a set of test certificates inside of the
+`raddb` directory, called `certs`. This directory contains sample server
+and client certificates, along with a demonstration certificate
+authority. These certificates may be used for this exercise, but should
+not be used in any live deployment of the server.
+
+You now edit the `etc/raddb/mods-available/eap` file to enable
+the `tls`. You should also set the configuration entry `default_eap_type`
+to `tls`.
+
+Start the server and verify that the `tls` module was loaded and that
+the server is `Ready to process requests`.
+
+This exercise does not cover how to configure EAP-TLS on the wireless
+client, nor how to set up a wireless access point to perform EAP-TLS. We
+suggest that the you consult the documentation for your wireless
+client software for details on this process.
+
+The wireless client will require the client certificate from the
+`raddb/certs` directory.
+
+Once the wireless client has been configured to enable EAP-TLS,
+you should perform a test authentication to the server. If all goes well,
+the server, AP, and wireless client should exchange multiple RADIUS
+`Access-Request` and `Access-Challenge` packets. This process should take
+a few seconds, and you should wait until it is done. If all goes
+well, the final packet from the server should be an `Access-Accept` and
+should contain the `MS-MPPE-Recv-Key` and `MS-MPPE-Send-Key` attributes.
+
+Verify that the authentication succeeded by using the `ping` command to
+see if the wireless client now has network access.
+
+== Further considerations
+
+EAP-TLS is an authentication protocol and nothing more. As such, the
+wireless client will still need to obtain an IP address. This address
+may be configured statically, or it may be obtained through DHCP.
+
+A benefit of EAP-TLS over EAP-MD5 is that it supports the creation of
+dynamic WEP keys. These keys are more secure than statically configured
+WEP keys and do not require administrator interaction to configure
+them. However, they are not perfectly secure, and we recommend that the
+server be configured to send a `Session-Timeout` attribute in the RADIUS
+`Access-Accept` packet in order to force the user to re-authenticate
+periodically, which will create new dynamic WEP keys.
+
+An issue with EAP-TLS is that it requires a client certificate. For
+secure authentication that does not require client certificates, see
+the EAP-TTLS and EAP-PEAP protocols.
+
+	Configuring the wireless client (usually a laptop or notebook
+computer) to perform EAP-TLS may be difficult. Windows (since Windows XP)
+ships with an EAP-PEAP client, which may influence any decision about
+which wireless authentication protocol to use.
+
+== Questions
+
+1.  What other benefits does EAP-TLS have over EAP-MD5?
+2.  What happens to the user's password when they use EAP-TLS?
+3.  Would you use EAP-TLS in a large deployment? If so, why? If not, why
+not?
+4.  What is the purpose of the `MS-MPPE-Recv-Key` and `MS-MPPE-Send-Key`
+attributes in the final `Access-Accept` packet?
+
+// Copyright (C) 2021 Network RADIUS SAS.  Licenced under CC-by-NC 4.0.
+// This documentation was developed by Network RADIUS SAS.
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/eap-ttls.adoc freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/eap-ttls.adoc
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/eap-ttls.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/eap-ttls.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,50 @@
+= EAP-TTLS: Tunneled authentication
+
+
+
+*Goal:* To configure the server to use the EAP-TTLS authentication
+protocol and to send and receive test packets.
+
+*Time:* 20-35 minutes.
+
+*File:*
+
+- `etc/raddb/sites-available/default`
+
+*Diagram:*
+
+image::eap-ttls.svg[Fig. TTLS Packet]
+
+During installation the build system automatically creates
+certificates for use with TTLS. In a normal installation, there should
+be little or no action required to enable TTLS.
+
+This exercise does not cover how to configure EAP-TTLS on the wireless
+client nor how to set up a wireless access point to perform EAP-TTLS.
+We suggest that you consult the documentation for your wireless
+client software for details on this process.
+
+For the initial testing of EAP-TTLS, we recommend using `PAP` on the
+wireless client as the tunneled authentication protocol.
+
+Once the wireless client has been configured to enable EAP-TTLS,
+you should perform a test authentication to the server. If all goes well,
+the server, AP, and wireless client should exchange multiple RADIUS
+`Access-Request` and `Access-Challenge` packets. This process should take
+a few seconds, and you should wait until it is done. If all goes well,
+the final packet from the server should be an `Access-Accept` and should
+contain the `MS-MPPE-Recv-Key` and `MS-MPPE-Send-Key` attributes.
+
+Verify that the authentication succeeded by using the `ping` command to
+see if the wireless client now has network access.
+
+== Questions
+
+1.  How is EAP-TTLS easier to use than EAP-TLS?
+2.  What authentication protocols may be carried inside of the TLS
+tunnel for EAP-TTLS?
+3.  Would you use EAP-TTLS in a large deployment? If so, why? If not,
+why not?
+
+// Copyright (C) 2021 Network RADIUS SAS.  Licenced under CC-by-NC 4.0.
+// This documentation was developed by Network RADIUS SAS.
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/failover.adoc freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/failover.adoc
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/failover.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/failover.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,331 @@
+= Configurable Module Fail Over
+
+Before configurable module failover, we had this kind of entry in "radiusd.conf"::
+----
+authorize {
+  preprocess
+  files
+}
+----
+
+This entry instructed the "authorize" section to first process the request through the "preprocess" module, and if that returned success, to process it through "files" module.  If that sequence returned success, then the "authorize" stage itself would then return success.  Processing was strictly linear and if one module failed, the whole section would fail immediately.
+
+Configurable failover provides more flexibility. It takes advantage of the tree structure of radiusd.conf to support a configuration
+language that allows you to "group" modules that should work together in ways other than simple lists.  You can control the flow of any stage (e.g. "authorize") to fit your needs, without touching C code, just by altering radiusd.conf.
+
+This configurable fail-over has a convenient short-hand, too.  Administrators commonly want to say things like "try SQL1, if it's
+down, try SQL2, otherwise drop the request."
+
+For example::
+----
+modules {
+    sql sql1 {
+        # configuration to connect to SQL database one
+    }
+    sql sql2 {
+        # configuration to connect to SQL database two
+    }
+    always handled {
+        rcode = handled
+    }
+}
+  
+#  Handle accounting packets
+accounting {
+    # always log to detail, stopping if it fails
+    detail
+    redundant {
+    # try module sql1
+          sql1
+          # if that's down, try module sql2
+          sql2
+          # otherwise drop the request as
+          # it's been "handled" by the "always"
+          # module (see doc/rlm_always)
+          handled
+    }
+}
+----
+
+The "redundant" section is a configuration directive which tells the server to process the second module if the first one fails.  Any
+number of modules can be listed in a "redundant" section.  The server will process each in turn, until one of the modules succeeds.  It will then stop processing the "redundant" list.
+
+== Rewriting results for single modules
+
+Normally, when a module fails, the entire section ("authorize", "accounting", etc.) stops being processed.  In some cases, we may want to permit "soft failures".  That is, we may want to tell the server that it is "ok" for a module to fail, and that the failure should not be treated as a fatal error.
+
+In this case, the module is treated as a "section", rather than just as a single line in "radiusd.conf".  The configuration entries for
+that section are taken from the "configurable fail-over" code, and not from the configuration information for that module.
+
+For example, the "detail" module normally returns "fail" if it is unable to write its information to the "detail" file.  As a test, we
+can configure the server so that it continues processing the request, even if the "detail" module fails.  The following example shows how::
+----
+#  Handle accounting packets
+accounting {
+    detail {
+    fail = 1
+}
+redundant {
+    sql1
+    sql2
+    handled
+    }
+}
+----
+
+The "fail = 1" entry tells the server to remember the "fail" code, with priority "1".  The normal configuration is "fail = return", which
+means "if the detail module fails, stop processing the accounting section".
+
+== Fail-over configuration entries
+
+Modules normally return on of the following codes as their result:
+
+[options="header"]
+[cols="30%,70%"]
+|=====
+| Code         | Meaning
+| notfound     | the user was not found
+| noop         | the module did nothing
+| ok           | the module succeeded
+| updated      | the module updated information in the request
+| fail         | the module failed
+| reject       | the module rejected the user
+| userlock     | the user was locked out
+| invalid      | the user's configuration entry was invalid
+| handled      | the module has done everything to handle the request
+|=====
+
+In a configurable fail-over section, each of these codes may be listed, with a value.  If the code is not listed, or a configurable fail-over section is not defined, then values that make sense for the requested "group" (group, redundant, load-balance, etc) are used.
+
+The special code "default" can be used to set all return codes to the specified value.  This value will be used with a lower priority than ones that are explicitly set.
+
+The values for each code may be one of the following:
+
+[options="header"]
+[cols="30%,70%"]
+|=====
+| Value        | Meaning
+| <number>     | Priority for this return code.
+| return       | Stop processing this configurable fail-over list.
+| reject       | Stop processing this configurable fail-over list and immediately return a reject.
+|=====
+
+The <number> used for a value may be any decimal number between 1 and 99999.  The number is used when processing a list of modules, to determine which code is returned from the list.  For example, if "module1" returns "fail" with priority "1", and a later "module2" returns "ok" with priority "3", the return code from the list of modules will be "ok", because it has higher priority than "fail".
+
+This configurability allows the administrator to permit some modules to fail, so long as a later module succeeds.
+
+== More Complex Configurations
+
+The "authorize" section is normally a list of module names.  We can create sub-lists by using the section name "group".  The "redundant" section above is just a short-hand for "group", with a set of default return codes, which are different than the normal "stop processing the list on failure".
+
+For example, we can configure two detail modules, and allow either to fail, so long as one of them succeeds.
+----
+#  Handle accounting packets
+accounting {
+    group {
+      detail1 {
+        fail = 1		# remember "fail" with priority 1
+	ok = return		# if we succeed, don't do "detail2"
+      }
+detail2 {
+	fail = 1		# remember "fail" with priority 1
+	ok = return		# if we succeed, return "ok"
+			# if "detail1" returned "fail"
+}
+    }			# returns "fail" only if BOTH modules returned "fail"
+    redundant {
+      sql1
+      sql2
+handled
+    }
+}
+----
+
+This configuration says:
+
+- Log to "detail1", and stop processing the "group" list if "detail1" returned OK.
+
+- If "detail1" returned "fail", then continue, but remember the "fail" code, with priority 1.
+
+- If "detail2" fails, then remember "fail" with priority 1.
+
+- If "detail2" returned "ok", return "ok" from the "group".
+
+The return code from the "group" is the return code which was either forced to return (e.g. "ok" for "detail1"), or the highest priority
+return code found by processing the list.
+
+This process can be extended to any number of modules listed in a "group" section.
+
+== More Complex Configuration using "if" and "else"
+
+As of version 2.0, the server allows "if"-style checking in the configuration sections.  The section is still processed as a list, so there is no looping or "goto" support.  But by using "if", the administrator can have branching paths of execution, where none was possible before.
+
+The "if" syntax added in 2.0.0-pre0 has been completely re-written in 2.0.0-pre2, to add major new functionality.  Documentation will be updated later...
+
+== Virtual Modules
+
+Some configurations may require using the same list of modules, in the same order, in multiple sections.  For those systems, the configuration can be simplified through the use of "virtual" modules.  These modules are configured as named sub-sections of the "instantiate" section, as follows::
+----
+instantiate {
+    ...
+  
+    redundant sql1_or_2 {
+        sql1
+        sql2
+    }
+}
+----
+
+The name "sql1_or_2" can then be used in any other section, such as "authorize" or "accounting".  The result will be exactly as if that section was placed at the location of the "sql1_or_2" reference.
+
+These virtual modules are full-fledged objects in and of themselves.  One virtual module can refer to another virtual module, and they can contain "if" conditions, or any other configuration permitted in a section.
+
+== Redundancy and Load-Balancing
+
+See load balancing for information on simple redundancy (fail-over) and load balancing.
+
+== The Gory Details
+
+The fundamental object is called a MODCALLABLE, because it is something that can be passed a specific radius request and returns one of the RLM_MODULE_* results. It is a function - if you can accept the fact that pieces of radiusd.conf are functions. There are two kinds of MODCALLABLEs: GROUPs and SINGLEs.
+
+A SINGLE is a reference to a module instance that was set up in the modules{} section of radiusd.conf, like "preprocess" or "sql1". When a SINGLE is called, the corresponding function in the rlm is invoked, and whichever RLM_MODULE_* it returns becomes the RESULT of the SINGLE.
+
+A GROUP is a section of radiusd.conf that includes some MODCALLABLEs.  Examples of GROUPs above include "authorize{...}", which implements the C function module_authorize, and "redundant{...}", which contains two SINGLEs that refer to a couple of redundant databases. Note that a GROUP can contain other GROUPs - "Auth-Type SQL{...}" is also a GROUP, which implements the C function module_authenticate when Auth-Type is set to SQL.
+
+Now here's the fun part - what happens when a GROUP is called? It simply runs through all of its children in order, and calls each one, whether it is another GROUP or a SINGLE. It then looks at the RESULT of that child, and takes some ACTION, which is basically either "return that RESULT immediately" or "Keep going". In the first example, any "bad" RESULT from the preprocess module causes an immediate return, and any "good" RESULT causes the authorize{...} GROUP to proceed to the files module.
+
+We can see the exact rules by writing them out the long way::
+----
+authorize {
+    preprocess {
+        notfound = 1
+        noop     = 2
+        ok       = 3
+        updated  = 4
+        fail     = return
+        reject   = return
+        userlock = return
+        invalid  = return
+        handled  = return
+    }
+    files {
+        notfound = 1
+        noop     = 2
+        ok       = 3
+        updated  = 4
+        fail     = return
+        reject   = return
+        userlock = return
+        invalid  = return
+        handled  = return
+    }
+  }
+----
+
+This is the same as the first example, with the behavior explicitly spelled out. Each SINGLE becomes its own section, containing a list of RESULTs that it may return and what ACTION should follow from them. So preprocess is called, and if it returns for example RLM_MODULE_REJECT, then the reject=return rule is applied, and the authorize{...} GROUP itself immediately returns RLM_MODULE_REJECT.
+
+If preprocess returns RLM_MODULE_NOOP, the corresponding ACTION is "2". An integer ACTION serves two purposes - first, it tells the parent GROUP to go on to the next module. Second, it is a hint as to how desirable this RESULT is as a candidate for the GROUP's own RESULT. So files is called... suppose it returns RLM_MODULE_NOTFOUND. The ACTION for notfound inside the files{...} block is "1". We have now reached the end of the authorize{...} GROUP and we look at the RESULTs we accumulated along the way - there is a noop with preference level 2, and a notfound with preference level 1, so the authorize{...} GROUP as a whole returns RLM_MODULE_NOOP, which makes sense because to say the user was not found at all would be a lie, since preprocess apparently found him, or else it would have returned RLM_MODULE_NOTFOUND too.
+
+We could use the "default" code to simplify the above example a little.  The following two configurations are identical::
+----
+files {
+    notfound = 1
+    noop     = 2
+    ok       = 3
+    updated  = 4
+    default  = return
+}
+----
+
+When putting the "default" first, later definitions over-ride it's return code::
+----
+  files {
+    default  = return
+    notfound = 1
+    noop     = 2
+    ok       = 3
+    updated  = 4
+}
+----
+
+[Take a deep breath - the worst is over]
+
+That RESULT preference/desirability stuff is pretty complex, but my hope is that it will be complex enough to handle the needs of everyone's real-world imperfect systems, while staying out of sight most of the time since the defaults will be right for the most common configurations.
+
+So where does redundant{...} fit in with all that? Well, redundant{...} is simply a group that changes the default ACTIONs to something like::
+----
+fail = 1
+everythingelse = return
+----
+
+so that when one module fails, we keep trying until we find one that doesn't fail, then return whatever it returned. And at the end, if they all failed, the redundant GROUP as a whole returns RLM_MODULE_FAIL, just as you'd want it to (I hope).
+
+There are two other kinds of grouping: group{...} which does not have any specialized default ACTIONs, and append{...}, which should be used when you have separate but similarly structured databases that are guaranteed not to overlap.
+
+That's all that really needs to be said. But now a few random notes:
+
+* GROUPs may have RESULT=ACTION specifiers too! It would look like this:
+----
+  authorize {
+      preprocess
+      redundant {
+          sql1
+          sql2
+          notfound = return
+      }
+      files
+  }
+----
+
+which would prevent rlm_files from being called if neither of the SQL instances could find the user.
+
+* redundant{...} and append{...} are just shortcuts. You could write:
+----
+group {
+    sql1 {
+        fail     = 1
+        notfound = 2
+        noop     = return
+        ok       = return
+        updated  = return
+        reject   = return
+        userlock = return
+        invalid  = return
+        handled  = return
+    }
+    sql2 {
+        fail     = 1
+        notfound = 2
+        noop     = return
+        ok       = return
+        updated  = return
+        reject   = return
+        userlock = return
+        invalid  = return
+        handled  = return
+    }
+}
+----
+
+instead of
+----
+redundant {
+    sql1
+    sql2
+}
+----
+
+but the latter is just a whole lot easier to read.
+
+* "authenticate{...}" itself is not a GROUP, even though it contains a list of Auth-Type GROUPs, because its semantics are totally different - it uses Auth-Type to decide which of its members to call, and their order is irrelevant.
+
+* The default rules are context-sensitive - for authorize, the defaults are what you saw above - notfound, noop, ok, and updated are considered success, and anything else has an ACTION of "return". For authenticate, the default is to return on success *or* reject, and only try the second and following items if the first one fails. You can read all the default ACTIONs in modcall.c (int defaultactions[][][]), or just trust me. They do the right thing.
+
+* There are some rules that can't be implemented in this language - things like "notfound = 1-reject", "noop = 2-ok", "ok = 3-ok", etc. But I don't feel justified adding that complexity in the first draft.  There are already enough things here that may never see real-world usage. Like append{...}
+
+== See Also
+
+* load balancing
+
+// Copyright (C) 2025 Network RADIUS SAS.  Licenced under CC-by-NC 4.0.
+// This documentation was developed by Network RADIUS SAS.
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/final_group_project.adoc freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/final_group_project.adoc
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/final_group_project.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/final_group_project.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,233 @@
+= Group Project - Simulating a production service
+
+*Goal:* To create a simulated, federated, production service
+
+*Time:* 2-3 hours
+
+This task is split into multiple sections.  If working with an instructor
+you should ask for your configuration file to be validated by the instructor
+after each section is complete.
+
+For this task you will need at least two participants.
+
+== Preparation
+
+Each participant should decide on the following:
+
+* A realm e.g. `example.com`, that their RADIUS server will respond to request for
+  the realm must be unique within the group.  This will be referred to as
+  `your_realm` in the rest of the text.
+* A shared secret for the realm `your_secret`.
+* A backend module (`your_module`) to use to authenticate their users. Again,
+  this should be unique within the group.
+  Options are:
++
+--
+** `files`
+** `ldap`
+** `redis`
+** `rest`
+** `sql`
+--
++
+For everything except `files` it's recommended to pick a module where you're
+familiar with the backend protocol.
+* A set of credentials (`your_user`, `your_password`). These should not be
+  sensitive credentials as they will be seen by the rest of the group.
+
+Each user should send the following information to the instructor or place it in
+a shared document:
+
+- `your_realm`
+- `your_secret`
+- `your_ip` (the public IP address of your test machine)
+- `your_module`
+- `your_user`
+- `your_password`
+
+For local preparation, you should ensure that the following sections have no
+content:
+
+- The `recv Access-Request { ... }` or `authorize { ... }` section of
+  `/etc/raddb/sites-available/default`.
+- The `send Access-Accept { ... }` or `post-auth { ... }` section of
+  `/etc/raddb/sites-available/default`.
+  _Clear the `post-auth-type reject { ...}` section if present but do not remove_.
+- The `send Access-Reject { ... }` section of `/etc/raddb/sites-available/default`.
+
+After completing each of the sections below, you should check that the
+configuration you've produced is valid (radiusd -XC), and if possible, test the
+functionality you've configured using `radtest` or `radclient`/
+
+== Proxying
+
+*Goal:* To simulate federated access, by configuring proxy destinations for
+multiple upstream home servers.
+
+*Files:*
+
+- xref:reference:raddb/mods-available/radius.adoc[`etc/raddb/mods-available/radius`]
+- xref:reference:raddb/sites-available/default.adoc[`etc/raddb/sites-available/default`] (optionally)
+- xref:reference:raddb/mods-available/linelog.adoc[`etc/raddb/mods-available/linelog`] (optionally)
+
+*Time:* 20-30 minutes
+
+For each participant in the group, create a realm with a single home server.
+
+The information for the realm should come from the shared document, and should use
+the realm name, the secret, and the ip address supplied by the participant.
+
+For `your_realm`, you should create a realm which authenticates users locally on
+your server.
+
+Liveliness checks should be performed with 'status-server'.
+
+All remote realms should be configured with "nostrip", so the full username is
+proxied.
+
+The local realm should not have "nostrip" set.
+
+=== Bonus tasks
+
+* When proxied requests fail, create a linelog message containing the date, the
+  username and the destination realm.
+* Log all outbound packets to the proxy.
+* Log all inbound packets from the proxy.
+* For each home server.
+** Set the check interval to three seconds.
+** Set the check timeout to three seconds.
+** Set the "number of answers until alive" to three answers.
+
+== Clients
+
+*Goal:* Allow incoming requests from other servers.
+
+*Files:*
+
+- xref:reference:raddb/clients.conf.adoc[`etc/raddb/clients.conf`]
+
+*Time*: 15-20 minutes
+
+Add client entries for each of the other participants server's, using
+the participant's name as the client name, the ip of their server as `ipaddr` and
+`your_secret` as the secret.
+
+[WARNING]
+====
+The secret used for the client _must_ be _your_ secret, not the other participants
+secret.  The other participant will be configuring your secret in the home
+server definition to send requests to your home server.  The client and home server
+definitions must match.
+====
+
+== Loading credentials
+
+*Goal:* Setup the backend, and populate it with credentials.
+
+*Time:* 10-60 minutes
+
+For your chosen backend:
+
+- Install any necessary packages
+- Load any FreeRADIUS specific schemas
+
+After the backend has bee setup insert your own credentials, and those for every
+other participant in the group, into your backend datastore.
+
+If the datastore provides no authentication method (`sql`, `redis`), you should
+use the value of `Stripped-User-Name` as the key, and when the user attempts to
+login, retrieve the user's password and store it in
+`control.Password.Cleartext`.
+
+== Authorization
+
+*Goal:* Retrieve user information from a backend datastore.
+
+*Files:*
+
+//- xref:reference:raddb/mods-available/suffix.adoc[`etc/raddb/mods-available/suffix`]
+- xref:reference:raddb/mods-available/files.adoc[`etc/raddb/mods-available/files`]
+- `etc/raddb/mods-config/files/authorize`
+- xref:reference:raddb/mods-available/ldap.adoc[`etc/raddb/mods-available/ldap`]
+- xref:reference:raddb/mods-available/redis.adoc[`etc/raddb/mods-available/redis`]
+- xref:reference:raddb/mods-available/rest.adoc[`etc/raddb/mods-available/rest`]
+- xref:reference:raddb/mods-available/sql.adoc[`etc/raddb/mods-available/sql`]
+
+*Time:* 20-60 minutes
+
+First, in the `recv Access-Request { ... }` or `authorize { ... }` section of
+of an appropriate virtual server,  call the suffix module.
+
+If, after the suffix module has returned, the `control.Proxy-To-Realm` attribute
+is set, use the `return` keyword to exit from the section.  This prevents local
+modules being called, when we know the request will be handled by a remote proxy.
+
+[source,unlang]
+----
+suffix
+if (control.Proxy-To-Realm) {
+	return
+}
+----
+
+The following backend modules have an built in authorization method:
+
+- `files`
+- `ldap`
+- `rest`
+- `sql`
+
+The redis module has a string expansion %redis(<command>) which can be used
+to retrieve a single value from the datastore.
+
+Call the backend module's authorize method (or run an appropriate expansion) to
+determine if the authenticating user exists in the datastore.
+
+If the user does exist, and your module has an authenticate method (`ldap`,
+`rest`), set `control.Auth-Type` to an appropriate value.
+
+If the backend module does not have an authenticate method (`redis`, `files`,
+`sql`), you should ensure the "known good" copy of the user's password is set in
+`control.Password.Cleartext` and then call the pap module.
+
+=== Bonus tasks
+
+- If the user was `notfound`, i.e. the user is local, log the fact the user was
+not found, along with the username, date and client IP address.
+
+== Authentication
+
+*Goal:* Authenticate a user.
+
+*Time:* 20-30 minutes
+
+For `ldap` and `rest` add or uncomment an appropriate `Auth-Type` section.
+
+For other backend modules, ensure the PAP module's `Auth-Type` section is
+uncommented.
+
+Run `radtest` or `radclient`, with credentials:
+`<your_user>@<your_realm>` and `your_password`. You should receive an Access-Accept.
+
+=== Bonus tasks
+
+- If the user was accepted, log the date, username, and client ip address.
+- If the user was rejected, log the date, username, and client ip address.
+
+== Remote-Authentication
+
+*Goal:* Verify all participants have configured their RADIUS services correctly.
+
+*Time:* 20+ minutes
+
+Check with the other participants to see how much of the exercise they have
+completed.  If a participant has a working RADIUS server, send request
+with `<your_user>@<their_realm>` and `your_password`, and verify that
+their server responds with an Access-Accept.
+
+If their server does not respond with an Access-Accept, work with the other
+participant to debug the issue.
+
+
+// Copyright (C) 2021 Network RADIUS SAS.  Licenced under CC-by-NC 4.0.
+// This documentation was developed by Network RADIUS SAS.
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/matching_users.adoc freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/matching_users.adoc
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/matching_users.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/matching_users.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,64 @@
+= Matching entries in the users file
+
+*Goal:* To configure multiple entries for a user in the "users" file
+and to validate the server's configuration by sending test packets to
+exercise the new entries.
+
+*Time:* 30-45 minutes.
+
+Now that we have verified that we can add a simple entry to the file, we
+will try more complex configurations.
+
+In this exercise, we will add three configuration entries for a user
+named "bob" with clear-text password "hello". The three entries are
+related as follows:
+
+* The first will configure user "bob" with password "hello". It will
+configure a reply message in an appropriate attribute. This
+configuration entry will cause the server to continue processing the
+file.
+* The second entry will configure user "bob" and will match only when
+"bob" is asking to use PPP. The configuration entry should add the
+appropriate attributes to the reply, to allow "bob" to use PPP and to
+assign him the IP address 192.168.10.12. This entry should also cause
+the server to continue processing the file.
+* The last entry will configure any user asking for "framed" service,
+and will assign them a default route of 192.168.10.1 with netmask of
+255.255.255.0.
+
+We suggest that you approach the problem by configuring each of the
+three entries in isolation. That is, add one entry, then create and send test
+packets until the server responds with the attributes you expect. Then,
+comment out the first entry and repeat the process for the second
+entry. Do the same for the third entry. Once all entries work in
+isolation, uncomment the first two and verify that the combination of
+entries behaves as expected.
+
+Test the server with username "bob" and password "hello". Use the
+debug output of the server to see which entries in the file were
+matched. You may use `radclient` or the `bob.sh` script to send the
+packets. In that case, save the packets into a file, and use the "-f"
+parameter to radclient to tell it which file to read.
+
+Perform other authentication tests, adding the appropriate attributes to
+the request sent by the RADIUS client. Continue until you have packets
+that will match:
+
+* entries 1 and 2, but not 3.
+* entries 1 and 3, but not 2.
+* entries 1, 2, and 3.
+
+Save copies of the packets.
+
+== Questions
+
+1.  What is the difference between the Framed-Route and Framed-Routing
+Attributes?
+2.  What is the Framed-IP-Netmask attribute used for?
+3.  What are potential pitfalls with the entry 2? That is, the entry
+meets the requirements, but do the requirements fit the needs of the
+network?
+4.  How does this kind of simple configuration scale to many users?
+
+// Copyright (C) 2021 Network RADIUS SAS.  Licenced under CC-by-NC 4.0.
+// This documentation was developed by Network RADIUS SAS.
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/module_fail_over.adoc freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/module_fail_over.adoc
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/module_fail_over.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/module_fail_over.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,114 @@
+= Module Fail-Over
+
+
+
+*Goal:* To configure the server to use a "backup" module if a
+"primary" module fails.
+
+*Time:* 15-25 minutes
+
+*Files:*
+
+- `etc/raddb/mods-available/detail`
+- `usr/share/doc/freeradius*/configurable_failover`
+- `/var/log/radius/radacct/detail1`
+- `/var/log/radius/radacct/detail2`
+
+When the server uses an external database to find user authentication
+information or to log accounting requests, that database may sometimes
+fail temporarily. This situation is similar to the situation seen in the exercise
+in xref:proxy_failover.adoc[Proxy Failover], where proxied
+requests "fail-over" to a backup RADIUS server when the primary
+RADIUS server does not respond.
+
+In this exercise, we will configure the server to use two "databases"
+(here, detail files) for recording accounting data. We will simulate the
+failure of one database by changing the file permissions on the first
+detail file, and we will verify that accounting requests are logged to the
+second detail file.
+
+The first step is to configure the server to have two instances of the
+`detail` module. The following information should be added to the
+`etc/raddb/mods-available/detail` file:
+
+--------------------------------------------------
+detail detail1 {
+	filename = ${radacctdir}/detail1
+	permissions = 0600
+}
+
+detail detail2 {
+	filename = ${radacctdir}/detail2
+	permissions = 0600
+}
+--------------------------------------------------
+
+In the file `configurable_failover` in the documentation directory,
+there is a section titled "More Complex Configurations". This section contains a
+sample entry for the "accounting" section of `etc/raddb/sites-available/default`.
+The sample entry is a "group" with configurable fail-over between two modules named
+`detail1` and `detail2`. Copy the "group" section to the start of the
+`accounting` section in your `etc/raddb/sites-available/default` file.
+
+Now start the server and verify that it is `Ready to process requests.`
+
+Send the server a sample accounting packet (`bob-acct-start.sh`). Verify
+that the client receives an accounting response packet and that the
+server is using the `detail1` module to log the request.
+
+Verify that the `detail1` file contains the accounting request by
+examining it:
+
+[source, bash]
+-----------------------------------------------
+$ more /var/log/radius/radacct/detail1
+-----------------------------------------------
+
+Also, verify that the `detail2` module is not referenced in the
+debugging messages of the server when the request is processed. Check
+that the `detail2` file does not exist:
+
+[source, bash]
+---------------------------------------------
+$ ls /var/log/radius/radacct/detail2
+---------------------------------------------
+
+The command should fail with an error like "file not found."
+
+Now, simulate a database failure by changing the permissions on the
+file so that the server may not access it:
+
+[source, bash]
+----------------------------------------------------
+$ chmod a-w /var/log/radius/radacct/detail1
+----------------------------------------------------
+
+Send the server another accounting packet ( `bob-acct-stop.sh`).
+
+Verify that the client receives an accounting response packet, that
+the `detail1` module fails, and that the server is using the `detail2`
+module to log the request.
+
+Verify that the `detail1` file does not contain the accounting request
+by examining it:
+
+[source, bash]
+-----------------------------------------------
+$ more /var/log/radius/radacct/detail1
+-----------------------------------------------
+
+Verify that the `detail2` file exists, and that it contains the accounting
+request:
+
+[source, bash]
+-----------------------------------------------
+$ more /var/log/radius/radacct/detail2
+-----------------------------------------------
+
+== Questions
+
+1.  Could the configuration for the "group" section containing the
+"detail1" and "detail2" modules be simplified? If so, how?
+
+// Copyright (C) 2021 Network RADIUS SAS.  Licenced under CC-by-NC 4.0.
+// This documentation was developed by Network RADIUS SAS.
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/multiple_modules.adoc freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/multiple_modules.adoc
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/multiple_modules.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/multiple_modules.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,71 @@
+= Multiple instances of a module
+
+
+
+*Goal:* To configure the server to have multiple instances of a module.
+
+*Time:* 10-20 minutes
+
+*File:*
+
+- `/etc/raddb/mods-available/detail`
+
+In this exercise, we will configure the server to use two independent
+``databases'' (here, detail files) for recording accounting data. These
+databases will use the same `detail` module, but with two different
+configurations. The `detail` module logs plain-text information about
+the request to a local file and is therefore an easy module to use for
+demonstration purposes.
+
+The first step is to configure the server to have two instances of the
+`detail` module. The first instance should log requests to a different
+file for each user name. The second should log requests to a different file
+for each date. The following information should be added to the
+`/etc/raddb/mods-available/detail` file.
+
+--------------------------------------------------------------------
+detail byname {
+	filename = ${radacctdir}/byname/%{User-Name || 'none'}
+	permissions = 0600
+}
+
+detail bydate {
+	filename = ${radacctdir}/bydate/%Y-%m-%d
+	permissions = 0600
+}
+--------------------------------------------------------------------
+
+In the module configurations contained within `/etc/raddb/mods-available/*`,
+each module may have two names. The first name is the name of the dynamically
+loadable module that implements that functionality. The second (optional) name
+is the name of an additional instance of the module. In this case, the `detail`
+module has two additional instances, `byname` and `bydate`. These instance names
+can be used in the `authorize`, `accounting`, etc. sections, just like a
+normal module name.
+
+You should now add the two modules to the list of modules in the
+`authorize` section. Start the server and verify that it is
+`Ready to process requests.`
+
+Send the server a test `Access-Request` packet (`bob.sh`). Verify that
+the client receives a response packet and that the server is using the
+two modules to log the request.
+
+Verify that the request was logged to two different files by examining
+them:
+
+[source, bash]
+------------------------------------------------
+$ more /var/log/radius/radacct/byname/*
+$ more /var/log/radius/radacct/bydate/*
+------------------------------------------------
+
+Once you have verified that the files exist and that the correct
+information is logged in them, you may stop the server.
+
+== Questions
+
+1.  Why is it useful to have multiple versions of a module?
+
+// Copyright (C) 2021 Network RADIUS SAS.  Licenced under CC-by-NC 4.0.
+// This documentation was developed by Network RADIUS SAS.
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/new_client.adoc freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/new_client.adoc
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/new_client.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/new_client.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,62 @@
+= Adding a new client to the server
+
+*Goal:* To permit an additional RADIUS client to communicate with the
+server.
+
+*Time:* 5-10 minutes.
+
+*File:*
+
+- `etc/raddb/clients.conf`
+
+The RADIUS server will only communicate with known clients. This
+restriction is for security, so that unknown machines on the Internet
+cannot probe the RADIUS server with test packets.
+
+In FreeRADIUS, the `clients.conf` file lists the clients that are
+permitted to send requests to the server. Take some time to read this file and
+the included comments.
+
+Configure the server with the the IP address of the new client and a
+shared secret. If the server is already running, stop it.
+
+Start the server
+
+[source, bash]
+------------
+$ radiusd -X
+------------
+
+Send a Status-Server packet from the new client to the server, using the
+correct IP address, port, and shared secret.
+
+Verify that the server saw the packet. Also verify that the client saw
+the response.
+
+Some common problems are:
+
+* not using the correct port in the client software
+* not using the the correct shared secret in the client software
+* the server responds to the client from an address that is different from the one to which the client sent the request.
+
+The first two problems can be solved by configuring the client with the
+correct information. The last problem is seen when the client does not
+see the response from the server, or when the server gives an error message about an
+invalid response.
+
+If the server responds to the packet and the client accepts the
+response, then the test was successful, and the server may be halted.
+
+== Questions
+
+1.  What happens when the server receives a packet from a machine not
+listed in "clients.conf"?
+2.  Why does the client not accept the response from the server when
+that response originates from another IP address?
+3.  Why does the server have to be re-started when the "clients.conf"
+file is edited?
+4.  What are the other fields in a client entry, and what are they used
+for?
+
+// Copyright (C) 2021 Network RADIUS SAS.  Licenced under CC-by-NC 4.0.
+// This documentation was developed by Network RADIUS SAS.
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/new_user.adoc freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/new_user.adoc
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/new_user.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/new_user.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,90 @@
+= Adding a new user to the server
+
+*Goal:* To configure the server with a new user, to send test packets as
+that new user, and to receive a reply.
+
+*Time:* 15-25 minutes.
+
+*File:*
+
+- `etc/raddb/users`
+
+*`man` page:* users
+
+The file is the usual place where new users may be added. The file is located
+in `etc/raddb/users`. It has a manual page; `man users`, or `man 5
+users` will display this page. The manual page describes how the entries in the file are
+formatted and also contains some example entries.
+
+The comments at the top of the file should also be read.
+
+For testing purposes, add an entry at the top of the file, which will add
+a new user "bob" with password "hello", as suggested in the `man`
+page for the file.
+
+Start the server:
+
+[source, bash]
+------------
+$ radiusd -X
+------------
+
+Test the server with a radius test client (radclient, NTRadPing), and
+verify that the server responds with an Access-Accept packet. For this
+test, use a PAP password.
+
+If the server was successful, look for a message similar to:
+
+---------------------------------------------------------------------
+(0)  files : users: Matched entry bob at line 1
+(0)   [files] = ok
+---------------------------------------------------------------------
+
+These messages indicate which entries in the file were used to match the
+incoming request.
+
+If the server does not see the packet, then double-check the IP address
+and port to which the client is sending the request.
+
+If the server does not send an Access-Accept, then stop the server and
+re-start it, while recording its output to a log file:
+
+[source, bash]
+----------------
+$ script log.txt
+$ radiusd -X
+----------------
+
+Send the test packet again, and after the Access-Reject is received by
+the client, "exit" the shell to close the "log.txt" file. Open the
+"log.txt" file in a text editor, and read the output. The cause of the
+error can generally be determined from those messages.
+
+The error will usually be one of the following problems:
+
+* the shared secret was incorrect
+* the user was not found, or no entry matched the request.
+
+Test the server again with a PAP password, but this time, deliberately
+use the wrong shared secret. Observe what happens and what error
+messages are produced.
+
+Test the server again with a test packet, this time using a CHAP
+password. Verify that authentication also succeeds.
+
+Test the server again with a CHAP password, but this time, deliberately
+use the wrong shared secret. Observe what happens and what error
+messages are produced. Also observe how the error messages are different
+from the previous test with a PAP password and incorrect shared secret.
+
+Stop the server.
+
+== Questions
+
+1.  What happens when using a PAP password with an incorrect shared secret, and why do we get this result?
+2.  What is different when using a CHAP password with an incorrect shared secret?
+3.  Why does the server need access to a clear-text password to perform
+CHAP authentication?
+
+// Copyright (C) 2021 Network RADIUS SAS.  Licenced under CC-by-NC 4.0.
+// This documentation was developed by Network RADIUS SAS.
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/prepaid.adoc freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/prepaid.adoc
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/prepaid.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/prepaid.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,46 @@
+= A simple pre-paid example
+
+
+
+
+*Goal:* To implement a simple "prepaid" functionality in the server.
+
+*Time:* 15-25 minutes
+
+*Files:*
+
+- `etc/raddb/mods-available/counter`
+
+Many system administrators wish to implement "prepaid" billing for
+their systems. In this exercise, we will configure the server to use a
+simple "prepaid" scheme, wherein all users will be permitted to log in
+for only one hour a day.
+
+Read `etc/raddb/mods-available/counter` and look for the `counter daily` instance
+The documentation for the module consists solely of the comments in
+`etc/raddb/mods-available/counter`, so those comments should be read carefully.
+Search the rest of the configuration file for references to the `daily` module
+and un-comment any references you find.
+
+Add an entry that sets the `Max-Daily-Session`
+to have the value 3600 to the top of the file. Start the server, and test it with the `bob.sh`
+script. Note that unlike previous responses from the server, this one
+contains a `Session-Timeout` attribute with value 3600.
+
+Wait five to ten seconds, and then use the `bob-acct-stop.sh` script to
+tell the server that user "bob" has logged off. Observe that the `counter`
+module is called and that this module updates the user's login time. Now send the
+server another login request (`bob.sh`), and observe that the
+"Session-Timeout" attribute has a value less than 3600. The value
+should be near 3600. This value depends on the length of time passed
+between when the server is started and when the `bob-acct-stop.sh` script is run.
+
+== Questions
+
+1.  How would you configure the server to obtain the daily access limits
+from an SQL database?
+2.  Why is it useful to enforce time-based restrictions on users, in
+addition to enforcing `Simultaneous-Use`?
+
+// Copyright (C) 2021 Network RADIUS SAS.  Licenced under CC-by-NC 4.0.
+// This documentation was developed by Network RADIUS SAS.
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/proxy.adoc freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/proxy.adoc
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/proxy.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/proxy.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,61 @@
+= Configuring a server to proxy requests
+
+
+
+*Goal:* To configure the server to proxy packets to a remote (home)
+RADIUS server and to perform test authentications against both the
+proxy server and the home server.
+
+*Time:* 15-25 minutes
+
+*File:*
+
+- `etc/raddb/proxy.conf`
+
+*Diagram:*
+
+image::access-request-proxy.svg[Fig. Proxy]
+
+For this exercise, you will configure a RADIUS server to proxy
+requests to a home RADIUS server that is run by another user
+(the uber user)).
+
+You will configure a realm, called "realm1" in the
+`raddb/proxy.conf` file. This realm will be proxied to the RADIUS server
+administered by the uber user, who will supply the IP address, port,
+and shared secret used by their RADIUS server. The entry for the home
+server in `proxy.conf` will be configured to "strip" the realm name
+from the incoming request.
+
+The entry from the exercise in
+xref:new_user.adoc[New User] for user "bob", in the
+"users" file will be used in this exercise.
+
+The example packets `bob.sh` and `bob@realm1.sh` may be used in this
+exercise.
+
+You should verify that authentication requests for user "bob"
+to their RADIUS server result in authentication accept replies and that
+the request was not forwarded to the home RADIUS server. You
+should then use the `bob@realm1.sh` script to attempt an authentication
+request to their RADIUS server, which will then be proxied to the home
+server.
+
+Once you have verified that authentication requests are proxied
+to the home server and that you have received an authentication accept, the
+uber user will halt the home server. The users should then
+re-attempt the `bob@realm1.sh` authentication request to their server.
+They should then observe the resulting behavior of their server, as it
+attempts to proxy to a home server that does not respond.
+
+== Questions
+
+1.  How would you configure "proxy.conf" so that "realm1" was not
+proxied, but was instead handled by the local RADIUS server?
+2.  Will it make any difference for the home server if the request sent
+to the proxy contains CHAP-Password instead of User-Password?
+3.  Since the User-Password is encrypted with the RADIUS shared secret,
+what happens to it when a request is proxied?
+
+// Copyright (C) 2021 Network RADIUS SAS.  Licenced under CC-by-NC 4.0.
+// This documentation was developed by Network RADIUS SAS.
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/proxy_failover.adoc freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/proxy_failover.adoc
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/proxy_failover.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/proxy_failover.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,69 @@
+= Proxy Fail-over
+
+
+
+*Goal:* To configure a "backup" home server that is used when the
+"primary" home server fails.
+
+*Time:* 15-25 minutes
+
+*Files:*
+
+- `etc/raddb/proxy.conf`
+- `etc/raddb/clients.conf`
+
+*Diagram:*
+
+image::proxy_backup_server.svg[Fig. Proxy Backup Server]
+
+For this exercise, you should find a group of other willing
+FreeRADIUS users!
+
+Divide yourselves into groups of three. One person (user 1) will
+operate the RADIUS server for "realm1" and the others will be operate
+the RADIUS server for "realm2".
+
+Each user will configure their realm in the `proxy.conf` file to
+be a "local" realm. user 1 will also configure two entries in the
+`proxy.conf` file for "realm2", one entry for each of the other
+partner's RADIUS servers. user 1 will configure the realms to "strip"
+the realm name from the incoming request.
+
+The two group for "realm2" should also configure their
+`clients.conf` file to permit user 1’s RADIUS server to act as a client,
+as given in the exercise in xref:new_client.adoc[New Clients].
+Each user operating "realm2" should pick a different shared
+secret to use with user 1.
+
+Once the servers have been configured, the group should collectively
+observe user 1 sending the following requests to their server:
+- bob@realm1.sh
+- bob@realm2.sh
+
+The group should verify that the expected authentication requests
+sent to the server for "realm1" are handled locally, as in the
+exercise in xref:proxy.adoc[Proxy].
+
+The group should then verify that the expected requests sent to
+the server for "realm1" are proxied to a server for "realm2". The
+group should send multiple requests to the server for "realm1" that are
+proxied to a server for "realm2", and they should verify that all of
+the requests are proxied to the same home server for "realm2".
+
+The group should then stop the "realm2" server that responded
+to that request, and they should repeat the request to "realm1". The
+group should observe the resulting behavior of the server for "realm1".
+
+If time permits, the group may switch roles, so that users have the
+opportunity to set up a proxy and a home server.
+
+== Questions
+
+1.  Which server for "realm2" is picked by "realm1"? Why?
+2.  Would the server for "realm1" ever again try to send packets to
+the "realm2" server that has been stopped? If so, when? If not,
+why not?
+3.  What would happen if both servers for "realm2" failed?
+
+// Copyright (C) 2021 Network RADIUS SAS.  Licenced under CC-by-NC 4.0.
+// This documentation was developed by Network RADIUS SAS.
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/proxy_load_balance.adoc freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/proxy_load_balance.adoc
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/proxy_load_balance.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/proxy_load_balance.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,40 @@
+= Proxy Load Balancing
+
+
+
+*Goal:* To configure a server to load-balanceproxied requests across
+multiple home servers.
+
+*Time:* 10-15 minutes
+
+*File:*
+
+- `etc/raddb/proxy.conf`
+
+*Diagram:*
+
+image::proxy_load_balance.svg[Fig. Proxy Loadbalance]
+
+For this exercise, the users will be divided into the same groups as
+the previous exercise in xref:proxy_failover.adoc[Proxy Failover].
+
+User 1 will edit his `proxy.conf` file, so that the entries for
+"realm2" are marked as load balancing. The users will send multiple
+requests to the server for "realm1", and observe how the proxied
+requests are distributed among the servers for "realm2".
+
+== Questions
+
+1.  Why is load balancing useful?
+2.  How is load balancing different than fail-over?
+3.  What happens to the load balancing when one of the "realm2"
+servers is stopped, and the server for "realm1" tries to proxy
+requests to it?
+4.  How would this exercise be different if there were more than two
+home server to load balance to?
+5.  If the load balancing home server which has "failed" is started
+again, will the proxying server ever send requests to it again? If so,
+when? If not, why not?
+
+// Copyright (C) 2021 Network RADIUS SAS.  Licenced under CC-by-NC 4.0.
+// This documentation was developed by Network RADIUS SAS.
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/proxy_receive.adoc freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/proxy_receive.adoc
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/proxy_receive.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/proxy_receive.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,78 @@
+= Configuring a server to send and receive proxy requests
+
+
+
+*Goal:* To configure the server to proxy packets to a remote (home)
+RADIUS server and to receive packets from another proxy server.
+
+*Time:* 15-25 minutes
+
+*Files:*
+
+- `etc/raddb/proxy.conf`
+- `etc/raddb/clients.conf`
+
+For this exercise, the users will be divided into groups of two. One
+user will be named "realm1" and the other will be named
+"realm2".
+
+Each user will configure two realms in the `proxy.conf` file. One of the
+user's assigned realms will be authenticated by the local RADIUS
+server. The other realm will be proxied to the RADIUS server
+administered by the other user. Both realms will be configured to
+"strip" the realm name from the incoming request.
+
+User 1:
+
+realm1 is local
+
+realm2 gets proxied to the server running as "realm2".
+
+User 2:
+
+realm1 gets proxied to the server running as "realm1".
+
+realm2 is local
+
+The users should also configure each other's server as a RADIUS
+client, as given in the exercise in xref:new_client.adoc[New Clients].
+
+The entry from the exercise in xref:new_user.adoc[New User] for user "bob" in
+the file, will be used in this exercise.
+
+The example packets `bob.sh`, `bob@realm1.sh`, and `bob@realm2.sh` may
+be used in this exercise.
+
+Each user should test that authentication requests from "bob" to
+their RADIUS server should result in authentication accept replies and
+that the request was not forwarded to the other RADIUS server.
+
+Each user should test that authentication requests for their own
+realm (User 1: "bob@realm1", User 2: "bob@realm2") to their
+RADIUS server should result in authentication accept replies and that
+the request was not forwarded to the other RADIUS server.
+
+Each user in turn should then attempt authentication using the other
+user's realm (User 1: "bob@realm2", User 2: "bob@realm1"),
+to their local RADIUS server.
+
+Each in turn should verify that authentication requests for their
+realm sent to the other user's RADIUS server results in an
+authentication reject.
+
+User 2 should then stop his server. User 1 should then attempt an
+authentication request to his server where the request would normally
+be proxied. Both users should examine the debug logs of User 1’s
+RADIUS client and server in order to observe what the server's resulting behavior
+will be.
+
+== Questions
+
+1.  Why is it necessary for each server to mark some realms as local?
+2.  What would happen if each user did not configure the other RADIUS
+server in the "raddb/clients.conf" file?
+3.  What would happen if each user did not configure the realms to
+"strip" the realm from the proxied requests?
+
+// Copyright (C) 2021 Network RADIUS SAS.  Licenced under CC-by-NC 4.0.
+// This documentation was developed by Network RADIUS SAS.
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/radmin.adoc freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/radmin.adoc
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/radmin.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/radmin.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,34 @@
+= The Administration CLI
+
+*Goal:* To understand how to use the `radmin` command.
+
+*Time:* 20-30 minutes
+
+*File:*
+
+- `etc/raddb/sites-enabled/control-socket`
+
+*`man` page:* radmin, raddebug
+
+The `radmin` command is an interactive command-line interface (CLI) to
+the internals of the server. It can be used to monitor statistics, to
+show the current configuration, and to change the configuration.
+
+Check that the control socket is enabled, and start the server in
+debugging mode. Connect to the control socket via `radmin`. Type `help`,
+and read the output. Use `radtest` to send the server packets, and see
+how the statistics change.
+
+== Questions
+
+1.  How can you modify the `control-socket` file so that you can change
+the server configuration?
+2.  What happens when you disable a module and try to authenticate a
+user?
+3.  How can you run a command from the shell without starting the
+`radmin` command?
+4.  Can you start the server in non-debugging mode (`radiusd -f`), and
+still see the debugging output? How?
+
+// Copyright (C) 2021 Network RADIUS SAS.  Licenced under CC-by-NC 4.0.
+// This documentation was developed by Network RADIUS SAS.
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/simultaneous_use.adoc freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/simultaneous_use.adoc
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/simultaneous_use.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/simultaneous_use.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,61 @@
+[[simultaneous-use]]
+= Configuring users for limited simultaneous access
+
+*Goal:* To prevent a user from having more than one login session at a
+time.
+
+*Time:* 20-35 minutes
+
+*Files:*
+
+- `etc/raddb/users`
+
+For this exercise, you are assumed to have previously worked
+through, and be familiar with, the accounting exercise from
+xref:accounting.adoc[Accounting], and to have an entry in the file, as given the
+exercise in xref:new_user.adoc[New User], for user "bob".
+
+In this exercise, youwill work through an example of a user
+logging into the server, and then attempting a simultaneous login for a
+second session, while still logged in for the first session.
+
+You should run the `bob-login-one.sh` and `bob-acct-start.sh`
+scripts, to simulate a successful user login. You should check the database
+to verify that the server knows that the user is logged
+in.
+
+You should then run the `bob-login-two.sh`, and observe that the
+second authentication request succeeds. The login record should be
+removed through running the `bob-acct-stop.sh` script, and check the database
+to verify that no one is currently
+logged in.
+
+you should now read the `Simultaneous-Use` file in the
+documentation directory, to determine how to limit a user to only one
+login at a time. The "bob" entry in the file should then be edited, to
+add the limitation that "bob" may only have one login session at a
+time.
+
+The scripts `bob-login-one.sh` and `bob-acct-start.sh` should be run
+again, to simulate a successful user login. The `bob-login-two.sh`
+script should then be run, to verify that the second simultaneous
+authentication attempt fails.
+
+After running the `bob-acct-stop.sh` script, you should run the
+`bob-login-two.sh` script again, to verify that the other login attempt
+is now permitted to succeed.
+
+== Questions
+
+1.  Why is it useful to prevent a user from having more than one
+simultaneous login session?
+2.  How would you configure `Simultaneous-Use` with an SQL database?
+3.  What are the benefits of using an SQL database for
+`Simultaneous-Use`, over the `radumtp` file?
+4.  How does `Simultaneous-Use` affect users with multiple "bonded"
+lines, like MPP, or ISDN?
+5.  What would happen if the user tried to log in a second time, before
+the accounting start packet was received?
+
+// Copyright (C) 2021 Network RADIUS SAS.  Licenced under CC-by-NC 4.0.
+// This documentation was developed by Network RADIUS SAS.
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/sql.adoc freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/sql.adoc
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/sql.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/sql.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,176 @@
+= Communicating with an SQL database
+
+
+
+*Goal:* To configure the server to communicate with an SQL database.
+
+*Time:* 25-40 minutes.
+
+*File:*
+
+- `etc/raddb/mods-available/sql`
+- `etc/raddb/mods-config/sql/main/*`
+
+In addition to the file, the server may obtain user configuration
+information from an SQL database. In this exercise, you will
+configure the server to communicate with an SQL database. you
+will configure the schema for the SQL server, and will populate that
+schema with a sample entry similar to that for the exercise in
+xref:new_user.adoc[New User].
+
+There are a number of reasons why user information may be stored in an
+SQL database, rather than the file. While the file is adequate for a
+small number of users, it does not scale well to millions of users, and
+it may not be updated by general non-RADIUS tools. In contrast, SQL
+databases are designed to store millions of records, to have fast
+queries and retrievals, and there are many third-party tools for
+maintaining and updating the databases.
+
+The SQL schema used by FreeRADIUS is designed to mirror the users file.
+Each SQL dialect has its own set of schema and configuration files.
+They are located in the `raddb/mods-config/sql/main/<dialect>` directory.
+
+The schema is defined by the "schema.sql" file, and the queries are
+defined by the `queries.conf` file.
+
+The main configuration for the SQL module is `raddb/mods-available/sql`
+it will `$INCLUDE` the appropriate "queries.conf" file for the dialect
+chosen.
+
+You should now read the configuration file for the SQL database which you
+use.
+
+[TIP]
+========================================================================
+Unless there is a pre-configured database available we recommend the
+sqlite driver be used. If the sqlite specific stanzas are uncommented
+in `raddb/mods-available/sql` it will automatically bootstrap a new
+database using the bundled schema.
+========================================================================
+
+The first step is to configure the server to use the SQL module, and to
+communicate with the SQL database. Edit the `radiusd.conf` file, and
+look for the `instantiate` section. Inside of that section, add one line
+containing the word `sql`, as follows:
+
+------------------------------------------
+instantiate {
+        sql     # start up the SQL module.
+}
+------------------------------------------
+
+This tells the server to look for, and use, the `sql` module when the
+server starts. Note that since the `sql` module is not listed in any of
+the "authorize", "authenticate", etc. sections, it will not be used
+in to process any authentication requests, or accounting requests. For
+now, we are interested solely in making the FreeRADIUS server
+communicate with the SQL server.
+
+Open `raddb/mods-available/sql` verify that the first few configuration
+entries are correct. That is, the "server", "login", and "password"
+entries should be set up correctly for your local SQL database.
+
+If using sqlite, these entries can be left commented out as they're not
+required, but you should uncomment the `sqlite {}` section and the
+configuration items within that section.
+
+FreeRADIUS uses the `rlm_sql` module to interface with the SQL
+databases. You should check that this module is installed by doing:
+
+[source, bash]
+--------------------------------------
+$ ls -l usr/lib64/freeradius/rlm_sql*
+--------------------------------------
+
+(Or, the directory wherever the FreeRADIUS libraries were installed.)
+
+You should see not only files like "rlm_sql.so", but also
+"rlm_sql_mysql.so", or "rlm_sql_sqlite.so". If you do not see
+"rlm_sql.so", or you do not see the sub-module which interfaces with
+your SQL server, you will have to install it now. You may do this by
+going to the rlm_sql subdirectory, and building the module:
+
+[source, bash]
+------------------------
+$ cd freeradius-server/src/modules/rlm_sql
+$ ./configure
+$ make
+$ make install
+------------------------
+
+This exercise has insufficient room to describe how to debug any
+configuration, build, or installation problems with the SQL drivers. For
+the remainder of this exercise, we will assume that the driver is
+installed in the appropriate library directory.
+
+Once you have verified that the SQL driver exists, have enabled the module
+by creating a symlink from `raddb/mods-available/sql` to
+`raddb/mods-enabled/sql` and you have configured the appropriate sql dialect,
+you should start the server as usual:
+
+------------
+$ radiusd -X
+------------
+
+If all has gone well, the server should print out the normal "Ready to
+process requests" message. Scroll up in your terminal window, and there
+should be messages from the `sql` module, such as:
+
+--------------
+rlm_sql_sqlite: Database doesn't exist, creating it and loading schema
+rlm_sql_sqlite: Executing SQL statements from file "/etc/raddb/mods-config/sql/main/sqlite/schema.sql"
+rlm_sql (sql): Driver rlm_sql_sqlite (module rlm_sql_sqlite) loaded and linked
+rlm_sql (sql): Attempting to connect to database "radius"
+rlm_sql (sql): Initialising connection pool
+   pool {
+   	start = 5
+   	min = 4
+   	max = 100
+   	spare = 3
+   	uses = 0
+   	lifetime = 0
+   	cleanup_interval = 30
+   	idle_timeout = 60
+   	retry_delay = 1
+   	spread = no
+   }
+rlm_sql (sql): Opening additional connection (0)
+rlm_sql_sqlite: Opening SQLite database "/tmp/freeradius.db"
+rlm_sql (sql): Opening additional connection (1)
+rlm_sql_sqlite: Opening SQLite database "/tmp/freeradius.db"
+rlm_sql (sql): Opening additional connection (2)
+rlm_sql_sqlite: Opening SQLite database "/tmp/freeradius.db"
+rlm_sql (sql): Opening additional connection (3)
+rlm_sql_sqlite: Opening SQLite database "/tmp/freeradius.db"
+rlm_sql (sql): Opening additional connection (4)
+rlm_sql_sqlite: Opening SQLite database "/tmp/freeradius.db"
+--------------
+
+These messages indicate that the server was able to load the `sql`
+module, and that the `sql` module was able to communicate with the SQL
+server.
+
+If there is a problem with shared libraries, or with access permissions
+to the SQL database, then an error message will be printed, and the
+server will not start properly. The FreeRADIUS FAQ and the
+`radiusd.conf` file, entry "libdir", contain information as to how to
+fix shared library issues.
+
+If there are issues connecting to the database you should verify manually
+that you can connect to the SQL database using the given "server",
+"login", and "password". The SQL database should come with a test
+client which may be used to perform this test.
+
+Now stop the server. The next exercise will be to add the schema to the
+database, and to populate it with a test entry.
+
+== Questions
+
+1.  Why is it important to test SQL connectivity, independently of
+testing the ability to obtain user configuration from an SQL database?
+2.  Why are there different configuration files for each SQL server?
+3.  What additional benefits, not mentioned here, do SQL databases have
+over the files module?
+
+// Copyright (C) 2021 Network RADIUS SAS.  Licenced under CC-by-NC 4.0.
+// This documentation was developed by Network RADIUS SAS.
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/sql_user.adoc freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/sql_user.adoc
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/sql_user.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/sql_user.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,93 @@
+= Configuring a user in an SQL database
+
+*Goal:* To configure the server to have a new user in an SQL database,
+to send test packets as that user, and to receive a reply.
+
+*Time:* 25-40 minutes.
+
+*File:*
+
+- `etc/raddb/mods-available/sql`
+- `etc/raddb/mods-config/sql/main/*`
+
+Now that we have verified in the previous exercise,
+xref:sql.adoc[SQL] that the server can communicate with
+an SQL server, we proceed to adding user configuration entries into the
+SQL database.
+
+Before adding any user configuration to an SQL database, we first need
+to create the schema used to store that information. In the source
+archive, the file `RADIUS-SQL.schema` in the documentatin directory,
+describes where the schemas are located, and how to install them. In
+general, you will need to be familiar with the tools for the SQL
+database your are using, as they are too complicated and variable to
+describe here.
+
+Once the schema has been created, use an SQL client utility to execute
+the following SQL commands:
+
+[source, sql]
+---------------------------------------------------------
+INSERT INTO radcheck (UserName, Attribute, op, Value)
+  values("bob", "Password.Cleartext", ":=", "hello");
+INSERT INTO radreply (UserName, Attribute, op, Value)
+  values("bob", "Reply-Message", ":=", "Hello from SQL");
+---------------------------------------------------------
+
+These commands may need to be modified slightly, depending on the syntax
+required by your SQL database.
+
+These commands mirror the "check" and "reply" entries listed in the
+file for the user "bob". Use the SQL client to verify that the entries
+are now in the database.
+
+As the previous exercise in xref:sql.adoc[SQL]
+did not tell the server to query the database, but only to connect to it,
+we must now configure FreeRADIUS to query the database. This may be done
+by editing `etc/raddb/sites-available/default`, and listing the `sql`
+module in the "authorize" section.
+
+There should already be a commented-out entry for `sql` in the
+"authorize" section or there will be `-sql` entry.
+If the entry is commented it should be un-commented, to make it live.
+If the entry has a '-' prefix, it may be left as is, the '-' prefix is used
+to mark modules as optional, so that the server can start even if they
+are not enabled.
+
+The file should now be edited to delete the existing entry or entries
+for user "bob". This may be done by commenting out the entries, rather
+than deleting them. Add a `#` character to the start of every line
+for the relevant entries, and save the updated file.
+
+The server should now be started. Send a test packet for user "bob",
+and verify that an authentication accept packet is received. Observe the
+debugging output of the server, and verify that the `sql` module is
+called, and that it successfully returns data for user "bob".
+
+If the server rejects the access request, then there are a number of
+steps to take, to correct the problem. Verify that FreeRADIUS is
+connecting to the SQL server, and that FreeRADIUS is "Ready to process
+requests." Verify that the file entry for "bob" has not matched the
+request. Verify that the SQL module returns "ok", rather than
+"notfound".
+
+If necessary, edit the `etc/raddb/mods-enabled/sql` file, and enable
+additional debugging of SQL statements via the `sqltrace` and `sqltracefile`
+configuration options. If the SQL queries are performed by the server and
+logged to the file, but the request for user "bob" is still rejected, then
+perform those queries by hand, using an SQL test client. Once you have
+verified that the SQL test client returns the correct information for
+the queries, then send the access request again.
+
+== Questions
+
+1.  Why do we not use an SQL database to "authenticate" users?
+2.  How do we have a DEFAULT entry in an SQL database?
+3.  Why is there no "Fall-Through" entry in an SQL database?
+4.  Does that DEFAULT entry differ from its use in the file? If so, why,
+and how? If not, why not?
+5.  What other configuration entries in `etc/raddb/sites-available/default`
+    exist for the `sql` module, and why?
+
+// Copyright (C) 2021 Network RADIUS SAS.  Licenced under CC-by-NC 4.0.
+// This documentation was developed by Network RADIUS SAS.
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/trouble_shooting.adoc freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/trouble_shooting.adoc
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/trouble_shooting.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/trouble_shooting.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,44 @@
+If you encounter a problem with server configuration, observe the following set of procedures to troubleshoot or debug the server:
+
+* Make small, discrete changes to the configuration files.
+
+* Start the server in debugging mode: `radiusd -X`
+
+* Verify that the results are what you expect
+** The debug output shows any configuration changes you have made.
+** Databases (if used) are connected and operating.
+** Test packets are accepted by the server.
+** The debug output shows that the packets are being processed as you expect.
+** The response packets are contain the attributes you expect to see.
+
+* If everything is OK, save a copy of the configuration, go back and make another change.
+
+* If anything goes wrong,
+** double-check the configuration
+** read the entire debug output, looking for words like error or warning. These messages usually contain descriptions of what went wrong, and suggestions for how it can be fixed.
+
+* If you can't make any progress, try to replace your configuration with a saved copy of a "known working" configuration, and start again. This process can clean up errors caused by temporary edits, or edits that you have forgotten.
+
+* If you get stuck, ask for help on the freeradius-users [[project/Mailing list|mailing list]]. Include a description of what you are trying to do, and the entire debugging output, especially output showing the server receiving and processing test packets.
+** You may want to scrub "secret" information from the output before posting it - shared secrets, passwords, etc
+** Please do *not* scrub all the exact addresses and similar data, because often the process of obfuscating can introduce more errors
+
+== Reminder - run the server in debugging mode!
+
+Run the server in debugging mode as suggested in the FAQ, README, INSTALL, man page, and daily on the mailing list.
+
+We cannot emphasize that strongly enough. There is no way for anyone to help you unless you post the debugging output along with your question. If you do not post the debugging output, your question will either be ignored, or you will receive a number of responses saying
+Post the debug output as suggested in the FAQ, README, INSTALL, man page, and daily on the mailing list.
+
+A large number of problems can be trivially solved by having an expert read the debug output. If you do not post it to the list, you are making it impossible for anyone to help you.
+
+== Parsing debug mode
+
+You can usually interpret the debug messages, but if you need help, there is a debug form available at:
+
+* http://networkradius.com/freeradius.html
+
+Paste the output into the debug form, and a colorized HTML version will be produced. Look for red or yellow text, and read the messages.
+
+// Copyright (C) 2025 Network RADIUS SAS.  Licenced under CC-by-NC 4.0.
+// This documentation was developed by Network RADIUS SAS.
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/unlang_policies.adoc freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/unlang_policies.adoc
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/unlang_policies.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/unlang_policies.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,62 @@
+= Unlang Policies
+
+*Goal:* Create and use policies for abstracting business logic
+
+*Time:* 10-20 minutes
+
+*File:*
+
+- `etc/raddb/policy.d/*`
+
+*`man` page:* unlang
+
+include::partial$unlang_start.adoc[]
+
+Look through the existing files in `etc/raddb/policy.d/*` and the rest
+of the documentation to get a feel for the unlang syntax and the tasks
+that policies can be used for.
+
+The basic structure of a policy is the policy name then a set of curly
+braces containing the body of the policy
+
+------------------------------------------------
+a_policy {
+	if (User-Name =~ /@([\w.+])/) {
+		reply.Reply-Message := "Hello remote %{User-Name}"
+	}
+}
+------------------------------------------------
+
+Policies defined within `etc/raddb/policy.d/*` can be called from
+anywhere in the server where modules can be called.
+
+------------------------------------------------
+authorize {
+	...
+	a_policy
+	...
+}
+------------------------------------------------
+
+Create a policy `proxy_to_realm` that forwards the incoming request
+to to a remote realm if the `User-Name` attribute ends in `@<remote realm>`.
+
+The contents of this policy should be identical to the the 'unlang'
+code written for the xref:unlang_splitting_strings.adoc[Splitting Strings]
+tutorial.
+
+Call this policy at the start of the `authorize {}` section of the
+`etc/raddb/sites-available/default` virtual server.
+
+All the information you need to create this policy is contained within
+documentation pages and the examples in this exercise.
+
+== Questions
+
+1.  What are the advantages of using the policy language over interpreted
+    language modules?
+2.  What are the main differences between a policy and a function in other
+    languages?
+
+// Copyright (C) 2021 Network RADIUS SAS.  Licenced under CC-by-NC 4.0.
+// This documentation was developed by Network RADIUS SAS.
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/unlang_return_codes.adoc freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/unlang_return_codes.adoc
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/unlang_return_codes.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/unlang_return_codes.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,68 @@
+= Module return codes
+
+*Goal:* Explore uses of return codes and return code overrides
+
+*Time:* 10-15 minutes
+
+*File:*
+
+- `etc/raddb/policy.d/*`
+
+*`man` page:* unlang
+
+- xref:unlang:index.adoc[Conditional Expressions]
+- xref:unlang:return_codes.adoc[Return Codes]
+- xref:unlang:return_codes.adoc[The Return Code Operator]
+- https://github.com/FreeRADIUS/freeradius-server/blob/v3.2.x/src/modules/rlm_always/README.md[The Always Module]
+- https://github.com/FreeRADIUS/freeradius-server/blob/695a87f98c02568d5aa2f07ae1b9212101c4dcf9/src/modules/rlm_sometimes/README.md[The Sometimes Module]
+
+include::partial$unlang_start.adoc[]
+
+The server includes a number of instances of the
+xref:reference:raddb/mods-available/always.adoc[always] module.  These are used to set
+return codes during policy evaluation.
+
+For example, if the `ok` always module instance is called, the `ok` return code
+will be returned, and subject too priority comparisons, will be set as the
+return code for the request.
+
+One of the most common reasons for overriding return codes is to implement
+special behaviour on failure.
+
+To minimize external dependencies, for this exercise we will use the
+xref:reference:raddb/mods-available/sometimes.adoc[sometimes] module to simulate an
+unreliable external database.
+
+This module will return a specified xref:unlang:return_codes.adoc[return code] 50%
+of the time.
+
+Create an instance of the sometimes module called `bad_ldap`.
+
+Add unlang statements such that if the module returns `noop`, then a
+`control.Password.Cleartext = 'hello'` attribute pair is added to the request,
+and the return code is set to `updated`.
+
+Run three test requests using `bob.sh`, you should see that at least one request
+fails (though it may not as sometimes is truly random).
+
+Now add a policy to handle the `fail` return code of the sometimes module by
+executing the `files` module to provide an alternative source of credentials.
+
+[TIP]
+====
+You may need to modify the return code priorities of the
+xref:reference:raddb/mods-available/sometimes.adoc[sometimes] module.
+====
+
+If the policies are correct you will see that FreeRADIUS returns an
+`Access-Accept` 100% of the time.
+
+1.  Why might you need to override the return code priorities of the
+    sometimes module?
+2.  Looking through the unlang keyword list, do you see any of keywords
+    that might produce similar fail-over behaviour as the behaviour
+    configured above xref:unlang:keywords.adoc[Keywords].
+
+
+// Copyright (C) 2021 Network RADIUS SAS.  Licenced under CC-by-NC 4.0.
+// This documentation was developed by Network RADIUS SAS.
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/unlang_splitting_strings.adoc freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/unlang_splitting_strings.adoc
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/unlang_splitting_strings.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/unlang_splitting_strings.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,60 @@
+= Splitting strings
+
+
+
+*Goal:* Explore uses of regular expressions and subcapture groups
+
+*Time:* 10-20 minutes
+
+*File:*  
+
+- `etc/raddb/policy.d/*`
+
+*`man` page:* unlang
+
+*documentation page(s):*
+
+- xref:unlang:condition/index.adoc[Conditions]
+- xref:unlang:condition/regex.adoc[Regular expressions]
+- xref:unlang:update.adoc[The Update Statement]
+
+include::partial$unlang_start.adoc[]
+
+include::partial$common_control_attrs_sidebar.adoc[]
+
+Regular expressions are an extremely powerful tool in the 'unlang' policy
+language.  They provide both validation capabilities, allowing users
+to check the format of incoming attributes, and substring extraction
+(via capture groups).
+
+If you've completed the xref:proxy.adoc[Proxy] exercise you'll have
+used the `suffix` module to split an incoming `User-Name` value into
+its components and setup the request for proxying.
+
+Create an unlang version of "suffix" that splits an incoming `User-Name` into
+two components on the "@" separator.
+
+The first component should be written to the `request.Stripped-User-Name`
+attribute and the second component should be written to the
+`control.Stripped-User-Domain` attribute.
+
+Use `bob@realm1.sh` and `bob@realm2.sh` to test your new policy to ensure
+it works as expected.
+
+If you've completed the xref:proxy.adoc[Proxy] tutorial and have test
+realms setup, modify the policy code you have just written to proxy
+the request to the realm specified in the `User-Name` attribute.
+
+== Questions
+
+1.  Regular expressions can contain attribute expansions.  Given that
+    all supported regular expression libraries support pre-compilation
+    of expressions, why would regular expressions containing expansions
+    be avoided when the server being deployed will be under heavy load?
+2.  Why might you want to re-implement functionality offered by modules
+    in unlang?
+3.  What is an advantage of using expression based string splitting
+    over the suffix module?
+
+// Copyright (C) 2021 Network RADIUS SAS.  Licenced under CC-by-NC 4.0.
+// This documentation was developed by Network RADIUS SAS.
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/unlang_update_blocks_and_conditions.adoc freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/unlang_update_blocks_and_conditions.adoc
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/unlang_update_blocks_and_conditions.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/unlang_update_blocks_and_conditions.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,79 @@
+= Update blocks and simple conditions
+
+*Goal:* Explore uses of update blocks in the policy language
+
+*Time:* 10-25 minutes
+
+*File:*
+
+- `sites-available/default`
+
+*`man` page:* unlang
+
+*documentation page(s):*
+
+- xref:unlang:condition/index.adoc[Conditional Expressions]
+- xref:unlang:update.adoc[The Update Statement]
+
+include::partial$unlang_start.adoc[]
+include::partial$common_control_attrs_sidebar.adoc[]
+
+Unlang `update` blocks are used to update one or attributes in one
+of the server's xref:unlang:list.adoc[attribute lists].
+
+
+In previous tutorials we've used the `files` modules, and the authorize
+methods of authentication modules such as `pap` and `chap` to alter how
+the server processes requests by setting a `Auth-Type` value.
+Here, we will emulate that behaviour using the policy language.
+
+* Create a condition (_condition 1_) to execute policy code if
+the `User-Name` in the request is 'bob'.
+* Within that condition block, set the control attribute `Password.Cleartext`
+to be 'hello', and instruct the server to run the the `authenticate { ... }`
+subsection for `pap`.
+* Use the `bob.sh` script to verify that you see an `Access-Accept` returned
+despite the `files` module not being called.
+
+Using additional conditions and update blocks, emulate the logic implemented
+using the files module in the xref:matching_users.adoc[Matching Users]
+exercise.
+
+To recap:
+
+* If an incoming request contains a `User-Name` attribute with the value
+  'bob', and contains an attribute `Framed-Protocol` with value `PPP`
+  (_condition 2_), reply with a `Framed-IP-Address` attribute with the value
+  `192.168.10.12`.
+* If an incoming request contains a `Service-Type` attribute with a value
+  of `Framed-User` (_condition 3_), reply with a `Framed-Route` attribute
+  assigning a default route of `192.168.10.1` (`0.0.0.0/0 192.168.10.1 1`) and
+  a `Framed-IP-Netmask` attribute with a value of `255.255.255.0`.
+
+Again test the server with username "bob" and password "hello". Use the
+debug output of the server to see which unlang conditions evaluated to
+true.  You may use `radclient` or the `bob.sh` script to send the packets.
+
+Perform other authentication tests, adding the appropriate attributes to
+the test requests to exercise the different conditions. If you already have
+test packets from the xref:matching_users.adoc[Matching Users] exercises,
+you may use those, otherwise continue until you have packets that will match:
+
+* conditions 1 and 2, but not 3.
+* conditions 1 and 3, but not 2.
+* conditions 1, 2, and 3.
+
+== Questions
+
+1.  What are the advantages of unlang over the files module when creating
+    policies?
+2.  What are the advantages of the files modules over unlang?  Are there
+    any situations where you think the files module might be better suited
+    to a task than unlang?
+3.  Can you think of any efficiencies the users module might have over
+    multiple conditions, where policies are being assigned to many different
+    users?
+
+
+// Copyright (C) 2025 Network RADIUS SAS.  Licenced under CC-by-NC 4.0.
+// This documentation was developed by Network RADIUS SAS.
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/variables.adoc freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/variables.adoc
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/variables.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/variables.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,95 @@
+= Using configuration and run-time variables
+
+*Goal:* To use run-time variable expansion.
+
+*Time:* 15-30 minutes.
+
+*Files:*
+
+- `etc/raddb/radiusd.conf`
+- `etc/raddb/users`
+- `etc/raddb/mods-available/detail`
+
+*`man` page:* `radiusd.conf`
+
+*documentation page:* xref:unlang:xlat/index.adoc[Dynamic expansions]
+
+There are two kinds of variables within the server. The first is within
+`radiusd.conf` and related files. These variables are referenced via the
+`$` character, which is used to define common terms (e.g. `${logdir}` so that
+those terms do not have to be repeated multiple times in the
+configuration files. These variables are used only when the server reads
+the configuration files, and they cannot be updated or edited once the files
+have been read.
+
+The second kind of variable is a run-time variable, which is dynamically
+expanded for each request received by the server. These variables are
+referenced by the `%` character, and they may be used to pull the values of
+attributes from the request to be used by a module. These variables may
+also be used by one module to obtain information from another module.
+
+In this exercise, we cover configuration variables and some simple
+properties of the run-time variables. Later exercises cover additional
+properties of the run-time variables.
+
+The main configuration file `radiusd.conf` and the module configuration
+files contains a number of examples of the use of variables. For example,
+the `detail` module (configured in `etc/raddb/mods-enabled/detail`)
+has a configuration entry named "filename", which by default has the
+following value:
+
+----------------------------------------------------------------
+filename = ${radacctdir}/%{Net.Src.IP}/detail-%Y%m%d
+----------------------------------------------------------------
+
+The configuration entry is composed of two kinds of variable expansion.
+One references the `${radacctdir}` configuration variable, which was
+previously defined in `radiusd.conf`. The following variables are
+expanded at run time and depend on information in the request packet
+and other dynamically calculated data.
+
+Start the server in debugging mode (`radiusd -X`).
+In the server output, look for the `detail` module and the `filename`
+configuration entry for that module. Verify that the string printed
+for the `filename` does not print the reference to the `${radacctdir}`
+variable, but instead has substituted the value of that variable.
+Verify also that the values of the run-time variables have _not_
+been substituted and that they are still printed as variables.
+
+If you don't see any configuration printed for the `detail` file module
+ensure it is uncommented in the `accounting {}` section of the
+`raddb/sites-available/default` virtual server.
+
+Now read the
+https://github.com/FreeRADIUS/freeradius-server/blob/v3.2.x/doc/configuration/variables.rst[variables]
+documentation file to determine the meaning of the variables used in the `filename` configuration entry.
+Once you are done, send the server an accounting packet (e.g.,
+`bob-acct-stop.sh`), and go look for the detail file, which will be
+dynamically created. Verify that the contents of the file are the
+accounting packet you just sent.
+
+In addition to being used in the configuration files, run-time variables
+may also be used to create values for reply attributes. Stop the server,
+and edit the users file to add the following entry at the top:
+
+-----------------------------------------------------------------------------
+bob Password.Cleartext := "hello"
+        Reply-Message = "Hello %{User-Name}, your NAS port is %{NAS-Port}",
+        Reply-Message += "at time %T"
+-----------------------------------------------------------------------------
+
+Start the server, and run the `bob-login-one.sh` script. Verify that the
+`Reply-Message` attributes contain the user name, NAS port, time, and a
+copy of the `Class` attribute from the reply.
+
+== Questions
+
+1.  Why are run-time variables useful?
+2.  How would you configure that entry in the file to reply with the
+directory name where the `radiusd.conf` file is stored? Why is this a
+bad idea?
+3.  How would you create an entry in the users file that matched users when
+their `Class` was the same as their `NAS-Port`?
+
+// Copyright (C) 2021 Network RADIUS SAS.  Licenced under CC-by-NC 4.0.
+// This documentation was developed by Network RADIUS SAS.
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/virtual.adoc freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/virtual.adoc
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/pages/virtual.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/pages/virtual.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,59 @@
+= Virtual Servers
+
+
+
+*Goal:* To understand how to create and use a new virtual server.
+
+*Time:* 20-30 minutes
+
+*File:*
+
+- `etc/raddb/sites-enabled/virtual`
+
+*documentation page:* raddb/sites-available/README
+
+A "virtual server" is a configuration file that contains the
+following sections:
+
+- *listen* Defines a new socket.
+- *authorize* The authorization section
+- *authenticate* The authentication section
+- *post-auth* The post-authentication section
+- *pre-proxy* The pre-proxy section
+- *post-proxy* The post-proxy section
+- *preacct* The pre-accounting section
+- *accounting* The accounting section
+
+Create a new file `raddb/sites-enabled/virtual`. Put the following text
+into it:
+
+-----------------------------------------------
+listen {
+    ipaddr = 127.0.0.1
+    port = 18273   # some random 5 digit number
+    type = auth
+}
+
+authorize {
+    control.Clearext-Password := "hello"
+    pap
+}
+
+authenticate {
+    pap
+}
+-----------------------------------------------
+
+Start the server in debugging mode, and use `radtest` to send a PAP
+authentication request to the server at the port defined above.
+
+== Questions
+
+1.  What happens when you try to use CHAP or MS-CHAP? Why does this result occur?
+2.  How can you make that virtual server use CHAP or MS-CHAP?
+3.  What happens when you try different User-Names? Why does this result occur?
+4.  How can you make the above configuration authenticate different
+users via different passwords?
+
+// Copyright (C) 2021 Network RADIUS SAS.  Licenced under CC-by-NC 4.0.
+// This documentation was developed by Network RADIUS SAS.
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/partials/common_control_attrs_sidebar.adoc freeradius-server-3.2.8/doc/antora/modules/tutorials/partials/common_control_attrs_sidebar.adoc
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/partials/common_control_attrs_sidebar.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/partials/common_control_attrs_sidebar.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,10 @@
+.Common control attributes
+****
+Attributes in the `control` list can control the behaviour of the server.
+Commonly used control attributes are:
+
+- `control.Auth-Type` specifies the `authenticate <name> {}` section to run
+****
+
+// Copyright (C) 2025 Network RADIUS SAS.  Licenced under CC-by-NC 4.0.
+// This documentation was developed by Network RADIUS SAS.
diff -urpN freeradius-server-3.2.7/doc/antora/modules/tutorials/partials/unlang_start.adoc freeradius-server-3.2.8/doc/antora/modules/tutorials/partials/unlang_start.adoc
--- freeradius-server-3.2.7/doc/antora/modules/tutorials/partials/unlang_start.adoc	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/tutorials/partials/unlang_start.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,9 @@
+[TIP]
+====
+For this tutorial you should start with an empty authorization section
+(`recv Access-Request { ... }` or in ≤ v3.2.x `authorize { ... }`)
+in the virtual server you're using to process requests.
+====
+
+// Copyright (C) 2025 Network RADIUS SAS.  Licenced under CC-by-NC 4.0.
+// This documentation was developed by Network RADIUS SAS.
diff -urpN freeradius-server-3.2.7/doc/antora/modules/unlang/pages/attr.adoc freeradius-server-3.2.8/doc/antora/modules/unlang/pages/attr.adoc
--- freeradius-server-3.2.7/doc/antora/modules/unlang/pages/attr.adoc	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/unlang/pages/attr.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -1,9 +1,15 @@
 = &Attribute References
 
+Attributes may be referenced via the following syntax:
+
 .Syntax
 [source,unlang]
 ----
-[&]Attribute-Name
+&Attribute-Name
+&Attribute-Name:TAG
+&Attribute-Name[NUM]
+&<list>:Attribute-Name
+&<list>:Attribute-Name:TAG[NUM]
 ----
 
 The `&Attribute-Name` operator returns a reference to the named
@@ -39,6 +45,9 @@ looks in the input packet list for the n
 
 == Array References
 
+Finding a particular attribute from multiple instances can be done via
+an array reference.
+
 .Syntax
 [source,unlang]
 ----
@@ -58,10 +67,33 @@ etc.
 &reply:NAS-IP-Address[2]
 ----
 
+== Other Array indexes
+
+The array syntax can be used for a few special cases, too.
+
+.Syntax
+[source,unlang]
+----
+&Attribute-Name[#]
+&Attribute-Name[*]
+&Attribute-Name[n]
+----
+
+These extra fields have the following definitions:
+
+`#`::
+Returns an integer which is the number of instances of this attribute.
+
+`*`::
+Returns all of the instances of the given attribute.  This syntax can only be used in a xref:xlat/index.adoc[string expansion].  It will return all of the values of the attribute, separated by commas.
+
+`n`::
+Returns the last instance of the given attribute.
+
 == Removing ambuguity from the configuration files
 
-The server does not use the `&` character to distinguish attribute names
-from other strings.  
+In most cases, the server uses the `&` character to distinguish
+attribute names from other strings.
 
 Without the `&`, it is more difficult to parse the configuration file
 clearly. You could interpret a string as `hello-there`
@@ -73,5 +105,5 @@ now easily distinguishable from literal
 `&` character is highly recommended.
 
 
-// Copyright (C) 2020 Network RADIUS SAS.  Licenced under CC-by-NC 4.0.
+// Copyright (C) 2025 Network RADIUS SAS.  Licenced under CC-by-NC 4.0.
 // Development of this documentation was sponsored by Network RADIUS SAS.
diff -urpN freeradius-server-3.2.7/doc/antora/modules/unlang/pages/index.adoc freeradius-server-3.2.8/doc/antora/modules/unlang/pages/index.adoc
--- freeradius-server-3.2.7/doc/antora/modules/unlang/pages/index.adoc	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/doc/antora/modules/unlang/pages/index.adoc	2025-08-20 23:29:15.000000000 +0700
@@ -11,12 +11,15 @@ Where more complicated functionality is
 the `lua`, `perl` or `python` modules.  Those modules allow the insertion of
 full-featured scripts at any point in the packet processing.
 
-NOTE: The documentation is this directory is _reference_
+[NOTE]
+====
+The documentation is this directory is *reference*
 documentation.  That is, it describes the syntax of `unlang` keywords,
 using minimal examples.  The reference documentation does not,
-however, describe _when_ to use the keywords, or _how_ to create
-policies. Please see the xref:howto:index.adoc[howto] directory for
-more in-depth "how to" guides.
+however, describe *when* to use the keywords, or *how* to create
+policies. Please see the xref:howto:index.adoc[Howto] section for
+more in-depth "howto" guides.
+====
 
 The documentation is organized so that each item is on its own page.
 The page beings with a description of the item, followed by some text
@@ -57,7 +60,7 @@ if ((&User-Name == "bob") && (&Calling-S
 
 == Update Statements
 
-xref:update.adoc[update] statements are used to edit attributes and
+xref:update.adoc[Update] statements are used to edit attributes and
 lists of attributes.
 
 Most request packets will result in reply packets that contain
diff -urpN freeradius-server-3.2.7/doc/rfc/rfc7599.txt freeradius-server-3.2.8/doc/rfc/rfc7599.txt
--- freeradius-server-3.2.7/doc/rfc/rfc7599.txt	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/doc/rfc/rfc7599.txt	1970-01-01 07:00:00.000000000 +0700
@@ -1,1515 +0,0 @@
-
-
-
-
-
-
-Internet Engineering Task Force (IETF)                             X. Li
-Request for Comments: 7599                                        C. Bao
-Category: Standards Track                            Tsinghua University
-ISSN: 2070-1721                                              W. Dec, Ed.
-                                                                O. Troan
-                                                           Cisco Systems
-                                                           S. Matsushima
-                                                        SoftBank Telecom
-                                                             T. Murakami
-                                                             IP Infusion
-                                                               July 2015
-
-
-         Mapping of Address and Port using Translation (MAP-T)
-
-Abstract
-
-   This document specifies the solution architecture based on "Mapping
-   of Address and Port" stateless IPv6-IPv4 Network Address Translation
-   (NAT64) for providing shared or non-shared IPv4 address connectivity
-   to and across an IPv6 network.
-
-Status of This Memo
-
-   This is an Internet Standards Track document.
-
-   This document is a product of the Internet Engineering Task Force
-   (IETF).  It represents the consensus of the IETF community.  It has
-   received public review and has been approved for publication by the
-   Internet Engineering Steering Group (IESG).  Further information on
-   Internet Standards is available in Section 2 of RFC 5741.
-
-   Information about the current status of this document, any errata,
-   and how to provide feedback on it may be obtained at
-   http://www.rfc-editor.org/info/rfc7599.
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-Li, et al.                   Standards Track                    [Page 1]
-
-RFC 7599                          MAP-T                        July 2015
-
-
-Copyright Notice
-
-   Copyright (c) 2015 IETF Trust and the persons identified as the
-   document authors.  All rights reserved.
-
-   This document is subject to BCP 78 and the IETF Trust's Legal
-   Provisions Relating to IETF Documents
-   (http://trustee.ietf.org/license-info) in effect on the date of
-   publication of this document.  Please review these documents
-   carefully, as they describe your rights and restrictions with respect
-   to this document.  Code Components extracted from this document must
-   include Simplified BSD License text as described in Section 4.e of
-   the Trust Legal Provisions and are provided without warranty as
-   described in the Simplified BSD License.
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-Li, et al.                   Standards Track                    [Page 2]
-
-RFC 7599                          MAP-T                        July 2015
-
-
-Table of Contents
-
-   1. Introduction ....................................................4
-   2. Conventions .....................................................4
-   3. Terminology .....................................................5
-   4. Architecture ....................................................6
-   5. Mapping Rules ...................................................8
-      5.1. Destinations outside the MAP Domain ........................8
-   6. The IPv6 Interface Identifier ...................................9
-   7. MAP-T Configuration ............................................10
-      7.1. MAP CE ....................................................10
-      7.2. MAP BR ....................................................11
-   8. MAP-T Packet Forwarding ........................................11
-      8.1. IPv4 to IPv6 at the CE ....................................11
-      8.2. IPv6 to IPv4 at the CE ....................................12
-      8.3. IPv6 to IPv4 at the BR ....................................12
-      8.4. IPv4 to IPv6 at the BR ....................................13
-   9. ICMP Handling ..................................................13
-   10. Fragmentation and Path MTU Discovery ..........................14
-      10.1. Fragmentation in the MAP Domain ..........................14
-      10.2. Receiving IPv4 Fragments on the MAP Domain Borders .......14
-      10.3. Sending IPv4 Fragments to the Outside ....................14
-   11. NAT44 Considerations ..........................................15
-   12. Usage Considerations ..........................................15
-      12.1. EA-Bit Length 0 ..........................................15
-      12.2. Mesh and Hub-and-Spoke Modes .............................15
-      12.3. Communication with IPv6 Servers in the MAP-T Domain ......15
-      12.4. Compatibility with Other NAT64 Solutions .................16
-   13. Security Considerations .......................................16
-   14. References ....................................................17
-      14.1. Normative References .....................................17
-      14.2. Informative References ...................................18
-   Appendix A. Examples of MAP-T Translation .........................21
-   Appendix B. Port-Mapping Algorithm ................................24
-   Acknowledgements ..................................................25
-   Contributors ......................................................25
-   Authors' Addresses ................................................26
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-Li, et al.                   Standards Track                    [Page 3]
-
-RFC 7599                          MAP-T                        July 2015
-
-
-1.  Introduction
-
-   Experiences from initial service provider IPv6 network deployments,
-   such as [RFC6219], indicate that successful transition to IPv6 can
-   happen while supporting legacy IPv4 users without a full end-to-end
-   dual-IP-stack deployment.  However, due to public IPv4 address
-   exhaustion, this requires an IPv6 technology that supports IPv4 users
-   utilizing shared IPv4 addressing, while also allowing the network
-   operator to optimize their operations around IPv6 network practices.
-   The use of double NAT64 translation-based solutions is an optimal way
-   to address these requirements, especially in combination with
-   stateless translation techniques that minimize operational challenges
-   outlined in [Solutions-4v6].
-
-   The Mapping of Address and Port using Translation (MAP-T)
-   architecture specified in this document is such a double stateless
-   NAT64-based solution.  It builds on existing stateless NAT64
-   techniques specified in [RFC6145], along with the stateless
-   algorithmic address and transport-layer port-mapping scheme defined
-   in the Mapping of Address and Port with Encapsulation (MAP-E)
-   specification [RFC7597].  The MAP-T solution differs from MAP-E in
-   that MAP-T uses IPv4-IPv6 translation, rather than encapsulation, as
-   the form of IPv6 domain transport.  The translation mode is
-   considered advantageous in scenarios where the encapsulation
-   overhead, or IPv6 operational practices (e.g., the use of IPv6-only
-   servers, or reliance on IPv6 + protocol headers for traffic
-   classification) rule out encapsulation.  These scenarios are
-   presented in [MAP-T-Use-Cases].
-
-2.  Conventions
-
-   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
-   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
-   document are to be interpreted as described in RFC 2119 [RFC2119].
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-Li, et al.                   Standards Track                    [Page 4]
-
-RFC 7599                          MAP-T                        July 2015
-
-
-3.  Terminology
-
-   MAP-T:                  Mapping of Address and Port using
-                           Translation.
-
-   MAP Customer Edge (CE): A device functioning as a Customer Edge
-                           router in a MAP deployment.  A typical MAP CE
-                           adopting MAP Rules will serve a residential
-                           site with one WAN-side IPv6-addressed
-                           interface and one or more LAN-side interfaces
-                           addressed using private IPv4 addressing.
-
-   MAP Border Relay (BR):  A MAP-enabled router managed by the service
-                           provider at the edge of a MAP domain.  A BR
-                           has at least an IPv6-enabled interface and an
-                           IPv4 interface connected to the native IPv4
-                           network.  A MAP BR may also be referred to as
-                           simply a "BR" within the context of MAP.
-
-   MAP domain:             One or more MAP CEs and BRs connected by
-                           means of an IPv6 network and sharing a common
-                           set of MAP Rules.  A service provider may
-                           deploy a single MAP domain or may utilize
-                           multiple MAP domains.
-
-   MAP Rule:               A set of parameters describing the mapping
-                           between an IPv4 prefix, IPv4 address, or
-                           shared IPv4 address and an IPv6 prefix or
-                           address.  Each MAP domain uses a different
-                           mapping rule set.
-
-   MAP rule set:           A rule set is composed of all the MAP Rules
-                           communicated to a device that are intended to
-                           determine the device's IP+port mapping and
-                           forwarding operations.  The MAP rule set is
-                           interchangeably referred to in this document
-                           as a MAP rule table or as simply a "rule
-                           table".  Two specific types of rules -- the
-                           Basic Mapping Rule (BMR) and the Forwarding
-                           Mapping Rule (FMR) -- are defined in
-                           Section 5 of [RFC7597].  The Default Mapping
-                           Rule (DMR) is defined in this document.
-
-   MAP rule table:         See MAP rule set.
-
-   MAP node:               A device that implements MAP.
-
-
-
-
-
-Li, et al.                   Standards Track                    [Page 5]
-
-RFC 7599                          MAP-T                        July 2015
-
-
-   Port set:               Each node has a separate part of the
-                           transport-layer port space; this is denoted
-                           as a port set.
-
-   Port Set ID (PSID):     Algorithmically identifies a set of ports
-                           exclusively assigned to a CE.
-
-   Shared IPv4 address:    An IPv4 address that is shared among multiple
-                           CEs.  Only ports that belong to the assigned
-                           port set can be used for communication.  Also
-                           known as a port-restricted IPv4 address.
-
-   End-user IPv6 prefix:   The IPv6 prefix assigned to an End-user CE by
-                           means other than MAP itself, e.g.,
-                           provisioned using DHCPv6 Prefix Delegation
-                           (PD) [RFC3633], assigned via Stateless
-                           Address Autoconfiguration (SLAAC) [RFC4862],
-                           or configured manually.  It is unique for
-                           each CE.
-
-   MAP IPv6 address:       The IPv6 address used to reach the MAP
-                           function of a CE from other CEs and from BRs.
-
-   Rule IPv6 prefix:       An IPv6 prefix assigned by a service provider
-                           for a MAP Rule.
-
-   Rule IPv4 prefix:       An IPv4 prefix assigned by a service provider
-                           for a MAP Rule.
-
-   Embedded Address (EA) bits:
-                           The IPv4 EA-bits in the IPv6 address identify
-                           an IPv4 prefix/address (or part thereof) or a
-                           shared IPv4 address (or part thereof) and a
-                           Port Set Identifier.
-
-4.  Architecture
-
-   Figure 1 depicts the overall MAP-T architecture, which sees any
-   number of privately addressed IPv4 users (N and M) connected by means
-   of MAP-T CEs to an IPv6 network that is equipped with one or more
-   MAP-T BRs.  CEs and BRs that share MAP configuration parameters,
-   referred to as "MAP Rules", form a MAP-T domain.
-
-
-
-
-
-
-
-
-
-Li, et al.                   Standards Track                    [Page 6]
-
-RFC 7599                          MAP-T                        July 2015
-
-
-   Functionally, the MAP-T CE and BR utilize and extend some
-   well-established technology building blocks to allow the IPv4 users
-   to correspond with nodes on the public IPv4 network or on the IPv6
-   network as follows:
-
-   o  A (NAT44) Network Address and Port Translation (NAPT) [RFC2663]
-      function on a MAP CE is extended with support for restricting the
-      allowable TCP/UDP ports for a given IPv4 address.  The IPv4
-      address and port range used are determined by the MAP provisioning
-      process and identical to MAP-E [RFC7597].
-
-   o  A stateless NAT64 function [RFC6145] is extended to allow
-      stateless mapping of IPv4 and transport-layer port ranges to the
-      IPv6 address space.
-
-         User N
-       Private IPv4
-      |  Network
-      |
-   O--+---------------O
-   |  | MAP-T CE      |
-   | +-----+--------+ |
-   | NAPT44|  MAP-T | |
-   | +-----+        | +-._   ,-------.                     .------.
-   |       +--------+ |   ,-'         `-.                ,-'       `-.
-   O------------------O  /              \   O---------O /   Public   \
-                         /   IPv6-only   \  |  MAP-T  |/     IPv4     \
-                        (    Network      --+  Border +-   Network     )
-                         \               /  |  Relay  |\              /
-   O------------------O  \              /   O---------O \             /
-   |    MAP-T CE      |   ;".         ,-'                `-.       ,-'
-   | +-----+--------+ | ,"   `----+--'                      ------'
-   | NAPT44|  MAP-T | |,          |
-   | +-----+        | +        IPv6 node(s)
-   |   |   +--------+ |  (with IPv4-embedded IPv6 address)
-   O---+--------------O
-       |
-         User M
-       Private IPv4
-         Network
-
-                       Figure 1: MAP-T Architecture
-
-   Each MAP-T CE is assigned with a regular IPv6 prefix from the
-   operator's IPv6 network.  This, in conjunction with MAP domain
-   configuration settings and the use of the MAP procedures, allows the
-   computation of a MAP IPv6 address and a corresponding IPv4 address.
-   To allow for IPv4 address sharing, the CE may also have to be
-
-
-
-Li, et al.                   Standards Track                    [Page 7]
-
-RFC 7599                          MAP-T                        July 2015
-
-
-   configured with a TCP/UDP port range that is identified by means of a
-   MAP Port Set Identifier (PSID) value.  Each CE is responsible for
-   forwarding traffic between a given user's private IPv4 address space
-   and the MAP domain's IPv6 address space.  The IPv4-IPv6 adaptation
-   uses stateless NAT64, in conjunction with the MAP algorithm for
-   address computation.
-
-   The MAP-T BR connects one or more MAP-T domains to external IPv4
-   networks using stateless NAT64 as extended by the MAP-T behavior
-   described in this document.
-
-   In contrast to MAP-E, NAT64 technology is used in the architecture
-   for two purposes.  First, it is intended to diminish encapsulation
-   overhead and allow IPv4 and IPv6 traffic to be treated as similarly
-   as possible.  Second, it is intended to allow IPv4-only nodes to
-   correspond directly with IPv6 nodes in the MAP-T domain that have
-   IPv4-embedded IPv6 addresses as per [RFC6052].
-
-   The MAP-T architecture is based on the following key properties:
-
-   1.  Algorithmic IPv4-IPv6 address mapping codified as MAP Rules, as
-       described in Section 5
-
-   2.  A MAP IPv6 address identifier, as described in Section 6
-
-   3.  MAP-T IPv4-IPv6 forwarding behavior, as described in Section 8
-
-5.  Mapping Rules
-
-   The MAP-T algorithmic mapping rules are identical to those in
-   Section 5 of the MAP-E specification [RFC7597], with the following
-   exception: the forwarding of traffic to and from IPv4 destinations
-   outside a MAP-T domain is to be performed as described in this
-   document, instead of Section 5.4 of the MAP-E specification.
-
-5.1.  Destinations outside the MAP Domain
-
-   IPv4 traffic sent by MAP nodes that are all within one MAP domain is
-   translated to IPv6, with the sender's MAP IPv6 address, derived via
-   the Basic Mapping Rule (BMR), as the IPv6 source address and the
-   recipient's MAP IPv6 address, derived via the Forwarding Mapping Rule
-   (FMR), as the IPv6 destination address.
-
-   IPv4-addressed destinations outside of the MAP domain are represented
-   by means of IPv4-embedded IPv6 addresses as per [RFC6052], using the
-   BR's IPv6 prefix.  For a CE sending traffic to any such destination,
-   the source address of the IPv6 packet will be that of the CE's MAP
-   IPv6 address, and the destination IPv6 address will be the
-
-
-
-Li, et al.                   Standards Track                    [Page 8]
-
-RFC 7599                          MAP-T                        July 2015
-
-
-   destination IPv4-embedded IPv6 address.  This address mapping is said
-   to be following the MAP-T Default Mapping Rule (DMR) and is defined
-   in terms of the IPv6 prefix advertised by one or more BRs, which
-   provide external connectivity.  A typical MAP-T CE will install an
-   IPv4 default route using this rule.  A BR will use this rule when
-   translating all outside IPv4 source addresses to the IPv6 MAP domain.
-
-   The DMR IPv6 prefix length SHOULD be 64 bits long by default and in
-   any case MUST NOT exceed 96 bits.  The mapping of the IPv4
-   destination behind the IPv6 prefix will by default follow the /64
-   rule as per [RFC6052].  Any trailing bits after the IPv4 address are
-   set to 0x0.
-
-6.  The IPv6 Interface Identifier
-
-   The interface identifier format of a MAP-T node is the same as the
-   format described in Section 6 of [RFC7597].  The format diagram is
-   provided here for convenience:
-
-                   |          128-n-o-s bits          |
-                   | 16 bits|    32 bits     | 16 bits|
-                   +--------+----------------+--------+
-                   |   0    |  IPv4 address  |  PSID  |
-                   +--------+----------------+--------+
-
-                    Figure 2: IPv6 Interface Identifier
-
-   In the case of an IPv4 prefix, the IPv4 address field is right-padded
-   with zeros up to 32 bits.  The PSID is left-padded with zeros to
-   create a 16-bit field.  For an IPv4 prefix or a complete IPv4
-   address, the PSID field is zero.
-
-   If the End-user IPv6 prefix length is larger than 64, the most
-   significant parts of the interface identifier are overwritten by the
-   prefix.
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-Li, et al.                   Standards Track                    [Page 9]
-
-RFC 7599                          MAP-T                        July 2015
-
-
-7.  MAP-T Configuration
-
-   For a given MAP domain, the BR and CE MUST be configured with the
-   following MAP parameters.  The values for these parameters are
-   identical for all CEs and BRs within a given MAP-T domain.
-
-   o  The Basic Mapping Rule and, optionally, the Forwarding Mapping
-      Rules, including the Rule IPv6 prefix, Rule IPv4 prefix, and
-      Length of embedded address bits
-
-   o  Use of hub-and-spoke mode or Mesh mode (if all traffic should be
-      sent to the BR, or if direct CE-to-CE correspondence should be
-      supported)
-
-   o  Use of IPv4-IPv6 translation (MAP-T)
-
-   o  The BR's IPv6 prefix used in the DMR
-
-7.1.  MAP CE
-
-   For a given MAP domain, the MAP configuration parameters are the same
-   across all CEs within that domain.  These values may be conveyed and
-   configured on the CEs using a variety of methods, including DHCPv6,
-   the Broadband Forum's "TR-69" Residential Gateway management
-   interface [TR069], the Network Configuration Protocol (NETCONF), or
-   manual configuration.  This document does not prescribe any of these
-   methods but recommends that a MAP CE SHOULD implement DHCPv6 options
-   as per [RFC7598].  Other configuration and management methods may use
-   the data model described by this option for consistency and
-   convenience of implementation on CEs that support multiple
-   configuration methods.
-
-   Besides the MAP configuration parameters, a CE requires an IPv6
-   prefix to be assigned to the CE.  This End-user IPv6 prefix is
-   configured as part of obtaining IPv6 Internet access and is acquired
-   using standard IPv6 means applicable in the network where the CE is
-   located.
-
-   The MAP provisioning parameters, and hence the IPv4 service itself,
-   are tied to the End-user IPv6 prefix; thus, the MAP service is also
-   tied to this in terms of authorization, accounting, etc.
-
-   A single MAP CE MAY be connected to more than one MAP domain, just as
-   any router may have more than one IPv4-enabled service-provider-
-   facing interface and more than one set of associated addresses
-   assigned by DHCPv6.  Each domain within which a given CE operates
-
-
-
-
-
-Li, et al.                   Standards Track                   [Page 10]
-
-RFC 7599                          MAP-T                        July 2015
-
-
-   would require its own set of MAP configuration elements and would
-   generate its own IPv4 address.  Each MAP domain requires a distinct
-   End-user IPv6 prefix.
-
-7.2.  MAP BR
-
-   The MAP BR MUST be configured with the same MAP elements as the MAP
-   CEs operating within the same domain.
-
-   For increased reliability and load balancing, the BR IPv6 prefix MAY
-   be shared across a given MAP domain.  As MAP is stateless, any BR may
-   be used for forwarding to/from the domain at any time.
-
-   Since MAP uses provider address space, no specific IPv6 or IPv4
-   routes need to be advertised externally outside the service
-   provider's network for MAP to operate.  However, the BR prefix needs
-   to be advertised in the service provider's IGP.
-
-8.  MAP-T Packet Forwarding
-
-   The end-to-end packet flow in MAP-T involves an IPv4 or IPv6 packet
-   being forwarded by a CE or BR in one of two directions for each such
-   case.  This section presents a conceptual view of the operations
-   involved in such forwarding.
-
-8.1.  IPv4 to IPv6 at the CE
-
-   A MAP-T CE receiving IPv4 packets SHOULD perform NAPT44 processing
-   and create any necessary NAPT44 bindings.  The source address and
-   source port range of packets resulting from the NAPT44 processing
-   MUST correspond to the source IPv4 address and source transport port
-   range assigned to the CE by means of the MAP Basic Mapping Rule
-   (BMR).
-
-   The IPv4 packet is subject to a longest IPv4 destination address +
-   port match MAP Rule selection, which then determines the parameters
-   for the subsequent NAT64 operation.  By default, all traffic is
-   matched to the DMR and is subject to the stateless NAT64 operation
-   using the DMR parameters for NAT64 (Section 5.1).  Packets that are
-   matched to (optional) Forwarding Mapping Rules (FMRs) are subject to
-   the stateless NAT64 operation using the FMR parameters (Section 5)
-   for the MAP algorithm.  In all cases, the CE's MAP IPv6 address
-   (Section 6) is used as a source address.
-
-   A MAP-T CE MUST support a Default Mapping Rule and SHOULD support one
-   or more Forwarding Mapping Rules.
-
-
-
-
-
-Li, et al.                   Standards Track                   [Page 11]
-
-RFC 7599                          MAP-T                        July 2015
-
-
-8.2.  IPv6 to IPv4 at the CE
-
-   A MAP-T CE receiving an IPv6 packet performs its regular IPv6
-   operations (filtering, pre-routing, etc.).  Only packets that are
-   addressed to the CE's MAP-T IPv6 addresses, and with source addresses
-   matching the IPv6 MAP Rule prefixes of a DMR or FMR, are processed by
-   the MAP-T CE, with the DMR or FMR being selected based on a longest
-   match.  The CE MUST check that each MAP-T received packet's
-   transport-layer destination port number is in the range allowed for
-   by the CE's MAP BMR configuration.  The CE MUST silently drop any
-   nonconforming packet and increment an appropriate counter.  When
-   receiving a packet whose source IP address longest matches an FMR
-   prefix, the CE MUST perform a check of consistency of the source
-   address against the allowed values as per the derived allocated
-   source port range.  If the source port number of a packet is found to
-   be outside the allocated range, the CE MUST drop the packet and
-   SHOULD respond with an ICMPv6 "Destination Unreachable, source
-   address failed ingress/egress policy" (Type 1, Code 5).
-
-   For each MAP-T processed packet, the CE's NAT64 function MUST compute
-   an IPv4 source and destination address.  The IPv4 destination address
-   is computed by extracting relevant information from the IPv6
-   destination and the information stored in the BMR as per Section 5.
-   The IPv4 source address is formed by classifying a packet's source as
-   longest matching a DMR or FMR rule prefix, and then using the
-   respective rule parameters for the NAT64 operation.
-
-   The resulting IPv4 packet is then forwarded to the CE's NAPT44
-   function, where the destination IPv4 address and port number MUST be
-   mapped to their original value before being forwarded according to
-   the CE's regular IPv4 rules.  When the NAPT44 function is not
-   enabled, by virtue of MAP configuration, the traffic from the
-   stateless NAT64 function is directly forwarded according to the CE's
-   IPv4 rules.
-
-8.3.  IPv6 to IPv4 at the BR
-
-   A MAP-T BR receiving an IPv6 packet MUST select a matching MAP Rule
-   based on a longest address match of the packet's source address
-   against the MAP Rules present on the BR.  In combination with the
-   Port Set ID derived from the packet's source IPv6 address, the
-   selected MAP Rule allows the BR to verify that the CE is using its
-   allowed address and port range.  Thus, the BR MUST perform a
-   validation of the consistency of the source against the allowed
-   values from the identified port range.  If the packet's source port
-   number is found to be outside the range allowed, the BR MUST drop the
-
-
-
-
-
-Li, et al.                   Standards Track                   [Page 12]
-
-RFC 7599                          MAP-T                        July 2015
-
-
-   packet and increment a counter to indicate the event.  The BR SHOULD
-   also respond with an ICMPv6 "Destination Unreachable, source address
-   failed ingress/egress policy" (Type 1, Code 5).
-
-   When constructing the IPv4 packet, the BR MUST derive the source and
-   destination IPv4 addresses as per Section 5 of this document and
-   translate the IPv6-to-IPv4 headers as per [RFC6145].  The resulting
-   IPv4 packet is then passed to regular IPv4 forwarding.
-
-8.4.  IPv4 to IPv6 at the BR
-
-   A MAP-T BR receiving IPv4 packets uses a longest match IPv4 +
-   transport-layer port lookup to identify the target MAP-T domain and
-   select the FMR and DMR rules.  The MAP-T BR MUST then compute and
-   apply the IPv6 destination addresses from the IPv4 destination
-   address and port as per the selected FMR.  The MAP-T BR MUST also
-   compute and apply the IPv6 source addresses from the IPv4 source
-   address as per Section 5.1 (i.e., using the IPv4 source and the BR's
-   IPv6 prefix, it forms an IPv6-embedded IPv4 address).  The generic
-   IPv4-to-IPv6 header translation procedures outlined in [RFC6145]
-   apply throughout.  The resulting IPv6 packets are then passed to
-   regular IPv6 forwarding.
-
-   Note that the operation of a BR, when forwarding to/from MAP-T
-   domains that are defined without IPv4 address sharing, is the same as
-   that of stateless NAT64 IPv4/IPv6 translation.
-
-9.  ICMP Handling
-
-   MAP-T CEs and BRs MUST follow ICMP/ICMPv6 translation as per
-   [RFC6145]; however, additional behavior is also required due to the
-   presence of NAPT44.  Unlike TCP and UDP, which provide two transport-
-   protocol port fields to represent both source and destination, the
-   ICMP/ICMPv6 [RFC792] [RFC4443] Query message header has only one ID
-   field, which needs to be used to identify a sending IPv4 host.  When
-   receiving IPv4 ICMP messages, the MAP-T CE MUST rewrite the ID field
-   to a port value derived from the CE's Port Set ID.
-
-   A MAP-T BR receiving an IPv4 ICMP packet that contains an ID field
-   that is bound for a shared address in the MAP-T domain SHOULD use the
-   ID value as a substitute for the destination port in determining the
-   IPv6 destination address.  In all other cases, the MAP-T BR MUST
-   derive the destination IPv6 address by simply mapping the destination
-   IPv4 address without additional port information.
-
-
-
-
-
-
-
-Li, et al.                   Standards Track                   [Page 13]
-
-RFC 7599                          MAP-T                        July 2015
-
-
-10.  Fragmentation and Path MTU Discovery
-
-   Due to the different sizes of the IPv4 and IPv6 headers, handling the
-   maximum packet size is relevant for the operation of any system
-   connecting the two address families.  There are three mechanisms to
-   handle this issue: Path MTU Discovery (PMTUD), fragmentation, and
-   transport-layer negotiation such as the TCP Maximum Segment Size
-   (MSS) option [RFC879].  MAP can use all three mechanisms to deal with
-   different cases.
-
-   Note: The NAT64 [RFC6145] mechanism is not lossless.  When
-   IPv4-originated communication traverses a double NAT64 function
-   (a.k.a. NAT464), any IPv4-originated ICMP-independent Path MTU
-   Discovery, as specified in [RFC4821], ceases to be entirely reliable.
-   This is because the DF=1/MF=1 combination as defined in [RFC4821]
-   results in DF=0/MF=1 after a double NAT64 translation.
-
-10.1.  Fragmentation in the MAP Domain
-
-   Translating an IPv4 packet to carry it across the MAP domain will
-   increase its size (typically by 20 bytes).  The MTU in the MAP domain
-   should be well managed, and the IPv6 MTU on the CE WAN-side interface
-   SHOULD be configured so that no fragmentation occurs within the
-   boundary of the MAP domain.
-
-   Fragmentation in MAP-T domains SHOULD be handled as described in
-   Sections 4 and 5 of [RFC6145].
-
-10.2.  Receiving IPv4 Fragments on the MAP Domain Borders
-
-   The forwarding of an IPv4 packet received from outside of the MAP
-   domain requires the IPv4 destination address and the transport-
-   protocol destination port.  The transport-protocol information is
-   only available in the first fragment received.  As described in
-   Section 5.3.3 of [RFC6346], a MAP node receiving an IPv4 fragmented
-   packet from outside SHOULD reassemble the packet before sending the
-   packet onto the MAP domain.  If the first packet received contains
-   the transport-protocol information, it is possible to optimize this
-   behavior by using a cache and forwarding the fragments unchanged.  A
-   description of such a caching algorithm is outside the scope of this
-   document.
-
-10.3.  Sending IPv4 Fragments to the Outside
-
-   Two IPv4 hosts behind two different MAP CEs with the same IPv4
-   address sending fragments to an IPv4 destination host outside the
-   domain may happen to use the same IPv4 fragmentation identifier,
-   resulting in incorrect reassembly of the fragments at the destination
-
-
-
-Li, et al.                   Standards Track                   [Page 14]
-
-RFC 7599                          MAP-T                        July 2015
-
-
-   host.  Given that the IPv4 fragmentation identifier is a 16-bit
-   field, it can be used similarly to port ranges.  Thus, a MAP CE
-   SHOULD rewrite the IPv4 fragmentation identifier to a value
-   equivalent to a port of its allocated port set.
-
-11.  NAT44 Considerations
-
-   The NAT44 implemented in the MAP CE SHOULD conform to the behavior
-   and best current practices documented in [RFC4787], [RFC5508], and
-   [RFC5382].  In MAP address-sharing mode (determined by the MAP
-   domain / rule configuration parameters), the operation of the NAT44
-   MUST be restricted to the available port numbers derived via the
-   Basic Mapping Rule.
-
-12.  Usage Considerations
-
-12.1.  EA-Bit Length 0
-
-   The MAP solution supports the use and configuration of domains where
-   a BMR expresses an EA-bit length of 0.  This results in independence
-   between the IPv6 prefix assigned to the CE and the IPv4 address
-   and/or port range used by MAP.  The k-bits of PSID information may in
-   this case be derived from the BMR.
-
-   The constraint imposed is that each such MAP domain be composed of
-   just one MAP CE that has a predetermined IPv6 end-user prefix.  The
-   BR would be configured with an FMR for each such Customer Premises
-   Equipment (CPE), where the rule would uniquely associate the IPv4
-   address + optional PSID and the IPv6 prefix of that given CE.
-
-12.2.  Mesh and Hub-and-Spoke Modes
-
-   The hub-and-spoke mode of communication, whereby all traffic sent by
-   a MAP-T CE is forwarded via a BR, and the Mesh mode, whereby a CE is
-   directly able to forward traffic to another CE, are governed by the
-   activation of Forwarding Mapping Rules that cover the IPv4-prefix
-   destination and port-index range.  By default, a MAP CE configured
-   only with a BMR, as per this specification, will use it to configure
-   its IPv4 parameters and IPv6 MAP address without enabling Mesh mode.
-
-12.3.  Communication with IPv6 Servers in the MAP-T Domain
-
-   By default, MAP-T allows communication between both IPv4-only and any
-   IPv6-enabled devices, as well as with native IPv6-only servers,
-   provided that the servers are configured with an IPv4-mapped IPv6
-   address.  This address could be part of the IPv6 prefix used by the
-   DMR in the MAP-T domain.  Such IPv6 servers (e.g., an HTTP server or
-   a web content cache device) are thus able to serve IPv6 users and
-
-
-
-Li, et al.                   Standards Track                   [Page 15]
-
-RFC 7599                          MAP-T                        July 2015
-
-
-   IPv4-only users alike, utilizing IPv6.  Any such IPv6-only servers
-   SHOULD have both A and AAAA records in DNS.  DNS64 [RFC6147] will be
-   required only when IPv6 servers in the MAP-T domain are themselves
-   expected to initiate communication to external IPv4-only hosts.
-
-12.4.  Compatibility with Other NAT64 Solutions
-
-   The MAP-T CE's NAT64 function is by default compatible for use with
-   [RFC6146] stateful NAT64 devices that are placed in the operator's
-   network.  In such a case, the MAP-T CE's DMR prefix is configured to
-   correspond to the NAT64 device prefix.  This in effect allows the use
-   of MAP-T CEs in environments that need to perform statistical
-   multiplexing of IPv4 addresses, while utilizing stateful NAT64
-   devices, and can take the role of a customer-side translator (CLAT)
-   as defined in [RFC6877].
-
-13.  Security Considerations
-
-   Spoofing attacks:  With consistency checks between IPv4 and IPv6
-      sources that are performed on IPv4/IPv6 packets received by MAP
-      nodes, MAP does not introduce any new opportunity for spoofing
-      attacks that would not already exist in IPv6.
-
-   Denial-of-service attacks:  In MAP domains where IPv4 addresses are
-      shared, the fact that IPv4 datagram reassembly may be necessary
-      introduces an opportunity for DoS attacks.  This is inherent in
-      address sharing and is common with other address-sharing
-      approaches such as Dual-Stack Lite (DS-Lite) and NAT64/DNS64.  The
-      best protection against such attacks is to accelerate IPv6 support
-      in both clients and servers.
-
-   Routing loop attacks:  Routing loop attacks may exist in some
-      "automatic tunneling" scenarios and are documented in [RFC6324].
-      They cannot exist with MAP because each BR checks that the IPv6
-      source address of a received IPv6 packet is a CE address based on
-      the Forwarding Mapping Rule.
-
-   Attacks facilitated by restricted port set:  From hosts that are not
-      subject to ingress filtering [RFC2827], an attacker can inject
-      spoofed packets during ongoing transport connections [RFC4953]
-      [RFC5961] [RFC6056].  The attacks depend on guessing which ports
-      are currently used by target hosts.  Using an unrestricted port
-      set is preferable, i.e., using native IPv6 connections that are
-      not subject to MAP port-range restrictions.  To minimize these
-      types of attacks when using a restricted port set, the MAP CE's
-      NAT44 filtering behavior SHOULD be "Address-Dependent Filtering"
-      as described in Section 5 of [RFC4787].  Furthermore, the MAP CEs
-      SHOULD use a DNS transport proxy function to handle DNS traffic
-
-
-
-Li, et al.                   Standards Track                   [Page 16]
-
-RFC 7599                          MAP-T                        July 2015
-
-
-      and source such traffic from IPv6 interfaces not assigned to
-      MAP-T.  Practicalities of these methods are discussed in
-      Section 5.9 of [Stateless-4Via6].
-
-   ICMP Flooding:  Given the necessity to process and translate ICMP and
-      ICMPv6 messages by the BR and CE nodes, a foreseeable attack
-      vector is that of a flood of such messages leading to a saturation
-      of the node's ICMP computing resources.  This attack vector is not
-      specific to MAP, and its mitigation lies in a combination of
-      policing the rate of ICMP messages, policing the rate at which
-      such messages can get processed by the MAP nodes, and of course
-      identifying and blocking off the source(s) of such traffic.
-
-   [RFC6269] outlines general issues with IPv4 address sharing.
-
-14.  References
-
-14.1.  Normative References
-
-   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
-              Requirement Levels", BCP 14, RFC 2119,
-              DOI 10.17487/RFC2119, March 1997,
-              <http://www.rfc-editor.org/info/rfc2119>.
-
-   [RFC6052]  Bao, C., Huitema, C., Bagnulo, M., Boucadair, M., and X.
-              Li, "IPv6 Addressing of IPv4/IPv6 Translators", RFC 6052,
-              DOI 10.17487/RFC6052, October 2010,
-              <http://www.rfc-editor.org/info/rfc6052>.
-
-   [RFC6145]  Li, X., Bao, C., and F. Baker, "IP/ICMP Translation
-              Algorithm", RFC 6145, DOI 10.17487/RFC6145, April 2011,
-              <http://www.rfc-editor.org/info/rfc6145>.
-
-   [RFC6346]  Bush, R., Ed., "The Address plus Port (A+P) Approach to
-              the IPv4 Address Shortage", RFC 6346,
-              DOI 10.17487/RFC6346, August 2011,
-              <http://www.rfc-editor.org/info/rfc6346>.
-
-   [RFC7597]  Troan, O., Ed., Dec, W., Li, X., Bao, C., Matsushima, S.,
-              Murakami, T., and T. Taylor, Ed., "Mapping of Address and
-              Port with Encapsulation (MAP-E)", RFC 7597,
-              DOI 10.17487/RFC7597, July 2015,
-              <http://www.rfc-editor.org/info/rfc7597>.
-
-
-
-
-
-
-
-
-Li, et al.                   Standards Track                   [Page 17]
-
-RFC 7599                          MAP-T                        July 2015
-
-
-14.2.  Informative References
-
-   [MAP-T-Use-Cases]
-              Maglione, R., Ed., Dec, W., Leung, I., and E. Mallette,
-              "Use cases for MAP-T", Work in Progress,
-              draft-maglione-softwire-map-t-scenarios-05, October 2014.
-
-   [RFC792]   Postel, J., "Internet Control Message Protocol", STD 5,
-              RFC 792, DOI 10.17487/RFC0792, September 1981,
-              <http://www.rfc-editor.org/info/rfc792>.
-
-   [RFC879]   Postel, J., "The TCP Maximum Segment Size and Related
-              Topics", RFC 879, DOI 10.17487/RFC0879, November 1983,
-              <http://www.rfc-editor.org/info/rfc879>.
-
-   [RFC2663]  Srisuresh, P. and M. Holdrege, "IP Network Address
-              Translator (NAT) Terminology and Considerations",
-              RFC 2663, DOI 10.17487/RFC2663, August 1999,
-              <http://www.rfc-editor.org/info/rfc2663>.
-
-   [RFC2827]  Ferguson, P. and D. Senie, "Network Ingress Filtering:
-              Defeating Denial of Service Attacks which employ IP Source
-              Address Spoofing", BCP 38, RFC 2827, DOI 10.17487/RFC2827,
-              May 2000, <http://www.rfc-editor.org/info/rfc2827>.
-
-   [RFC3633]  Troan, O. and R. Droms, "IPv6 Prefix Options for Dynamic
-              Host Configuration Protocol (DHCP) version 6", RFC 3633,
-              DOI 10.17487/RFC3633, December 2003,
-              <http://www.rfc-editor.org/info/rfc3633>.
-
-   [RFC4443]  Conta, A., Deering, S., and M. Gupta, Ed., "Internet
-              Control Message Protocol (ICMPv6) for the Internet
-              Protocol Version 6 (IPv6) Specification", RFC 4443,
-              DOI 10.17487/RFC4443, March 2006,
-              <http://www.rfc-editor.org/info/rfc4443>.
-
-   [RFC4787]  Audet, F., Ed., and C. Jennings, "Network Address
-              Translation (NAT) Behavioral Requirements for Unicast
-              UDP", BCP 127, RFC 4787, DOI 10.17487/RFC4787,
-              January 2007, <http://www.rfc-editor.org/info/rfc4787>.
-
-   [RFC4821]  Mathis, M. and J. Heffner, "Packetization Layer Path MTU
-              Discovery", RFC 4821, DOI 10.17487/RFC4821, March 2007,
-              <http://www.rfc-editor.org/info/rfc4821>.
-
-
-
-
-
-
-
-Li, et al.                   Standards Track                   [Page 18]
-
-RFC 7599                          MAP-T                        July 2015
-
-
-   [RFC4862]  Thomson, S., Narten, T., and T. Jinmei, "IPv6 Stateless
-              Address Autoconfiguration", RFC 4862,
-              DOI 10.17487/RFC4862, September 2007,
-              <http://www.rfc-editor.org/info/rfc4862>.
-
-   [RFC4953]  Touch, J., "Defending TCP Against Spoofing Attacks",
-              RFC 4953, DOI 10.17487/RFC4953, July 2007,
-              <http://www.rfc-editor.org/info/rfc4953>.
-
-   [RFC5382]  Guha, S., Ed., Biswas, K., Ford, B., Sivakumar, S., and P.
-              Srisuresh, "NAT Behavioral Requirements for TCP", BCP 142,
-              RFC 5382, DOI 10.17487/RFC5382, October 2008,
-              <http://www.rfc-editor.org/info/rfc5382>.
-
-   [RFC5508]  Srisuresh, P., Ford, B., Sivakumar, S., and S. Guha, "NAT
-              Behavioral Requirements for ICMP", BCP 148, RFC 5508,
-              DOI 10.17487/RFC5508, April 2009,
-              <http://www.rfc-editor.org/info/rfc5508>.
-
-   [RFC5961]  Ramaiah, A., Stewart, R., and M. Dalal, "Improving TCP's
-              Robustness to Blind In-Window Attacks", RFC 5961,
-              DOI 10.17487/RFC5961, August 2010,
-              <http://www.rfc-editor.org/info/rfc5961>.
-
-   [RFC6056]  Larsen, M. and F. Gont, "Recommendations for Transport-
-              Protocol Port Randomization", BCP 156, RFC 6056,
-              DOI 10.17487/RFC6056, January 2011,
-              <http://www.rfc-editor.org/info/rfc6056>.
-
-   [RFC6146]  Bagnulo, M., Matthews, P., and I. van Beijnum, "Stateful
-              NAT64: Network Address and Protocol Translation from IPv6
-              Clients to IPv4 Servers", RFC 6146, DOI 10.17487/RFC6146,
-              April 2011, <http://www.rfc-editor.org/info/rfc6146>.
-
-   [RFC6147]  Bagnulo, M., Sullivan, A., Matthews, P., and I. van
-              Beijnum, "DNS64: DNS Extensions for Network Address
-              Translation from IPv6 Clients to IPv4 Servers", RFC 6147,
-              DOI 10.17487/RFC6147, April 2011,
-              <http://www.rfc-editor.org/info/rfc6147>.
-
-   [RFC6219]  Li, X., Bao, C., Chen, M., Zhang, H., and J. Wu, "The
-              China Education and Research Network (CERNET) IVI
-              Translation Design and Deployment for the IPv4/IPv6
-              Coexistence and Transition", RFC 6219,
-              DOI 10.17487/RFC6219, May 2011,
-              <http://www.rfc-editor.org/info/rfc6219>.
-
-
-
-
-
-Li, et al.                   Standards Track                   [Page 19]
-
-RFC 7599                          MAP-T                        July 2015
-
-
-   [RFC6269]  Ford, M., Ed., Boucadair, M., Durand, A., Levis, P., and
-              P. Roberts, "Issues with IP Address Sharing", RFC 6269,
-              DOI 10.17487/RFC6269, June 2011,
-              <http://www.rfc-editor.org/info/rfc6269>.
-
-   [RFC6324]  Nakibly, G. and F. Templin, "Routing Loop Attack Using
-              IPv6 Automatic Tunnels: Problem Statement and Proposed
-              Mitigations", RFC 6324, DOI 10.17487/RFC6324, August 2011,
-              <http://www.rfc-editor.org/info/rfc6324>.
-
-   [RFC6877]  Mawatari, M., Kawashima, M., and C. Byrne, "464XLAT:
-              Combination of Stateful and Stateless Translation",
-              RFC 6877, DOI 10.17487/RFC6877, April 2013,
-              <http://www.rfc-editor.org/info/rfc6877>.
-
-   [RFC7598]  Mrugalski, T., Troan, O., Farrer, I., Perreault, S., Dec,
-              W., Bao, C., Yeh, L., and X. Deng, "DHCPv6 Options for
-              Configuration of Softwire Address and Port-Mapped
-              Clients", RFC 7598, DOI 10.17487/RFC7598, July 2015,
-              <http://www.rfc-editor.org/info/rfc7598>.
-
-   [Solutions-4v6]
-              Boucadair, M., Ed., Matsushima, S., Lee, Y., Bonness, O.,
-              Borges, I., and G. Chen, "Motivations for Carrier-side
-              Stateless IPv4 over IPv6 Migration Solutions", Work in
-              Progress, draft-ietf-softwire-stateless-4v6-motivation-05,
-              November 2012.
-
-   [Stateless-4Via6]
-              Dec, W., Asati, R., Bao, C., Deng, H., and M. Boucadair,
-              "Stateless 4Via6 Address Sharing", Work in Progress,
-              draft-dec-stateless-4v6-04, October 2011.
-
-   [TR069]    Broadband Forum TR-069, "CPE WAN Management Protocol",
-              Amendment 5, CWMP Version: 1.4, November 2013,
-              <https://www.broadband-forum.org>.
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-Li, et al.                   Standards Track                   [Page 20]
-
-RFC 7599                          MAP-T                        July 2015
-
-
-Appendix A.  Examples of MAP-T Translation
-
-   Example 1 - Basic Mapping Rule:
-
-   Given the following MAP domain information and IPv6 end-user prefix
-   assigned to a MAP CE:
-
-   End-user IPv6 prefix:  2001:db8:0012:3400::/56
-   Basic Mapping Rule:    {2001:db8:0000::/40 (Rule IPv6 prefix),
-                           192.0.2.0/24 (Rule IPv4 prefix),
-                           16 (Rule EA-bit length)}
-   PSID length:           (16 - (32 - 24) = 8 (sharing ratio of 256)
-   PSID offset:           6 (default)
-
-   A MAP node (CE or BR) can, via the BMR or equivalent FMR, determine
-   the IPv4 address and port set as shown below:
-
-   EA bits offset:        40
-   IPv4 suffix bits (p):  Length of IPv4 address (32) -
-                          IPv4 prefix length (24) = 8
-   IPv4 address:          192.0.2.18 (0xc0000212)
-   PSID start:            40 + p = 40 + 8 = 48
-   PSID length (q):       o - p = (End-user prefix len -
-                          Rule IPv6 prefix len) - p
-                          = (56 - 40) - 8 = 8
-   PSID:                  0x34
-
-   Available ports (63 ranges): 1232-1235, 2256-2259, ...... ,
-                                63696-63699, 64720-64723
-
-   The BMR information allows a MAP CE to determine (complete) its
-   IPv6 address within the indicated End-user IPv6 prefix.
-
-   IPv6 address of MAP CE:  2001:db8:0012:3400:0000:c000:0212:0034
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-Li, et al.                   Standards Track                   [Page 21]
-
-RFC 7599                          MAP-T                        July 2015
-
-
-   Example 2 - BR:
-
-   Another example is a MAP-T BR configured with the following FMR
-   when receiving a packet with the following characteristics:
-
-   IPv4 source address:       10.2.3.4 (0x0a020304)
-   TCP source port:           80
-   IPv4 destination address:  192.0.2.18 (0xc0000212)
-   TCP destination port:      1232
-
-   Forwarding Mapping Rule:   {2001:db8::/40 (Rule IPv6 prefix),
-                               192.0.2.0/24 (Rule IPv4 prefix),
-                               16 (Rule EA-bit length)}
-
-   MAP-T BR Prefix (DMR):     2001:db8:ffff::/64
-
-   The above information allows the BR to derive the mapped destination
-   IPv6 address for the corresponding MAP-T CE, and also the source
-   IPv6 address for the mapped IPv4 source address, as follows:
-
-   IPv4 suffix bits (p):     32 - 24 = 8 (18 (0x12))
-   PSID length:              8
-   PSID:  0                  x34 (1232)
-
-   The resulting IPv6 packet will have the following header fields:
-
-   IPv6 source address:      2001:db8:ffff:0:000a:0203:0400::
-   IPv6 destination address: 2001:db8:0012:3400:0000:c000:0212:0034
-   TCP source port:          80
-   TCP destination port:     1232
-
-
-   Example 3 - FMR:
-
-   An IPv4 host behind a MAP-T CE (configured as per the previous
-   examples) corresponding with IPv4 host 10.2.3.4 will have its
-   packets converted into IPv6 using the DMR configured on the MAP-T
-   CE as follows:
-
-   Default Mapping Rule:         {2001:db8:ffff::/64 (Rule IPv6 prefix),
-                                  0.0.0.0/0 (Rule IPv4 prefix)}
-
-   IPv4 source address:          192.0.2.18
-   IPv4 destination address:     10.2.3.4
-   IPv4 source port:             1232
-   IPv4 destination port:        80
-   MAP-T CE IPv6 source address: 2001:db8:0012:3400:0000:c000:0212:0034
-   IPv6 destination address:     2001:db8:ffff:0:000a:0203:0400::
-
-
-
-Li, et al.                   Standards Track                   [Page 22]
-
-RFC 7599                          MAP-T                        July 2015
-
-
-   Example 4 - Rule with no embedded address bits and no address
-   sharing:
-
-   End-user IPv6 prefix:    2001:db8:0012:3400::/56
-   Basic Mapping Rule:      {2001:db8:0012:3400::/56 (Rule IPv6 prefix),
-                             192.0.2.1/32 (Rule IPv4 prefix),
-                             0 (Rule EA-bit length)}
-   PSID length:             0 (sharing ratio is 1)
-   PSID offset:             n/a
-
-   A MAP node can, via the BMR or equivalent FMR, determine the
-   IPv4 address and port set as shown below:
-
-   EA bits offset:          0
-   IPv4 suffix bits (p):    Length of IPv4 address -
-                            IPv4 prefix length = 32 - 32 = 0
-   IPv4 address:            192.0.2.18 (0xc0000212)
-   PSID start:              0
-   PSID length:             0
-   PSID:                    null
-
-   The BMR information allows a MAP CE to also determine (complete) its
-   full IPv6 address by combining the IPv6 prefix with the MAP interface
-   identifier (that embeds the IPv4 address).
-
-   IPv6 address of MAP CE:  2001:db8:0012:3400:0000:c000:0201:0000
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-Li, et al.                   Standards Track                   [Page 23]
-
-RFC 7599                          MAP-T                        July 2015
-
-
-   Example 5 - Rule with no embedded address bits and address sharing
-   (sharing ratio of 256):
-
-   End-user IPv6 prefix:    2001:db8:0012:3400::/56
-   Basic Mapping Rule:      {2001:db8:0012:3400::/56 (Rule IPv6 prefix),
-                             192.0.2.18/32 (Rule IPv4 prefix),
-                             0 (Rule EA-bit length)}
-   PSID length:             (16 - (32 - 24)) = 8 (sharing ratio of 256;
-                            provisioned with DHCPv6)
-   PSID offset:             6 (default)
-   PSID:                    0x20 (provisioned with DHCPv6)
-
-   A MAP node can, via the BMR, determine the IPv4 address and port set
-   as shown below:
-
-   EA bits offset:          0
-   IPv4 suffix bits (p):    Length of IPv4 address -
-                            IPv4 prefix length = 32 - 32 = 0
-   IPv4 address             192.0.2.18 (0xc0000212)
-   PSID start:              0
-   PSID length:             8
-   PSID:                    0x34
-
-   Available ports (63 ranges): 1232-1235, 2256-2259, ...... ,
-                                63696-63699, 64720-64723
-
-   The BMR information allows a MAP CE to also determine (complete) its
-   full IPv6 address by combining the IPv6 prefix with the MAP interface
-   identifier (that embeds the IPv4 address and PSID).
-
-   IPv6 address of MAP CE:  2001:db8:0012:3400:0000:c000:0212:0034
-
-   Note that the IPv4 address and PSID are not derived from the IPv6
-   prefix assigned to the CE but are provisioned separately, using, for
-   example, MAP options in DHCPv6.
-
-Appendix B.  Port-Mapping Algorithm
-
-   The driving principles and the mathematical expression of the mapping
-   algorithm used by MAP can be found in Appendix B of [RFC7597].
-
-
-
-
-
-
-
-
-
-
-
-Li, et al.                   Standards Track                   [Page 24]
-
-RFC 7599                          MAP-T                        July 2015
-
-
-Acknowledgements
-
-   This document is based on the ideas of many, particularly Remi
-   Despres, who has tirelessly worked on generalized mechanisms for
-   stateless address mapping.
-
-   The authors would also like to thank Mohamed Boucadair, Guillaume
-   Gottard, Dan Wing, Jan Zorz, Nejc Skoberne, Tina Tsou, Gang Chen,
-   Maoke Chen, Xiaohong Deng, Jouni Korhonen, Tomek Mrugalski, Jacni
-   Qin, Chunfa Sun, Qiong Sun, Leaf Yeh, Andrew Yourtchenko, Roberta
-   Maglione, and Hongyu Chen for their review and comments.
-
-Contributors
-
-   The following individuals authored major contributions to this
-   document and made the document possible:
-
-   Chongfeng Xie
-   China Telecom
-   Room 708, No. 118, Xizhimennei Street
-   Beijing  100035
-   China
-   Phone: +86-10-58552116
-   Email: xiechf@ctbri.com.cn
-
-   Qiong Sun
-   China Telecom
-   Room 708, No. 118, Xizhimennei Street
-   Beijing  100035
-   China
-   Phone: +86-10-58552936
-   Email: sunqiong@ctbri.com.cn
-
-   Rajiv Asati
-   Cisco Systems
-   7025-6 Kit Creek Road
-   Research Triangle Park, NC  27709
-   United States
-   Email: rajiva@cisco.com
-
-   Gang Chen
-   China Mobile
-   29, Jinrong Avenue
-   Xicheng District, Beijing  100033
-   China
-   Email: phdgang@gmail.com, chengang@chinamobile.com
-
-
-
-
-
-Li, et al.                   Standards Track                   [Page 25]
-
-RFC 7599                          MAP-T                        July 2015
-
-
-   Wentao Shang
-   CERNET Center/Tsinghua University
-   Room 225, Main Building, Tsinghua University
-   Beijing  100084
-   China
-   Email: wentaoshang@gmail.com
-
-   Guoliang Han
-   CERNET Center/Tsinghua University
-   Room 225, Main Building, Tsinghua University
-   Beijing  100084
-   China
-   Email: bupthgl@gmail.com
-
-   Yu Zhai
-   CERNET Center/Tsinghua University
-   Room 225, Main Building, Tsinghua University
-   Beijing  100084
-   China
-   Email: jacky.zhai@gmail.com
-
-Authors' Addresses
-
-   Xing Li
-   CERNET Center/Tsinghua University
-   Room 225, Main Building, Tsinghua University
-   Beijing  100084
-   China
-
-   Email: xing@cernet.edu.cn
-
-
-   Congxiao Bao
-   CERNET Center/Tsinghua University
-   Room 225, Main Building, Tsinghua University
-   Beijing  100084
-   China
-
-   Email: congxiao@cernet.edu.cn
-
-
-   Wojciech Dec (editor)
-   Cisco Systems
-   Haarlerbergpark Haarlerbergweg 13-19
-   Amsterdam, NOORD-HOLLAND  1101 CH
-   The Netherlands
-
-   Email: wdec@cisco.com
-
-
-
-Li, et al.                   Standards Track                   [Page 26]
-
-RFC 7599                          MAP-T                        July 2015
-
-
-   Ole Troan
-   Cisco Systems
-   Philip Pedersens vei 1
-   Lysaker  1366
-   Norway
-
-   Email: ot@cisco.com
-
-
-   Satoru Matsushima
-   SoftBank Telecom
-   1-9-1 Higashi-Shinbashi, Munato-ku
-   Tokyo
-   Japan
-
-   Email: satoru.matsushima@g.softbank.co.jp
-
-
-   Tetsuya Murakami
-   IP Infusion
-   1188 East Arques Avenue
-   Sunnyvale, CA  94085
-   United States
-
-   Email: tetsuya@ipinfusion.com
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-Li, et al.                   Standards Track                   [Page 27]
-
diff -urpN freeradius-server-3.2.7/raddb/certs/Makefile freeradius-server-3.2.8/raddb/certs/Makefile
--- freeradius-server-3.2.7/raddb/certs/Makefile	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/raddb/certs/Makefile	2025-08-20 23:29:15.000000000 +0700
@@ -5,7 +5,7 @@
 #
 #	See the README file in this directory for more information.
 #
-#	$Id: 34948bd9248a6953de3696abcd2088a7a5cee014 $
+#	$Id: 1b6b944ee3ad2512cba7803db7cb013706318bec $
 #
 ######################################################################
 
@@ -98,6 +98,9 @@ server.p12: server.crt
 	$(OPENSSL) pkcs12 -export -in server.crt -inkey server.key -out server.p12  -passin pass:$(PASSWORD_SERVER) -passout pass:$(PASSWORD_SERVER)
 	chmod g+r server.p12
 
+server.der: server.pem
+	$(OPENSSL) x509 -inform PEM -outform DER -in server.pem -out server.der
+
 server.pem: server.p12
 	$(OPENSSL) pkcs12 -in server.p12 -out server.pem -passin pass:$(PASSWORD_SERVER) -passout pass:$(PASSWORD_SERVER)
 	chmod g+r server.pem
diff -urpN freeradius-server-3.2.7/raddb/certs/README.md freeradius-server-3.2.8/raddb/certs/README.md
--- freeradius-server-3.2.7/raddb/certs/README.md	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/raddb/certs/README.md	2025-08-20 23:29:15.000000000 +0700
@@ -194,7 +194,7 @@ number, i.e. the actual EAP-TLS performa
 number printed here.
 
 The reason is that EAP requires many round-trip packets, whereas
-`openssl speed rsa2028` only does RSA calculations, and nothing else.
+`openssl speed rsa2048` only does RSA calculations, and nothing else.
 
 
 ## Compatibility
diff -urpN freeradius-server-3.2.7/raddb/mods-available/dpsk freeradius-server-3.2.8/raddb/mods-available/dpsk
--- freeradius-server-3.2.7/raddb/mods-available/dpsk	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/raddb/mods-available/dpsk	2025-08-20 23:29:15.000000000 +0700
@@ -1,6 +1,6 @@
 # -*- text -*-
 #
-#  $Id: 7781915bcb9fa7d5bacefe8efee20c35acaab5d0 $
+#  $Id: 19e2f4f09b80dd878d7575a8561ea6a9d3035d6a $
 
 #
 #  Calculate dynamic PSKs
@@ -24,27 +24,67 @@
 #		...
 #		rewrite_called_station_id
 #
-#		update control {
-#			&PSK-Identity := "bob"
-#			&Pre-Shared-Key := "this-is-super-secret"
-#		}
 #		dpsk
+#		if (ok) {
+#			update control {
+#				&PSK-Identity := "bob"
+#				&Pre-Shared-Key := "this-is-super-secret"
+#			}
+#		}
 #
 #	}
 #
-#  And update the "authenticate" section to list the "dpsk" module:
+#  Alternatively, you can read &control:PSK-Identity and
+#  &control:Pre-Shared-Key from a database.  Just do that before
+#  running the "authenticate" section.  You can do the database lookup
+#  after running the "dpsk" module in the "authorize" section.
+#
+#  The database should look up the User-Name (i.e. MAC), and then set
+#  &control:PSK-Identity and &control:Pre-Shared-Key.  In general, it
+#  is easiest to just set PSK-Identity to be same as the User-Name.
+#
+#  Then update the "authenticate" section to list the "dpsk" module:
 #
 #	authenticate {
 #		...
-#		dpsk
+#
+#		Auth-Type dpsk {
+#			dpsk
+#			if (updated) {
+#				... cache &reply:Pre-Shared-Key
+#				... cache &reply:PSK-Identity
+#
+#			}
+#		}
+#
 #		...
 #	}
 #
-#  The module will return "fail" if the PSK is not correct.  It will return "ok"
-#  if the PSK is correct.
+#  In the "authenticate" section, the module will return
 #
-#  It also updates &reply:Pre-Shared-Key with the found key, along with
-#  &reply:PSK-Identity with the found identity.
+#  * noop	if there are no DPSK attributes in the request
+#
+#  * fail	if there are DPSK attributes, but it is unable to get the
+#		information necessary to check the DPSK data.
+#
+#  * reject 	if there are DPSK attributes, but they do not match any
+#		given PSK.
+#
+#  * ok		if there are DPSK attributes, and they match a known PSK.
+#
+#  * updated	if there are DPSK attributes which match a PSK, and the
+#		PSK was read from 'filename'.
+#
+#		It also updates the attributes &reply:Pre-Shared-Key
+#		with the found PSK, along with &reply:PSK-Identity
+#		with the found identity.
+#
+#		You can then check the return code for "updated", and
+#		write those attributes into a database.  This step
+#		ensures that 'filename' is read only as a last resort.
+#		Since the file is read from top to bottom for every
+#		packet, this process is much slower than using a
+#		database which is keyed to the PSK Identity.
 #
 #  We STRONGLY RECOMMEND THAT NO ONE USE THIS MODULE.
 #
@@ -73,6 +113,9 @@ dpsk {
 	#  and/or the PMK which are used to verify the information in
 	#  the Access-Request.
 	#
+	#  Caching entries can help, even when using a database.  It
+	#  is very slow to calculate the PMK from the PSK.
+	#
 	cache_size = 1024
 
 	#
diff -urpN freeradius-server-3.2.7/raddb/mods-available/eap freeradius-server-3.2.8/raddb/mods-available/eap
--- freeradius-server-3.2.7/raddb/mods-available/eap	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/raddb/mods-available/eap	2025-08-20 23:29:15.000000000 +0700
@@ -2,7 +2,7 @@
 ##
 ##  eap.conf -- Configuration for EAP types (PEAP, TTLS, etc.)
 ##
-##	$Id: 84660d7c1e84d9cdd144b2ceba08a44ebc44d7e1 $
+##	$Id: 97c7435a7c741138626a55153a322ca53fdc81f0 $
 
 #######################################################################
 #
@@ -1148,6 +1148,17 @@ eap {
 	#
 	#  The TEAP module implements the EAP-TEAP protocol
 	#
+	#  Note that for Windows:
+	#
+	#  * "machine" authentication is ALWAYS EAP-TLS.
+	#  * "user" authentication is almost always EAP-MSCHAPv2,
+	#    except when Windows is configured for "smartcard"
+	#    authentication.
+	#
+	#  If you configure FreeRADIUS to do anything else, then
+	#  Windows will either fail, or will just return one of the
+	#  methods listed above.
+	#
 	#teap {
 		#  Point to the common TLS configuration
 		#
diff -urpN freeradius-server-3.2.7/raddb/mods-available/exec freeradius-server-3.2.8/raddb/mods-available/exec
--- freeradius-server-3.2.7/raddb/mods-available/exec	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/raddb/mods-available/exec	2025-08-20 23:29:15.000000000 +0700
@@ -1,11 +1,42 @@
 # -*- text -*-
 #
-#  $Id: bb1d4374b741a7bfcdfc098fc57af650509ceae2 $
+#  $Id: 72af894d3109f7a9288abd58a6fa89eb37156135 $
 
 #
 #  Execute external programs
 #
-#  This module is useful only for 'xlat'.  To use it,
+# == Don't use this module.
+#
+#  We provide this module for the _extremely rare_ case when it is
+#  useful.  The main utility of the module is for testing, and for
+#  doing some unusual things which aren't possible via any other
+#  method.
+#
+#  It can be appealing to just ignore `unlang`, and run `exec`
+#  everywhere.  This kind of configuration can be written quickly,
+#  means that you don't need to spend any time understanding the
+#  server configuration.  This process is generally more effort than
+#  it is worth.
+#
+#  The biggest problem with `exec` is that it is slow.  Very, very,
+#  very, slow.  We have tested the server at 80K Access-Requests per
+#  second (to OpenLDAP) on low-end hardware.  This is fast enough to
+#  run a major ISP.
+#
+#  In contrast, when each Access-Request causes an `exec` script to be
+#  run, the rate of access-Request can drop by a factor of 100 or
+#  more.  It is not unusual for the server to max out at a few hundred
+#  authentications per second when running multiple scripts per packet.
+#
+#  The server has sufficient functionality that it is essentially
+#  never necessary to `exec` and external script.  Please use the
+#  built-in functionality of the server; it is hundreds of times
+#  faster than running a script, and it is designed to process
+#  packets.  An external script is worse, by nearly all possible
+#  standards of measurement.
+#
+#
+#  This module is mainly for dynamic expansions.  To use it,
 #  put 'exec' into the 'instantiate' section.  You can then
 #  do dynamic translation of attributes like:
 #
diff -urpN freeradius-server-3.2.7/raddb/mods-available/json freeradius-server-3.2.8/raddb/mods-available/json
--- freeradius-server-3.2.7/raddb/mods-available/json	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/raddb/mods-available/json	2025-08-20 23:29:15.000000000 +0700
@@ -1,7 +1,7 @@
 #  -*- text -*-
 #
 #
-#  $Id: 88f17c030bfed7e11f2144a6f74874e662d3e38c $
+#  $Id: bdf74d4240c78e73ea5acb405d73890f489f01a8 $
 
 #######################################################################
 #
@@ -80,6 +80,17 @@ json {
 #			enum_as_integer = no
 
 			#
+			#  dates_as_integer:: output dates as seconds since the
+			#  epoch
+			#
+			#  Where an attribute is a date, the textual
+			#  representation of the date will normally be output.
+			#  Enable this option to force the date to be rendered
+			#  as seconds since the epoch instead.
+			#
+#			dates_as_integer = no
+
+			#
 			#  always_string:: force all values to be strings
 			#
 			#  Integer values are normally written to the JSON
diff -urpN freeradius-server-3.2.7/raddb/mods-available/kafka freeradius-server-3.2.8/raddb/mods-available/kafka
--- freeradius-server-3.2.7/raddb/mods-available/kafka	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/raddb/mods-available/kafka	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,127 @@
+kafka {
+	bootstrap-servers = "localhost:9092"
+
+	#
+	#  This initialises the default, synchronous instance of the kafka
+	#  module which has robust event durability semantics.
+	#
+	#  The module adds the message to the local in-memory queue and then
+	#  waits upon a delivery report indicating that it was removed, i.e.
+	#  either successfully delivered to the brokers or not.
+	#
+
+	global-config {
+
+		#
+		#  There are many global parameters that can be used (with
+		#  careful consideration) described in the "Global
+		#  configuration properties" here:
+		#
+		#  https://docs.confluent.io/platform/current/clients/librdkafka/html/md_CONFIGURATION.html
+		#
+		#message.max.bytes = 1048576
+		#socket.send.buffer.bytes = 100000000
+		#socket.receive.buffer.bytes = 100000000
+		#sasl.mechanism = "SCRAM-SHA-512"
+		#security.protocol = "SASL_SSL"
+		#ssl.ca.location = "${cadir}"
+		#sasl.username = "kafkauser"
+		#sasl.password = "kafkapass"
+		#  ...
+		#
+
+	}
+
+	#
+	#  Example of a user-defined topic called by reference from another
+	#  section, or by using its name (which may be changed) in an xlat of
+	#  either form:
+	#
+	#    - "%{kafka:custom-topic (<header-list>) &Key-Attr-Ref Remainder is the message}"
+	#    - "%{kafka:custom-topic (<header-list>)  Remainder is the message}", if no key
+	#    - "%{kafka:custom-topic &Key-Attr-Ref Remainder is the message}"
+	#    - "%{kafka:custom-topic  Remainder is the message}", if no key
+	#
+	#  The attribute referred to by the optional &Key-Attr-Ref holds the
+	#  Kafka message's key. Notice that it is replaced with a mandatory
+	#  space if there is no key.
+	#
+	#  <header-list> has the same format as the json_encode xlat. For
+	#  example `&request[*] !&User-Password` creates Kafka headers from all
+	#  attributes in the RADIUS request, except for `User-Password`.
+	#
+	topic-config custom-topic {
+
+		#
+		#  The message durabily strategy: Number of acks required by all
+		#  in-sync replicas. Default of "-1" means all must have acked.
+		#
+		#request.required.acks = -1
+
+		#
+		#  How long a message can remain undelivered in the local
+		#  in-memory queue before it is timed out.
+		#
+		#  For synchronous delivery, the default local queue is set to
+		#  25 sec. It should be some value less than max_request_time
+		#  to avoid blocking the server indefinately in the event of
+		#  delivery problems.
+		#
+		#message.timeout.ms = 25000
+
+		#
+		#  There are many additional topic parameters that can be used
+		#  (with careful consideration) described in the "Topic
+		#  configuration properties" here:
+		#
+		#  https://docs.confluent.io/platform/current/clients/librdkafka/html/md_CONFIGURATION.html
+		#
+		#  ...
+		#
+
+	}
+
+	#
+	#  Topic used by calls from an accounting section
+	#
+	topic-config accounting {
+
+		#
+		#  You may either provide topic configuration parameters
+		#  or reference an existing topic (declared above this) to
+		#  reuse it.
+		#
+		#reference = custom-topic
+
+	}
+
+	#
+	#  Topic used by calls from an authorize section
+	#
+	topic-config authorize {
+
+		#
+		#  Used to set the topic name to something other than the
+		#  section from which it was called.
+		#
+		#name = "radius.auth_request"
+
+	}
+
+	#
+	#  Topic used by calls from a post-auth section
+	#
+	topic-config post-auth {
+		#name = "radius.auth_result"
+		#request.required.acks = 2
+	}
+
+	#
+	#  Uncomment to generate producer statistics
+	#
+#	statistics {
+#		file = /tmp/kafka_stats.json
+#	}
+
+	$INCLUDE ${modconfdir}/kafka/messages-json.conf
+}
diff -urpN freeradius-server-3.2.7/raddb/mods-available/kafka_async freeradius-server-3.2.8/raddb/mods-available/kafka_async
--- freeradius-server-3.2.7/raddb/mods-available/kafka_async	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/raddb/mods-available/kafka_async	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,150 @@
+kafka kafka_async {
+	bootstrap-servers = "localhost:9092"
+
+	#
+	#  This initialises an asynchronous instance of the kafka module.
+	#
+	#  When running asynchronously, calls to this module return as soon as
+	#  the message is enqueued in the local in-memory queue, with delivery
+	#  being attempted by a background thread according to the settings
+	#  specified below.
+	#
+	#  WARNING: This has consequences for event durability, for example
+	#  acknowledged accounting events will be lost if the process crashes
+	#  with events remaining in the local queue.
+	#
+	#  It can be enabled alongside the synchronous instance to support
+	#  messages with different durability strategies, for example:
+	#
+	#    Acct Stop: Call kafka instance (synchronous) => slow, durable
+	#    Acct I-U:  Call kafka_async instance         => fast, not durable
+	#
+	asynchronous = yes
+
+	global-config {
+
+		#
+		#  Local resources can be capped here
+		#
+		#queue.buffering.max.messages = 1000000
+		#queue.buffering.max.kbytes = 10000000
+
+		#
+		#  How long a request should wait in the queue in the hope of
+		#  batching requests for transmission. The default is not to
+		#  wait (0), but batching can result in significant performance
+		#  gains with asynchronous delivery.
+		#
+		linger.ms = 10
+
+		#
+		#  There are many additional topic parameters that can be used
+		#  (with careful consideration) described in the "Global
+		#  configuration properties" here:
+		#
+		#  https://docs.confluent.io/platform/current/clients/librdkafka/html/md_CONFIGURATION.html
+		#
+		#message.max.bytes = 1048576
+		#socket.send.buffer.bytes = 100000000
+		#socket.receive.buffer.bytes = 100000000
+		#sasl.mechanism = "SCRAM-SHA-512"
+		#security.protocol = "SASL_SSL"
+		#ssl.ca.location = "${cadir}"
+		#sasl.username = "kafkauser"
+		#sasl.password = "kafkapass"
+		#  ...
+		#
+
+	}
+
+	#
+	#  Example of a user-defined topic called by reference from another
+	#  section, or by using its name (which may be changed) in an xlat of
+	#  either form:
+	#
+	#    - "%{kafka_async:custom-topic (<header-list>) &Key-Attr-Ref Remainder is the message}"
+	#    - "%{kafka_async:custom-topic (<header-list>)  Remainder is the message}", if no key
+	#    - "%{kafka_async:custom-topic &Key-Attr-Ref Remainder is the message}"
+	#    - "%{kafka_async:custom-topic  Remainder is the message}", if no key
+	#
+	#  The attribute referred to by the optional &Key-Attr-Ref holds the
+	#  Kafka message's key. Notice that it is replaced with a mandatory
+	#  space if there is no key.
+	#
+	#  <header-list> has the same format as the json_encode xlat. For
+	#  example `&request[*] !&User-Password` creates Kafka headers from all
+	#  attributes in the RADIUS request, except for `User-Password`.
+	#
+	topic-config custom-topic {
+
+		#
+		#  The message durabily strategy: Number of acks required by all
+		#  in-sync replicas. Default of "-1" means all must have acked.
+		#
+		#request.required.acks = -1
+
+		#
+		#  How long a message can remain undelivered in the local
+		#  in-memory queue before it is timed out.
+		#
+		#  Default is determined by librdclient, typically 5 mins.
+		#
+		#  Set higher than the maximum broker outage that you need to
+		#  tollerate without losing events.
+		#
+		#message.timeout.ms = 3600000
+
+		#
+		#  There are many additional topic parameters that can be used
+		#  (with careful consideration) described in the "Topic
+		#  configuration properties" here:
+		#
+		#  https://docs.confluent.io/platform/current/clients/librdkafka/html/md_CONFIGURATION.html
+		#
+		#  ...
+		#
+
+	}
+
+	#
+	#  Topic used by calls from an accounting section
+	#
+	topic-config accounting {
+
+		#
+		#  You may either provide topic configuration parameters
+		#  or reference an existing topic (declared above this) to
+		#  reuse it.
+		#
+		#reference = custom-topic
+
+	}
+
+	#
+	#  Topic used by calls from an authorize section
+	#
+	topic-config authorize {
+
+		#
+		#  Used to set the topic name to something other than the
+		#  section from which it was called.
+		#
+		#name = "radius.auth_request"
+
+	}
+
+	#
+	#  Topic used by calls from a post-auth section
+	#
+	topic-config post-auth {
+		#name = "radius.auth_result"
+		#request.required.acks = 2
+	}
+
+
+#	statistics {
+#		file = /tmp/kafka_async_stats.json
+#	}
+
+	$INCLUDE ${modconfdir}/kafka/messages-json.conf
+}
diff -urpN freeradius-server-3.2.7/raddb/mods-available/ldap freeradius-server-3.2.8/raddb/mods-available/ldap
--- freeradius-server-3.2.7/raddb/mods-available/ldap	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/raddb/mods-available/ldap	2025-08-20 23:29:15.000000000 +0700
@@ -1,6 +1,6 @@
 # -*- text -*-
 #
-#  $Id: d5838ffa01a880fdb516159d9a289d9578acffd8 $
+#  $Id: 82438cc604bc9babff7a3b30891c52d185a64175 $
 
 #
 #  Lightweight Directory Access Protocol (LDAP)
@@ -129,9 +129,24 @@ ldap {
 		control:Password-With-Header	+= 'userPassword'
 #		control:NT-Password		:= 'ntPassword'
 #		reply:Reply-Message		:= 'radiusReplyMessage'
-#		reply:Tunnel-Type		:= 'radiusTunnelType'
-#		reply:Tunnel-Medium-Type	:= 'radiusTunnelMediumType'
-#		reply:Tunnel-Private-Group-ID	:= 'radiusTunnelPrivategroupId'
+
+		#
+		#  These attributes take tags.  The tag can be place
+		#  on the left-hand side, as is done elsewhere in the
+		#  server.
+		#
+		#  Or, the special tag ":V" can be used, in which case
+		#  the value read from LDAP should begin with the tag
+		#  number, which is surrounded by ':'  e.g.
+		#
+		#	:1:foo
+		#
+		#  If the value does not begin with a tag in the above
+		#  format, then the tag is set to zero (0).
+		#
+#		reply:Tunnel-Type:V		:= 'radiusTunnelType'
+#		reply:Tunnel-Medium-Type:V	:= 'radiusTunnelMediumType'
+#		reply:Tunnel-Private-Group-ID:V	:= 'radiusTunnelPrivategroupId'
 
 		#  Where only a list is specified as the RADIUS attribute,
 		#  the value of the LDAP attribute is parsed as a valuepair
@@ -602,7 +617,7 @@ ldap {
 	#
 	#  For more details, see:
 	#
-	#	http://packages.networkradius.com
+	#	http://packages.inkbridgenetworks.com
 	#
 	tls {
 		# Set this to 'yes' to use TLS encrypted connections
diff -urpN freeradius-server-3.2.7/raddb/mods-available/proxy_rate_limit freeradius-server-3.2.8/raddb/mods-available/proxy_rate_limit
--- freeradius-server-3.2.7/raddb/mods-available/proxy_rate_limit	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/raddb/mods-available/proxy_rate_limit	2025-08-20 23:29:15.000000000 +0700
@@ -1,6 +1,6 @@
 # -*- text -*-
 #
-#  $Id: e7db410a8c3d300e9552731c037fa55186137290 $
+#  $Id: 6d424a8d53faefa42d605cde273eb8a0705a7f79 $
 
 #
 #  This module performs rate limiting on proxied packets.
@@ -57,6 +57,14 @@
 #		...
 #	}
 #
+#  The module can also be listed in the "authorize" section.  Listing
+#  it there as the first module allows the server to reject bad
+#  packets as quickly as possible, while doing zero additional work
+#  for policies, database lookups, etc.
+#
+#  If it is listed in the "authorize" section, then it should not be
+#  listed in the "pre-proxy" section.
+#
 
 #
 #  The module configuration.
@@ -82,4 +90,10 @@ proxy_rate_limit {
 	#  the entry is expired.
 	#
 	idle_timeout = 10
+
+	#
+	#  The suppression period.  If a client retransmits during this time,
+	#  the rate limiting will start, and the proxy will send a reject.
+	#
+	window = 1
 }
diff -urpN freeradius-server-3.2.7/raddb/mods-available/sql freeradius-server-3.2.8/raddb/mods-available/sql
--- freeradius-server-3.2.7/raddb/mods-available/sql	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/raddb/mods-available/sql	2025-08-20 23:29:15.000000000 +0700
@@ -2,7 +2,7 @@
 ##
 ## mods-available/sql -- SQL modules
 ##
-##	$Id: 68ac4da753b5db0671e2cd1bd1589daec4bf1b1e $
+##	$Id: 38a8f76b64e88b1dd2f2b4288576825553fa675a $
 
 ######################################################################
 #
@@ -403,6 +403,19 @@ sql {
 	#  function.
 #	auto_escape = no
 
+	#  When the SQL module is called in accounting and post-auth one or
+	#  more queries may be run, until at least one record is updated.
+	#
+	#  It can be helpful to know which query was run.  E.g. the default
+	#  queries for Interim-Update handling, start with an UPDATE and
+	#  if that does not update any records, an INSERT is run.  Knowing
+	#  which query updated data indicates the state of the data prior
+	#  to the update.
+	#
+	#  Setting this to 'yes', will cause `&control:SQL-Query-Number` to be
+	#  populated with the number of the query which updated data.
+#	record_query_number = no
+
 	# Read database-specific queries
 	$INCLUDE ${modconfdir}/${.:name}/main/${dialect}/queries.conf
 }
diff -urpN freeradius-server-3.2.7/raddb/mods-config/kafka/messages-json.conf freeradius-server-3.2.8/raddb/mods-config/kafka/messages-json.conf
--- freeradius-server-3.2.7/raddb/mods-config/kafka/messages-json.conf	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/raddb/mods-config/kafka/messages-json.conf	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,59 @@
+#
+#  key:       An optional key for the message.
+#
+#  headers:   An optional specification for which attributes should
+#             be set as Kafka headers, with their values encoded as strings.
+#
+#  message:   The message itself.
+#
+#  reference: Expanded to a configuration item reference that contains the
+#             message.
+#
+#  To use the json_encode xlats in the schemas examples below, you must first
+#  enable the json module, and may probably want to set
+#  json.encode.output_mode = object_simple
+#
+
+authorize {
+
+	key = "%{User-Name}"
+	headers = "&Calling-Station-Id"
+	message = "%{json_encode:&request:[*]}"
+
+}
+
+post-auth {
+
+	key = "%{User-Name}"
+	headers = "&reply:Framed-IP-Address"
+	reference = "messages.%{%{reply:Packet-Type}:-default}"
+
+	messages {
+		Access-Accept = "%{json_encode:&User-Name &reply:[*]}"
+		Access-Reject = "%{json_encode:&User-Name &reply:[*]}"
+		Access-Challenge = ""
+
+		default = "Unknown packet type %{Packet-Type}"
+	}
+
+}
+
+accounting {
+
+	key = "%{Acct-Unique-Session-Id}"
+	headers = "&Acct-Status-Type &NAS-Identifier"
+
+	reference = "messages.%{%{Acct-Status-Type}:-default}"
+
+	messages {
+		Start = "%{json_encode:&request:[*]}"
+		Stop = "%{json_encode:&request:[*]}"
+		Alive = "%{json_encode:&request:[*]}"
+
+		Accounting-On = "%{json_encode:&request:[*]}"
+		Accounting-Off = "%{json_encode:&request:[*]}"
+
+		default = "Unknown Acct-Status-Type: %{Acct-Status-Type}"
+	}
+
+}
diff -urpN freeradius-server-3.2.7/raddb/proxy.conf freeradius-server-3.2.8/raddb/proxy.conf
--- freeradius-server-3.2.7/raddb/proxy.conf	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/raddb/proxy.conf	2025-08-20 23:29:15.000000000 +0700
@@ -2,7 +2,7 @@
 ##
 ## proxy.conf -- proxy radius and realm configuration directives
 ##
-##	$Id: cf0697d408b64fd357da29e1518a667919b6a5c0 $
+##	$Id: ec92fb9b8d51bbc561571f699c5e2c544d7a423b $
 
 #######################################################################
 #
@@ -614,8 +614,7 @@ home_server_pool my_auth_failover {
 	#
 	#  client-balance - the home server is chosen by hashing the
 	#	source IP address of the packet.  If that home server
-	#	is down, the next one in the list is used, just as
-	#	with "fail-over".
+	#	is down, then "load-balance" method is used.
 	#
 	#	There is no way of predicting which source IP will map
 	#	to which home server.
@@ -626,8 +625,8 @@ home_server_pool my_auth_failover {
 	#
 	#  client-port-balance - the home server is chosen by hashing
 	#	the source IP address and source port of the packet.
-	#	If that home server is down, the next one in the list
-	#	is used, just as with "fail-over".
+	#	If that home server is down, then "load-balance"
+	#	method is used.
 	#
 	#	This method provides slightly better load balancing
 	#	for EAP sessions than "client-balance".  However, it
@@ -642,15 +641,33 @@ home_server_pool my_auth_failover {
 	#		server = (hash % num_servers_in_pool).
 	#
 	#	If there is no Load-Balance-Key in the control items,
-	#	the load balancing method is identical to "load-balance".
+	#	or if the chosen server is down, then the
+	#	"load-balance" method is used.
 	#
 	#	For most non-EAP authentication methods, The User-Name
 	#	attribute provides a good key.  An "unlang" policy can
 	#	be used to copy the User-Name to the Load-Balance-Key
 	#	attribute.  This method may not work for EAP sessions,
 	#	as the User-Name outside of the TLS tunnel is often
-	#	static, e.g. "anonymous@realm".
-	#
+	#	static, e.g. "anonymous@realm".  In that case, the key
+	#	should include both the User-Name, and the
+	#	Calling-Station-Id, which helps to make the hash more
+	#	evenly distributed.
+	#
+	#  consistent-keyed-balance - the server uses consistent
+	#	hashing to pick a home server.  When all servers are
+	#	up, this method is similar to keyed-balance.  However,
+	#	when one or more servers are down, this method will
+	#	consistently use the key to pick a "second choice"
+	#	home server.
+	#
+	#	This method is most useful for EAP, where all packets
+	#	for the same authentication session should take the
+	#	same route through a proxy fabric.  In the event of a
+	#	failure of one home server, all packets for one EAP
+	#	session will still be routed through the same "second
+	#	choice" home server.  This load balancing method
+	#	should help with proxy stability.
 	#
 	#  The default type is fail-over.
 	type = fail-over
diff -urpN freeradius-server-3.2.7/raddb/radiusd.conf.in freeradius-server-3.2.8/raddb/radiusd.conf.in
--- freeradius-server-3.2.7/raddb/radiusd.conf.in	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/raddb/radiusd.conf.in	2025-08-20 23:29:15.000000000 +0700
@@ -3,7 +3,7 @@
 ## radiusd.conf	-- FreeRADIUS server configuration file - @RADIUSD_VERSION_STRING@
 ##
 ##	http://www.freeradius.org/
-##	$Id: 376892e151857fa35c22662769acef3dcea08ecc $
+##	$Id: 3fe562843d95acfd5f8227692ef195379c49ba7b $
 ##
 
 ######################################################################
@@ -29,15 +29,31 @@
 #		How to create certificates for EAP or RadSec.
 #
 #	Every configuration item in the server is documented
-#	extensively in the comments in the example configuration
-#	files.
+#	extensively in the comments of the configuration files.
+#
+#	Substantial documentation on AAA concepts, dictionaries,
+#	modules, unlang, etc. is also available on the FreeRADIUS web
+#	site:
+#
+#		https://www.freeradius.org/documentation/freeradius-server/v3.2.x/
+#
+#
+#	# Making Changes
 #
 #	Before editing this (or any other) configuration file, PLEASE
 #	read "man radiusd".  See the section titled DEBUGGING.  It
 #	outlines a method where you can quickly create the
 #	configuration you want, with minimal effort.
 #
-#	Run the server in debugging mode, and READ the output.
+#	Start with the default configuration.  Make one change.  Test it.
+#	Save a copy (`git commit` is your friend).  Make another change.
+#	test it.
+#
+#	Making ten changes at the same time will ALMOST ALWAYS break
+#	something.  Don't do that.
+#
+#	Every time you make a change, run the server in debugging
+#	mode, and READ the output.
 #
 #		$ radiusd -X
 #
@@ -53,6 +69,16 @@
 #	More documentation on "radiusd -X" is available on the wiki:
 #		https://wiki.freeradius.org/radiusd-X
 #
+#
+#	# Mailing list
+#
+#	Questions can be asked on the mailing list:
+#
+#		https://lists.freeradius.org/mailman/listinfo/freeradius-users
+#
+#	Questions do not belong on GitHub.  Any configuration question
+#	that is posted to GitHub will be deleted.
+#
 #	If you are going to ask a question on the mailing list, then
 #	explain what you are trying to do, and include the output from
 #	debugging mode (radiusd -X).  Failure to do so means that all
@@ -62,20 +88,27 @@
 #	Guidelines for posting to the mailing list are on the wiki:
 #		https://wiki.freeradius.org/list-help
 #
-#	Please read those guidelines before posting to the list.
+#	Please read those guidelines before posting to the list, which
+#	are largely:
 #
-#	Further documentation is available in the "doc" directory
-#	of the server distribution, or on the wiki at:
-#		https://wiki.freeradius.org/
+#	Ask a good questions:
+#
+#		Good: "I changed file X from A to B, now it does ZZZ,
+# 		      and I expected it to do YYY instead"
 #
-#	New users to RADIUS should read the Technical Guide.  That guide
-#	explains how RADIUS works, how FreeRADIUS works, and what each
-#	part of a RADIUS system does.  It is not just "configure FreeRADIUS"!
-#		https://networkradius.com/doc/FreeRADIUS-Technical-Guide.pdf
-#
-#	More documentation on dictionaries, modules, unlang, etc. is also
-#	available on the Network RADIUS web site:
-#		https://networkradius.com/freeradius-documentation/
+#		Bad: "I changed some things, and now it doesn't work,
+#		      what's wrong?"
+#
+#	There is much documentation available in the "doc" directory
+#	of the server distribution.  The files there are used to build
+#	the documentation on the main freeradius.org site.
+#
+#	Older documentation is on the wiki.  However, due to spam, the
+#	Wiki is no longer editable.  We are working at moving the
+#	content from the Wiki to the main freeradius.org documentation
+#	page.
+#
+#		https://wiki.freeradius.org/
 #
 
 ######################################################################
@@ -428,6 +461,14 @@ log {
 	#  by seeing what is actually being sent.
 	#
 #	suppress_secrets = no
+
+	#  Add timestamps to debug logs
+	#
+	#  By default, at debug level 1 and 2, messages are produced
+	#  without timestamps.
+	#
+	#  Enabling this option will include timestamps on all debug logs.
+#	timestamp = no
 }
 
 #  The program to execute to do concurrency checks.
@@ -589,9 +630,18 @@ security {
 
 	#
 	#  reject_delay: When sending an Access-Reject, it can be
-	#  delayed for a few seconds.  This may help slow down a DoS
-	#  attack.  It also helps to slow down people trying to brute-force
-	#  crack a users password.
+	#  delayed for a short period of time.  This may help slow
+	#  down a DoS attack.  It also helps to slow down people
+	#  trying to brute-force crack a users password.
+	#
+	#  The reject will be sent no earlier then "recieve time + delay".
+	#  This configuration will not _add_ a fixed delay, it makes sure
+	#  that the time between Access-Request and Access-Reject is
+	#  _at least_ the given reject_delay value.
+	#
+	#  i.e. if "reject_delay = 1", and the server takes 4 seconds to
+	#  query an SQL database, then the reject has already been delayed
+	#  for 4 seconds.
 	#
 	#  Setting this number to 0 means "send rejects immediately"
 	#
@@ -599,12 +649,20 @@ security {
 	#  rejects will be sent at 'cleanup_delay' time, when the request
 	#  is deleted from the internal cache of requests.
 	#
+	#  Some equipment is known to retry aggressively if the delay is about
+	#  one second.
+	#
 	#  This number can be a decimal, e.g. 3.4
 	#
-	#  Useful ranges: 1 to 5
+	#  Useful ranges: 0.5 to 5
 	reject_delay = 1
 
 	#
+	#  Do we apply reject delays to proxied packets, too?
+	#
+#	delay_proxy_rejects = no
+
+	#
 	#  status_server: Whether or not the server will respond
 	#  to Status-Server requests.
 	#
@@ -705,6 +763,11 @@ security {
 	#    the to "yes" manually, in order to make a permanent
 	#    change to the configuration.
 	#
+	#    The "auto" flag will have no effect for a client which
+	#    uses a network IP/mask definition.  If you need to
+	#    control this flag on a per-IP basis, then each "client"
+	#    definition must have only one IP address listed.
+	#
 	#    WARNING: If there are multiple NASes with the same source
 	#    IP and client definitions, BUT the NASes have different
 	#    behavior, then this flag WILL LIKELY BREAK YOUR NETWORK.
diff -urpN freeradius-server-3.2.7/raddb/sites-available/example freeradius-server-3.2.8/raddb/sites-available/example
--- freeradius-server-3.2.7/raddb/sites-available/example	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/raddb/sites-available/example	2025-08-20 23:29:15.000000000 +0700
@@ -2,7 +2,7 @@
 #
 #	An example virtual server configuration.
 #
-#	$Id: 5f204aaa6fc87e487b8542e1e4781623ff7f4a73 $
+#	$Id: 1457d29c891806ca7ec22ce8bcc8af5afe0588d4 $
 #
 ######################################################################
 
@@ -61,7 +61,7 @@ server example {
 	#
 	listen {
 		ipaddr = 192.0.2.1
-		port = 1821
+		port = 1812
 		type = auth
 	}
 
diff -urpN freeradius-server-3.2.7/redhat/freeradius.spec freeradius-server-3.2.8/redhat/freeradius.spec
--- freeradius-server-3.2.7/redhat/freeradius.spec	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/redhat/freeradius.spec	2025-08-20 23:29:15.000000000 +0700
@@ -33,13 +33,13 @@
 
 Summary: High-performance and highly configurable free RADIUS server
 Name: freeradius
-Version: 3.2.7
+Version: 3.2.8
 Release: 1%{?dist}
 License: GPLv2+ and LGPLv2+
 Group: System Environment/Daemons
 URL: http://www.freeradius.org/
 
-Source0: ftp://ftp.freeradius.org/pub/radius/freeradius-server-%{version}.tar.bz2
+Source0: https://www.freeradius.org/ftp/pub/radius/freeradius-server-%{version}.tar.bz2
 %if %{?_unitdir:1}%{!?_unitdir:0}
 Source100: radiusd.service
 Source104: freeradius-tmpfiles-conf
@@ -63,7 +63,11 @@ BuildRequires: autoconf
 BuildRequires: gdbm-devel
 BuildRequires: openssl, openssl-devel
 BuildRequires: pam-devel
+%if 0%{rhel} >= 10
+BuildRequires: pcre2-devel
+%else
 BuildRequires: pcre-devel
+%endif
 BuildRequires: zlib-devel
 BuildRequires: net-snmp-devel
 BuildRequires: net-snmp-utils
@@ -235,10 +239,17 @@ Requires: %{name} = %{version}-%{release
 %if 0%{?rhel} <= 7
 Requires: mysql
 %endif
-%if 0%{?rhel} >= 8
+%if 0%{?rhel} >= 8 && 0%{?rhel} <= 9
 Requires: mysql-libs
 %endif
+%if 0%{rhel} >= 10
+Requires: mariadb-connector-c
+%endif
+%if 0%{rhel} >= 10
+BuildRequires: mariadb-connector-c-devel
+%else
 BuildRequires: mysql-devel
+%endif
 
 %description mysql
 This plugin provides MySQL support for the FreeRADIUS server project.
@@ -360,6 +371,17 @@ BuildRequires: ykclient-devel >= 2.10
 This plugin provides YubiCloud support for the FreeRADIUS server project.
 %endif
 
+%if 0%{?rhel} >= 8
+%package kafka
+Summary: Kafka producer support for FreeRADIUS
+Group: System Environment/Daemons
+Requires: %{name} = %{version}-%{release}
+Requires: librdkafka
+BuildRequires: librdkafka-devel
+
+%description kafka
+This plugin provides Kafka producer support for the FreeRADIUS server project.
+%endif
 
 %prep
 %setup -q -n freeradius-server-%{version}
@@ -731,6 +753,8 @@ fi
 %attr(640,root,radiusd) %config(noreplace) %{_sysconfdir}/raddb/mods-config/preprocess/*
 %dir %attr(750,root,radiusd) %{_sysconfdir}/raddb/mods-config/unbound
 %attr(640,root,radiusd) %config(noreplace) %{_sysconfdir}/raddb/mods-config/unbound/*
+%dir %attr(750,root,radiusd) %{_sysconfdir}/raddb/mods-config/kafka
+%attr(640,root,radiusd) %config(noreplace) %{_sysconfdir}/raddb/mods-config/kafka/*
 %if %{?el6:0}%{!?el6:1}
 %if 0%{?rhel} <= 8
 %dir %attr(750,root,radiusd) %{_sysconfdir}/raddb/mods-config/python
@@ -966,6 +990,12 @@ fi
 %{_libdir}/freeradius/rlm_yubikey.so
 %endif
 
+%if 0%{?rhel} >= 8
+%files kafka
+%defattr(-,root,root)
+%{_libdir}/freeradius/rlm_kafka.so
+%endif
+
 %changelog
 * Wed Sep 25 2013 Alan DeKok <aland@freeradius.org> - 3.0.0
 - upgrade to latest upstream release
diff -urpN freeradius-server-3.2.7/scripts/crossbuild/docker/debian10/Dockerfile freeradius-server-3.2.8/scripts/crossbuild/docker/debian10/Dockerfile
--- freeradius-server-3.2.7/scripts/crossbuild/docker/debian10/Dockerfile	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/scripts/crossbuild/docker/debian10/Dockerfile	1970-01-01 07:00:00.000000000 +0700
@@ -1,85 +0,0 @@
-# Auto generated for debian10
-# from scripts/crossbuild/m4/Dockerfile.deb.m4
-#
-# Rebuild this file with `make crossbuild.debian10.regen`
-#
-ARG from=debian:buster
-FROM ${from} as build
-
-ARG DEBIAN_FRONTEND=noninteractive
-
-#
-#  Install add-apt-repository
-#
-RUN apt-get update && \
-    apt-get install -y software-properties-common gnupg2 procps && \
-    apt-get clean && \
-    rm -r /var/lib/apt/lists/*
-
-#  For clang
-RUN add-apt-repository -y "deb http://apt.llvm.org/buster/ llvm-toolchain-buster-8 main" && \
-    apt-key adv --fetch-keys http://apt.llvm.org/llvm-snapshot.gpg.key
-
-RUN apt-get update && \
-#  Development utilities
-    apt-get install -y devscripts equivs git quilt rsync && \
-#  Compilers
-    apt-get install -y g++ llvm-8 clang-8 lldb-8 && \
-#  eapol_test dependencies
-    apt-get install -y libnl-3-dev libnl-genl-3-dev
-
-#
-#  Documentation build dependecies
-#
-
-#  - doxygen & JSON.pm
-RUN apt-get install -y doxygen graphviz libjson-perl
-#  - antora (npm needed)
-RUN curl -sL https://deb.nodesource.com/setup_20.x | bash -
-RUN apt-get install -y nodejs
-RUN npm i -g @antora/cli@3.1.7 @antora/site-generator-default@3.1.7
-#  - pandoc
-WORKDIR /tmp
-RUN curl -OL $(curl -s https://api.github.com/repos/jgm/pandoc/releases/latest | grep "browser_download_url.*deb" | cut -d '"' -f 4)
-RUN apt-get install -y ./pandoc-*.deb
-#  - asciidoctor
-RUN apt-get install -y ruby-dev
-RUN gem install asciidoctor
-
-#
-#  Set defaults
-#
-RUN update-alternatives --install /usr/bin/clang clang /usr/bin/clang-8 60 && \
-    update-alternatives --config clang
-
-RUN update-alternatives --install /usr/bin/lldb lldb /usr/bin/lldb-8 60 && \
-    update-alternatives --config lldb
-
-
-#
-#  Setup a src dir in /usr/local
-#
-RUN mkdir -p /usr/local/src/repositories
-WORKDIR /usr/local/src/repositories
-
-
-#
-#  Shallow clone the FreeRADIUS source
-#
-WORKDIR /usr/local/src/repositories
-ARG source=https://github.com/FreeRADIUS/freeradius-server.git
-RUN git clone --depth 1 --no-single-branch ${source}
-
-#
-#  Install build dependencies for all branches from v3 onwards
-#
-WORKDIR freeradius-server
-RUN for i in $(git for-each-ref --format='%(refname:short)' refs/remotes/origin 2>/dev/null | sed -e 's#origin/##' | egrep "^(v[3-9]*\.[0-9x]*\.x|master)$");\
-	do \
-		git checkout $i; \
-		if [ -e ./debian/control.in ] ; then \
-			debian/rules debian/control ; \
-		fi ; \
-		echo 'y' | \
-		mk-build-deps -irt'apt-get -yV' debian/control ; \
-	done
diff -urpN freeradius-server-3.2.7/scripts/crossbuild/docker/debian13/Dockerfile freeradius-server-3.2.8/scripts/crossbuild/docker/debian13/Dockerfile
--- freeradius-server-3.2.7/scripts/crossbuild/docker/debian13/Dockerfile	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/scripts/crossbuild/docker/debian13/Dockerfile	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,74 @@
+# Auto generated for debian13
+# from scripts/crossbuild/m4/Dockerfile.deb.m4
+#
+# Rebuild this file with `make crossbuild.debian13.regen`
+#
+ARG from=debian:trixie
+FROM ${from} as build
+
+ARG DEBIAN_FRONTEND=noninteractive
+
+#
+#  Install add-apt-repository
+#
+RUN apt-get update && \
+    apt-get install -y gnupg2 procps && \
+    apt-get clean && \
+    rm -r /var/lib/apt/lists/*
+
+
+RUN apt-get update && \
+#  Development utilities
+    apt-get install -y devscripts equivs git quilt rsync fakeroot && \
+#  Compilers
+    apt-get install -y g++ llvm clang lldb && \
+#  eapol_test dependencies
+    apt-get install -y libnl-3-dev libnl-genl-3-dev
+
+#
+#  Documentation build dependecies
+#
+
+#  - doxygen & JSON.pm
+RUN apt-get install -y doxygen graphviz libjson-perl
+#  - antora (npm needed)
+RUN curl -sL https://deb.nodesource.com/setup_20.x | bash -
+RUN apt-get install -y nodejs
+RUN npm i -g @antora/cli@3.1.7 @antora/site-generator-default@3.1.7
+#  - pandoc
+WORKDIR /tmp
+RUN curl -OL $(curl -s https://api.github.com/repos/jgm/pandoc/releases/latest | grep "browser_download_url.*deb" | cut -d '"' -f 4)
+RUN apt-get install -y ./pandoc-*.deb
+#  - asciidoctor
+RUN apt-get install -y ruby-dev
+RUN gem install asciidoctor
+
+
+
+#
+#  Setup a src dir in /usr/local
+#
+RUN mkdir -p /usr/local/src/repositories
+WORKDIR /usr/local/src/repositories
+
+
+#
+#  Shallow clone the FreeRADIUS source
+#
+WORKDIR /usr/local/src/repositories
+ARG source=https://github.com/FreeRADIUS/freeradius-server.git
+RUN git clone --depth 1 --no-single-branch ${source}
+
+#
+#  Install build dependencies for all branches from v3 onwards
+#
+WORKDIR freeradius-server
+RUN for i in $(git for-each-ref --format='%(refname:short)' refs/remotes/origin 2>/dev/null | sed -e 's#origin/##' | egrep "^(v[3-9]*\.[0-9x]*\.x|master)$");\
+	do \
+		git checkout $i; \
+		if [ -e ./debian/control.in ] ; then \
+			debian/rules debian/control ; \
+		fi ; \
+		echo 'y' | \
+		mk-build-deps -irt'apt-get -yV' debian/control ; \
+	done
diff -urpN freeradius-server-3.2.7/scripts/crossbuild/docker/rocky10/Dockerfile freeradius-server-3.2.8/scripts/crossbuild/docker/rocky10/Dockerfile
--- freeradius-server-3.2.7/scripts/crossbuild/docker/rocky10/Dockerfile	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/scripts/crossbuild/docker/rocky10/Dockerfile	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,91 @@
+# Auto generated for rocky10
+# from scripts/crossbuild/m4/Dockerfile.rpm.m4
+#
+# Rebuild this file with `make crossbuild.rocky10.regen`
+#
+ARG from=rockylinux/rockylinux:10
+FROM ${from} as build
+
+#
+#  Install yum
+#
+RUN dnf install -y yum
+
+#
+#  Install devtools like make and git and the EPEL
+#  repository for freetds and hiredis
+#
+RUN yum update -y
+RUN yum install -y rpmdevtools openssl epel-release git procps yum-utils \
+	rsync dnf-plugins-core
+
+
+
+RUN yum config-manager --set-enabled crb
+
+#
+#  Documentation build dependecies
+#
+
+#  - doxygen & JSON.pm
+RUN yum install -y doxygen graphviz perl-JSON
+#  - antora (npm needed)
+RUN curl -sL https://rpm.nodesource.com/setup_20.x | bash -
+RUN yum install -y nodejs
+RUN npm i -g @antora/cli@3.1.7 @antora/site-generator-default@3.1.7
+#  - pandoc
+RUN curl -o - -L $(curl -s https://api.github.com/repos/jgm/pandoc/releases/latest | grep "browser_download_url.*tar.gz" | cut -d '"' -f 4) | tar xzvf - -C /tmp/
+RUN mv /tmp/pandoc-*/bin/* /usr/local/bin
+#  - asciidoctor
+RUN yum install -y rubygems-devel
+RUN gem install asciidoctor
+
+#
+#  Setup a src dir in /usr/local
+#
+RUN mkdir -p /usr/local/src/repositories
+WORKDIR /usr/local/src/repositories
+
+
+#
+#  Shallow clone the FreeRADIUS source
+#
+WORKDIR /usr/local/src/repositories
+ARG source=https://github.com/FreeRADIUS/freeradius-server.git
+RUN git clone --depth 1 --no-single-branch ${source}
+
+#
+#  Install build dependencies for all branches from v3 onwards
+#  Nodesource has issues (no SRPMS in some repos) and is not needed here
+#  CentOS/RHEL 7 do not support "-D" for yum-builddep so do that separately below if needed
+#
+WORKDIR freeradius-server
+RUN for i in $(git for-each-ref --format='%(refname:short)' refs/remotes/origin 2>/dev/null | sed -e 's#origin/##' | egrep "^(v[3-9]*\.[0-9x]*\.x|master)$");\
+	do \
+		git checkout $i; \
+		[ -e redhat/freeradius.spec ] && yum-builddep -D "_with_rlm_yubikey 1" -y redhat/freeradius.spec; \
+	done
+
+
+RUN yum install -y libyubikey-devel
+
+#
+#  Which is required by fixture setup utilities
+#
+RUN yum install -y which
+
+#
+#  Explicitly install libnl3-devel which is required for the EAP tests
+#
+RUN yum install -y libnl3-devel
+
+#
+#  We test with TLS1.1, but that is disabled by default on some
+#  newer systems.
+#
+RUN update-crypto-policies --set LEGACY
+
+#
+#  Create the RPM build tree
+#
+RUN rpmdev-setuptree
diff -urpN freeradius-server-3.2.7/scripts/crossbuild/docker/ubuntu18/Dockerfile freeradius-server-3.2.8/scripts/crossbuild/docker/ubuntu18/Dockerfile
--- freeradius-server-3.2.7/scripts/crossbuild/docker/ubuntu18/Dockerfile	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/scripts/crossbuild/docker/ubuntu18/Dockerfile	1970-01-01 07:00:00.000000000 +0700
@@ -1,74 +0,0 @@
-# Auto generated for ubuntu18
-# from scripts/crossbuild/m4/Dockerfile.deb.m4
-#
-# Rebuild this file with `make crossbuild.ubuntu18.regen`
-#
-ARG from=ubuntu:18.04
-FROM ${from} as build
-
-ARG DEBIAN_FRONTEND=noninteractive
-
-#
-#  Install add-apt-repository
-#
-RUN apt-get update && \
-    apt-get install -y software-properties-common gnupg2 procps && \
-    apt-get clean && \
-    rm -r /var/lib/apt/lists/*
-
-
-RUN apt-get update && \
-#  Development utilities
-    apt-get install -y devscripts equivs git quilt rsync && \
-#  Compilers
-    apt-get install -y g++ llvm clang lldb && \
-#  eapol_test dependencies
-    apt-get install -y libnl-3-dev libnl-genl-3-dev
-
-#
-#  Documentation build dependecies
-#
-
-#  - doxygen & JSON.pm
-RUN apt-get install -y doxygen graphviz libjson-perl
-#  - antora (npm needed)
-RUN curl -sL https://deb.nodesource.com/setup_16.x | bash -
-RUN apt-get install -y nodejs
-RUN npm i -g @antora/cli@3.1.7 @antora/site-generator-default@3.1.7
-#  - pandoc
-WORKDIR /tmp
-RUN curl -OL $(curl -s https://api.github.com/repos/jgm/pandoc/releases/latest | grep "browser_download_url.*deb" | cut -d '"' -f 4)
-RUN apt-get install -y ./pandoc-*.deb
-#  - asciidoctor
-RUN apt-get install -y ruby-dev
-RUN gem install asciidoctor
-
-
-
-#
-#  Setup a src dir in /usr/local
-#
-RUN mkdir -p /usr/local/src/repositories
-WORKDIR /usr/local/src/repositories
-
-
-#
-#  Shallow clone the FreeRADIUS source
-#
-WORKDIR /usr/local/src/repositories
-ARG source=https://github.com/FreeRADIUS/freeradius-server.git
-RUN git clone --depth 1 --no-single-branch ${source}
-
-#
-#  Install build dependencies for all branches from v3 onwards
-#
-WORKDIR freeradius-server
-RUN for i in $(git for-each-ref --format='%(refname:short)' refs/remotes/origin 2>/dev/null | sed -e 's#origin/##' | egrep "^(v[3-9]*\.[0-9x]*\.x|master)$");\
-	do \
-		git checkout $i; \
-		if [ -e ./debian/control.in ] ; then \
-			debian/rules debian/control ; \
-		fi ; \
-		echo 'y' | \
-		mk-build-deps -irt'apt-get -yV' debian/control ; \
-	done
diff -urpN freeradius-server-3.2.7/scripts/crossbuild/m4/Dockerfile.deb.m4 freeradius-server-3.2.8/scripts/crossbuild/m4/Dockerfile.deb.m4
--- freeradius-server-3.2.7/scripts/crossbuild/m4/Dockerfile.deb.m4	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/scripts/crossbuild/m4/Dockerfile.deb.m4	2025-08-20 23:29:15.000000000 +0700
@@ -7,7 +7,11 @@ ARG DEBIAN_FRONTEND=noninteractive
 #  Install add-apt-repository
 #
 RUN apt-get update && \
+ifelse(D_NAME, `debian13', `dnl
+    apt-get install -y gnupg2 procps && \
+', `dnl
     apt-get install -y software-properties-common gnupg2 procps && \
+')dnl
     apt-get clean && \
     rm -r /var/lib/apt/lists/*
 
diff -urpN freeradius-server-3.2.7/scripts/crossbuild/m4/Dockerfile.rpm.m4 freeradius-server-3.2.8/scripts/crossbuild/m4/Dockerfile.rpm.m4
--- freeradius-server-3.2.7/scripts/crossbuild/m4/Dockerfile.rpm.m4	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/scripts/crossbuild/m4/Dockerfile.rpm.m4	2025-08-20 23:29:15.000000000 +0700
@@ -9,7 +9,7 @@ RUN sed -i "s/^mirrorlist/#mirrorlist/g"
 RUN sed -i "s|#\s*baseurl=http://mirror.centos.org|baseurl=http://vault.centos.org|g" /etc/yum.repos.d/CentOS-*
 ')dnl
 
-ifelse(OS_VER, `9', `dnl
+ifelse(ifelse(OS_VER, 9, yes, OS_VER, 10, yes, no), yes, `dnl
 #
 #  Install yum
 #
@@ -51,7 +51,7 @@ RUN yum config-manager --set-enabled pow
 RUN yum install -y gcc-toolset-9
 ')dnl
 
-ifelse(OS_VER, `9', `dnl
+ifelse(ifelse(OS_VER, 9, yes, OS_VER, 10, yes, no), yes, `dnl
 RUN yum config-manager --set-enabled crb
 ')dnl
 
diff -urpN freeradius-server-3.2.7/scripts/docker/dists/alpine/Dockerfile freeradius-server-3.2.8/scripts/docker/dists/alpine/Dockerfile
--- freeradius-server-3.2.7/scripts/docker/dists/alpine/Dockerfile	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/scripts/docker/dists/alpine/Dockerfile	2025-08-20 23:29:15.000000000 +0700
@@ -30,7 +30,10 @@ COPY . .
 RUN git clean -fdxx \
  && git reset --hard HEAD
 
-RUN [ -z "$release" ] || git checkout ${release}
+ARG release
+RUN [ -z "$release" ] || git checkout ${release} ; \
+    git status ; \
+    git log -1 --oneline
 
 
 #
diff -urpN freeradius-server-3.2.7/scripts/docker/dists/centos7/Dockerfile freeradius-server-3.2.8/scripts/docker/dists/centos7/Dockerfile
--- freeradius-server-3.2.7/scripts/docker/dists/centos7/Dockerfile	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/scripts/docker/dists/centos7/Dockerfile	2025-08-20 23:29:15.000000000 +0700
@@ -14,6 +14,7 @@ RUN sed -i "s|#\s*baseurl=http://mirror.
 
 
 
+
 #
 #  Install build tools
 #
diff -urpN freeradius-server-3.2.7/scripts/docker/dists/debian10/Dockerfile freeradius-server-3.2.8/scripts/docker/dists/debian10/Dockerfile
--- freeradius-server-3.2.7/scripts/docker/dists/debian10/Dockerfile	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/scripts/docker/dists/debian10/Dockerfile	1970-01-01 07:00:00.000000000 +0700
@@ -1,82 +0,0 @@
-# Auto generated for debian10
-# from scripts/docker/m4/Dockerfile.deb.m4
-#
-# Rebuild this file with `make docker.debian10.regen`
-#
-ARG from=debian:buster
-FROM ${from} AS build
-
-ARG DEBIAN_FRONTEND=noninteractive
-
-#
-#  Install build tools
-#
-RUN apt-get update
-RUN apt-get install -y devscripts equivs git quilt gcc
-
-#
-#  Create build directory
-#
-RUN mkdir -p /usr/local/src/repositories/freeradius-server
-WORKDIR /usr/local/src/repositories/freeradius-server/
-
-#
-#  Copy the FreeRADIUS directory in
-#
-COPY . .
-
-#
-#  Clean up tree - we want to build from the latest commit, not from
-#  any cruft left around on the local system
-#
-RUN git clean -fdxx \
- && git reset --hard HEAD
-
-ARG release
-RUN [ -z "$release" ] || git checkout ${release} ; \
-    git status ; \
-    git log -1 --oneline
-
-#
-#  Install build dependencies
-#
-RUN if [ -e ./debian/control.in ]; then \
-        debian/rules debian/control; \
-    fi; \
-    echo 'y' | mk-build-deps -irt'apt-get -yV' debian/control
-
-#
-#  Build the server
-#
-#  Work around fakeroot problems in Docker when building for different
-#  platforms - doesn't matter as we run as root in the container anyway.
-#
-#RUN make -j$(nproc) deb
-RUN debian/rules debian/control \
- && dpkg-buildpackage --jobs=auto -b -uc
-
-#
-#  Clean environment and run the server
-#
-FROM ${from}
-ARG DEBIAN_FRONTEND=noninteractive
-
-COPY --from=build /usr/local/src/repositories/*.deb /tmp/
-
-RUN ln -fs /usr/share/zoneinfo/Etc/UTC /etc/localtime
-
-RUN apt-get update \
- && apt-get install -y tzdata \
- && apt-get install -y /tmp/*.deb \
- && apt-get clean \
- && rm -r /var/lib/apt/lists/* /tmp/*.deb \
-    \
- && ln -s /etc/freeradius /etc/raddb
-
-WORKDIR /
-COPY scripts/docker/etc/docker-entrypoint.sh.deb docker-entrypoint.sh
-RUN chmod +x docker-entrypoint.sh
-
-EXPOSE 1812/udp 1813/udp
-ENTRYPOINT ["/docker-entrypoint.sh"]
-CMD ["freeradius"]
diff -urpN freeradius-server-3.2.7/scripts/docker/dists/debian10/docker-entrypoint.sh freeradius-server-3.2.8/scripts/docker/dists/debian10/docker-entrypoint.sh
--- freeradius-server-3.2.7/scripts/docker/dists/debian10/docker-entrypoint.sh	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/scripts/docker/dists/debian10/docker-entrypoint.sh	1970-01-01 07:00:00.000000000 +0700
@@ -1,24 +0,0 @@
-#!/bin/sh
-set -e
-
-# this if will check if the first argument is a flag
-# but only works if all arguments require a hyphenated flag
-# -v; -SL; -f arg; etc will work, but not arg1 arg2
-if [ "$#" -eq 0 ] || [ "${1#-}" != "$1" ]; then
-    set -- freeradius "$@"
-fi
-
-# check for the expected command
-if [ "$1" = 'freeradius' ]; then
-    shift
-    exec freeradius -f "$@"
-fi
-
-# many people are likely to call "radiusd" as well, so allow that
-if [ "$1" = 'radiusd' ]; then
-    shift
-    exec freeradius -f "$@"
-fi
-
-# else default to run whatever the user wanted like "bash" or "sh"
-exec "$@"
diff -urpN freeradius-server-3.2.7/scripts/docker/dists/debian13/Dockerfile freeradius-server-3.2.8/scripts/docker/dists/debian13/Dockerfile
--- freeradius-server-3.2.7/scripts/docker/dists/debian13/Dockerfile	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/scripts/docker/dists/debian13/Dockerfile	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,87 @@
+# Auto generated for debian13
+# from scripts/docker/m4/Dockerfile.deb.m4
+#
+# Rebuild this file with `make docker.debian13.regen`
+#
+ARG from=debian:trixie
+FROM ${from} AS build
+
+ARG DEBIAN_FRONTEND=noninteractive
+
+#
+#  Install build tools
+#
+RUN apt-get update
+RUN apt-get install -y devscripts equivs git quilt gcc
+
+#
+#  Create build directory
+#
+RUN mkdir -p /usr/local/src/repositories/freeradius-server
+WORKDIR /usr/local/src/repositories/freeradius-server/
+
+#
+#  Copy the FreeRADIUS directory in
+#
+COPY . .
+
+#
+#  Clean up tree - we want to build from the latest commit, not from
+#  any cruft left around on the local system
+#
+RUN git clean -fdxx \
+ && git reset --hard HEAD
+
+ARG release
+RUN [ -z "$release" ] || git checkout ${release} ; \
+    git status ; \
+    git log -1 --oneline
+
+#
+#  Install build dependencies
+#
+RUN if [ -e ./debian/control.in ]; then \
+        debian/rules debian/control; \
+    fi; \
+    echo 'y' | mk-build-deps -irt'apt-get -yV' debian/control
+
+#
+#  Build the server
+#
+#  Work around fakeroot problems in Docker when building for different
+#  platforms - doesn't matter as we run as root in the container anyway.
+#
+#RUN make -j$(nproc) deb
+RUN debian/rules debian/control \
+ && dpkg-buildpackage --jobs=auto -b -uc
+
+#
+#  Clean environment and run the server
+#
+FROM ${from}
+ARG DEBIAN_FRONTEND=noninteractive
+
+COPY --from=build /usr/local/src/repositories/*.deb /tmp/
+
+RUN ln -fs /usr/share/zoneinfo/Etc/UTC /etc/localtime
+
+ARG freerad_uid=101
+ARG freerad_gid=101
+
+RUN groupadd -g ${freerad_gid} -r freerad \
+ && useradd -u ${freerad_uid} -g freerad -r -M -d /etc/freeradius -s /usr/sbin/nologin freerad \
+ && apt-get update \
+ && apt-get install -y tzdata \
+ && apt-get install -y /tmp/*.deb \
+ && apt-get clean \
+ && rm -r /var/lib/apt/lists/* /tmp/*.deb \
+    \
+ && ln -s /etc/freeradius /etc/raddb
+
+WORKDIR /
+COPY scripts/docker/etc/docker-entrypoint.sh.deb docker-entrypoint.sh
+RUN chmod +x docker-entrypoint.sh
+
+EXPOSE 1812/udp 1813/udp
+ENTRYPOINT ["/docker-entrypoint.sh"]
+CMD ["freeradius"]
diff -urpN freeradius-server-3.2.7/scripts/docker/dists/debian13/docker-entrypoint.sh freeradius-server-3.2.8/scripts/docker/dists/debian13/docker-entrypoint.sh
--- freeradius-server-3.2.7/scripts/docker/dists/debian13/docker-entrypoint.sh	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/scripts/docker/dists/debian13/docker-entrypoint.sh	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,24 @@
+#!/bin/sh
+set -e
+
+# this if will check if the first argument is a flag
+# but only works if all arguments require a hyphenated flag
+# -v; -SL; -f arg; etc will work, but not arg1 arg2
+if [ "$#" -eq 0 ] || [ "${1#-}" != "$1" ]; then
+    set -- freeradius "$@"
+fi
+
+# check for the expected command
+if [ "$1" = 'freeradius' ]; then
+    shift
+    exec freeradius -f "$@"
+fi
+
+# many people are likely to call "radiusd" as well, so allow that
+if [ "$1" = 'radiusd' ]; then
+    shift
+    exec freeradius -f "$@"
+fi
+
+# else default to run whatever the user wanted like "bash" or "sh"
+exec "$@"
diff -urpN freeradius-server-3.2.7/scripts/docker/dists/rocky10/Dockerfile freeradius-server-3.2.8/scripts/docker/dists/rocky10/Dockerfile
--- freeradius-server-3.2.7/scripts/docker/dists/rocky10/Dockerfile	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/scripts/docker/dists/rocky10/Dockerfile	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,129 @@
+# Auto generated for rocky10
+# from scripts/docker/m4/Dockerfile.rpm.m4
+#
+# Rebuild this file with `make docker.rocky10.regen`
+#
+ARG from=rockylinux/rockylinux:10
+FROM ${from} AS build
+
+
+#
+#  Install yum
+#
+RUN dnf install -y yum
+
+
+RUN rpmkeys --import /etc/pki/rpm-gpg/RPM-GPG-KEY-Rocky-10
+
+#
+#  Install build tools
+#
+RUN yum groupinstall -y "Development Tools"
+
+RUN yum install -y rpmdevtools openssl dnf-utils
+
+
+#
+#  Create build directory
+#
+RUN mkdir -p /usr/local/src/repositories/freeradius-server
+WORKDIR /usr/local/src/repositories/freeradius-server/
+
+#
+#  Copy the FreeRADIUS directory in
+#
+COPY . .
+
+#
+#  Clean up tree - we want to build from the latest commit, not from
+#  any cruft left around on the local system
+#
+RUN git clean -fdxx \
+ && git reset --hard HEAD
+
+ARG release
+RUN [ -z "$release" ] || git checkout ${release} ; \
+    git status ; \
+    git log -1 --oneline
+
+#
+#  Other requirements
+#
+
+#  Enable EPEL repository for freetds and hiredis
+
+RUN yum install -y https://dl.fedoraproject.org/pub/epel/epel-release-latest-10.noarch.rpm
+
+
+#  Enable Code Ready Builder repo (CentOS powertools equivalent)
+RUN yum install -y yum-utils
+RUN yum config-manager --enable crb
+
+#
+#  Install build dependencies
+#
+#  Run twice, it doesn't always get everything with one invocation
+#
+RUN [ -e redhat/freeradius.spec ] && \
+	yum-builddep -y redhat/freeradius.spec && \
+	yum-builddep -y redhat/freeradius.spec
+
+#
+#  Create RPM build environment
+#
+ENV BUILDDIR=/root/rpmbuild
+RUN rpmdev-setuptree
+
+RUN ./configure
+RUN cp VERSION /VERSION
+RUN make freeradius-server-$(cat /VERSION).tar.bz2
+RUN cp freeradius-server-$(cat /VERSION).tar.bz2 $BUILDDIR/SOURCES/
+RUN cp -r redhat/* $BUILDDIR/SOURCES/
+RUN sed -i "s/^Version:.*/Version: $(cat /VERSION)/" redhat/freeradius.spec
+RUN cp -r redhat/freeradius.spec $BUILDDIR/SPECS/
+WORKDIR $BUILDDIR
+
+#
+#  Build the server
+#
+ENV QA_RPATHS=0x0003
+RUN rpmbuild -bb --define "_release $(cat /VERSION)" "$BUILDDIR/SPECS/freeradius.spec"
+
+RUN mkdir /root/rpms
+RUN mv $BUILDDIR/RPMS/*/*.rpm /root/rpms/
+
+#
+#  Clean environment and run the server
+#
+FROM ${from}
+
+COPY --from=build /root/rpms /tmp/
+
+
+#
+#  Install yum
+#
+RUN dnf install -y yum
+
+
+#  EPEL repository for freetds and hiredis
+
+RUN yum install -y https://dl.fedoraproject.org/pub/epel/epel-release-latest-10.noarch.rpm \
+    && yum install -y dnf-utils \
+    && yum config-manager --enable crb \
+    && yum config-manager --enable epel-testing
+
+ARG radiusd_uid=95
+ARG radiusd_gid=95
+
+RUN groupadd -g ${radiusd_gid} -r radiusd \
+    && useradd -u ${radiusd_uid} -g radiusd -r -M -d /home/radiusd -s /sbin/nologin radiusd \
+    && yum install -y /tmp/*.rpm
+
+WORKDIR /
+COPY scripts/docker//etc/docker-entrypoint.sh.rpm docker-entrypoint.sh
+RUN chmod +x docker-entrypoint.sh
+
+EXPOSE 1812/udp 1813/udp
+ENTRYPOINT ["/docker-entrypoint.sh"]
+CMD ["radiusd"]
diff -urpN freeradius-server-3.2.7/scripts/docker/dists/rocky10/docker-entrypoint.sh freeradius-server-3.2.8/scripts/docker/dists/rocky10/docker-entrypoint.sh
--- freeradius-server-3.2.7/scripts/docker/dists/rocky10/docker-entrypoint.sh	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/scripts/docker/dists/rocky10/docker-entrypoint.sh	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,24 @@
+#!/bin/sh
+set -e
+
+# this if will check if the first argument is a flag
+# but only works if all arguments require a hyphenated flag
+# -v; -SL; -f arg; etc will work, but not arg1 arg2
+if [ "$#" -eq 0 ] || [ "${1#-}" != "$1" ]; then
+    set -- radiusd "$@"
+fi
+
+# check for the expected command
+if [ "$1" = 'radiusd' ]; then
+    shift
+    exec radiusd -f "$@"
+fi
+
+# debian people are likely to call "freeradius" as well, so allow that
+if [ "$1" = 'freeradius' ]; then
+    shift
+    exec radiusd -f "$@"
+fi
+
+# else default to run whatever the user wanted like "bash" or "sh"
+exec "$@"
diff -urpN freeradius-server-3.2.7/scripts/docker/dists/rocky8/Dockerfile freeradius-server-3.2.8/scripts/docker/dists/rocky8/Dockerfile
--- freeradius-server-3.2.7/scripts/docker/dists/rocky8/Dockerfile	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/scripts/docker/dists/rocky8/Dockerfile	2025-08-20 23:29:15.000000000 +0700
@@ -14,6 +14,7 @@ RUN dnf install -y yum
 
 RUN rpmkeys --import /etc/pki/rpm-gpg/RPM-GPG-KEY-rockyofficial
 
+
 #
 #  Install build tools
 #
diff -urpN freeradius-server-3.2.7/scripts/docker/dists/rocky9/Dockerfile freeradius-server-3.2.8/scripts/docker/dists/rocky9/Dockerfile
--- freeradius-server-3.2.7/scripts/docker/dists/rocky9/Dockerfile	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/scripts/docker/dists/rocky9/Dockerfile	2025-08-20 23:29:15.000000000 +0700
@@ -14,6 +14,7 @@ RUN dnf install -y yum
 
 RUN rpmkeys --import /etc/pki/rpm-gpg/RPM-GPG-KEY-Rocky-9
 
+
 #
 #  Install build tools
 #
diff -urpN freeradius-server-3.2.7/scripts/docker/dists/ubuntu18/Dockerfile freeradius-server-3.2.8/scripts/docker/dists/ubuntu18/Dockerfile
--- freeradius-server-3.2.7/scripts/docker/dists/ubuntu18/Dockerfile	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/scripts/docker/dists/ubuntu18/Dockerfile	1970-01-01 07:00:00.000000000 +0700
@@ -1,82 +0,0 @@
-# Auto generated for ubuntu18
-# from scripts/docker/m4/Dockerfile.deb.m4
-#
-# Rebuild this file with `make docker.ubuntu18.regen`
-#
-ARG from=ubuntu:18.04
-FROM ${from} AS build
-
-ARG DEBIAN_FRONTEND=noninteractive
-
-#
-#  Install build tools
-#
-RUN apt-get update
-RUN apt-get install -y devscripts equivs git quilt gcc
-
-#
-#  Create build directory
-#
-RUN mkdir -p /usr/local/src/repositories/freeradius-server
-WORKDIR /usr/local/src/repositories/freeradius-server/
-
-#
-#  Copy the FreeRADIUS directory in
-#
-COPY . .
-
-#
-#  Clean up tree - we want to build from the latest commit, not from
-#  any cruft left around on the local system
-#
-RUN git clean -fdxx \
- && git reset --hard HEAD
-
-ARG release
-RUN [ -z "$release" ] || git checkout ${release} ; \
-    git status ; \
-    git log -1 --oneline
-
-#
-#  Install build dependencies
-#
-RUN if [ -e ./debian/control.in ]; then \
-        debian/rules debian/control; \
-    fi; \
-    echo 'y' | mk-build-deps -irt'apt-get -yV' debian/control
-
-#
-#  Build the server
-#
-#  Work around fakeroot problems in Docker when building for different
-#  platforms - doesn't matter as we run as root in the container anyway.
-#
-#RUN make -j$(nproc) deb
-RUN debian/rules debian/control \
- && dpkg-buildpackage --jobs=auto -b -uc
-
-#
-#  Clean environment and run the server
-#
-FROM ${from}
-ARG DEBIAN_FRONTEND=noninteractive
-
-COPY --from=build /usr/local/src/repositories/*.deb /tmp/
-
-RUN ln -fs /usr/share/zoneinfo/Etc/UTC /etc/localtime
-
-RUN apt-get update \
- && apt-get install -y tzdata \
- && apt-get install -y /tmp/*.deb \
- && apt-get clean \
- && rm -r /var/lib/apt/lists/* /tmp/*.deb \
-    \
- && ln -s /etc/freeradius /etc/raddb
-
-WORKDIR /
-COPY scripts/docker/etc/docker-entrypoint.sh.deb docker-entrypoint.sh
-RUN chmod +x docker-entrypoint.sh
-
-EXPOSE 1812/udp 1813/udp
-ENTRYPOINT ["/docker-entrypoint.sh"]
-CMD ["freeradius"]
diff -urpN freeradius-server-3.2.7/scripts/docker/dists/ubuntu18/docker-entrypoint.sh freeradius-server-3.2.8/scripts/docker/dists/ubuntu18/docker-entrypoint.sh
--- freeradius-server-3.2.7/scripts/docker/dists/ubuntu18/docker-entrypoint.sh	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/scripts/docker/dists/ubuntu18/docker-entrypoint.sh	1970-01-01 07:00:00.000000000 +0700
@@ -1,24 +0,0 @@
-#!/bin/sh
-set -e
-
-# this if will check if the first argument is a flag
-# but only works if all arguments require a hyphenated flag
-# -v; -SL; -f arg; etc will work, but not arg1 arg2
-if [ "$#" -eq 0 ] || [ "${1#-}" != "$1" ]; then
-    set -- freeradius "$@"
-fi
-
-# check for the expected command
-if [ "$1" = 'freeradius' ]; then
-    shift
-    exec freeradius -f "$@"
-fi
-
-# many people are likely to call "radiusd" as well, so allow that
-if [ "$1" = 'radiusd' ]; then
-    shift
-    exec freeradius -f "$@"
-fi
-
-# else default to run whatever the user wanted like "bash" or "sh"
-exec "$@"
diff -urpN freeradius-server-3.2.7/scripts/docker/docker.mk freeradius-server-3.2.8/scripts/docker/docker.mk
--- freeradius-server-3.2.7/scripts/docker/docker.mk	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/scripts/docker/docker.mk	2025-08-20 23:29:15.000000000 +0700
@@ -65,6 +65,9 @@ ifneq "$(DOCKER_REGISTRY)" ""
 	override DOCKER_REGISTRY := $(DOCKER_REGISTRY)/
 endif
 
+#
+#  Alternative version for building manifests
+DOCKER_MANIFEST_VERSION := $(DOCKER_VERSION)
 
 #
 #  Print some useful help
@@ -204,8 +207,13 @@ docker-publish: docker docker-push-lates
 #
 .PHONY: docker-ci-manifest
 docker-ci-manifest:
+	echo docker manifest create \
+		$(DOCKER_REGISTRY)$(DOCKER_REPO)$(DOCKER_TAG):$(DOCKER_MANIFEST_VERSION) \
+		$(foreach ARCH,$(DOCKER_ARCHS),--amend $(DOCKER_REGISTRY)$(DOCKER_REPO)$(DOCKER_TAG):$(ARCH)-$(DOCKER_VERSION))
+	echo docker manifest push \
+		$(DOCKER_REGISTRY)$(DOCKER_REPO)$(DOCKER_TAG):$(DOCKER_MANIFEST_VERSION)
 	$(Q)docker manifest create \
-		$(DOCKER_REGISTRY)$(DOCKER_REPO)$(DOCKER_TAG):$(DOCKER_VERSION) \
+		$(DOCKER_REGISTRY)$(DOCKER_REPO)$(DOCKER_TAG):$(DOCKER_MANIFEST_VERSION) \
 		$(foreach ARCH,$(DOCKER_ARCHS),--amend $(DOCKER_REGISTRY)$(DOCKER_REPO)$(DOCKER_TAG):$(ARCH)-$(DOCKER_VERSION))
 	$(Q)docker manifest push \
-		$(DOCKER_REGISTRY)$(DOCKER_REPO)$(DOCKER_TAG):$(DOCKER_VERSION)
+		$(DOCKER_REGISTRY)$(DOCKER_REPO)$(DOCKER_TAG):$(DOCKER_MANIFEST_VERSION)
diff -urpN freeradius-server-3.2.7/scripts/docker/m4/Dockerfile.alpine.m4 freeradius-server-3.2.8/scripts/docker/m4/Dockerfile.alpine.m4
--- freeradius-server-3.2.7/scripts/docker/m4/Dockerfile.alpine.m4	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/scripts/docker/m4/Dockerfile.alpine.m4	2025-08-20 23:29:15.000000000 +0700
@@ -25,7 +25,10 @@ COPY . .
 RUN git clean -fdxx \
  && git reset --hard HEAD
 
-RUN [ -z "$release" ] || git checkout ${release}
+ARG release
+RUN [ -z "$release" ] || git checkout ${release} ; \
+    git status ; \
+    git log -1 --oneline
 
 
 #
diff -urpN freeradius-server-3.2.7/scripts/docker/m4/Dockerfile.deb.m4 freeradius-server-3.2.8/scripts/docker/m4/Dockerfile.deb.m4
--- freeradius-server-3.2.7/scripts/docker/m4/Dockerfile.deb.m4	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/scripts/docker/m4/Dockerfile.deb.m4	2025-08-20 23:29:15.000000000 +0700
@@ -62,7 +62,6 @@ RUN ln -fs /usr/share/zoneinfo/Etc/UTC /
 
 ifelse(ifelse(
 	D_NAME, `debian10', no,
-	D_NAME, `ubuntu18', no,
 	D_NAME, `ubuntu20', no,
 	yes), yes, `dnl
 ARG freerad_uid=101
diff -urpN freeradius-server-3.2.7/scripts/docker/m4/Dockerfile.m4 freeradius-server-3.2.8/scripts/docker/m4/Dockerfile.m4
--- freeradius-server-3.2.7/scripts/docker/m4/Dockerfile.m4	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/scripts/docker/m4/Dockerfile.m4	2025-08-20 23:29:15.000000000 +0700
@@ -22,8 +22,8 @@ ifelse(
 	D_NAME, [debian10],	[p_SET([deb], [debian],	[10],	[buster],	[debian:buster])],
 	D_NAME, [debian11],	[p_SET([deb], [debian],	[11],	[bullseye],	[debian:bullseye])],
 	D_NAME, [debian12],	[p_SET([deb], [debian],	[12],	[bookworm],	[debian:bookworm])],
+	D_NAME, [debian13],	[p_SET([deb], [debian],	[13],	[trixie],	[debian:trixie])],
 	D_NAME, [debiansid],	[p_SET([deb], [debian],	[99],	[sid],		[debian:sid])],
-	D_NAME, [ubuntu18],	[p_SET([deb], [ubuntu],	[18],	[bionic],	[ubuntu:18.04])],
 	D_NAME, [ubuntu20],	[p_SET([deb], [ubuntu],	[20],	[focal],	[ubuntu:20.04])],
 	D_NAME, [ubuntu22],	[p_SET([deb], [ubuntu],	[22],	[jammy],	[ubuntu:22.04])],
 	D_NAME, [ubuntu24],	[p_SET([deb], [ubuntu],	[24],	[noble],	[ubuntu:24.04])],
@@ -31,6 +31,7 @@ ifelse(
 	D_NAME, [centos8],	[p_SET([rpm], [centos],	[8],	[8],		[centos:8])],
 	D_NAME, [rocky8],	[p_SET([rpm], [rocky],	[8],	[8],		[rockylinux/rockylinux:8])],
 	D_NAME, [rocky9],	[p_SET([rpm], [rocky],	[9],	[9],		[rockylinux/rockylinux:9])],
+	D_NAME, [rocky10],	[p_SET([rpm], [rocky],	[10],	[10],		[rockylinux/rockylinux:10])],
 	[errprint(error: OS 'D_NAME' not defined[,] see __file__
 )m4exit(1)]
 )
diff -urpN freeradius-server-3.2.7/scripts/docker/m4/Dockerfile.rpm.m4 freeradius-server-3.2.8/scripts/docker/m4/Dockerfile.rpm.m4
--- freeradius-server-3.2.7/scripts/docker/m4/Dockerfile.rpm.m4	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/scripts/docker/m4/Dockerfile.rpm.m4	2025-08-20 23:29:15.000000000 +0700
@@ -22,6 +22,9 @@ RUN rpmkeys --import /etc/pki/rpm-gpg/RP
 ifelse(OS_VER, 9, `dnl
 RUN rpmkeys --import /etc/pki/rpm-gpg/RPM-GPG-KEY-Rocky-9
 ')
+ifelse(OS_VER, 10, `dnl
+RUN rpmkeys --import /etc/pki/rpm-gpg/RPM-GPG-KEY-Rocky-10
+')
 #
 #  Install build tools
 #
@@ -95,7 +98,7 @@ RUN yum config-manager --enable powertoo
 #  Enable epel-testing, currently needed for hiredis-devel
 RUN yum config-manager --enable epel-testing
 ')dnl
-ifelse(OS_VER, 9, `
+ifelse(ifelse(OS_VER, 9, yes, OS_VER, 10, yes, no), yes, `
 #  Enable Code Ready Builder repo (CentOS powertools equivalent)
 RUN yum install -y yum-utils
 RUN yum config-manager --enable crb
@@ -189,7 +192,7 @@ ifelse(OS_VER, 7, `    \', `dnl
 ifelse(OS_VER, 8, `dnl
     && yum config-manager --enable powertools \
 ')dnl
-ifelse(OS_VER, 9, `dnl
+ifelse(ifelse(OS_VER, 9, yes, OS_VER, 10, yes, no), yes, `dnl
     && yum config-manager --enable crb \
 ')dnl
     && yum config-manager --enable epel-testing
diff -urpN freeradius-server-3.2.7/share/dictionary.alteon freeradius-server-3.2.8/share/dictionary.alteon
--- freeradius-server-3.2.7/share/dictionary.alteon	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/share/dictionary.alteon	2025-08-20 23:29:15.000000000 +0700
@@ -4,7 +4,7 @@
 #
 #	Alteon Webswitch
 #
-#	$Id: 96f0b8690f7bca485151548c213981396ee5c9ca $
+#	$Id: 5559f91194af94ad39c43e9cf55e02c60376bda6 $
 #
 VENDOR		Alteon				1872
 
@@ -22,6 +22,7 @@ ATTRIBUTE	Alteon-Domain-Name			10	string
 
 ATTRIBUTE	Alteon-Service-Type			26	integer
 
+VALUE	Alteon-Service-Type		Alteon-Admin		6
 VALUE	Alteon-Service-Type		Alteon-L4admin		250
 VALUE	Alteon-Service-Type		Alteon-Slbadmin		251
 VALUE	Alteon-Service-Type		Alteon-Oper		252
@@ -29,4 +30,9 @@ VALUE	Alteon-Service-Type		Alteon-L4oper
 VALUE	Alteon-Service-Type		Alteon-Slboper		254
 VALUE	Alteon-Service-Type		Alteon-User		255
 
+ATTRIBUTE	Alteon-Language				28	integer
+
+VALUE	Alteon-Language			Alteon-English		0
+VALUE	Alteon-Language			Alteon-Chinese		1
+
 END-VENDOR	Alteon
diff -urpN freeradius-server-3.2.7/share/dictionary.cisco freeradius-server-3.2.8/share/dictionary.cisco
--- freeradius-server-3.2.7/share/dictionary.cisco	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/share/dictionary.cisco	2025-08-20 23:29:15.000000000 +0700
@@ -5,7 +5,7 @@
 #		Accounting VSAs originally by
 #		"Marcelo M. Sosa Lugones" <marcelo@sosa.com.ar>
 #
-# Version:	$Id: c62922820c592c5f60be01a34b845c2242cb50ab $
+# Version:	$Id: 7ec2f3f6d4ba8a9044d82dd29aa2e6b1a88bbcb3 $
 #
 #  For documentation on Cisco RADIUS attributes, see:
 #
@@ -88,6 +88,8 @@ ATTRIBUTE	Cisco-Sub-Deactivate-Service
 ATTRIBUTE	Cisco-DHCP-Subscriber-Id		65	string
 ATTRIBUTE	Cisco-DHCPv6-Link-Address		66	string
 
+ATTRIBUTE	Cisco-DHCPv4-Option-To-AAA		90	string
+
 ATTRIBUTE	sip-conf-id				100	string
 ATTRIBUTE	h323-credit-amount			101	string
 ATTRIBUTE	h323-credit-time			102	string
diff -urpN freeradius-server-3.2.7/share/dictionary.freeradius freeradius-server-3.2.8/share/dictionary.freeradius
--- freeradius-server-3.2.7/share/dictionary.freeradius	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/share/dictionary.freeradius	2025-08-20 23:29:15.000000000 +0700
@@ -4,7 +4,7 @@
 #
 #	The FreeRADIUS Vendor-Specific dictionary.
 #
-# Version:	$Id: 38e52801aff6378caead66694ade6071d79fe546 $
+# Version:	$Id: 90100e7bfdb4bc47910427e3340e12f742ed2112 $
 #
 
 VENDOR		FreeRADIUS			11344
@@ -304,7 +304,17 @@ ATTRIBUTE	FreeRADIUS-Stats-Threads-Activ
 ATTRIBUTE	FreeRADIUS-Stats-Threads-Total		194	integer
 ATTRIBUTE	FreeRADIUS-Stats-Threads-Max		195	integer
 
-ATTRIBUTE	FreeRADIUS-Stats-Server-Src-IP-Address	176	ipaddr
-ATTRIBUTE	FreeRADIUS-Stats-Server-Src-IPv6-Address 177	ipaddr
+ATTRIBUTE	FreeRADIUS-Stats-Server-Src-IP-Address	196	ipaddr
+ATTRIBUTE	FreeRADIUS-Stats-Server-Src-IPv6-Address 197	ipaddr
+
+ATTRIBUTE	FreeRADIUS-Stats-Elapsed		 198	tlv
+ATTRIBUTE	FreeRADIUS-Stats-Elapsed-1us		 198.1	integer64
+ATTRIBUTE	FreeRADIUS-Stats-Elapsed-10us		 198.2	integer64
+ATTRIBUTE	FreeRADIUS-Stats-Elapsed-100us		 198.3	integer64
+ATTRIBUTE	FreeRADIUS-Stats-Elapsed-1ms		 198.4	integer64
+ATTRIBUTE	FreeRADIUS-Stats-Elapsed-10ms		 198.5	integer64
+ATTRIBUTE	FreeRADIUS-Stats-Elapsed-100ms		 198.6	integer64
+ATTRIBUTE	FreeRADIUS-Stats-Elapsed-1s		 198.7	integer64
+ATTRIBUTE	FreeRADIUS-Stats-Elapsed-10s		 198.8	integer64
 
 END-VENDOR FreeRADIUS
diff -urpN freeradius-server-3.2.7/share/dictionary.freeradius.internal freeradius-server-3.2.8/share/dictionary.freeradius.internal
--- freeradius-server-3.2.7/share/dictionary.freeradius.internal	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/share/dictionary.freeradius.internal	2025-08-20 23:29:15.000000000 +0700
@@ -4,7 +4,7 @@
 #
 #	Non Protocol Attributes used by FreeRADIUS
 #
-#	$Id: 82b5f7185cdb9083c3082b516d39f427093dcaf9 $
+#	$Id: 71611c6f66a10b497956204cec0181c888af9a2b $
 #
 
 #	The attributes number ranges are allocates as follows:
@@ -109,6 +109,7 @@ ATTRIBUTE	Module-Failure-Message			1076
 #		X99-Fast		1077	integer
 ATTRIBUTE	Rewrite-Rule				1078	string
 # SQL-Group is now dynamically created
+ATTRIBUTE	SQL-Query-Number			1079	integer
 ATTRIBUTE	Response-Packet-Type			1080	integer virtual
 ATTRIBUTE	Digest-HA1				1081	string
 ATTRIBUTE	MS-CHAP-Use-NTLM-Auth			1082	integer
@@ -291,6 +292,11 @@ ATTRIBUTE	SSHA3-256-Password			1183	octe
 ATTRIBUTE	SSHA3-384-Password			1184	octets
 ATTRIBUTE	SSHA3-512-Password			1185	octets
 
+ATTRIBUTE	PBKDF2-SHA1-Password			1186	octets
+ATTRIBUTE	PBKDF2-SHA256-Password			1187	octets
+ATTRIBUTE	PBKDF2-SHA512-Password			1188	octets
+ATTRIBUTE	PBKDF2-SHA256-LEGACY-Password		1189	octets
+
 ATTRIBUTE	MS-CHAP-Peer-Challenge			1192	octets
 ATTRIBUTE	Home-Server-Name			1193	string
 ATTRIBUTE	Originating-Realm-Key			1194	string
diff -urpN freeradius-server-3.2.7/share/dictionary.infinera freeradius-server-3.2.8/share/dictionary.infinera
--- freeradius-server-3.2.7/share/dictionary.infinera	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/share/dictionary.infinera	2025-08-20 23:29:15.000000000 +0700
@@ -1,12 +1,66 @@
 # -*- text -*-
-# Copyright (C) 2019 The FreeRADIUS Server project and contributors
+# Copyright (C) 2025 The FreeRADIUS Server project and contributors
 # This work is licensed under CC-BY version 4.0 https://creativecommons.org/licenses/by/4.0
 #
-VENDOR		Infinera			8708
+VENDOR		Infinera			21296
 
-BEGIN-VENDOR	Infinera
+BEGIN-VENDOR Infinera
 
-ATTRIBUTE	Infinera-User-Category			1	string
-ATTRIBUTE	Infinera-ENM-User-Category		2	string
+ATTRIBUTE	Infinera-User-Priv-SA			1	integer
+ATTRIBUTE	Infinera-User-Priv-NA			2	integer
+ATTRIBUTE	Infinera-User-Priv-NE			3	integer
+ATTRIBUTE	Infinera-User-Priv-PR			4	integer
+ATTRIBUTE	Infinera-User-Priv-TT			5	integer
+ATTRIBUTE	Infinera-User-Priv-MA			6	integer
+ATTRIBUTE	Infinera-User-Priv-RA			7	integer
+ATTRIBUTE	Infinera-User-Priv-EA			8	integer
+ATTRIBUTE	Infinera-User-SessionTimeout		17	integer
+ATTRIBUTE	Infinera-User-LockedOut			18	integer
+ATTRIBUTE	Infinera-User-CanUseResSession		19	integer
+ATTRIBUTE	Infinera-User-MgtType-EMS		33	integer
+ATTRIBUTE	Infinera-User-MgtType-GNM		34	integer
+ATTRIBUTE	Infinera-User-MgtType-TL1		35	integer
+ATTRIBUTE	Infinera-User-MgtType-CLI		36	integer
+ATTRIBUTE	Infinera-User-MgtType-NETCONF		37	integer
+ATTRIBUTE	Infinera-Rsvd-Str-Attribute1		240	string
+ATTRIBUTE	Infinera-Rsvd-Str-Attribute2		241	string
+ATTRIBUTE	Infinera-Rsvd-Int-Attribute1		249	integer
+ATTRIBUTE	Infinera-Rsvd-Int-Attribute2		250	integer
 
-END-VENDOR      Infinera
+VALUE	Infinera-User-Priv-NE		Non-Privileged		0
+VALUE	Infinera-User-Priv-NE		Privileged		1
+
+VALUE	Infinera-User-Priv-PR		Non-Privileged		0
+VALUE	Infinera-User-Priv-PR		Privileged		1
+
+VALUE	Infinera-User-Priv-TT		Non-Privileged		0
+VALUE	Infinera-User-Priv-TT		Privileged		1
+
+VALUE	Infinera-User-Priv-MA		Non-Privileged		0
+VALUE	Infinera-User-Priv-MA		Privileged		1
+
+VALUE	Infinera-User-Priv-RA		Non-Privileged		0
+VALUE	Infinera-User-Priv-RA		Privileged		1
+
+VALUE	Infinera-User-Priv-EA		Non-Privileged		0
+VALUE	Infinera-User-Priv-EA		Privileged		1
+
+VALUE	Infinera-User-CanUseResSession	No			0
+VALUE	Infinera-User-CanUseResSession	Can-Yes			1
+
+VALUE	Infinera-User-MgtType-EMS	Disallowed		0
+VALUE	Infinera-User-MgtType-EMS	Allowed			1
+
+VALUE	Infinera-User-MgtType-GNM	Disallowed		0
+VALUE	Infinera-User-MgtType-GNM	Allowed			1
+
+VALUE	Infinera-User-MgtType-TL1	Disallowed		0
+VALUE	Infinera-User-MgtType-TL1	Allowed			1
+
+VALUE	Infinera-User-MgtType-CLI	Disallowed		0
+VALUE	Infinera-User-MgtType-CLI	Allowed			1
+
+VALUE	Infinera-User-MgtType-NETCONF	Disallowed		0
+VALUE	Infinera-User-MgtType-NETCONF	Allowed			1
+
+END-VENDOR               Infinera
diff -urpN freeradius-server-3.2.7/share/dictionary.infinera.broken freeradius-server-3.2.8/share/dictionary.infinera.broken
--- freeradius-server-3.2.7/share/dictionary.infinera.broken	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/share/dictionary.infinera.broken	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,12 @@
+# -*- text -*-
+# Copyright (C) 2019 The FreeRADIUS Server project and contributors
+# This work is licensed under CC-BY version 4.0 https://creativecommons.org/licenses/by/4.0
+#
+VENDOR		Infinera			8708
+
+BEGIN-VENDOR	Infinera
+
+ATTRIBUTE	Infinera-User-Category			1	string
+ATTRIBUTE	Infinera-ENM-User-Category		2	string
+
+END-VENDOR      Infinera
diff -urpN freeradius-server-3.2.7/share/dictionary.microsoft freeradius-server-3.2.8/share/dictionary.microsoft
--- freeradius-server-3.2.7/share/dictionary.microsoft	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/share/dictionary.microsoft	2025-08-20 23:29:15.000000000 +0700
@@ -4,7 +4,7 @@
 #
 #	Microsoft's VSA's, from RFC 2548
 #
-#	$Id: 6ba9dd5bedec065f0535f82390a8b6e9cdbaaf0f $
+#	$Id: fdc7bff59f56dca34c642f10c61173f8409b43ca $
 #
 
 VENDOR		Microsoft			311
@@ -15,7 +15,7 @@ ATTRIBUTE	MS-CHAP-Error				2	string
 ATTRIBUTE	MS-CHAP-CPW-1				3	octets[70]
 ATTRIBUTE	MS-CHAP-CPW-2				4	octets[84]
 ATTRIBUTE	MS-CHAP-LM-Enc-PW			5	octets
-ATTRIBUTE	MS-CHAP-NT-Enc-PW			6	octets
+ATTRIBUTE	MS-CHAP-NT-Enc-PW			6	octets	secret
 ATTRIBUTE	MS-MPPE-Encryption-Policy		7	integer
 
 VALUE	MS-MPPE-Encryption-Policy	Encryption-Allowed	1
@@ -32,7 +32,7 @@ VALUE	MS-MPPE-Encryption-Types	RC4-40or1
 
 ATTRIBUTE	MS-RAS-Vendor				9	integer	# content is Vendor-ID
 ATTRIBUTE	MS-CHAP-Domain				10	string
-ATTRIBUTE	MS-CHAP-Challenge			11	octets
+ATTRIBUTE	MS-CHAP-Challenge			11	octets	secret
 ATTRIBUTE	MS-CHAP-MPPE-Keys			12	octets[24]  encrypt=1
 ATTRIBUTE	MS-BAP-Usage				13	integer
 ATTRIBUTE	MS-Link-Utilization-Threshold		14	integer # values are 1-100
diff -urpN freeradius-server-3.2.7/src/include/all.mk freeradius-server-3.2.8/src/include/all.mk
--- freeradius-server-3.2.7/src/include/all.mk	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/include/all.mk	2025-08-20 23:29:15.000000000 +0700
@@ -1,5 +1,5 @@
 #
-# Version:	$Id: e666f1403a068a348be17fad00aa7ff5b8fba3ad $
+# Version:	$Id: 1e789505ec2484ee78781038e35b38f36f49b33a $
 #
 
 #
@@ -96,6 +96,10 @@ src/include/features.h: src/include/feat
 	@cp $< $@
 	@grep "^#define[ ]*WITH_" src/include/autoconf.h >> $@
 	@grep "^#define[ ]*RADIUSD_VERSION" src/include/autoconf.h >> $@
+	@echo '#define DOC_ROOT_URL "https://www.freeradius.org/documentation/freeradius-server/" RADIUSD_VERSION_STRING' >> $@
+	@echo '#define DOC_KEYWORD_URL(_x) DOC_ROOT_URL "/unlang/" STRINGIFY(_x) ".html"' >> $@
+	@echo '#define DOC_KEYWORD_REF(_x) "For more information, please see " DOC_KEYWORD_URL(_x)' >> $@
+
 
 #
 #  Use the SED script we built earlier to make permanent substitutions
diff -urpN freeradius-server-3.2.7/src/include/autoconf.h.in freeradius-server-3.2.8/src/include/autoconf.h.in
--- freeradius-server-3.2.7/src/include/autoconf.h.in	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/include/autoconf.h.in	2025-08-20 23:29:15.000000000 +0700
@@ -330,6 +330,9 @@
 /* define this if we have libpcre */
 #undef HAVE_PCRE
 
+/* define this if we have libpcre2 */
+#undef HAVE_PCRE2
+
 /* Define to 1 if you have the <prot.h> header file. */
 #undef HAVE_PROT_H
 
diff -urpN freeradius-server-3.2.7/src/include/libradius.h freeradius-server-3.2.8/src/include/libradius.h
--- freeradius-server-3.2.7/src/include/libradius.h	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/include/libradius.h	2025-08-20 23:29:15.000000000 +0700
@@ -16,14 +16,14 @@
 #ifndef LIBRADIUS_H
 #define LIBRADIUS_H
 /*
- * $Id: d3a47815847652873076bc7e25f1e0e0fcc2371d $
+ * $Id: 9dd22b3361a48629bf5216d8b8246fc04f583d36 $
  *
  * @file libradius.h
  * @brief Structures and prototypes for the radius library.
  *
  * @copyright 1999-2014 The FreeRADIUS server project
  */
-RCSIDH(libradius_h, "$Id: d3a47815847652873076bc7e25f1e0e0fcc2371d $")
+RCSIDH(libradius_h, "$Id: 9dd22b3361a48629bf5216d8b8246fc04f583d36 $")
 
 /*
  *  Compiler hinting macros.  Included here for 3rd party consumers
@@ -152,6 +152,7 @@ typedef void (*sig_t)(int);
 #define TAG_VALID(x)		((x) > 0 && (x) < 0x20)
 #define TAG_VALID_ZERO(x)	((x) < 0x20)
 #define TAG_ANY			INT8_MIN
+#define TAG_VALUE		(INT8_MIN + 1)
 #define TAG_NONE		0
 /** Check if tags are equal
  *
diff -urpN freeradius-server-3.2.7/src/include/log.h freeradius-server-3.2.8/src/include/log.h
--- freeradius-server-3.2.7/src/include/log.h	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/include/log.h	2025-08-20 23:29:15.000000000 +0700
@@ -16,7 +16,7 @@
 #ifndef FR_LOG_H
 #define FR_LOG_H
 /**
- * $Id: 2736591779e3c80137b1a753bf75e5d2182595c5 $
+ * $Id: f978496a0a32bcadd89f5465675a80058fb8f923 $
  *
  * @file log.h
  * @brief Macros and function definitions to write log messages, and control the logging system.
@@ -24,7 +24,7 @@
  * @copyright 2015 Arran Cudbard-Bell <a.cudbardb@freeradius.org>
  * @copyright 2013 Alan DeKok <aland@freeradius.org>
  */
-RCSIDH(log_h, "$Id: 2736591779e3c80137b1a753bf75e5d2182595c5 $")
+RCSIDH(log_h, "$Id: f978496a0a32bcadd89f5465675a80058fb8f923 $")
 
 #ifdef __cplusplus
 extern "C" {
@@ -70,6 +70,7 @@ typedef struct fr_log_t {
 	log_dst_t	dst;		//!< Log destination.
 	char const	*file;		//!< Path to log file.
 	char const	*debug_file;	//!< Path to debug log file.
+	bool		timestamp;	//!< Should logs always have timestamps.
 } fr_log_t;
 
 typedef		void (*radlog_func_t)(log_type_t lvl, log_lvl_t priority, REQUEST *, char const *, va_list ap);
diff -urpN freeradius-server-3.2.7/src/include/modules.h freeradius-server-3.2.8/src/include/modules.h
--- freeradius-server-3.2.7/src/include/modules.h	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/include/modules.h	2025-08-20 23:29:15.000000000 +0700
@@ -15,7 +15,7 @@
  */
 
 /**
- * $Id: 9ba81b3bc1fb7f19a25bfbbd8007a6ea8239d561 $
+ * $Id: a07b2f6fe7c67ef52b1a5485fd2ca4f1981ac93e $
  *
  * @file modules.h
  * @brief Interface to the RADIUS module system.
@@ -26,7 +26,7 @@
 #ifndef RADIUS_MODULES_H
 #define RADIUS_MODULES_H
 
-RCSIDH(modules_h, "$Id: 9ba81b3bc1fb7f19a25bfbbd8007a6ea8239d561 $")
+RCSIDH(modules_h, "$Id: a07b2f6fe7c67ef52b1a5485fd2ca4f1981ac93e $")
 
 #include <freeradius-devel/conffile.h>
 #include <freeradius-devel/features.h>
@@ -168,6 +168,8 @@ rlm_rcode_t indexed_modcall(rlm_componen
 int virtual_servers_load(CONF_SECTION *config);
 void virtual_servers_free(time_t when);
 
+int virtual_server_sanity_check(REQUEST *request);
+
 #ifdef __cplusplus
 }
 #endif
diff -urpN freeradius-server-3.2.7/src/include/radiusd.h freeradius-server-3.2.8/src/include/radiusd.h
--- freeradius-server-3.2.7/src/include/radiusd.h	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/include/radiusd.h	2025-08-20 23:29:15.000000000 +0700
@@ -16,7 +16,7 @@
 #ifndef RADIUSD_H
 #define RADIUSD_H
 /**
- * $Id: da7a6b8421fbaed9baebcca46c6cdb114022e9b7 $
+ * $Id: 67ef17e17d6cfacc5dfdfe535078637951f0c372 $
  *
  * @file radiusd.h
  * @brief Structures, prototypes and global variables for the FreeRADIUS server.
@@ -24,7 +24,7 @@
  * @copyright 1999-2000,2002-2008  The FreeRADIUS server project
  */
 
-RCSIDH(radiusd_h, "$Id: da7a6b8421fbaed9baebcca46c6cdb114022e9b7 $")
+RCSIDH(radiusd_h, "$Id: 67ef17e17d6cfacc5dfdfe535078637951f0c372 $")
 
 #include <freeradius-devel/libradius.h>
 #include <freeradius-devel/radpaths.h>
@@ -133,6 +133,7 @@ typedef struct main_config {
 	bool		proxy_requests;			//!< Toggle to enable/disable proxying globally.
 #endif
 	struct timeval	reject_delay;			//!< How long to wait before sending an Access-Reject.
+	bool		delay_proxy_rejects;		//!< do we delay proxied rejects
 	bool		status_server;			//!< Whether to respond to status-server messages.
 
 
@@ -469,7 +470,7 @@ int	regex_request_to_sub(TALLOC_CTX *ctx
 /*
  *	Named capture groups only supported by PCRE.
  */
-#  ifdef HAVE_PCRE
+#  if defined(HAVE_PCRE) || defined(HAVE_PCRE2)
 int	regex_request_to_sub_named(TALLOC_CTX *ctx, char **out, REQUEST *request, char const *name);
 #  endif
 #endif
@@ -495,7 +496,7 @@ void		version_print(void);
 char	*auth_name(char *buf, size_t buflen, REQUEST *request, bool do_cli);
 int		rad_authenticate (REQUEST *);
 int		rad_postauth(REQUEST *);
-int		rad_virtual_server(REQUEST *);
+int		rad_virtual_server(REQUEST *, bool check_username);
 
 /* exec.c */
 pid_t radius_start_program(char const *cmd, REQUEST *request, bool exec_wait,
diff -urpN freeradius-server-3.2.7/src/include/realms.h freeradius-server-3.2.8/src/include/realms.h
--- freeradius-server-3.2.7/src/include/realms.h	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/include/realms.h	2025-08-20 23:29:15.000000000 +0700
@@ -5,11 +5,11 @@
  * realms.h	Structures, prototypes and global variables
  *		for realms
  *
- * Version:	$Id: 1085e23d272d131b25b4e670c1b3d2790f12f88f $
+ * Version:	$Id: 2d8106263fdf845117a490d9a216c095ab2c68e7 $
  *
  */
 
-RCSIDH(realms_h, "$Id: 1085e23d272d131b25b4e670c1b3d2790f12f88f $")
+RCSIDH(realms_h, "$Id: 2d8106263fdf845117a490d9a216c095ab2c68e7 $")
 
 #ifdef __cplusplus
 extern "C" {
@@ -82,6 +82,8 @@ typedef struct home_server {
 	fr_ipaddr_t		ipaddr;			//!< IP address of home server.
 	uint16_t		port;
 
+	uint32_t		affinity;		//!< for home server fail-over groups and EAP.
+
 	char const		*type_str;		//!< String representation of type.
 	home_type_t		type;			//!< Auth, Acct, CoA etc.
 
@@ -156,7 +158,7 @@ typedef struct home_server {
 #ifdef HAVE_TRUST_ROUTER_TR_DH_H
 	time_t			expiration;
 #endif
-
+	uint32_t		id;
 } home_server_t;
 
 
@@ -166,7 +168,8 @@ typedef enum home_pool_type_t {
 	HOME_POOL_FAIL_OVER,
 	HOME_POOL_CLIENT_BALANCE,
 	HOME_POOL_CLIENT_PORT_BALANCE,
-	HOME_POOL_KEYED_BALANCE
+	HOME_POOL_KEYED_BALANCE,
+	HOME_POOL_CONSISTENT_KEYED_BALANCE
 } home_pool_type_t;
 
 
@@ -184,6 +187,8 @@ typedef struct home_pool_t {
 	time_t			time_all_dead;
 	time_t			last_serviced;
 
+	home_server_t		**affinity_group;
+
 	int			num_home_servers;
 	home_server_t		*servers[1];
 } home_pool_t;
diff -urpN freeradius-server-3.2.7/src/include/regex.h freeradius-server-3.2.8/src/include/regex.h
--- freeradius-server-3.2.7/src/include/regex.h	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/include/regex.h	2025-08-20 23:29:15.000000000 +0700
@@ -17,20 +17,43 @@
 #define REGEX_H
 #ifdef HAVE_REGEX
 /*
- * $Id: efb7b8615cbed32b893108defb0335ec3e5f8553 $
+ * $Id: c56a41c96af2ef1c736a62823fc39d50c2c2aabb $
  *
  * @file regex.h
  * @brief Wrappers around various regular expression libraries.
  *
  * @copyright 2014 The FreeRADIUS server project
  */
-RCSIDH(regex_h, "$Id: efb7b8615cbed32b893108defb0335ec3e5f8553 $")
+RCSIDH(regex_h, "$Id: c56a41c96af2ef1c736a62823fc39d50c2c2aabb $")
 
 #  ifdef __cplusplus
 extern "C" {
 #  endif
-#  ifdef HAVE_PCRE
-#    include <pcre.h>
+#  ifdef HAVE_PCRE2
+#    define PCRE2_CODE_UNIT_WIDTH 8
+#    include <pcre2.h>
+int fr_pcre2_gcontext_setup(void);
+void fr_pcre2_gcontext_free(void);
+
+typedef struct regmatch {
+	pcre2_match_data	*match_data;	//!< Match data containing the subject
+						///< and various match offsets.
+#ifndef NDEBUG
+	char const		*subject;	//!< Here for debugging purposes if we explicitly duped the string.
+#endif
+} regmatch_t;
+
+typedef struct regex {
+	pcre2_code_8	*compiled;	//!< Compiled regular expression.
+	uint32_t	subcaptures;	//!< Number of subcaptures contained within the expression.
+	bool		precompiled;	//!< Whether this regex was precompiled, or compiled for one of evaluation.
+	bool		jitd;		//!< Whether JIT data is available.
+} regex_t;
+
+regmatch_t *regex_match_data_alloc(TALLOC_CTX *ctx, uint32_t count);
+
+#  elif defined (HAVE_PCRE)
+#      include <pcre.h>
 /*
  *  Versions older then 8.20 didn't have the JIT functionality
  *  gracefully degrade.
diff -urpN freeradius-server-3.2.7/src/lib/pair.c freeradius-server-3.2.8/src/lib/pair.c
--- freeradius-server-3.2.7/src/lib/pair.c	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/lib/pair.c	2025-08-20 23:29:15.000000000 +0700
@@ -1,7 +1,7 @@
 /*
  * pair.c	Functions to handle VALUE_PAIRs
  *
- * Version:	$Id: c9f2f046819e4fe81b7ffca154f6132f3515e069 $
+ * Version:	$Id: 31b5c0938c724998b631324dd01af04bed2941bb $
  *
  *   This library is free software; you can redistribute it and/or
  *   modify it under the terms of the GNU Lesser General Public
@@ -20,7 +20,7 @@
  * Copyright 2000,2006  The FreeRADIUS server project
  */
 
-RCSID("$Id: c9f2f046819e4fe81b7ffca154f6132f3515e069 $")
+RCSID("$Id: 31b5c0938c724998b631324dd01af04bed2941bb $")
 
 #include <freeradius-devel/libradius.h>
 #include <freeradius-devel/regex.h>
@@ -1296,9 +1296,84 @@ int fr_pair_value_from_str(VALUE_PAIR *v
 	type = vp->da->type;
 
 	/*
+	 *	We MIGHT get the tag from the value.  But it's not guaranteed.
+	 *
+	 *	:tag:value
+	 *
+	 *	@todo - the current parser requires that strings are NOT quoted.
+	 */
+	if (vp->tag == TAG_VALUE) {
+		char const *p = value;
+		char const *end = value + inlen;
+
+		vp->tag = 0;
+
+		/*
+		 *	No data or no ':' prefix, there's no tag.
+		 */
+		if ((inlen == 0) || (*p != ':')) goto parse_value;
+		p++;
+
+		/*
+		 *	Input is just ':', that's invalid.
+		 */
+		if (p == end) {
+		missing_tag:
+			fr_strerror_printf("Value has tag prefix ':', but the tag is missing or malformed");
+			return -1;
+		}
+
+		/*
+		 *	:x is invalid.
+		 */
+		if (!((*p >= 0) && (*p <= '9'))) {
+		invalid_chars:
+			fr_strerror_printf("Value has invalid characters in tag");
+			return -1;
+		}
+		vp->tag = *p - '0';
+		p++;
+
+		/*
+		 *	:1 is invalid.
+		 */
+		if (p == end) goto done_tag;
+
+		/*
+		 *	:1: is a valid tag, with perhaps an empty string.
+		 */
+		if (*p == ':') {
+			p++;
+			goto done_tag;
+		}
+
+		/*
+		 *	Tags are 0..31
+		 */
+		if (!((*p >= 0) && (*p <= '9'))) goto invalid_chars;
+
+		vp->tag *= 10;
+		vp->tag += *p - '0';
+
+		if (vp->tag >= 0x20) goto invalid_chars;
+		p++;
+
+		/*
+		 *	Tags must end with another ':'
+		 */
+		if ((p == end) || (*p != ':')) goto missing_tag;
+		p++;
+
+	done_tag:
+		value = p;
+		inlen = (size_t) (end - p);
+	}
+
+	/*
 	 *	We presume that the input data is from a double quoted
 	 *	string, and needs escaping
 	 */
+parse_value:
 	ret = value_data_from_str(vp, &vp->data, &type, vp->da, value, inlen, '"');
 	if (ret < 0) return -1;
 
@@ -1545,7 +1620,10 @@ VALUE_PAIR *fr_pair_make(TALLOC_CTX *ctx
 			 if (tc && !*tc && TAG_VALID_ZERO(tag))
 				 *ts = '\0';
 			 else tag = TAG_ANY;
+		 } else if (ts[1] == 'V') {
+			 tag = TAG_VALUE;
 		 } else {
+		 invalid_tag:
 			 fr_strerror_printf("Invalid tag for attribute %s", attribute);
 			 return NULL;
 		 }
@@ -1563,6 +1641,11 @@ VALUE_PAIR *fr_pair_make(TALLOC_CTX *ctx
 		return vp;
 	}
 
+	/*
+	 *	Can only use tags when the DA says that it supports tags.
+	 */
+	if (!da->flags.has_tag && found_tag) goto invalid_tag;
+
 	/*      Check for a tag in the 'Merit' format of:
 	 *      :Tag:Value.  Print an error if we already found
 	 *      a tag in the Attribute.
@@ -1570,7 +1653,7 @@ VALUE_PAIR *fr_pair_make(TALLOC_CTX *ctx
 
 	if (value && (*value == ':' && da->flags.has_tag)) {
 		/* If we already found a tag, this is invalid */
-		if(found_tag) {
+		if(found_tag && (tag != TAG_VALUE)) {
 			fr_strerror_printf("Duplicate tag %s for attribute %s",
 				   value, da->name);
 			DEBUG("Duplicate tag %s for attribute %s\n",
@@ -1730,7 +1813,8 @@ do_add:
  */
 int fr_pair_mark_xlat(VALUE_PAIR *vp, char const *value)
 {
-	char *raw;
+	char *str;
+	char const *q;
 
 	/*
 	 *	valuepair should not already have a value.
@@ -1740,14 +1824,36 @@ int fr_pair_mark_xlat(VALUE_PAIR *vp, ch
 		return -1;
 	}
 
-	raw = talloc_typed_strdup(vp, value);
-	if (!raw) {
+	/*
+	 *	No '%', OR '%' is at the end of the string.  Just set
+	 *	the value from the string.
+	 */
+	q = strchr(value, '%');
+	while (true) {
+		if (!q || !q[1]) return fr_pair_value_from_str(vp, value, -1);
+
+		if (q[1] == '{') goto do_xlat; /* very common */
+
+		if (strchr("%cdelmntCDGHIMSTYv", q[1])) goto do_xlat;
+
+		/*
+		 *	"%?" either gets ignored by the xlat parser,
+		 *	or results in an error where it can't expand
+		 *	the string.  For our purposes, we skip them,
+		 *	to allow more strings to be treated "as-is"
+		 */
+		q = strchr(q + 1, '%');
+	}
+
+do_xlat:
+	str = talloc_typed_strdup(vp, value);
+	if (!str) {
 		fr_strerror_printf("Out of memory");
 		return -1;
 	}
 
 	vp->type = VT_XLAT;
-	vp->value.xlat = raw;
+	vp->value.xlat = str;
 	vp->vp_length = 0;
 
 	return 0;
@@ -1995,6 +2101,14 @@ FR_TOKEN fr_pair_list_afrom_str(TALLOC_C
 		}
 		if (last_token == T_INVALID) break;
 
+		/*
+		 *	Mark double-quoted strings as being expanded,
+		 *	but only if they contain a '%' character.
+		 *
+		 *	Note that this check is a bit too narrow, but
+		 *	most of the time it avoids marking the string
+		 *	for expansion.
+		 */
 		if (raw.quote == T_DOUBLE_QUOTED_STRING) {
 			vp = fr_pair_make(ctx, NULL, raw.l_opand, NULL, raw.op);
 			if (!vp) {
diff -urpN freeradius-server-3.2.7/src/lib/radius.c freeradius-server-3.2.8/src/lib/radius.c
--- freeradius-server-3.2.7/src/lib/radius.c	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/lib/radius.c	2025-08-20 23:29:15.000000000 +0700
@@ -15,7 +15,7 @@
  */
 
 /**
- * $Id: c381b72e94dcdb7ed5eb95737238e6eaa6bd46c3 $
+ * $Id: e795ca2b3df8886f9fb7786654aeba209b650139 $
  *
  * @file radius.c
  * @brief Functions to send/receive radius packets.
@@ -23,7 +23,7 @@
  * @copyright 2000-2003,2006  The FreeRADIUS server project
  */
 
-RCSID("$Id: c381b72e94dcdb7ed5eb95737238e6eaa6bd46c3 $")
+RCSID("$Id: e795ca2b3df8886f9fb7786654aeba209b650139 $")
 
 #include	<freeradius-devel/libradius.h>
 
@@ -325,7 +325,11 @@ static int rad_sendto(int sockfd, void *
 done:
 #endif
 	if (rcode < 0) {
-		fr_strerror_printf("sendto failed: %s", fr_syserror(errno));
+		if (errno == EMSGSIZE) {
+			fr_strerror_printf("sendto failed - destination does not support UDP fragmentation: %s", fr_syserror(errno));
+		} else {
+			fr_strerror_printf("sendto failed: %s", fr_syserror(errno));
+		}
 	}
 
 	return rcode;
diff -urpN freeradius-server-3.2.7/src/lib/regex.c freeradius-server-3.2.8/src/lib/regex.c
--- freeradius-server-3.2.7/src/lib/regex.c	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/lib/regex.c	2025-08-20 23:29:15.000000000 +0700
@@ -27,10 +27,319 @@
 #include <freeradius-devel/regex.h>
 
 /*
+ *	Wrapper functions for libpcre2. Much more powerful, and guaranteed
+ *	to be binary safe for both patterns and subjects but require
+ *	libpcre2.
+ */
+#  ifdef HAVE_PCRE2
+/** Free regex_t structure
+ *
+ * Calls libpcre specific free functions for the expression and study.
+ *
+ * @param preg to free.
+ */
+static int _regex_free(regex_t *preg)
+{
+	if (preg->compiled) {
+		pcre2_code_free(preg->compiled);
+		preg->compiled = NULL;
+	}
+
+	return 0;
+}
+
+/** Talloc wrapper for pcre2 memory allocation
+ *
+ * @param[in] to_alloc		How many bytes to alloc.
+ * @param[in] uctx		UNUSED.
+ */
+static void *_pcre2_talloc(PCRE2_SIZE to_alloc, UNUSED void *uctx)
+{
+	return talloc_array(NULL, uint8_t, to_alloc);
+}
+
+/** Talloc wrapper for pcre2 memory freeing
+ *
+ * @param[in] to_free		Memory to free.
+ * @param[in] uctx		UNUSED.
+ */
+static void _pcre2_talloc_free(void *to_free, UNUSED void *uctx)
+{
+	talloc_free(to_free);
+}
+
+/*
+ *	A PCRE2 general context used to point to our custom alloc / free functions
+ */
+static pcre2_general_context	*_pcre2_gcontext = NULL;
+
+int fr_pcre2_gcontext_setup(void)
+{
+	_pcre2_gcontext = pcre2_general_context_create(_pcre2_talloc, _pcre2_talloc_free, NULL);
+	if (!_pcre2_gcontext) return -1;
+	return 1;
+}
+
+void fr_pcre2_gcontext_free(void)
+{
+	pcre2_general_context_free(_pcre2_gcontext);
+}
+
+/** Wrapper around pcre_compile
+ *
+ * Allows the rest of the code to do compilations using one function signature.
+ *
+ * @note Compiled expression must be freed with talloc_free.
+ *
+ * @param out Where to write out a pointer to the structure containing the compiled expression.
+ * @param pattern to compile.
+ * @param len of pattern.
+ * @param ignore_case whether to do case insensitive matching.
+ * @param multiline If true $ matches newlines.
+ * @param subcaptures Whether to compile the regular expression to store subcapture
+ *	data.
+ * @param runtime If false run the pattern through the PCRE JIT to convert it to machine code.
+ *	This trades startup time (longer) for runtime performance (better).
+ * @return >= 1 on success, <= 0 on error. Negative value is offset of parse error.
+ */
+ssize_t regex_compile(TALLOC_CTX *ctx, regex_t **out, char const *pattern, size_t len,
+		      bool ignore_case, bool multiline, bool subcaptures, bool runtime)
+{
+	int		ret;
+	PCRE2_SIZE	offset;
+	int		cflags = 0;
+	regex_t		*preg;
+#ifdef PCRE2_CONFIG_JIT
+	static bool	setup = false;
+	static bool	do_jit = false;
+
+	if (!setup) {
+		pcre2_config(PCRE2_CONFIG_JIT, &do_jit);
+		setup = true;
+	}
+#endif
+
+	*out = NULL;
+
+	if (len == 0) {
+		fr_strerror_printf("Empty expression");
+		return 0;
+	}
+
+	if (ignore_case) cflags |= PCRE2_CASELESS;
+	if (multiline) cflags |= PCRE2_MULTILINE;
+	if (!subcaptures) cflags |= PCRE2_NO_AUTO_CAPTURE;
+
+	preg = talloc_zero(ctx, regex_t);
+	talloc_set_destructor(preg, _regex_free);
+
+	preg->compiled = pcre2_compile((PCRE2_SPTR8)pattern, len, cflags, &ret, &offset, NULL);
+	if (!preg->compiled) {
+		PCRE2_UCHAR errbuff[128];
+
+		pcre2_get_error_message(ret, errbuff, sizeof(errbuff));
+		fr_strerror_printf("%s", (char *)errbuff);
+		talloc_free(preg);
+
+		return -(ssize_t)offset;
+	}
+	if (!runtime) {
+		preg->precompiled = true;
+
+#ifdef PCRE2_CONFIG_JIT
+		/*
+		 *	This is expensive, so only do it for
+		 *	expressions that are going to be
+		 *	evaluated repeatedly.
+		 */
+		if (do_jit) {
+			ret = pcre2_jit_compile(preg->compiled, PCRE2_JIT_COMPLETE);
+			if (ret < 0) {
+				PCRE2_UCHAR errbuff[128];
+
+				pcre2_get_error_message(ret, errbuff, sizeof(errbuff));
+				fr_strerror_printf("Pattern JIT failed: %s", (char *)errbuff);
+				talloc_free(preg);
+
+				return 0;
+			}
+			preg->jitd = true;
+		}
+#endif
+	}
+
+	*out = preg;
+
+	return len;
+}
+
+/** Wrapper around pcre2_match
+ *
+ * @param preg The compiled expression.
+ * @param subject to match.
+ * @param len Length of subject.
+ * @param pmatch Array of match pointers.
+ * @param nmatch How big the match array is. Updated to number of matches.
+ * @return -1 on error, 0 on no match, 1 on match.
+ */
+int regex_exec(regex_t *preg, char const *subject, size_t len, regmatch_t *pmatch, size_t *nmatch)
+{
+	int			ret;
+	uint32_t		options = 0;
+	bool			dup_subject = true;
+	char			*our_subject = NULL;
+	pcre2_match_data	*match_data;
+
+	/*
+	 *	PCRE_NO_AUTO_CAPTURE is a compile time only flag,
+	 *	and can't be passed here.
+	 *	We rely on the fact that matches has been set to
+	 *	0 as a hint that no subcapture data should be
+	 *	generated.
+	 */
+	if (!pmatch || !nmatch) {
+		pmatch = NULL;
+		if (nmatch) *nmatch = 0;
+	}
+
+	if (pmatch) {
+#ifdef PCRE2_COPY_MATCHED_SUBJECT
+		/*
+		 *	This is apparently only supported for pcre2_match
+		 *	NOT pcre2_jit_match.
+		 */
+#  ifdef PCRE2_CONFIG_JIT
+		if (!preg->jitd) {
+#  endif
+			dup_subject = false;
+
+			/*
+			 *	If PCRE2_COPY_MATCHED_SUBJECT is available
+			 *	and set as an options flag, pcre2_match will
+			 *	strdup the subject string if pcre2_match is
+			 *	successful and store a pointer to it in the
+			 *	regmatch struct.
+			 *
+			 *	The lifetime of the string memory will be
+			 *	bound to the regmatch struct.  This is more
+			 *	efficient that doing it ourselves, as the
+			 *	strdup only occurs if the subject matches.
+			 */
+			options |= PCRE2_COPY_MATCHED_SUBJECT;
+#  ifdef PCRE2_CONFIG_JIT
+		}
+#  endif
+#endif
+		if (dup_subject) {
+			/*
+			 *	We have to dup and operate on the duplicate
+			 *	of the subject, because pcre2_jit_match and
+			 *	pcre2_match store a pointer to the subject
+			 *	in the regmatch structure.
+			 */
+			subject = our_subject = talloc_bstrndup(pmatch, subject, len);
+			if (!subject) {
+				fr_strerror_printf("Out of memory");
+				return -1;
+			}
+#ifndef NDEBUG
+			pmatch->subject = subject; /* Stored only for tracking memory issues */
+#endif
+		}
+	}
+
+	/*
+	 *	If we weren't given match data we need to alloc it else pcre2_match
+	 *	fails when passed NULL match data.
+	 */
+	if (!pmatch) {
+		match_data = pcre2_match_data_create_from_pattern(preg->compiled, _pcre2_gcontext);
+		if (!match_data) {
+			fr_strerror_printf("Failed allocating temporary match data");
+			return -1;
+		}
+	} else {
+		match_data = pmatch->match_data;
+	}
+
+#ifdef PCRE2_CONFIG_JIT
+	if (preg->jitd) {
+		ret = pcre2_jit_match(preg->compiled, (PCRE2_SPTR8)subject, len, 0, options,
+				      match_data, NULL);
+	} else
+#endif
+	{
+		ret = pcre2_match(preg->compiled, (PCRE2_SPTR8)subject, len, 0, options,
+				  match_data, NULL);
+	}
+	if (!pmatch) pcre2_match_data_free(match_data);
+	if (ret < 0) {
+		PCRE2_UCHAR	errbuff[128];
+
+		if (dup_subject) talloc_free(our_subject);
+
+		if (ret == PCRE2_ERROR_NOMATCH) {
+			if (nmatch) *nmatch = 0;
+			return 0;
+		}
+
+		pcre2_get_error_message(ret, errbuff, sizeof(errbuff));
+		fr_strerror_printf("regex evaluation failed with code (%i): %s", ret, errbuff);
+
+		return -1;
+	}
+
+	if (nmatch && (ret > 0)) *nmatch = ret;
+
+	return 1;
+}
+
+/** Free libpcre2's matchdata
+ *
+ * @note Don't call directly, will be called if talloc_free is called on a #regmatch_t.
+ */
+static int _pcre2_match_data_free(regmatch_t *regmatch)
+{
+	pcre2_match_data_free(regmatch->match_data);
+	return 0;
+}
+
+/** Allocate vectors to fill with match data
+ *
+ * @param[in] ctx	to allocate match vectors in.
+ * @param[in] count	The number of vectors to allocate.
+ * @return
+ *	- NULL on error.
+ *	- Array of match vectors.
+ */
+regmatch_t *regex_match_data_alloc(TALLOC_CTX *ctx, uint32_t count)
+{
+	regmatch_t *regmatch;
+
+	regmatch = talloc(ctx, regmatch_t);
+	if (!regmatch) {
+	oom:
+		fr_strerror_printf("Out of memory");
+		return NULL;
+	}
+
+	regmatch->match_data = pcre2_match_data_create(count, _pcre2_gcontext);
+	if (!regmatch->match_data) {
+		talloc_free(regmatch);
+		goto oom;
+	}
+	talloc_set_type(regmatch->match_data, pcre2_match_data);
+
+	talloc_set_destructor(regmatch, _pcre2_match_data_free);
+
+	return regmatch;
+}
+
+/*
  *	Wrapper functions for libpcre. Much more powerful, and guaranteed
  *	to be binary safe but require libpcre.
  */
-#  ifdef HAVE_PCRE
+#  elif defined(HAVE_PCRE)
 /** Free regex_t structure
  *
  * Calls libpcre specific free functions for the expression and study.
diff -urpN freeradius-server-3.2.7/src/main/all.mk freeradius-server-3.2.8/src/main/all.mk
--- freeradius-server-3.2.7/src/main/all.mk	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/main/all.mk	2025-08-20 23:29:15.000000000 +0700
@@ -1,3 +1,3 @@
 SUBMAKEFILES := radclient.mk radiusd.mk radsniff.mk radmin.mk radattr.mk \
 	radwho.mk radlast.mk radtest.mk radzap.mk checkrad.mk radsecret.mk \
-	libfreeradius-server.mk unittest.mk
+	libfreeradius-server.mk unittest.mk fuzzer.mk
diff -urpN freeradius-server-3.2.7/src/main/auth.c freeradius-server-3.2.8/src/main/auth.c
--- freeradius-server-3.2.7/src/main/auth.c	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/main/auth.c	2025-08-20 23:29:15.000000000 +0700
@@ -1,7 +1,7 @@
 /*
  * auth.c	User authentication.
  *
- * Version:	$Id: 5fa400b9968f5ca6f196aad2b9b4eb7e39213646 $
+ * Version:	$Id: 395680635498c92cdf29db1931f3d7f1093663b8 $
  *
  *   This program is free software; you can redistribute it and/or modify
  *   it under the terms of the GNU General Public License as published by
@@ -21,7 +21,7 @@
  * Copyright 2000  Miquel van Smoorenburg <miquels@cistron.nl>
  * Copyright 2000  Jeff Carneal <jeff@apex.net>
  */
-RCSID("$Id: 5fa400b9968f5ca6f196aad2b9b4eb7e39213646 $")
+RCSID("$Id: 395680635498c92cdf29db1931f3d7f1093663b8 $")
 
 #include <freeradius-devel/radiusd.h>
 #include <freeradius-devel/modules.h>
@@ -732,7 +732,7 @@ authenticate:
  *	Run a virtual server auth and postauth
  *
  */
-int rad_virtual_server(REQUEST *request)
+int rad_virtual_server(REQUEST *request, bool check_username)
 {
 	VALUE_PAIR *vp;
 	int result;
@@ -747,7 +747,7 @@ int rad_virtual_server(REQUEST *request)
 	/*
 	 *	Complain about possible issues related to tunnels.
 	 */
-	if (request->parent && request->parent->username && request->username) {
+	if (request->parent && request->parent->username && request->username && check_username) {
 		/*
 		 *	Look at the full User-Name with realm.
 		 */
diff -urpN freeradius-server-3.2.7/src/main/conffile.c freeradius-server-3.2.8/src/main/conffile.c
--- freeradius-server-3.2.7/src/main/conffile.c	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/main/conffile.c	2025-08-20 23:29:15.000000000 +0700
@@ -5,7 +5,7 @@
  *		write a decent parser. I know how to do that, really :)
  *		miquels@cistron.nl
  *
- * Version:	$Id: 75bb5d616e1ea7b053e5951e1d55c23920c20400 $
+ * Version:	$Id: bc8969f37aa8d384ef858d0d67e86caf04c37e5d $
  *
  *   This program is free software; you can redistribute it and/or modify
  *   it under the terms of the GNU General Public License as published by
@@ -26,7 +26,7 @@
  * Copyright 2000  Alan DeKok <aland@ox.org>
  */
 
-RCSID("$Id: 75bb5d616e1ea7b053e5951e1d55c23920c20400 $")
+RCSID("$Id: bc8969f37aa8d384ef858d0d67e86caf04c37e5d $")
 
 #include <freeradius-devel/radiusd.h>
 #include <freeradius-devel/parser.h>
@@ -2632,6 +2632,19 @@ static int cf_section_read(char const *f
 					}
 					if (*p != '\0') continue;
 
+					/*
+					 *	Ignore config files generated by deb / rpm packaging updates.
+					 */
+					len = strlen(dp->d_name);
+					if ((len > 10) && (strncmp(&dp->d_name[len - 10], ".dpkg-dist", 10) == 0)) {
+					pkg_file:
+						WARN("Ignoring packaging system produced file %s%s", value, dp->d_name);
+					 	continue;
+					}
+					if ((len > 9) && (strncmp(&dp->d_name[len - 9], ".dpkg-old", 9) == 0)) goto pkg_file;
+					if ((len > 7) && (strncmp(&dp->d_name[len - 7], ".rpmnew", 9) == 0)) goto pkg_file;
+					if ((len > 8) && (strncmp(&dp->d_name[len - 8], ".rpmsave", 10) == 0)) goto pkg_file;
+
 					slen = snprintf(buf2, sizeof(buf2), "%s%s",
 							value, dp->d_name);
 					if (slen >= (int) sizeof(buf2) || slen < 0) {
diff -urpN freeradius-server-3.2.7/src/main/evaluate.c freeradius-server-3.2.8/src/main/evaluate.c
--- freeradius-server-3.2.7/src/main/evaluate.c	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/main/evaluate.c	2025-08-20 23:29:15.000000000 +0700
@@ -1,7 +1,7 @@
 /*
  * evaluate.c	Evaluate complex conditions
  *
- * Version:	$Id: c8585b67e0e0940e4bc328d425d7b2ca4d5941ad $
+ * Version:	$Id: 8066c56454e89a676831277b12dd78dc2d53fab7 $
  *
  *   This program is free software; you can redistribute it and/or modify
  *   it under the terms of the GNU General Public License as published by
@@ -21,7 +21,7 @@
  * Copyright 2007  Alan DeKok <aland@deployingradius.com>
  */
 
-RCSID("$Id: c8585b67e0e0940e4bc328d425d7b2ca4d5941ad $")
+RCSID("$Id: 8066c56454e89a676831277b12dd78dc2d53fab7 $")
 
 #include <freeradius-devel/radiusd.h>
 #include <freeradius-devel/modules.h>
@@ -161,8 +161,13 @@ static int cond_do_regex(REQUEST *reques
 	int		ret;
 
 	regex_t		*preg, *rreg = NULL;
+#ifdef HAVE_PCRE2
+	regmatch_t	*rxmatch;
+	size_t		nmatch = REQUEST_MAX_REGEX + 1;
+#else
 	regmatch_t	rxmatch[REQUEST_MAX_REGEX + 1];	/* +1 for %{0} (whole match) capture group */
 	size_t		nmatch = sizeof(rxmatch) / sizeof(regmatch_t);
+#endif
 
 	if (!lhs || (lhs_type != PW_TYPE_STRING)) return -1;
 
@@ -173,7 +178,7 @@ static int cond_do_regex(REQUEST *reques
 	switch (map->rhs->type) {
 	case TMPL_TYPE_REGEX_STRUCT: /* pre-compiled to a regex */
 		preg = map->rhs->tmpl_preg;
-#ifdef HAVE_PCRE
+#if defined(HAVE_PCRE) || defined(HAVE_PCRE2)
 		rad_assert(preg->precompiled);
 #endif
 		break;
@@ -196,6 +201,9 @@ static int cond_do_regex(REQUEST *reques
 		break;
 	}
 
+#ifdef HAVE_PCRE2
+	rxmatch = regex_match_data_alloc(request, REQUEST_MAX_REGEX + 1);
+#endif
 	ret = regex_exec(preg, lhs->strvalue, lhs_len, rxmatch, &nmatch);
 	switch (ret) {
 	case 0:
diff -urpN freeradius-server-3.2.7/src/main/fuzzer.c freeradius-server-3.2.8/src/main/fuzzer.c
--- freeradius-server-3.2.7/src/main/fuzzer.c	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/main/fuzzer.c	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,175 @@
+/*
+ *   This program is free software; you can redistribute it and/or modify
+ *   it under the terms of the GNU General Public License as published by
+ *   the Free Software Foundation; either version 2 of the License, or
+ *   (at your option) any later version.
+ *
+ *   This program is distributed in the hope that it will be useful,
+ *   but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ *   GNU General Public License for more details.
+ *
+ *   You should have received a copy of the GNU General Public License
+ *   along with this program; if not, write to the Free Software
+ *   Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301, USA
+ */
+
+/**
+ * $Id: 93b0e3afb2a6b37c1d929922e957414e46e48942 $
+ *
+ * @file src/main/fuzzer.c
+ * @brief Functions to fuzz protocol decoding
+ *
+ * @copyright 2019 Network RADIUS SAS (legal@networkradius.com)
+ */
+RCSID("$Id: 93b0e3afb2a6b37c1d929922e957414e46e48942 $")
+
+#include <freeradius-devel/radiusd.h>
+
+/*
+ *	Run from the source directory via:
+ *
+ *	./build/make/jlibtool --mode=execute ./build/bin/local/fuzzer_radius -D share/dictionary /path/to/corpus/directory/
+ */
+
+static bool			init = false;
+
+int LLVMFuzzerInitialize(int *argc, char ***argv);
+int LLVMFuzzerTestOneInput(const uint8_t *buf, size_t len);
+
+static void exitHandler(void)
+{
+	dict_free();
+}
+
+int LLVMFuzzerInitialize(int *argc, char ***argv)
+{
+	char const		*dict_dir	= getenv("FR_DICTIONARY_DIR");
+	char const		*debug_lvl_str	= getenv("FR_DEBUG_LVL");
+	char const		*p;
+#ifdef FUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION
+	char			*dict_dir_to_free = NULL;
+#endif
+
+	if (!argc || !argv || !*argv) return -1; /* shut up clang scan */
+
+	if (debug_lvl_str) fr_debug_lvl = atoi(debug_lvl_str);
+
+	/*
+	 *	Initialise the error stack _before_ we run any
+	 *	tests so there's no chance of the memory
+	 *	appearing as a leak the first time an error
+	 *	is generated.
+	 */
+	fr_strerror_printf("fuzz"); /* allocate the pools */
+	fr_strerror_printf(NULL); /* clears the message, leaves the pools */
+
+	/*
+	 *	Setup our own internal atexit handler
+	 */
+	if (atexit(exitHandler)) {
+		fr_perror("fuzzer: Failed to register exit handler: %s", strerror(errno));
+		exit(EXIT_FAILURE);
+	}
+
+	/*
+	 *	Look for -D dir
+	 *
+	 *	If found, nuke it from the argument list.
+	 */
+	if (!dict_dir) {
+		int i, j;
+
+		for (i = 0; i < *argc - 1; i++) {
+			p = (*argv)[i];
+
+			if ((p[0] == '-') && (p[1] == 'D')) {
+				dict_dir = (*argv)[i + 1];
+
+				for (j = i + 2; j < *argc; i++, j++) {
+					(*argv)[i] = (*argv)[j];
+				}
+
+				*argc -= 2;
+				break;
+			}
+		}
+	}
+
+#ifdef FUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION
+	/*
+	 *	oss-fuzz puts the dictionaries, etc. into subdirectories named after the location of the
+	 *	binary.  So we find the directory of the binary, and append "/dict" or "/lib" to find
+	 *	dictionaries and libraries.
+	 */
+	p = strrchr((*argv)[0], '/');
+	if (p) {
+		if (!dict_dir) {
+			dict_dir = dict_dir_to_free = talloc_asprintf(NULL, "%.*s/dict", (int) (p - (*argv)[0]), (*argv)[0]);
+			if (!dict_dir_to_free) fr_exit_now(EXIT_FAILURE);
+		}
+	}
+#endif
+
+	if (!dict_dir) dict_dir = DICTDIR;
+
+	/*
+	 *	When jobs=N is specified the fuzzer spawns worker processes via
+	 *	a shell. We have removed any -D dictdir argument that were
+	 *	supplied, so we pass it to our children via the environment.
+	 */
+	if (setenv("FR_DICTIONARY_DIR", dict_dir, 1)) {
+		fprintf(stderr, "Failed to set FR_DICTIONARY_DIR env variable\n");
+		exit(EXIT_FAILURE);
+	}
+
+	if (dict_init(dict_dir, RADIUS_DICTIONARY) < 0) {
+		fr_perror("fuzzer");
+		exit(EXIT_FAILURE);
+	}
+
+	/*
+	 *	Disable hostname lookups, so we don't produce spurious DNS
+	 *	queries, and there's no chance of spurious failures if
+	 *	it takes a long time to get a response.
+	 */
+	fr_hostname_lookups = fr_dns_lookups = false;
+
+	init = true;
+
+#ifdef FUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION
+	talloc_free(dict_dir_to_free);
+#endif
+
+	return 1;
+}
+
+int LLVMFuzzerTestOneInput(const uint8_t *buf, size_t len)
+{
+	RADIUS_PACKET		*packet;
+
+	if (!init) LLVMFuzzerInitialize(NULL, NULL);
+
+	packet = rad_alloc(NULL, false);
+
+	memcpy(&packet->data, &buf, sizeof(buf)); /* const issues */
+	packet->data_len = len;
+
+	if (rad_packet_ok(packet, 0, NULL)) {
+		(void) rad_decode(packet, NULL, "testing123");
+		if (fr_debug_lvl > 3) vp_printlist(stdout, packet->vps);
+	}
+
+	packet->data = NULL;
+	packet->data_len = 0;
+	talloc_free(packet);
+
+	/*
+	 *	Clear error messages from the run.  Clearing these
+	 *	keeps malloc/free balanced, which helps to avoid the
+	 *	fuzzers leak heuristics from firing.
+	 */
+	fr_strerror_printf(NULL);
+
+	return 0;
+}
diff -urpN freeradius-server-3.2.7/src/main/fuzzer.mk freeradius-server-3.2.8/src/main/fuzzer.mk
--- freeradius-server-3.2.7/src/main/fuzzer.mk	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/main/fuzzer.mk	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,20 @@
+ifneq "$(findstring fuzzer,${CFLAGS})" ""
+TARGET		:= fuzzer
+SOURCES		:= fuzzer.c
+
+TGT_INSTALLDIR  :=
+TGT_LDLIBS	:= $(LIBS)
+TGT_PREREQS	:= libfreeradius-radius.a
+
+fuzzer.run: $(BUILD_DIR)/bin/fuzzer
+	${Q}./build/make/jlibtool --mode=execute ./build/bin/local/fuzzer \
+	-artifact_prefix=src/tests/fuzzer/ \
+	-max_len=512 \
+	-D share \
+	src/tests/fuzzer
+
+.PHONY: fuzzer.help
+fuzzer.help:
+	@echo ./build/make/jlibtool --mode=execute ./build/bin/local/fuzzer -max_len=512 -D share src/tests/fuzzer
+
+endif
diff -urpN freeradius-server-3.2.7/src/main/listen.c freeradius-server-3.2.8/src/main/listen.c
--- freeradius-server-3.2.7/src/main/listen.c	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/main/listen.c	2025-08-20 23:29:15.000000000 +0700
@@ -1,7 +1,7 @@
 /*
  * listen.c	Handle socket stuff
  *
- * Version:	$Id: b817248d71906f14efa7951157207268d268b104 $
+ * Version:	$Id: 6d578999ab15ed4be1a1c47e757f12bc15d37161 $
  *
  *   This program is free software; you can redistribute it and/or modify
  *   it under the terms of the GNU General Public License as published by
@@ -21,7 +21,7 @@
  * Copyright 2005  Alan DeKok <aland@ox.org>
  */
 
-RCSID("$Id: b817248d71906f14efa7951157207268d268b104 $")
+RCSID("$Id: 6d578999ab15ed4be1a1c47e757f12bc15d37161 $")
 
 #include <freeradius-devel/radiusd.h>
 #include <freeradius-devel/modules.h>
@@ -279,13 +279,19 @@ RADCLIENT *client_listener_find(rad_list
 
 	request->listener = listener;
 	request->client = client;
-	request->packet = rad_recv(NULL, listener->fd, 0x02); /* MSG_PEEK */
+
+	request->packet = rad_alloc(request, false);
 	if (!request->packet) {				/* badly formed, etc */
 		talloc_free(request);
 		if (DEBUG_ENABLED) ERROR("Receive - %s", fr_strerror());
 		goto unknown;
 	}
-	(void) talloc_steal(request, request->packet);
+	request->packet->src_ipaddr = *ipaddr;
+	request->packet->src_port = src_port;
+	request->packet->dst_ipaddr = sock->my_ipaddr;
+	request->packet->dst_port = sock->my_port;
+	request->packet->proto = sock->proto;
+
 	request->reply = rad_alloc_reply(request, request->packet);
 	if (!request->reply) {
 		talloc_free(request);
@@ -569,6 +575,8 @@ static void blastradius_checks(RADIUS_PA
 			/*
 			 *	Don't change it from "auto" for wildcard clients.
 			 */
+			DEBUG("BlastRADIUS check: Received packet with Message-Authenticator.");
+			DEBUG("NOT changing \"require_message_authenticator\" flag for client %s with IP/mask", client->shortname);
 			return;
 
 		} else {
@@ -1151,7 +1159,7 @@ static int dual_tcp_accept(rad_listen_t
 		switch (listener->tls->radiusv11) {
 		case FR_RADIUSV11_FORBID:
 			if (client->radiusv11 == FR_RADIUSV11_REQUIRE) {
-				INFO("Ignoring new connection as client is marked as 'radiusv11 = require', and this socket has 'radiusv11 = forbid'");
+				RATE_LIMIT(INFO("Ignoring new connection from client %s it is marked as 'radiusv11 = require', and this socket has 'radiusv11 = forbid'", client->shortname));
 				close(newfd);
 				return 0;
 			}
@@ -1165,7 +1173,7 @@ static int dual_tcp_accept(rad_listen_t
 
 		case FR_RADIUSV11_REQUIRE:
 			if (client->radiusv11 == FR_RADIUSV11_FORBID) {
-				INFO("Ignoring new connection as client is marked as 'radiusv11 = forbid', and this socket has 'radiusv11 = require'");
+				RATE_LIMIT(INFO("Ignoring new connection from client %s as it is marked as 'radiusv11 = forbid', and this socket has 'radiusv11 = require'", client->shortname));
 				close(newfd);
 				return 0;
 			}
@@ -1184,7 +1192,7 @@ static int dual_tcp_accept(rad_listen_t
 		/*
 		 *	FIXME: Print client IP/port, and server IP/port.
 		 */
-		INFO("Ignoring new connection due to client max_connections (%d)", client->limit.max_connections);
+		RATE_LIMIT(INFO("Ignoring new connection from client %s due to client max_connections (%d)", client->shortname, client->limit.max_connections));
 		close(newfd);
 		return 0;
 	}
@@ -1195,7 +1203,7 @@ static int dual_tcp_accept(rad_listen_t
 		/*
 		 *	FIXME: Print client IP/port, and server IP/port.
 		 */
-		INFO("Ignoring new connection due to socket max_connections");
+		RATE_LIMIT(INFO("Ignoring new connection from client %s due to socket max_connections (%d)", client->shortname, sock->limit.num_connections));
 		close(newfd);
 		return 0;
 	}
@@ -3662,18 +3670,6 @@ rad_listen_t *proxy_new_listener(TALLOC_
 	if ((home->proto == IPPROTO_TCP) && home->tls) {
 		DEBUG("(TLS) Trying new outgoing proxy connection to %s", buffer);
 
-		/*
-		 *	Set SNI, if configured.
-		 *
-		 *	The OpenSSL API says the filename is "char
-		 *	const *", but some versions have it as "void
-		 *	*", without the "const".  So we un-const it
-		 *	here through various C magic.
-		 */
-		if (home->tls->client_hostname) {
-			(void) SSL_set_tlsext_host_name(sock->ssn->ssl, (void *) (uintptr_t) home->tls->client_hostname);
-		}
-
 #ifdef WITH_RADIUSV11
 		this->radiusv11 = home->tls->radiusv11;
 #endif
diff -urpN freeradius-server-3.2.7/src/main/log.c freeradius-server-3.2.8/src/main/log.c
--- freeradius-server-3.2.7/src/main/log.c	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/main/log.c	2025-08-20 23:29:15.000000000 +0700
@@ -15,7 +15,7 @@
  */
 
 /**
- * $Id: 1ca2f914c258f3c199274421d7d2e2c96e747b18 $
+ * $Id: cc31fdd0361868c7afdef53f97125426e861b3e3 $
  *
  * @brief Logging functions used by the server core.
  * @file main/log.c
@@ -25,7 +25,7 @@
  * @copyright 2000  Alan DeKok <aland@ox.org>
  * @copyright 2001  Chad Miller <cmiller@surfsouth.com>
  */
-RCSID("$Id: 1ca2f914c258f3c199274421d7d2e2c96e747b18 $")
+RCSID("$Id: cc31fdd0361868c7afdef53f97125426e861b3e3 $")
 
 #include <freeradius-devel/radiusd.h>
 #include <freeradius-devel/rad_assert.h>
@@ -219,6 +219,7 @@ fr_log_t default_log = {
 	.dst = L_DST_STDOUT,
 	.file = NULL,
 	.debug_file = NULL,
+	.timestamp = false,
 };
 
 static int stderr_fd = -1;	//!< The original unmolested stderr file descriptor
@@ -401,7 +402,7 @@ int vradlog(log_type_t type, char const
 	 *	of debugging.
 	 */
 	if (default_log.dst != L_DST_SYSLOG) {
-		if ((rad_debug_lvl != 1) && (rad_debug_lvl != 2)) {
+		if (((rad_debug_lvl != 1) && (rad_debug_lvl != 2)) || default_log.timestamp) {
 			time_t timeval;
 
 			timeval = time(NULL);
diff -urpN freeradius-server-3.2.7/src/main/mainconfig.c freeradius-server-3.2.8/src/main/mainconfig.c
--- freeradius-server-3.2.7/src/main/mainconfig.c	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/main/mainconfig.c	2025-08-20 23:29:15.000000000 +0700
@@ -1,7 +1,7 @@
 /*
  * mainconf.c	Handle the server's configuration.
  *
- * Version:	$Id: debfb296f030b4f336551d161b0babcb41833aa1 $
+ * Version:	$Id: 3e073b08413439e481a386431e6d17a61591741e $
  *
  *   This program is free software; you can redistribute it and/or modify
  *   it under the terms of the GNU General Public License as published by
@@ -21,7 +21,7 @@
  * Copyright 2002  Alan DeKok <aland@ox.org>
  */
 
-RCSID("$Id: debfb296f030b4f336551d161b0babcb41833aa1 $")
+RCSID("$Id: 3e073b08413439e481a386431e6d17a61591741e $")
 
 #include <freeradius-devel/radiusd.h>
 #include <freeradius-devel/modules.h>
@@ -49,6 +49,10 @@ extern fr_cond_t	*debug_condition;
 fr_cond_t		*debug_condition = NULL;			//!< Condition used to mark packets up for checking.
 bool			event_loop_started = false;		//!< Whether the main event loop has been started yet.
 
+#ifdef HAVE_PCRE2
+#  include <freeradius-devel/regex.h>
+#endif
+
 typedef struct cached_config_t {
 	struct cached_config_t *next;
 	time_t		created;
@@ -201,6 +205,7 @@ static const CONF_PARSER log_config[] =
 	{ "use_utc", FR_CONF_POINTER(PW_TYPE_BOOLEAN, &log_dates_utc), NULL },
 	{ "msg_denied", FR_CONF_POINTER(PW_TYPE_STRING, &main_config.denied_msg), "You are already logged in - access denied" },
 	{ "suppress_secrets", FR_CONF_POINTER(PW_TYPE_BOOLEAN, &main_config.suppress_secrets), NULL },
+	{ "timestamp", FR_CONF_POINTER(PW_TYPE_BOOLEAN, &default_log.timestamp), NULL },
 	CONF_PARSER_TERMINATOR
 };
 
@@ -211,6 +216,7 @@ static const CONF_PARSER log_config[] =
 static const CONF_PARSER security_config[] = {
 	{ "max_attributes",  FR_CONF_POINTER(PW_TYPE_INTEGER, &fr_max_attributes), STRINGIFY(0) },
 	{ "reject_delay",  FR_CONF_POINTER(PW_TYPE_TIMEVAL, &main_config.reject_delay), STRINGIFY(0) },
+	{ "delay_proxy_rejects",  FR_CONF_POINTER(PW_TYPE_BOOLEAN, &main_config.delay_proxy_rejects), "no" },
 	{ "status_server", FR_CONF_POINTER(PW_TYPE_BOOLEAN, &main_config.status_server), "no"},
 	{ "require_message_authenticator", FR_CONF_POINTER(PW_TYPE_STRING, &require_message_authenticator), "auto"},
 	{ "limit_proxy_state", FR_CONF_POINTER(PW_TYPE_STRING, &limit_proxy_state), "auto"},
@@ -1214,11 +1220,15 @@ do {\
 	FR_INTEGER_COND_CHECK("max_request_time", main_config.max_request_time,
 			      (main_config.max_request_time != 0), 100);
 
+#ifndef USEC
+#define USEC (1000000)
+#endif
+
 	/*
 	 *	reject_delay can be zero.  OR 1 though 10.
 	 */
 	if ((main_config.reject_delay.tv_sec != 0) || (main_config.reject_delay.tv_usec != 0)) {
-		FR_TIMEVAL_BOUND_CHECK("reject_delay", &main_config.reject_delay, >=, 1, 0);
+		FR_TIMEVAL_BOUND_CHECK("reject_delay", &main_config.reject_delay, >=, 0, USEC / 2);
 	}
 
 	FR_INTEGER_BOUND_CHECK("proxy_dedup_window", main_config.proxy_dedup_window, <=, 10);
@@ -1334,6 +1344,19 @@ do {\
 	rad_assert(cs_cache == NULL);
 	cs_cache = cc;
 
+#ifdef HAVE_PCRE2
+	/*
+	 *	If pcre2 is being used for regex, we need to set up a global context
+	 *	to use our alloc / free routines.
+	 *	Since this is a library rather than module specific, it can't be done
+	 *	with a module bootstrap.
+	 */
+	if (fr_pcre2_gcontext_setup() < 0) {
+		ERROR("Failed creating pcre2 general context");
+		return -1;
+	}
+#endif
+
 	/* Clear any unprocessed configuration errors */
 	(void) fr_strerror();
 
@@ -1347,6 +1370,9 @@ int main_config_free(void)
 {
 	virtual_servers_free(0);
 
+#ifdef HAVE_PCRE2
+	fr_pcre2_gcontext_free();
+#endif
 	/*
 	 *	Clean up the configuration data
 	 *	structures.
diff -urpN freeradius-server-3.2.7/src/main/map.c freeradius-server-3.2.8/src/main/map.c
--- freeradius-server-3.2.7/src/main/map.c	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/main/map.c	2025-08-20 23:29:15.000000000 +0700
@@ -15,7 +15,7 @@
  */
 
 /*
- * $Id: 34683a2e1295282d2d6ae05e360412df6d83c667 $
+ * $Id: e8da0be78c408b580a83aa6f367cbfce27fe2d44 $
  *
  * @brief map / template functions
  * @file main/map.c
@@ -26,7 +26,7 @@
  * @copyright 2013  Alan DeKok <aland@freeradius.org>
  */
 
-RCSID("$Id: 34683a2e1295282d2d6ae05e360412df6d83c667 $")
+RCSID("$Id: e8da0be78c408b580a83aa6f367cbfce27fe2d44 $")
 
 #include <freeradius-devel/radiusd.h>
 #include <freeradius-devel/rad_assert.h>
@@ -271,6 +271,11 @@ int map_afrom_cp(TALLOC_CTX *ctx, vp_map
 			goto error;
 		}
 
+		if ((map->lhs->tmpl_tag == TAG_VALUE) &&
+		    ((map->op == T_OP_CMP_FALSE) || (map->op == T_OP_CMP_TRUE) || (map->op == T_OP_SUB))) {
+			cf_log_err_cp(cp, "Cannot use ':V' for this operator");
+			goto error;
+		}
 		break;
 	}
 
@@ -297,6 +302,24 @@ int map_afrom_cp(TALLOC_CTX *ctx, vp_map
 		goto error;
 	}
 
+	/*
+	 *	For :V, enforce / verify limits on the RHS.
+	 */
+	if ((map->lhs->type == TMPL_TYPE_ATTR) && (map->lhs->tmpl_tag == TAG_VALUE)) {
+		fr_assert(map->lhs->tmpl_da->flags.has_tag);
+
+		switch (map->rhs->type) {
+		case TMPL_TYPE_XLAT_STRUCT:
+		case TMPL_TYPE_XLAT:
+		case TMPL_TYPE_LITERAL:
+			break;
+
+		default:
+			cf_log_err_cp(cp, "Cannot use ':V' for tags here.");
+			goto error;
+		}
+	}
+
 	if (map->rhs->type == TMPL_TYPE_ATTR) {
 		/*
 		 *	We cannot assign a count to an attribute.  That must
@@ -725,8 +748,10 @@ static int map_exec_to_vp(TALLOC_CTX *ct
 
 		vp = fr_pair_afrom_da(ctx, map->lhs->tmpl_da);
 		if (!vp) return -1;
+
 		vp->op = map->op;
 		vp->tag = map->lhs->tmpl_tag;
+
 		if (fr_pair_value_from_str(vp, answer, -1) < 0) {
 			fr_pair_list_free(&vp);
 			return -2;
@@ -835,14 +860,15 @@ int map_to_vp(TALLOC_CTX *ctx, VALUE_PAI
 		RDEBUG2("EXPAND %s", map->rhs->name);
 		RDEBUG2("   --> %s", str);
 
+		new->op = map->op;
+		new->tag = map->lhs->tmpl_tag;
+
 		rcode = fr_pair_value_from_str(new, str, -1);
 		talloc_free(str);
 		if (rcode < 0) {
 			fr_pair_list_free(&new);
 			goto error;
 		}
-		new->op = map->op;
-		new->tag = map->lhs->tmpl_tag;
 		*out = new;
 		break;
 
@@ -860,14 +886,15 @@ int map_to_vp(TALLOC_CTX *ctx, VALUE_PAI
 			goto error;
 		}
 
+		new->op = map->op;
+		new->tag = map->lhs->tmpl_tag;
+
 		rcode = fr_pair_value_from_str(new, str, -1);
 		talloc_free(str);
 		if (rcode < 0) {
 			fr_pair_list_free(&new);
 			goto error;
 		}
-		new->op = map->op;
-		new->tag = map->lhs->tmpl_tag;
 		*out = new;
 		break;
 
@@ -878,12 +905,13 @@ int map_to_vp(TALLOC_CTX *ctx, VALUE_PAI
 		new = fr_pair_afrom_da(ctx, map->lhs->tmpl_da);
 		if (!new) return -1;
 
+		new->op = map->op;
+		new->tag = map->lhs->tmpl_tag;
+
 		if (fr_pair_value_from_str(new, map->rhs->name, -1) < 0) {
 			rcode = 0;
 			goto error;
 		}
-		new->op = map->op;
-		new->tag = map->lhs->tmpl_tag;
 		*out = new;
 		break;
 
@@ -914,6 +942,10 @@ int map_to_vp(TALLOC_CTX *ctx, VALUE_PAI
 				new = fr_pair_afrom_da(ctx, map->lhs->tmpl_da);
 				if (!new) return -1;
 
+				new->op = map->op;
+				new->tag = map->lhs->tmpl_tag;
+				fr_assert(new->tag != TAG_VALUE);
+
 				len = value_data_cast(new, &new->data, new->da->type, new->da,
 						      vp->da->type, vp->da, &vp->data, vp->vp_length);
 				if (len < 0) {
@@ -931,8 +963,6 @@ int map_to_vp(TALLOC_CTX *ctx, VALUE_PAI
 					rad_assert(new->vp_strvalue != NULL);
 				}
 
-				new->op = map->op;
-				new->tag = map->lhs->tmpl_tag;
 				fr_cursor_insert(&to, new);
 			}
 			return 0;
@@ -942,6 +972,7 @@ int map_to_vp(TALLOC_CTX *ctx, VALUE_PAI
 		 *   Otherwise we just need to fixup the attribute types
 		 *   and operators
 		 */
+		fr_assert(map->lhs->tmpl_tag != TAG_VALUE);
 		for (; vp; vp = fr_cursor_next(&from)) {
 			vp->da = map->lhs->tmpl_da;
 			vp->op = map->op;
@@ -959,15 +990,16 @@ int map_to_vp(TALLOC_CTX *ctx, VALUE_PAI
 		new = fr_pair_afrom_da(ctx, map->lhs->tmpl_da);
 		if (!new) return -1;
 
+		new->op = map->op;
+		new->tag = map->lhs->tmpl_tag;
+		fr_assert(new->tag != TAG_VALUE);
+
 		len = value_data_copy(new, &new->data, new->da->type, &map->rhs->tmpl_data_value,
 				      map->rhs->tmpl_data_length);
 		if (len < 0) goto error;
 
 		new->vp_length = len;
-		new->op = map->op;
-		new->tag = map->lhs->tmpl_tag;
 		*out = new;
-
 		VERIFY_MAP(map);
 		break;
 
@@ -1331,7 +1363,7 @@ int map_to_request(REQUEST *request, vp_
 	/*
 	 *	Another fixup pass to set tags on attributes were about to insert
 	 */
-	if (map->lhs->tmpl_tag != TAG_ANY) {
+	if (TAG_VALID(map->lhs->tmpl_tag)) {
 		for (vp = fr_cursor_init(&src_list, &head);
 		     vp;
 		     vp = fr_cursor_next(&src_list)) {
diff -urpN freeradius-server-3.2.7/src/main/modcall.c freeradius-server-3.2.8/src/main/modcall.c
--- freeradius-server-3.2.7/src/main/modcall.c	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/main/modcall.c	2025-08-20 23:29:15.000000000 +0700
@@ -1,7 +1,7 @@
 /*
  * @name modcall.c
  *
- * Version:	$Id: 29fc2be1b9912c51affbe05ab1300630008c6dbd $
+ * Version:	$Id: 3ad581e8b160379d0f135ba17f94f4f850f41025 $
  *
  *   This program is free software; you can redistribute it and/or modify
  *   it under the terms of the GNU General Public License as published by
@@ -20,7 +20,7 @@
  * Copyright 2000,2006  The FreeRADIUS server project
  */
 
-RCSID("$Id: 29fc2be1b9912c51affbe05ab1300630008c6dbd $")
+RCSID("$Id: 3ad581e8b160379d0f135ba17f94f4f850f41025 $")
 
 #include <freeradius-devel/radiusd.h>
 #include <freeradius-devel/modpriv.h>
@@ -1688,9 +1688,54 @@ int modcall_fixup_update(vp_map_t *map,
 				}
 				talloc_free(vpt);
 
-			} else if (tmpl_cast_in_place(map->rhs, map->lhs->tmpl_da->type, map->lhs->tmpl_da) < 0) {
-				cf_log_err(map->ci, "%s", fr_strerror());
-				return -1;
+			} else if (map->lhs->tmpl_tag != TAG_VALUE) {
+			do_cast:
+				if (tmpl_cast_in_place(map->rhs, map->lhs->tmpl_da->type, map->lhs->tmpl_da) < 0) {
+					cf_log_err(map->ci, "%s", fr_strerror());
+					return -1;
+				}
+
+			} else if (map->rhs->name[0] != ':') {
+				map->lhs->tmpl_tag = TAG_NONE; /* no tag, just do the cast */
+				goto do_cast;
+
+			} else {
+				ssize_t ret;
+				long num;
+				char const *p = map->rhs->name;
+				char *end;
+				vp_tmpl_t *vpt;
+
+				num = strtol(p + 1, &end, 10);
+				if ((num > 0x1f) || (num < 0)) {
+					cf_log_err(map->ci, "Invalid tag value '%li' (should be between 0-31)", num);
+					return -1;
+				}
+
+				if (*end && (*end != ':')) {
+					cf_log_err(map->ci, "Invalid tag is missing trailing ':'");
+					return -1;
+				}
+
+				map->lhs->tmpl_tag = num;
+				vpt = map->rhs;
+				vpt->tmpl_data_type = map->lhs->tmpl_da->type;
+
+				/*
+				 *	Just to tmpl_cast_in_place()
+				 *	ourselves, rather than mucking
+				 *	with strings.
+				 */
+				ret = value_data_from_str(vpt, &vpt->tmpl_data_value,
+							  &vpt->tmpl_data_type, map->lhs->tmpl_da,
+							  end + 1, strlen(end + 1), '\0');
+				if (ret < 0) {
+					cf_log_err(map->ci, "%s", fr_strerror());
+					return -1;
+				}
+
+				vpt->type = TMPL_TYPE_DATA;
+				vpt->tmpl_data_length = (size_t) ret;
 			}
 
 			/*
@@ -1734,7 +1779,7 @@ static modcallable *do_compile_modupdate
 	if (rcode < 0) return NULL; /* message already printed */
 	if (!head) {
 		cf_log_err_cs(cs, "'update' sections cannot be empty");
-		return NULL;
+		cf_log_err_cs(cs, DOC_KEYWORD_REF(update));
 	}
 
 	g = talloc_zero(parent, modgroup);
@@ -1777,12 +1822,14 @@ static modcallable *do_compile_modswitch
 	name2 = cf_section_name2(cs);
 	if (!name2) {
 		cf_log_err_cs(cs, "You must specify a variable to switch over for 'switch'");
+	print_url:
+		cf_log_err_cs(cs, DOC_KEYWORD_REF(switch));
 		return NULL;
 	}
 
 	if (!cf_item_find_next(cs, NULL)) {
 		cf_log_err_cs(cs, "'switch' statements cannot be empty");
-		return NULL;
+		goto print_url;
 	}
 
 	/*
@@ -1805,7 +1852,7 @@ static modcallable *do_compile_modswitch
 		talloc_free(spaces);
 		talloc_free(text);
 
-		return NULL;
+		goto print_url;
 	}
 
 	/*
@@ -1815,7 +1862,7 @@ static modcallable *do_compile_modswitch
 
 	if (vpt->type == TMPL_TYPE_LIST) {
 		cf_log_err_cs(cs, "Syntax error: Cannot switch over list '%s'", name2);
-		return NULL;
+		goto print_url;
 	}
 
 	/*
@@ -1842,7 +1889,7 @@ static modcallable *do_compile_modswitch
 
 			cf_log_err(ci, "\"switch\" sections can only have \"case\" subsections");
 			talloc_free(vpt);
-			return NULL;
+			goto print_url;
 		}
 
 		subcs = cf_item_to_section(ci);	/* can't return NULL */
@@ -1851,7 +1898,7 @@ static modcallable *do_compile_modswitch
 		if (strcmp(name1, "case") != 0) {
 			cf_log_err(ci, "\"switch\" sections can only have \"case\" subsections");
 			talloc_free(vpt);
-			return NULL;
+			goto print_url;
 		}
 
 		name2 = cf_section_name2(subcs);
@@ -1863,7 +1910,7 @@ static modcallable *do_compile_modswitch
 
 			cf_log_err(ci, "Cannot have two 'default' case statements");
 			talloc_free(vpt);
-			return NULL;
+			goto print_url;
 		}
 	}
 
@@ -1919,6 +1966,7 @@ static modcallable *do_compile_modcase(m
 			talloc_free(spaces);
 			talloc_free(text);
 
+			cf_log_err_cs(cs, DOC_KEYWORD_REF(case));
 			return NULL;
 		}
 
@@ -1986,6 +2034,8 @@ static modcallable *do_compile_modforeac
 
 	if (!cf_item_find_next(cs, NULL)) {
 		cf_log_err_cs(cs, "'foreach' blocks cannot be empty");
+	print_url:
+		cf_log_err_cs(cs, DOC_KEYWORD_REF(forach));
 		return NULL;
 	}
 
@@ -2009,7 +2059,7 @@ static modcallable *do_compile_modforeac
 		talloc_free(spaces);
 		talloc_free(text);
 
-		return NULL;
+		goto print_url;
 	}
 
 	/*
@@ -2020,7 +2070,7 @@ static modcallable *do_compile_modforeac
 
 	if ((vpt->type != TMPL_TYPE_ATTR) && (vpt->type != TMPL_TYPE_LIST)) {
 		cf_log_err_cs(cs, "MUST use attribute or list reference in 'foreach'");
-		return NULL;
+		goto print_url;
 	}
 
 	/*
@@ -2060,6 +2110,7 @@ static modcallable *do_compile_modbreak(
 
 	if (!cs) {
 		cf_log_err(ci, "'break' can only be used in a 'foreach' section");
+		cf_log_err(ci, DOC_KEYWORD_REF(break));
 		return NULL;
 	}
 
@@ -2319,6 +2370,7 @@ static modcallable *do_compile_modsingle
 			*modname = name2;
 
 			if (!all_children_are_modules(cs, modrefname)) {
+				cf_log_err_cs(cs, DOC_KEYWORD_REF(redundant));
 				return NULL;
 			}
 
@@ -2330,6 +2382,7 @@ static modcallable *do_compile_modsingle
 			*modname = name2;
 
 			if (!all_children_are_modules(cs, modrefname)) {
+				cf_log_err_cs(cs, DOC_KEYWORD_REF(load-balance));
 				return NULL;
 			}
 
@@ -2341,6 +2394,7 @@ static modcallable *do_compile_modsingle
 			*modname = name2;
 
 			if (!all_children_are_modules(cs, modrefname)) {
+				cf_log_err_cs(cs, DOC_KEYWORD_REF(redundant-load-balance));
 				return NULL;
 			}
 
@@ -2352,6 +2406,7 @@ static modcallable *do_compile_modsingle
 		} else 	if (strcmp(modrefname, "if") == 0) {
 			if (!cf_section_name2(cs)) {
 				cf_log_err(ci, "'if' without condition");
+				cf_log_err(ci, DOC_KEYWORD_REF(if));
 				return NULL;
 			}
 
@@ -2369,11 +2424,13 @@ static modcallable *do_compile_modsingle
 			    ((parent->type == MOD_LOAD_BALANCE) ||
 			     (parent->type == MOD_REDUNDANT_LOAD_BALANCE))) {
 				cf_log_err(ci, "'elsif' cannot be used in this section");
+				cf_log_err(ci, DOC_KEYWORD_REF(elsif));
 				return NULL;
 			}
 
 			if (!cf_section_name2(cs)) {
 				cf_log_err(ci, "'elsif' without condition");
+				cf_log_err(ci, DOC_KEYWORD_REF(elsif));
 				return NULL;
 			}
 
@@ -2387,11 +2444,13 @@ static modcallable *do_compile_modsingle
 			    ((parent->type == MOD_LOAD_BALANCE) ||
 			     (parent->type == MOD_REDUNDANT_LOAD_BALANCE))) {
 				cf_log_err(ci, "'else' cannot be used in this section section");
+				cf_log_err_cs(cs, DOC_KEYWORD_REF(else));
 				return NULL;
 			}
 
 			if (cf_section_name2(cs)) {
 				cf_log_err(ci, "Cannot have conditions on 'else'");
+				cf_log_err(ci, DOC_KEYWORD_REF(else));
 				return NULL;
 			}
 
@@ -2472,6 +2531,7 @@ static modcallable *do_compile_modsingle
 	if (strcmp(modrefname, "return") == 0) {
 		if (!cf_item_is_pair(ci)) {
 			cf_log_err(ci, "Invalid use of 'return' as section name.");
+			cf_log_err(ci, DOC_KEYWORD_REF(return));
 			return NULL;
 		}
 
diff -urpN freeradius-server-3.2.7/src/main/modules.c freeradius-server-3.2.8/src/main/modules.c
--- freeradius-server-3.2.7/src/main/modules.c	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/main/modules.c	2025-08-20 23:29:15.000000000 +0700
@@ -1,7 +1,7 @@
 /*
  * modules.c	Radius module support.
  *
- * Version:	$Id: 8f83690b6b4c322aeb3edee38695f141f29cfed6 $
+ * Version:	$Id: c3a4c3deb7ed84332387253a8d35597074095a06 $
  *
  *   This program is free software; you can redistribute it and/or modify
  *   it under the terms of the GNU General Public License as published by
@@ -22,7 +22,7 @@
  * Copyright 2000  Alan Curry <pacman@world.std.com>
  */
 
-RCSID("$Id: 8f83690b6b4c322aeb3edee38695f141f29cfed6 $")
+RCSID("$Id: c3a4c3deb7ed84332387253a8d35597074095a06 $")
 
 #include <freeradius-devel/radiusd.h>
 #include <freeradius-devel/modpriv.h>
@@ -2294,3 +2294,66 @@ rlm_rcode_t process_send_coa(int send_co
 	return indexed_modcall(MOD_SEND_COA, send_coa_type, request);
 }
 #endif
+
+int virtual_server_sanity_check(REQUEST *request)
+{
+	virtual_server_t *server;
+
+	server = virtual_server_find(request->server);
+	if (!server) {
+		RDEBUG("No such virtual server \"%s\"", request->server);
+		return -1;
+	}
+
+	switch (request->packet->code) {
+	case PW_CODE_ACCESS_REQUEST:
+		if (!server->mc[MOD_AUTHORIZE] &&
+		    !server->mc[MOD_AUTHENTICATE] &&
+		    !server->mc[MOD_POST_AUTH]) {
+			REDEBUG("The virtual server %s is missing ALL of the 'authorize', 'authenticate', and 'post-auth' sections.", server->name);
+			REDEBUG("Please either update the 'listen' section so that it does not receive Access-Request packets,");
+			REDEBUG("or, add those sections back into the virtual server.");
+			RDEBUG("The server WILL NOT be able to process Access-Request packets until the configuration is fixed.");
+			return -1;
+		}
+		break;
+
+	case PW_CODE_ACCOUNTING_REQUEST:
+		if (!server->mc[MOD_PREACCT] &&
+		    !server->mc[MOD_ACCOUNTING]) {
+			REDEBUG("The virtual server %s is missing ALL of the 'preacct' and 'accounting' sections.", server->name);
+			REDEBUG("Please either update the 'listen' section so that it does not receive Accounting-Request packets,");
+			REDEBUG("or, add those sections back into the virtual server.");
+			RDEBUG("The server WILL NOT be able to process Accounting-Request packets until the configuration is fixed.");
+			return -1;
+		}
+		break;
+
+	case PW_CODE_COA_REQUEST:
+		if (!server->mc[MOD_RECV_COA] &&
+		    !server->mc[MOD_SEND_COA]) {
+			REDEBUG("The virtual server %s is missing ALL of the 'recv-coa' and 'send-coa' sections.", server->name);
+			REDEBUG("Please either update the 'listen' section so that it does not receive CoA-Request packets,");
+			REDEBUG("or, add those sections back into the virtual server.");
+			RDEBUG("The server WILL NOT be able to process CoA-Request packets until the configuration is fixed.");
+			return -1;
+		}
+		break;
+
+	case PW_CODE_DISCONNECT_REQUEST:
+		if (!server->mc[MOD_RECV_COA] &&
+		    !server->mc[MOD_SEND_COA]) {
+			REDEBUG("The virtual server %s is missing ALL of the 'recv-coa' and 'send-coa' sections.", server->name);
+			REDEBUG("Please either update the 'listen' section so that it does not receive Disconnect-Request packets,");
+			REDEBUG("or, add those sections back into the virtual server.");
+			RDEBUG("The server WILL NOT be able to process Disconnect-Request packets until the configuration is fixed.");
+			return -1;
+		}
+		break;
+
+	default:
+		break;
+	}
+
+	return 0;
+}
diff -urpN freeradius-server-3.2.7/src/main/process.c freeradius-server-3.2.8/src/main/process.c
--- freeradius-server-3.2.7/src/main/process.c	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/main/process.c	2025-08-20 23:29:15.000000000 +0700
@@ -15,7 +15,7 @@
  */
 
 /**
- * $Id: 9753792f95f5f10f870ef03e03bbf51293a0a0a5 $
+ * $Id: df02f2ff3937c408e7e820b129c5c3727d2c8d80 $
  *
  * @file process.c
  * @brief Defines the state machines that control how requests are processed.
@@ -24,7 +24,7 @@
  * @copyright 2012  Alan DeKok <aland@deployingradius.com>
  */
 
-RCSID("$Id: 9753792f95f5f10f870ef03e03bbf51293a0a0a5 $")
+RCSID("$Id: df02f2ff3937c408e7e820b129c5c3727d2c8d80 $")
 
 #include <freeradius-devel/radiusd.h>
 #include <freeradius-devel/process.h>
@@ -1495,7 +1495,7 @@ static void request_finish(REQUEST *requ
 	else if (request->packet->code == PW_CODE_ACCESS_REQUEST) {
 		if (request->reply->code == 0) {
 			vp = fr_pair_find_by_num(request->config, PW_AUTH_TYPE, 0, TAG_ANY);
-			if (!vp || (vp->vp_integer != 5)) {
+			if (!vp) {
 				RDEBUG2("There was no response configured: "
 					"rejecting request");
 			}
@@ -1606,7 +1606,7 @@ static void request_finish(REQUEST *requ
 	 */
 	if ((request->packet->code == PW_CODE_ACCESS_REQUEST) &&
 	    (request->reply->code == PW_CODE_ACCESS_REJECT) &&
-	    (request->root->reject_delay.tv_sec > 0)) {
+	    ((request->root->reject_delay.tv_sec > 0) || (request->root->reject_delay.tv_usec > 0))) {
 		request->response_delay = request->root->reject_delay;
 
 		vp = fr_pair_find_by_num(request->reply->vps, PW_FREERADIUS_RESPONSE_DELAY, 0, TAG_ANY);
@@ -1640,11 +1640,36 @@ static void request_finish(REQUEST *requ
 		 *	adding their own reject delay, which would
 		 *	result in N*reject_delays being applied.
 		 */
-		if (request->proxy && (!request->proxy_reply || request->proxy->dst_port != 0)) {
+		if (request->proxy && !request->root->delay_proxy_rejects &&
+		    (!request->proxy_reply || request->proxy->dst_port != 0)) {
 			request->response_delay.tv_sec = 0;
 			request->response_delay.tv_usec = 0;
 		}
 #endif
+
+		/*
+		 *	We want to delay for AT LEAST the delay.  We
+		 *	don't want to ADD in the delay.
+		 */
+		if ((request->response_delay.tv_sec != 0) ||
+		    (request->response_delay.tv_usec != 0)) {
+			struct timeval when;
+
+			/*
+			 *	if ((received time + delay) < now) {
+			 *		send packet
+			 *	else
+			 *		delay = (received time + delay) - now
+			 */
+			timeradd(&request->packet->timestamp, &request->response_delay, &when);
+
+			if (timercmp(&when, &request->reply->timestamp, <=)) {
+				request->response_delay.tv_sec = 0;
+				request->response_delay.tv_usec = 0;
+			} else {
+				timersub(&when, &request->reply->timestamp, &request->response_delay);
+			}
+		}
 	}
 
 	/*
@@ -2121,6 +2146,13 @@ static REQUEST *request_setup(TALLOC_CTX
 		request->server = NULL;
 	}
 
+	if (fr_debug_lvl) {
+		if (virtual_server_sanity_check(request) < 0) {
+			talloc_free(request);
+			return NULL;
+		}
+	}
+
 	request->root = &main_config;
 #ifdef WITH_TCP
 	request->listener->count++;
@@ -2774,6 +2806,24 @@ static int process_proxy_reply(REQUEST *
 		return 0;
 	}
 
+	/*
+	 *	If we have affinity, then maybe update State.  But
+	 *	only for Access-Request, and only if there's a State
+	 *	attribute in the reply.
+	 */
+	if (request->home_pool && request->home_pool->affinity_group &&
+	    (request->reply->code == PW_CODE_ACCESS_CHALLENGE) &&
+	    ((vp = fr_pair_find_by_num(request->reply->vps, PW_STATE, 0, TAG_ANY)) != NULL)) {
+		uint8_t *src;
+
+		src = talloc_array(vp, uint8_t, vp->vp_length + 1);
+		if (!src) return 0; 
+
+		src[0] = request->home_server->affinity;
+		memcpy(&src[1], vp->vp_octets, vp->vp_length);
+		fr_pair_value_memsteal(vp, src);
+	}
+
 	return 1;
 }
 
@@ -3322,7 +3372,7 @@ static int request_will_proxy(REQUEST *r
 	} else if (((vp = fr_pair_find_by_num(request->config, PW_PACKET_DST_IP_ADDRESS, 0, TAG_ANY)) != NULL) ||
 		   ((vp = fr_pair_find_by_num(request->config, PW_PACKET_DST_IPV6_ADDRESS, 0, TAG_ANY)) != NULL)) {
 		uint16_t dst_port;
-		fr_ipaddr_t dst_ipaddr;
+		fr_ipaddr_t dst_ipaddr, src_ipaddr;
 
 		memset(&dst_ipaddr, 0, sizeof(dst_ipaddr));
 
@@ -3359,6 +3409,28 @@ static int request_will_proxy(REQUEST *r
 			dst_port = vp->vp_integer;
 		}
 
+		if (((vp = fr_pair_find_by_num(request->config, PW_PACKET_SRC_IP_ADDRESS, 0, TAG_ANY)) != NULL) ||
+		    ((vp = fr_pair_find_by_num(request->config, PW_PACKET_SRC_IPV6_ADDRESS, 0, TAG_ANY)) != NULL)) {
+			if (((dst_ipaddr.af == AF_INET) && (vp->da->attr != PW_PACKET_SRC_IP_ADDRESS)) ||
+			    ((dst_ipaddr.af == AF_INET6) && (vp->da->attr != PW_PACKET_SRC_IPV6_ADDRESS))) {
+				REDEBUG("Cannot mix IPv4 and IPv6 source and destination addresses");
+				return 0;
+			}
+			if (vp->da->attr == PW_PACKET_SRC_IP_ADDRESS) {
+				src_ipaddr.af = AF_INET;
+				src_ipaddr.ipaddr.ip4addr.s_addr = vp->vp_ipaddr;
+				src_ipaddr.prefix = 32;
+			} else {
+				src_ipaddr.af = AF_INET6;
+				memcpy(&src_ipaddr.ipaddr.ip6addr, &vp->vp_ipv6addr, sizeof(vp->vp_ipv6addr));
+				src_ipaddr.prefix = 128;
+			}
+			home = home_server_find_bysrc(&dst_ipaddr, dst_port, IPPROTO_UDP, &src_ipaddr);
+			if (!home) home_server_find_bysrc(&dst_ipaddr, dst_port, IPPROTO_TCP, &src_ipaddr);
+			if (!home) goto no_home;
+			goto found_home;
+		}
+
 		/*
 		 *	Find the home server.
 		 */
@@ -3366,13 +3438,14 @@ static int request_will_proxy(REQUEST *r
 		if (!home) home = home_server_find(&dst_ipaddr, dst_port, IPPROTO_TCP);
 		if (!home) {
 			char buffer[256];
-
+		no_home:
 			RWDEBUG("No such home server %s port %u",
 				inet_ntop(dst_ipaddr.af, &dst_ipaddr.ipaddr, buffer, sizeof(buffer)),
 				(unsigned int) dst_port);
 			return 0;
 		}
 
+	found_home:
 		/*
 		 *	The home server is alive (or may be alive).
 		 *	Send the packet to the IP.
diff -urpN freeradius-server-3.2.7/src/main/radtest.in freeradius-server-3.2.8/src/main/radtest.in
--- freeradius-server-3.2.7/src/main/radtest.in	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/main/radtest.in	2025-08-20 23:29:15.000000000 +0700
@@ -3,7 +3,7 @@
 # radtest	Emulate the user interface of the old
 #		radtest that used to be part of FreeRADIUS.
 #
-# Version:	$Id: 6b7103214f283fd0fd8ac61eda852a92c2008d33 $
+# Version:	$Id: f124f2122afee81e17a60327743e639317940818 $
 #
 
 prefix="@prefix@"
@@ -19,6 +19,7 @@ usage() {
 	echo "        -x                  Enable debug output" >&2
 	echo "        -4                  Use IPv4 for the NAS address (default)" >&2
 	echo "        -6                  Use IPv6 for the NAS address" >&2
+	echo "        -b                  Mandate checks for Blast RADIUS (this is not set by default)." >&2
 	exit 1
 }
 
@@ -55,6 +56,10 @@ do
 		NAS_ADDR_ATTR="NAS-IPv6-Address"
 		shift
 		;;
+	-b)
+		OPTIONS="$OPTIONS -b"
+		shift
+		;;
 	-d) 
 		OPTIONS="$OPTIONS -d $2"
 		shift;shift
diff -urpN freeradius-server-3.2.7/src/main/realms.c freeradius-server-3.2.8/src/main/realms.c
--- freeradius-server-3.2.7/src/main/realms.c	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/main/realms.c	2025-08-20 23:29:15.000000000 +0700
@@ -1,7 +1,7 @@
 /*
  * realms.c	Realm handling code
  *
- * Version:     $Id: eb81b8a6721f5f35e636802f5c47584620a51444 $
+ * Version:     $Id: 522287bdd7a3d779cbdc722e892e1c0420252e7b $
  *
  *   This program is free software; you can redistribute it and/or modify
  *   it under the terms of the GNU General Public License as published by
@@ -21,7 +21,7 @@
  * Copyright 2007  Alan DeKok <aland@deployingradius.com>
  */
 
-RCSID("$Id: eb81b8a6721f5f35e636802f5c47584620a51444 $")
+RCSID("$Id: 522287bdd7a3d779cbdc722e892e1c0420252e7b $")
 
 #include <freeradius-devel/radiusd.h>
 #include <freeradius-devel/realms.h>
@@ -532,6 +532,8 @@ static CONF_PARSER home_server_config[]
 	{ "username", FR_CONF_OFFSET(PW_TYPE_STRING | PW_TYPE_NOT_EMPTY, home_server_t, ping_user_name), NULL },
 	{ "password", FR_CONF_OFFSET(PW_TYPE_STRING | PW_TYPE_NOT_EMPTY, home_server_t, ping_user_password), NULL },
 
+	{ "affinity_id", FR_CONF_OFFSET(PW_TYPE_INTEGER, home_server_t, affinity), NULL},
+
 #ifdef WITH_STATS
 	{ "historic_average_window", FR_CONF_OFFSET(PW_TYPE_INTEGER, home_server_t, ema.window), NULL },
 #endif
@@ -634,6 +636,8 @@ void realm_home_server_sanitize(home_ser
 	if (parent && strcmp(cf_section_name1(parent), "server") == 0) {
 		home->parent_server = cf_section_name2(parent);
 	}
+
+	FR_INTEGER_BOUND_CHECK("affinity_id", home->affinity, <=, 255);
 }
 
 /** Insert a new home server into the various internal lookup trees
@@ -1442,7 +1446,7 @@ int realm_pool_add(home_pool_t *pool, CO
 
 	old = rbtree_finddata(home_pools_byname, pool);
 	if (old) {
-		cf_log_err_cs(cs, "Cannot add duplicate home server %s, original is at %s[%d]", pool->name,
+		cf_log_err_cs(cs, "Cannot add duplicate home server pool %s, original is at %s[%d]", pool->name,
 			      cf_section_filename(old->cs), cf_section_lineno(old->cs));
 		return 0;
 	}
@@ -1464,6 +1468,18 @@ int realm_pool_add(home_pool_t *pool, CO
 	return 1;
 }
 
+static int server_id_cmp(void const *one, void const *two)
+{
+	home_server_t const *a = *(home_server_t const * const *) one;
+	home_server_t const *b = *(home_server_t const * const *) two;
+
+	if (a->id < b->id) return -1;
+	if (a->id > b->id) return +1;
+
+	if (a < b) return -1;
+	return +1;
+}
+
 static int server_pool_add(realm_config_t *rc,
 			   CONF_SECTION *cs, home_type_t server_type, bool do_print)
 {
@@ -1560,6 +1576,7 @@ static int server_pool_add(realm_config_
 			{ "client-balance", HOME_POOL_CLIENT_BALANCE },
 			{ "client-port-balance", HOME_POOL_CLIENT_PORT_BALANCE },
 			{ "keyed-balance", HOME_POOL_KEYED_BALANCE },
+			{ "consistent-keyed-balance", HOME_POOL_CONSISTENT_KEYED_BALANCE },
 			{ NULL, 0 }
 		};
 
@@ -1641,12 +1658,107 @@ static int server_pool_add(realm_config_
 			goto error;
 		}
 
+		/*
+		 *	We can only do consistent keyed balance to real home servers.
+		 */
+		if (pool->type == HOME_POOL_CONSISTENT_KEYED_BALANCE) {
+			if (home->virtual_server) {
+				ERROR("Home server %s is a virtual server, and cannot be used with home_server_pool of 'type = consistent-keyed-balance'", home->name);
+				goto error;
+			}
+		}
+
+		if (home->affinity) {
+			if (home->virtual_server) {
+				ERROR("Home server %s is a virtual server, and cannot be used with 'affinity'", home->name);
+				goto error;
+			}
+
+			if (!pool->affinity_group) {
+				pool->affinity_group = talloc_zero_array(pool, home_server_t *, pool->num_home_servers);
+				if (!pool->affinity_group) {
+					ERROR("Out of memory");
+					goto error;
+				}
+			}
+
+			if (home->affinity >= (uint32_t) pool->num_home_servers) {
+				ERROR("Home server %s has invalid 'affinity' value %u.  It must be less than %u",
+				      home->name, home->affinity, pool->num_home_servers);
+				goto error;
+			}
+
+			if (pool->affinity_group[home->affinity]) {
+				ERROR("Home server %s has invalid 'affinity' value %u.  That value is already used by home server %s",
+				      home->name, home->affinity, pool->affinity_group[home->affinity]->name);
+				goto error;
+			}
+
+			pool->affinity_group[home->affinity] = home;
+		}
+
 		if (do_print) cf_log_info(cs, "\thome_server = %s", home->name);
 		pool->servers[num_home_servers++] = home;
 	} /* loop over home_server's */
 
-	if (pool->fallback && do_print) {
-		cf_log_info(cs, "\tfallback = %s", pool->fallback->name);
+	if (pool->fallback) {
+		if (do_print) cf_log_info(cs, "\tfallback = %s", pool->fallback->name);
+
+		if (pool->affinity_group) {
+			ERROR("Cannot use home server pool 'fallback' when home server 'affinity' is set");
+			goto error;
+		}
+	}
+
+	/*
+	 *	Create the hash ID, and then sort the home servers by ID.
+	 */
+	if (pool->type == HOME_POOL_CONSISTENT_KEYED_BALANCE) {
+		int i;
+
+		/*
+		 *	Create an ID for the home server which is
+		 *	unique across restarts.  We use the
+		 *	destination IP, port, and protocol.  This
+		 *	should make the fields unique.
+		 */
+		for (i = 0; i < pool->num_home_servers; i++) {
+			uint32_t hash;
+
+			home = pool->servers[i];
+
+			switch (home->ipaddr.af) {
+			case AF_INET:
+				hash = fr_hash(&home->ipaddr.ipaddr.ip4addr,
+					       sizeof(home->ipaddr.ipaddr.ip4addr));
+				break;
+
+			case AF_INET6:
+				hash = fr_hash(&home->ipaddr.ipaddr.ip6addr,
+					       sizeof(home->ipaddr.ipaddr.ip6addr));
+				break;
+
+			default:
+				ERROR("Invalid address family");
+				goto error;
+			}
+
+			/*
+			 *	If we use a different source IP, then
+			 *	we're a different client to the home
+			 *	server.  So we might as well use this,
+			 *	too.
+			 */
+			if (home->src_ipaddr_str) {
+				hash = fr_hash_update(home->src_ipaddr_str, strlen(home->src_ipaddr_str), hash);
+			}
+
+			hash = fr_hash_update(&home->proto, sizeof(home->proto), hash);
+			home->id = fr_hash_update(&home->port, sizeof(home->port), hash);
+		}
+
+		qsort(&pool->servers[0], pool->num_home_servers, sizeof(pool->servers[0]),
+		      server_id_cmp);
 	}
 
 	if (!realm_pool_add(pool, cs)) goto error;
@@ -2769,8 +2881,167 @@ void home_server_update_request(home_ser
 	}
 }
 
+static bool home_server_active(REQUEST *request, home_server_t *home)
+{
+	/*
+	 *	Skip dead home servers.
+	 *
+	 *	Home servers that are unknown, alive, or zombie
+	 *	are used for proxying.
+	 */
+	if (HOME_SERVER_IS_DEAD(home)) {
+		return false;
+	}
+
+	/*
+	 *	This home server is too busy.  Choose another one.
+	 */
+	if (home->currently_outstanding >= home->max_outstanding) {
+		return false;
+	}
+
+#ifdef WITH_DETAIL
+	/*
+	 *	We read the packet from a detail file, AND it
+	 *	came from this server.  Don't re-proxy it
+	 *	there.
+	 */
+	if (request->listener &&
+	    (request->listener->type == RAD_LISTEN_DETAIL) &&
+	    (request->packet->code == PW_CODE_ACCOUNTING_REQUEST) &&
+	    (fr_ipaddr_cmp(&home->ipaddr, &request->packet->src_ipaddr) == 0)) {
+		return false;
+	}
+#endif
+
+	/*
+	 *	Default virtual: ignore homes tied to a
+	 *	virtual.
+	 */
+	if (!request->server && home->parent_server) {
+		return false;
+	}
+
+	/*
+	 *	A virtual AND home is tied to virtual,
+	 *	ignore ones which don't match.
+	 */
+	if (request->server && home->parent_server &&
+	    strcmp(request->server, home->parent_server) != 0) {
+		return false;
+	}
+
+	/*
+	 *	Allow request->server && !home->parent_server
+	 *
+	 *	i.e. virtuals can proxy to globally defined
+	 *	homes.
+	 */
+
+	return true;
+}
+
+/*
+ *	Return the nearest neighbour by consistent hash.
+ *
+ *	The home servers are ordered by ID (small to large).  We
+ *	choose the nearest one (wrapping around) which is higher than
+ *	the current hash.
+ *
+ *	An implementation of https://arxiv.org/pdf/1505.00062
+ *	"Multi-probe consistent hashing".
+ *
+ *	It hashes the nodes once, and then hashes the key K ways.  We
+ *	then choose the node which has a value _closest_ to one of the
+ *	K keys.  Using K=2 achieves O(1) lookup with high probability,
+ *	and a max to average ration of ~3.
+ *
+ *	@todo - if there's only one server alive, just pick that?
+ */
+static home_server_t *home_server_by_consistent_key(REQUEST *request, home_pool_t *pool, uint32_t hash)
+{
+	int i, j;
+	uint32_t key[8];
+	unsigned int mask;
+	uint32_t found_diff;
+	home_server_t *found;
+	home_server_t *home[8] = { NULL, NULL, NULL, NULL, 
+				   NULL, NULL, NULL, NULL };
+	static const uint32_t constants[8] = { 0xff51afd7, 0xed558ccd, 0xc4ceb9fe, 0x1a85ec53,
+					      ~0xff51afd7,~0xed558ccd,~0xc4ceb9fe,~0x1a85ec53 };
+
+	/*
+	 *	Get some hash keys.
+	 */
+	for (i = 0; i < 8; i++) {
+		key[i] = fr_hash_update(&constants[i], sizeof(constants[i]), hash);
+	}
+	mask = (1 << 8) - 1;
+
+	/*
+	 *	Loop over all home servers, picking one of them
+	 *	which corresponds to the hash key.
+	 *
+	 *	We pick the first home server which has a key greater
+	 *	than the current one.  Note that the home servers are
+	 *	sorted by ID, so as soon as we find a matching one, we
+	 *	can stop walking the list of home servers.
+	 */
+	for (i = 0; i < pool->num_home_servers; i++) {
+		for (j = 0; j < 8; j++) {
+			if (!home[j] && (pool->servers[i]->id > key[j])) {
+				home[j] = pool->servers[i];
+
+				/*
+				 *	Stop early if we fill up the array.
+				 */
+				mask &= ~(1 << j);
+				if (!mask) goto pick;
+			}
+		}
+	}
+
+	/*
+	 *	If we didn't find a matching home server because our
+	 *	key was too large, then wrap around to pick the first
+	 *	home server.
+	 */
+	if (mask) for (i = 0; i < 8; i++) {
+		if (!home[i]) home[i] = pool->servers[0];
+	}
+
+pick:
+	found = NULL;
+	found_diff = ~((uint32_t) 0);
+
+	/*
+	 *	Pick the _alive_ home server which has an ID which is
+	 *	_closest_ to the given key.
+	 */
+	for (i = 0; i < 8; i++) {
+		uint32_t diff;
+
+		if (!home_server_active(request, home[i])) continue;
+
+		if (found->id <= key[i]) {
+			diff = key[i] - found->id;
+
+		} else {
+			diff = key[i] + (~((uint32_t) 0) - found->id) + 1;
+		}
+
+		if (!found || (diff < found_diff)) {
+			found = home[i];
+			found_diff = diff;
+			continue;
+		}
+	}
+
+	return found;
+}
+
 home_server_t *home_server_ldb(char const *realmname,
-			     home_pool_t *pool, REQUEST *request)
+			       home_pool_t *pool, REQUEST *request)
 {
 	int		start;
 	int		count;
@@ -2780,11 +3051,29 @@ home_server_t *home_server_ldb(char cons
 	uint32_t	hash;
 
 	/*
+	 *	Over-ride the pool configuration if the pool is marked up as having affinity, AND the packet has a State attribute.
+	 */
+	if (pool->affinity_group &&
+	    (request->packet->code == PW_CODE_ACCESS_REQUEST) &&
+	    ((vp = fr_pair_find_by_num(request->packet->vps, PW_STATE, 0, TAG_ANY)) != NULL) &&
+	    (vp->vp_length > 1) &&
+	    (vp->vp_octets[0] < (uint32_t) pool->num_home_servers) &&
+	    (pool->affinity_group[vp->vp_octets[0]] != NULL)) {
+		    found = pool->affinity_group[vp->vp_octets[0]];
+
+		    if (HOME_SERVER_IS_DEAD(found)) return NULL;
+
+		    /*
+		     *	Get rid of the extra octet that we added on the outbound proxying.
+		     */
+		    fr_pair_value_memcpy(vp, vp->vp_octets + 1, vp->vp_length - 1);
+		    return found;
+	}
+
+	/*
 	 *	Determine how to pick choose the home server.
 	 */
 	switch (pool->type) {
-
-
 		/*
 		 *	For load-balancing by client IP address, we
 		 *	pick a home server by hashing the client IP.
@@ -2809,7 +3098,23 @@ home_server_t *home_server_ldb(char cons
 			hash = 0;
 			break;
 		}
+
+	pick_matching_server:
+		/*
+		 *	Try the matching server first.  If it's alive, we return it.
+		 *
+		 *	Otherwise we fall back to just picking a random one.
+		 */
 		start = hash % pool->num_home_servers;
+		found = pool->servers[start];
+		if (home_server_active(request, found)) return found;
+
+		/*
+		 *	The matching one is dead.  We then use the
+		 *	"load-balance" algorithm to pick the server.
+		 */
+		found = NULL;
+		start = 0;
 		break;
 
 	case HOME_POOL_CLIENT_PORT_BALANCE:
@@ -2830,26 +3135,43 @@ home_server_t *home_server_ldb(char cons
 		}
 		hash = fr_hash_update(&request->packet->src_port,
 				      sizeof(request->packet->src_port), hash);
-		start = hash % pool->num_home_servers;
-		break;
+		goto pick_matching_server;
 
 	case HOME_POOL_KEYED_BALANCE:
 		if ((vp = fr_pair_find_by_num(request->config, PW_LOAD_BALANCE_KEY, 0, TAG_ANY)) != NULL) {
 			hash = fr_hash(vp->vp_strvalue, vp->vp_length);
-			start = hash % pool->num_home_servers;
-			break;
+			goto pick_matching_server;
 		}
 		/* FALL-THROUGH */
 
-	case HOME_POOL_LOAD_BALANCE:
 	case HOME_POOL_FAIL_OVER:
+	case HOME_POOL_LOAD_BALANCE:
 		start = 0;
 		break;
 
-	default:		/* this shouldn't happen... */
+	case HOME_POOL_CONSISTENT_KEYED_BALANCE:
+		/*
+		 *	If there's no key, we just pick a random destination.
+		 */
+		vp = fr_pair_find_by_num(request->config, PW_LOAD_BALANCE_KEY, 0, TAG_ANY);
+		if (!vp) {
+			start = 0;
+			break;
+		}
+
+		hash = fr_hash(vp->vp_strvalue, vp->vp_length);
+		found = home_server_by_consistent_key(request, pool, hash);
+		if (found) return found;
+
+		/*
+		 *	Fall back to just load balancing from the start.
+		 */
 		start = 0;
 		break;
 
+	default:		/* this shouldn't happen... */
+		start = 0;
+		break;
 	}
 
 	/*
@@ -2858,66 +3180,17 @@ home_server_t *home_server_ldb(char cons
 	 *	it.  If it is too busy, skip it.
 	 *
 	 *	Otherwise, use it.
+	 *
+	 *	The difference between fail-over (i.e redundant) and
+	 *	load balance is that redundant always starts at the
+	 *	first one, and load balance starts at a random one.
 	 */
 	for (count = 0; count < pool->num_home_servers; count++) {
 		home_server_t *home = pool->servers[(start + count) % pool->num_home_servers];
 
 		if (!home) continue;
 
-		/*
-		 *	Skip dead home servers.
-		 *
-		 *	Home servers that are unknown, alive, or zombie
-		 *	are used for proxying.
-		 */
-		if (HOME_SERVER_IS_DEAD(home)) {
-			continue;
-		}
-
-		/*
-		 *	This home server is too busy.  Choose another one.
-		 */
-		if (home->currently_outstanding >= home->max_outstanding) {
-			continue;
-		}
-
-#ifdef WITH_DETAIL
-		/*
-		 *	We read the packet from a detail file, AND it
-		 *	came from this server.  Don't re-proxy it
-		 *	there.
-		 */
-		if (request->listener &&
-		    (request->listener->type == RAD_LISTEN_DETAIL) &&
-		    (request->packet->code == PW_CODE_ACCOUNTING_REQUEST) &&
-		    (fr_ipaddr_cmp(&home->ipaddr, &request->packet->src_ipaddr) == 0)) {
-			continue;
-		}
-#endif
-
-		/*
-		 *	Default virtual: ignore homes tied to a
-		 *	virtual.
-		 */
-		if (!request->server && home->parent_server) {
-			continue;
-		}
-
-		/*
-		 *	A virtual AND home is tied to virtual,
-		 *	ignore ones which don't match.
-		 */
-		if (request->server && home->parent_server &&
-		    strcmp(request->server, home->parent_server) != 0) {
-			continue;
-		}
-
-		/*
-		 *	Allow request->server && !home->parent_server
-		 *
-		 *	i.e. virtuals can proxy to globally defined
-		 *	homes.
-		 */
+		if (!home_server_active(request, home)) continue;
 
 		/*
 		 *	It's zombie, so we remember the first zombie
@@ -2930,9 +3203,14 @@ home_server_t *home_server_ldb(char cons
 		}
 
 		/*
-		 *	We've found the first "live" one.  Use that.
+		 *	For fail-over, we just pick the first one
+		 *	which is alive.
+		 *
+		 *	For all other methods, we load balance among
+		 *	all servers, picking the least busy home
+		 *	server.
 		 */
-		if (pool->type != HOME_POOL_LOAD_BALANCE) {
+		if (pool->type == HOME_POOL_FAIL_OVER) {
 			found = home;
 			break;
 		}
diff -urpN freeradius-server-3.2.7/src/main/regex.c freeradius-server-3.2.8/src/main/regex.c
--- freeradius-server-3.2.7/src/main/regex.c	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/main/regex.c	2025-08-20 23:29:15.000000000 +0700
@@ -15,7 +15,7 @@
  */
 
 /*
- * $Id: f66414c903bde09edcaf3a5d297690fd51aefd12 $
+ * $Id: 60d51a8c9e1a5b25b267b2f21080c1948b3b6176 $
  *
  * @file main/regex.c
  * @brief Regular expression functions used by the server library.
@@ -23,7 +23,7 @@
  * @copyright 2014  The FreeRADIUS server project
  */
 
-RCSID("$Id: f66414c903bde09edcaf3a5d297690fd51aefd12 $")
+RCSID("$Id: 60d51a8c9e1a5b25b267b2f21080c1948b3b6176 $")
 
 #include <freeradius-devel/radiusd.h>
 #include <freeradius-devel/rad_assert.h>
@@ -33,7 +33,7 @@ RCSID("$Id: f66414c903bde09edcaf3a5d2976
 #define REQUEST_DATA_REGEX (0xadbeef00)
 
 typedef struct regcapture {
-#ifdef HAVE_PCRE
+#if defined(HAVE_PCRE) || defined(HAVE_PCRE2)
 	regex_t		*preg;		//!< Compiled pattern.
 #endif
 	char const	*value;		//!< Original string.
@@ -83,8 +83,12 @@ void regex_sub_to_request(REQUEST *reque
 	 */
 	MEM(new_sc = talloc(request, regcapture_t));
 
+#ifdef HAVE_PCRE2
+	new_sc->rxmatch = talloc_steal(new_sc, rxmatch);
+#else
 	MEM(new_sc->rxmatch = talloc_memdup(new_sc, rxmatch, sizeof(rxmatch[0]) * nmatch));
 	talloc_set_type(new_sc->rxmatch, regmatch_t[]);
+#endif
 
 	MEM(p = talloc_array(new_sc, char, len + 1));
 	memcpy(p, value, len);
@@ -92,7 +96,7 @@ void regex_sub_to_request(REQUEST *reque
 	new_sc->value = p;
 	new_sc->nmatch = nmatch;
 
-#ifdef HAVE_PCRE
+#if defined(HAVE_PCRE) || defined(HAVE_PCRE2)
 	if (!(*preg)->precompiled) {
 		new_sc->preg = talloc_steal(new_sc, *preg);
 		*preg = NULL;
@@ -104,7 +108,121 @@ void regex_sub_to_request(REQUEST *reque
 	request_data_add(request, request, REQUEST_DATA_REGEX, new_sc, true);
 }
 
-#  ifdef HAVE_PCRE
+#  ifdef HAVE_PCRE2
+/** Extract a subcapture value from the request
+ *
+ * @note This is the PCRE2 variant of the function.
+ *
+ * @param ctx To allocate subcapture buffer in.
+ * @param out Where to write the subcapture string.
+ * @param request to extract.
+ * @param num Subcapture index (0 for entire match).
+ * @return 0 on success, -1 on notfound.
+ */
+int regex_request_to_sub(TALLOC_CTX *ctx, char **out, REQUEST *request, uint32_t num)
+{
+	regcapture_t		*cap;
+	char			*buff;
+	int			ret;
+	size_t			len;
+	pcre2_match_data	*match_data;
+
+	cap = request_data_reference(request, request, REQUEST_DATA_REGEX);
+	if (!cap) {
+		RDEBUG4("No subcapture data found");
+		*out = NULL;
+		return -1;
+	}
+	match_data = talloc_get_type_abort(cap->rxmatch->match_data, pcre2_match_data);
+
+	ret = pcre2_substring_length_bynumber(match_data, num, &len);
+	switch (ret) {
+	case PCRE2_ERROR_NOMEMORY:
+		MEM(NULL);
+		/* FALL-THROUGH */
+
+	/*
+	 *	Not finding a substring is fine
+	 */
+	case PCRE2_ERROR_NOSUBSTRING:
+		RDEBUG4("%i/%zu Not found", num, cap->nmatch);
+		*out = NULL;
+		return -1;
+
+	default:
+		if (ret < 0) {
+			*out = NULL;
+			return -1;
+		}
+
+		MEM(buff = talloc_array(ctx, char, ++len));	/* +1 for \0, it'll get reset by pcre2_substring */
+		pcre2_substring_copy_bynumber(match_data, num, (PCRE2_UCHAR *)buff, &len); /* can't error */
+
+		memcpy(out, &buff, sizeof(*out));
+
+		RDEBUG4("%i/%zu Found: %s (%zu)", num, cap->nmatch, buff, talloc_array_length(buff));
+
+		return 0;
+	}
+}
+
+/** Extract a named subcapture value from the request
+ *
+ * @note This is the PCRE2 variant of the function.
+ *
+ * @param ctx To allocate subcapture buffer in.
+ * @param out Where to write the subcapture string.
+ * @param request to extract.
+ * @param name of subcapture.
+ * @return 0 on success, -1 on notfound.
+ */
+int regex_request_to_sub_named(TALLOC_CTX *ctx, char **out, REQUEST *request, char const *name)
+{
+	regcapture_t		*cap;
+	char			*buff;
+	int			ret;
+	size_t			len;
+	pcre2_match_data	*match_data;
+
+	cap = request_data_reference(request, request, REQUEST_DATA_REGEX);
+	if (!cap) {
+		RDEBUG4("No subcapture data found");
+		*out = NULL;
+		return -1;
+	}
+	match_data = talloc_get_type_abort(cap->rxmatch->match_data, pcre2_match_data);
+
+	ret = pcre2_substring_length_byname(match_data, (PCRE2_UCHAR const *)name, &len);
+	switch (ret) {
+	case PCRE2_ERROR_NOMEMORY:
+		MEM(NULL);
+		/* FALL-THROUGH */
+
+	/*
+	 *	Not finding a substring is fine
+	 */
+	case PCRE2_ERROR_NOSUBSTRING:
+		RDEBUG4("No named capture group \"%s\"", name);
+		*out = NULL;
+		return -1;
+
+	default:
+		if (ret < 0) {
+			*out = NULL;
+			return -1;
+		}
+
+		MEM(buff = talloc_array(ctx, char, ++len));	/* +1 for \0, it'll get reset by pcre2_substring */
+		pcre2_substring_copy_byname(match_data, (PCRE2_UCHAR const *)name, (PCRE2_UCHAR *)buff, &len); /* can't error */
+
+		memcpy(out, &buff, sizeof(*out));
+
+		RDEBUG4("Found \"%s\": %s (%zu)", name, buff, talloc_array_length(buff));
+
+		return 0;
+	}
+}
+#  elif defined(HAVE_PCRE)
 /** Extract a subcapture value from the request
  *
  * @note This is the PCRE variant of the function.
diff -urpN freeradius-server-3.2.7/src/main/stats.c freeradius-server-3.2.8/src/main/stats.c
--- freeradius-server-3.2.7/src/main/stats.c	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/main/stats.c	2025-08-20 23:29:15.000000000 +0700
@@ -1,7 +1,7 @@
 /*
  * stats.c	Internal statistics handling.
  *
- * Version:	$Id: 9c7d8f81b24003f027facbf91cd2c56e4aba4a98 $
+ * Version:	$Id: 826771bd1f201f50ace69b7ad72c2a85a8b1bc30 $
  *
  *   This program is free software; you can redistribute it and/or modify
  *   it under the terms of the GNU General Public License as published by
@@ -21,7 +21,7 @@
  * Copyright 2008  Alan DeKok <aland@deployingradius.com>
  */
 
-RCSID("$Id: 9c7d8f81b24003f027facbf91cd2c56e4aba4a98 $")
+RCSID("$Id: 826771bd1f201f50ace69b7ad72c2a85a8b1bc30 $")
 
 #include <freeradius-devel/radiusd.h>
 #include <freeradius-devel/rad_assert.h>
@@ -58,8 +58,8 @@ fr_stats_t proxy_dsc_stats = FR_STATS_IN
 #endif
 #endif
 
-static void stats_time(fr_stats_t *stats, struct timeval *start,
-		       struct timeval *end)
+static void stats_time(fr_stats_t *stats, REQUEST *request,
+		       struct timeval *start, struct timeval *end)
 {
 	struct timeval diff;
 	uint32_t delay;
@@ -69,6 +69,28 @@ static void stats_time(fr_stats_t *stats
 
 	rad_tv_sub(end, start, &diff);
 
+	/*
+	 *	Don't count proxy times as our packet processing
+	 *	times.  If the user wants to see how long it takes for
+	 *	packets to be processed, he should look at the proxy
+	 *	statistics.
+	 */
+	if (request && request->proxy && request->proxy_reply) {
+		struct timeval proxy, tmp;
+		rad_tv_sub(&request->proxy_reply->timestamp,
+			   &request->proxy->timestamp,
+			   &proxy);
+
+		/*
+		 *	This should always be smaller, but it doesn't
+		 *	hurt to check.
+		 */
+		if (timercmp(&proxy, &diff, <)) {
+			tmp = diff;
+			rad_tv_sub(&tmp, &proxy, &diff);
+		}
+	}
+
 	if (diff.tv_sec >= 10) {
 		stats->elapsed[7]++;
 	} else {
@@ -172,13 +194,13 @@ void request_stats_final(REQUEST *reques
 		/*
 		 *	FIXME: Do the time calculations once...
 		 */
-		stats_time(&radius_auth_stats,
+		stats_time(&radius_auth_stats, request,
 			   &request->packet->timestamp,
 			   &request->reply->timestamp);
-		stats_time(&request->client->auth,
+		stats_time(&request->client->auth, request,
 			   &request->packet->timestamp,
 			   &request->reply->timestamp);
-		stats_time(&listener->stats,
+		if (listener) stats_time(&listener->stats, request,
 			   &request->packet->timestamp,
 			   &request->reply->timestamp);
 		break;
@@ -194,10 +216,13 @@ void request_stats_final(REQUEST *reques
 #ifdef WITH_ACCOUNTING
 	case PW_CODE_ACCOUNTING_RESPONSE:
 		INC_ACCT(total_responses);
-		stats_time(&radius_acct_stats,
+		stats_time(&radius_acct_stats, request,
 			   &request->packet->timestamp,
 			   &request->reply->timestamp);
-		stats_time(&request->client->acct,
+		stats_time(&request->client->acct, request,
+			   &request->packet->timestamp,
+			   &request->reply->timestamp);
+		if (listener) stats_time(&listener->stats, request,
 			   &request->packet->timestamp,
 			   &request->reply->timestamp);
 		break;
@@ -208,7 +233,10 @@ void request_stats_final(REQUEST *reques
 		INC_COA(total_access_accepts);
 	  coa_stats:
 		INC_COA(total_responses);
-		stats_time(&request->client->coa,
+		stats_time(&request->client->coa, request,
+			   &request->packet->timestamp,
+			   &request->reply->timestamp);
+		if (listener) stats_time(&listener->stats, request,
 			   &request->packet->timestamp,
 			   &request->reply->timestamp);
 		break;
@@ -221,7 +249,10 @@ void request_stats_final(REQUEST *reques
 		INC_DSC(total_access_accepts);
 	  dsc_stats:
 		INC_DSC(total_responses);
-		stats_time(&request->client->dsc,
+		stats_time(&request->client->dsc, request,
+			   &request->packet->timestamp,
+			   &request->reply->timestamp);
+		if (listener) stats_time(&listener->stats, request,
 			   &request->packet->timestamp,
 			   &request->reply->timestamp);
 		break;
@@ -232,8 +263,9 @@ void request_stats_final(REQUEST *reques
 #endif
 
 		/*
-		 *	No response, it must have been a bad
-		 *	authenticator.
+		 *	No response, we did "do_not_respond", or the packet timed out.
+		 *
+		 *	This packet then isn't counted in the statistics for overall response times. :(
 		 */
 	case 0:
 		if (request->packet->code == PW_CODE_ACCESS_REQUEST) {
@@ -297,10 +329,10 @@ void request_stats_final(REQUEST *reques
 		INC(total_access_accepts);
 	proxy_stats:
 		INC(total_responses);
-		stats_time(&proxy_auth_stats,
+		stats_time(&proxy_auth_stats, NULL,
 			   &request->proxy->timestamp,
 			   &request->proxy_reply->timestamp);
-		stats_time(&request->home_server->stats,
+		stats_time(&request->home_server->stats, NULL,
 			   &request->proxy->timestamp,
 			   &request->proxy_reply->timestamp);
 		break;
@@ -317,10 +349,10 @@ void request_stats_final(REQUEST *reques
 	case PW_CODE_ACCOUNTING_RESPONSE:
 		proxy_acct_stats.total_responses++;
 		request->home_server->stats.total_responses++;
-		stats_time(&proxy_acct_stats,
+		stats_time(&proxy_acct_stats, NULL,
 			   &request->proxy->timestamp,
 			   &request->proxy_reply->timestamp);
-		stats_time(&request->home_server->stats,
+		stats_time(&request->home_server->stats, NULL,
 			   &request->proxy->timestamp,
 			   &request->proxy_reply->timestamp);
 		break;
@@ -331,10 +363,10 @@ void request_stats_final(REQUEST *reques
 	case PW_CODE_COA_NAK:
 		proxy_coa_stats.total_responses++;
 		request->home_server->stats.total_responses++;
-		stats_time(&proxy_coa_stats,
+		stats_time(&proxy_coa_stats, NULL,
 			   &request->proxy->timestamp,
 			   &request->proxy_reply->timestamp);
-		stats_time(&request->home_server->stats,
+		stats_time(&request->home_server->stats, NULL,
 			   &request->proxy->timestamp,
 			   &request->proxy_reply->timestamp);
 		break;
@@ -343,10 +375,10 @@ void request_stats_final(REQUEST *reques
 	case PW_CODE_DISCONNECT_NAK:
 		proxy_dsc_stats.total_responses++;
 		request->home_server->stats.total_responses++;
-		stats_time(&proxy_dsc_stats,
+		stats_time(&proxy_dsc_stats, NULL,
 			   &request->proxy->timestamp,
 			   &request->proxy_reply->timestamp);
-		stats_time(&request->home_server->stats,
+		stats_time(&request->home_server->stats, NULL,
 			   &request->proxy->timestamp,
 			   &request->proxy_reply->timestamp);
 		break;
@@ -361,7 +393,6 @@ void request_stats_final(REQUEST *reques
  done:
 #endif /* WITH_PROXY */
 
-
 	if (request->max_time) {
 		switch (request->packet->code) {
 		case PW_CODE_ACCESS_REQUEST:
@@ -507,6 +538,17 @@ static void request_stats_addvp(REQUEST
 		counter = *(uint64_t *) (((uint8_t *) stats) + table[i].offset);
 		vp->vp_integer = counter;
 	}
+
+	/*
+	 *	Add in count of elapsed times.
+	 */
+	for (i = 0; i < 8; i++) {
+		vp = radius_pair_create(request->reply, &request->reply->vps,
+					(198 + ((i + 1) << 8)), VENDORPEC_FREERADIUS);
+		if (!vp) continue;
+
+		vp->vp_integer64 = stats->elapsed[i];
+	}
 }
 
 static void stats_error(REQUEST *request, char const *msg)
diff -urpN freeradius-server-3.2.7/src/main/threads.c freeradius-server-3.2.8/src/main/threads.c
--- freeradius-server-3.2.7/src/main/threads.c	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/main/threads.c	2025-08-20 23:29:15.000000000 +0700
@@ -1,7 +1,7 @@
 /*
  * threads.c	request threading support
  *
- * Version:	$Id: 2075ba12ec742b3d25974fee00a86fc8b222d857 $
+ * Version:	$Id: 8fbb57b816cf4d210f0fc37385446156f8539db0 $
  *
  *   This program is free software; you can redistribute it and/or modify
  *   it under the terms of the GNU General Public License as published by
@@ -21,7 +21,7 @@
  * Copyright 2000  Alan DeKok <aland@ox.org>
  */
 
-RCSID("$Id: 2075ba12ec742b3d25974fee00a86fc8b222d857 $")
+RCSID("$Id: 8fbb57b816cf4d210f0fc37385446156f8539db0 $")
 USES_APPLE_DEPRECATED_API	/* OpenSSL API has been deprecated by Apple */
 
 #include <freeradius-devel/radiusd.h>
@@ -791,11 +791,6 @@ retry:
 
 	rad_assert(*prequest != NULL);
 	rad_assert(request->magic == REQUEST_MAGIC);
-	rad_assert(request->child_state == REQUEST_QUEUED);
-
-	request->component = "<core>";
-	request->module = "";
-	request->child_state = REQUEST_RUNNING;
 
 	/*
 	 *	If the request has sat in the queue for too long,
@@ -811,6 +806,12 @@ retry:
 		goto retry;
 	}
 
+	rad_assert(request->child_state == REQUEST_QUEUED);
+
+	request->component = "<core>";
+	request->module = "";
+	request->child_state = REQUEST_RUNNING;
+
 	/*
 	 *	The thread is currently processing a request.
 	 */
diff -urpN freeradius-server-3.2.7/src/main/tls.c freeradius-server-3.2.8/src/main/tls.c
--- freeradius-server-3.2.7/src/main/tls.c	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/main/tls.c	2025-08-20 23:29:15.000000000 +0700
@@ -1,7 +1,7 @@
 /*
  * tls.c
  *
- * Version:     $Id: 2a348eb9bb8058a5682243d09ab7c958ace32f7f $
+ * Version:     $Id: ba267983b14878f8e5193a410ebccb701e1bd627 $
  *
  *   This program is free software; you can redistribute it and/or modify
  *   it under the terms of the GNU General Public License as published by
@@ -22,7 +22,7 @@
  * Copyright 2006  The FreeRADIUS server project
  */
 
-RCSID("$Id: 2a348eb9bb8058a5682243d09ab7c958ace32f7f $")
+RCSID("$Id: ba267983b14878f8e5193a410ebccb701e1bd627 $")
 USES_APPLE_DEPRECATED_API	/* OpenSSL API has been deprecated by Apple */
 
 #include <freeradius-devel/radiusd.h>
@@ -498,6 +498,18 @@ tls_session_t *tls_new_client_session(TA
 	}
 
 	/*
+	 *	Set SNI, if configured.
+	 *
+	 *	The OpenSSL API says the filename is "char
+	 *	const *", but some versions have it as "void
+	 *	*", without the "const".  So we un-const it
+	 *	here through various C magic.
+	 */
+	if (conf->client_hostname) {
+		(void) SSL_set_tlsext_host_name(ssn->ssl, (void *) (uintptr_t) conf->client_hostname);
+	}
+
+	/*
 	 *	Add the message callback to identify what type of
 	 *	message/handshake is passed
 	 */
@@ -1308,9 +1320,11 @@ void tls_session_information(tls_session
 
 				case SSL3_AD_ILLEGAL_PARAMETER:
 					str_details2 = " illegal_parameter";
+#ifdef PSK_MAX_IDENTITY_LEN
 					if (tls_session->conf->psk_identity || tls_session->conf->psk_query) {
 						details = "the client and server have different values for the PSK";
 					}
+#endif
 					break;
 
 				case TLS1_AD_UNKNOWN_CA:
@@ -2997,7 +3011,7 @@ int cbtls_verify(int ok, X509_STORE_CTX
 	buf[0] = '\0';
 	sn = X509_get_serialNumber(client_cert);
 
-	RDEBUG2("(TLS) %s - Creating attributes from %d certificate in chain", conf->name, lookup + 1);
+	RDEBUG2("(TLS) %s - Creating attributes from certificate %d in chain", conf->name, lookup + 1);
  	RINDENT();
 
 	/*
@@ -3077,30 +3091,33 @@ int cbtls_verify(int ok, X509_STORE_CTX
 	/*
 	 *	Get the Certificate Distribution points
 	 */
-	crl_dp = X509_get_ext_d2i(client_cert, NID_crl_distribution_points, NULL, NULL);
-	if (crl_dp) {
-		DIST_POINT *dp;
-		const char *url_ptr;
+	if (certs && (lookup <= 1)) {
+		crl_dp = X509_get_ext_d2i(client_cert, NID_crl_distribution_points, NULL, NULL);
 
-		for (int i = 0; i < sk_DIST_POINT_num(crl_dp); i++) {
-			size_t len;
-			char cdp[1024];
+		if (crl_dp) {
+			DIST_POINT *dp;
+			const char *url_ptr;
 
-			dp = sk_DIST_POINT_value(crl_dp, i);
-			if (!dp) continue;
+			for (int i = 0; i < sk_DIST_POINT_num(crl_dp); i++) {
+				size_t len;
+				char cdp[1024];
 
-			url_ptr = get_cdp_url(dp);
-			if (!url_ptr) continue;
+				dp = sk_DIST_POINT_value(crl_dp, i);
+				if (!dp) continue;
 
-			len = strlen(url_ptr);
-			if (len >= sizeof(cdp)) continue;
+				url_ptr = get_cdp_url(dp);
+				if (!url_ptr) continue;
 
-			memcpy(cdp, url_ptr, len + 1);
+				len = strlen(url_ptr);
+				if (len >= sizeof(cdp)) continue;
 
-			vp = fr_pair_make(talloc_ctx, certs, cert_attr_names[FR_TLS_CDP][lookup], cdp, T_OP_ADD);
-			rdebug_pair(L_DBG_LVL_2, request, vp, NULL);
+				memcpy(cdp, url_ptr, len + 1);
+
+				vp = fr_pair_make(talloc_ctx, certs, cert_attr_names[FR_TLS_CDP][lookup], cdp, T_OP_ADD);
+				rdebug_pair(L_DBG_LVL_2, request, vp, NULL);
+			}
+			sk_DIST_POINT_pop_free(crl_dp, DIST_POINT_free);
 		}
-		sk_DIST_POINT_pop_free(crl_dp, DIST_POINT_free);
 	}
 
 	/*
@@ -3644,7 +3661,7 @@ int tls_global_init(TLS_UNUSED bool spaw
 	CONF_modules_load_file(NULL, NULL, 0);
 
 #if OPENSSL_VERSION_NUMBER >= 0x30000000L
-	EVP_set_default_properties(NULL, "fips=no");
+	EVP_set_default_properties(NULL, "-fips");
 #endif
 
 	/*
@@ -4088,6 +4105,13 @@ load_ca:
 post_ca:
 #endif
 
+#ifdef SSL_OP_NO_RENEGOTIATION
+	/*
+	 *	This is never useful for anything.
+	 */
+	ctx_options |= SSL_OP_NO_RENEGOTIATION;
+#endif
+
 	/*
 	 *	We never want SSLv2 or SSLv3.
 	 */
@@ -4777,6 +4801,8 @@ static int tls_realms_load(fr_tls_server
 			ERROR("Failed inserting certificate file %s into hash table", buffer);
 			goto error;
 		}
+
+		DEBUG("(TLS) Loaded certificate file %s", buffer);
 	}
 
 	conf->realms = ht;
diff -urpN freeradius-server-3.2.7/src/main/tmpl.c freeradius-server-3.2.8/src/main/tmpl.c
--- freeradius-server-3.2.7/src/main/tmpl.c	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/main/tmpl.c	2025-08-20 23:29:15.000000000 +0700
@@ -15,7 +15,7 @@
  */
 
 /**
- * $Id: 6746bdec8d9f8f61bb0cc5b0e271994c150e6169 $
+ * $Id: aa53e391438750d56adddad478abe27fe6104795 $
  *
  * @brief #VALUE_PAIR template functions
  * @file main/tmpl.c
@@ -24,7 +24,7 @@
  *
  * @copyright 2014-2015 The FreeRADIUS server project
  */
-RCSID("$Id: 6746bdec8d9f8f61bb0cc5b0e271994c150e6169 $")
+RCSID("$Id: aa53e391438750d56adddad478abe27fe6104795 $")
 
 #include <freeradius-devel/radiusd.h>
 #include <freeradius-devel/rad_assert.h>
@@ -167,6 +167,14 @@ size_t radius_list_name(pair_lists_t *ou
 			}
 		}
 
+		/*
+		 *	Check for the special ':V' tag.
+		 */
+		if ((*d == 'V') && !dict_attr_allowed_chars[(uint8_t) d[1]]) {
+			*out = def;
+			return 0;
+		}
+
 		*out = fr_substr2int(pair_lists, p, PAIR_LIST_UNKNOWN, (q - p));
 		if (*out == PAIR_LIST_UNKNOWN) return 0;
 
@@ -703,7 +711,6 @@ ssize_t tmpl_from_attr_substr(vp_tmpl_t
 	da = dict_attrbyvalue(attr.da->attr, attr.da->vendor);
 	if (da && (attr.da != da)) attr.da = da;
 
-
 	/*
 	 *	The string MIGHT have a tag.
 	 */
@@ -713,6 +720,15 @@ ssize_t tmpl_from_attr_substr(vp_tmpl_t
 			return -(p - name);
 		}
 
+		/*
+		 *	Get the tag from the value.
+		 */
+		if (p[1] == 'V') {
+			attr.tag = TAG_VALUE;
+			p += 2;
+			goto do_num;
+		}
+
 		num = strtol(p + 1, &q, 10);
 		if ((num > 0x1f) || (num < 0)) {
 			fr_strerror_printf("Invalid tag value '%li' (should be between 0-31)", num);
@@ -1223,6 +1239,13 @@ int tmpl_cast_to_vp(VALUE_PAIR **out, RE
 	data.strvalue = p;
 
 	/*
+	 *	Copy over any additional fields needed...
+	 */
+	if ((vpt->type == TMPL_TYPE_ATTR) && vp->da->flags.has_tag) {
+		vp->tag = vpt->tmpl_tag;
+	}
+
+	/*
 	 *	New escapes: strings are in binary form.
 	 */
 	if (cf_new_escape && (vp->da->type == PW_TYPE_STRING)) {
@@ -1235,13 +1258,6 @@ int tmpl_cast_to_vp(VALUE_PAIR **out, RE
 		return -1;
 	}
 
-	/*
-	 *	Copy over any additional fields needed...
-	 */
-	if ((vpt->type == TMPL_TYPE_ATTR) && vp->da->flags.has_tag) {
-		vp->tag = vpt->tmpl_tag;
-	}
-
 	*out = vp;
 	return 0;
 }
@@ -1732,7 +1748,15 @@ size_t tmpl_prints(char *out, size_t out
 		q = out + len;
 		outlen -= len;
 
-		if (vpt->tmpl_tag != TAG_ANY) {
+		if (vpt->tmpl_tag == TAG_ANY) {
+			/* do nothing */
+
+		} else if (vpt->tmpl_tag == TAG_VALUE) {
+			*q++ = ':';
+			*q++ = 'V';
+			outlen -= 2;
+
+		} else {
 			snprintf(q, outlen, ":%d", vpt->tmpl_tag);
 			len = strlen(q);
 			q += len;
@@ -1878,6 +1902,11 @@ VALUE_PAIR *tmpl_cursor_init(int *err, v
 	 *	May not may not be found, but it *is* a known name.
 	 */
 	case TMPL_TYPE_ATTR:
+		if (vpt->tmpl_tag == TAG_VALUE) {
+			if (err) *err = -1;
+			return NULL;
+		}
+
 		switch (vpt->tmpl_num) {
 		case NUM_ANY:
 			vp = fr_cursor_next_by_da(cursor, vpt->tmpl_da, vpt->tmpl_tag);
diff -urpN freeradius-server-3.2.7/src/main/unittest.c freeradius-server-3.2.8/src/main/unittest.c
--- freeradius-server-3.2.7/src/main/unittest.c	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/main/unittest.c	2025-08-20 23:29:15.000000000 +0700
@@ -1,7 +1,7 @@
 /*
  * unittest.c	Unit test wrapper for the RADIUS daemon.
  *
- * Version:	$Id: feb72d6598abb0f1aff5a0a1f37637051701aeca $
+ * Version:	$Id: 1abf1105ac962fa1c47ff54e9e77fb069ce8bc3b $
  *
  *   This program is free software; you can redistribute it and/or modify
  *   it under the terms of the GNU General Public License as published by
@@ -21,7 +21,7 @@
  * Copyright 2013  Alan DeKok <aland@ox.org>
  */
 
-RCSID("$Id: feb72d6598abb0f1aff5a0a1f37637051701aeca $")
+RCSID("$Id: 1abf1105ac962fa1c47ff54e9e77fb069ce8bc3b $")
 
 #include <freeradius-devel/radiusd.h>
 #include <freeradius-devel/modules.h>
@@ -909,7 +909,7 @@ int main(int argc, char *argv[])
 		fclose(fp);
 	}
 
-	rad_virtual_server(request);
+	rad_virtual_server(request, true);
 
 	if (!output_file || (strcmp(output_file, "-") == 0)) {
 		fp = stdout;
diff -urpN freeradius-server-3.2.7/src/main/util.c freeradius-server-3.2.8/src/main/util.c
--- freeradius-server-3.2.7/src/main/util.c	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/main/util.c	2025-08-20 23:29:15.000000000 +0700
@@ -1,7 +1,7 @@
 /*
  * util.c	Various utility functions.
  *
- * Version:     $Id: 607bcaa92cd39c90380b81ec09cb0c67cc3bebf1 $
+ * Version:     $Id: e39921e3127d67367179b308a975fb763a7ed0cf $
  *
  *   This program is free software; you can redistribute it and/or modify
  *   it under the terms of the GNU General Public License as published by
@@ -20,7 +20,7 @@
  * Copyright 2000,2006  The FreeRADIUS server project
  */
 
-RCSID("$Id: 607bcaa92cd39c90380b81ec09cb0c67cc3bebf1 $")
+RCSID("$Id: e39921e3127d67367179b308a975fb763a7ed0cf $")
 
 #include <freeradius-devel/radiusd.h>
 #include <freeradius-devel/rad_assert.h>
@@ -1534,6 +1534,8 @@ void rad_suid_up(void)
 		fr_exit_now(1);
 	}
 
+	if (euid == suid) return;
+
 	if (setresuid(-1, suid, -1) < 0) {
 		ERROR("Failed switching to privileged user");
 		fr_exit_now(1);
diff -urpN freeradius-server-3.2.7/src/main/version.c freeradius-server-3.2.8/src/main/version.c
--- freeradius-server-3.2.7/src/main/version.c	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/main/version.c	2025-08-20 23:29:15.000000000 +0700
@@ -1,7 +1,7 @@
 /*
  * version.c	Print version number and exit.
  *
- * Version:	$Id: 44a6edc699e8cad9eb54e54e673bf6fd316e8505 $
+ * Version:	$Id: 2334ac491982168ea47bdf6ca4a8cfec78a13c84 $
  *
  *   This program is free software; you can redistribute it and/or modify
  *   it under the terms of the GNU General Public License as published by
@@ -22,7 +22,7 @@
  * Copyright 2000  Chris Parker <cparker@starnetusa.com>
  */
 
-RCSID("$Id: 44a6edc699e8cad9eb54e54e673bf6fd316e8505 $")
+RCSID("$Id: 2334ac491982168ea47bdf6ca4a8cfec78a13c84 $")
 
 #include <freeradius-devel/radiusd.h>
 USES_APPLE_DEPRECATED_API	/* OpenSSL API has been deprecated by Apple */
@@ -630,12 +630,16 @@ void version_print(void)
 		DEBUG2("  ");
 	}
 	INFO("FreeRADIUS Version " RADIUSD_VERSION_STRING);
-	INFO("Copyright (C) 1999-2023 The FreeRADIUS server project and contributors");
+	INFO("Copyright (C) 1999-2025 The FreeRADIUS server project and contributors");
 	INFO("There is NO warranty; not even for MERCHANTABILITY or FITNESS FOR A");
 	INFO("PARTICULAR PURPOSE");
 	INFO("You may redistribute copies of FreeRADIUS under the terms of the");
 	INFO("GNU General Public License");
 	INFO("For more information about these matters, see the file named COPYRIGHT");
+	INFO("");
+	INFO("FreeRADIUS is developed, maintained, and supported by InkBridge Networks.");
+	INFO("For commercial support, please email sales@inkbridgenetworks.com");
+	INFO("https://inkbridgenetworks.com/");
 
 	fflush(NULL);
 }
diff -urpN freeradius-server-3.2.7/src/main/xlat.c freeradius-server-3.2.8/src/main/xlat.c
--- freeradius-server-3.2.7/src/main/xlat.c	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/main/xlat.c	2025-08-20 23:29:15.000000000 +0700
@@ -15,7 +15,7 @@
  */
 
 /**
- * $Id: 4bd0a379cb418e78e148b1fb171fdc3035788e8c $
+ * $Id: 37cf6ebc8e64e58b5951f1f229c0003532920e94 $
  *
  * @file xlat.c
  * @brief String expansion ("translation"). Implements %Attribute -> value
@@ -24,7 +24,7 @@
  * @copyright 2000  Alan DeKok <aland@ox.org>
  */
 
-RCSID("$Id: 4bd0a379cb418e78e148b1fb171fdc3035788e8c $")
+RCSID("$Id: 37cf6ebc8e64e58b5951f1f229c0003532920e94 $")
 
 #include <freeradius-devel/radiusd.h>
 #include <freeradius-devel/parser.h>
@@ -1509,12 +1509,24 @@ static ssize_t xlat_tokenize_literal(TAL
 
 		/*
 		 *	Check for valid single-character expansions.
+		 *
+		 *	Allow '%' at the end of a string as itself.
 		 */
-		if (p[0] == '%') {
+		if ((p[0] == '%') && p[1]) {
 			ssize_t slen;
 			xlat_exp_t *next;
 
-			if (!p[1] || !strchr("%}cdelmntCDGHIMSTYv", p[1])) {
+			/*
+			 *	%" is likely the end of a string inside of a string.
+			 *	We'll allow it.
+			 */
+			if ((p[1] == '"') || (p[1] == '\'') || (p[1] == '`') || (p[1] == '/')) {
+				p += 2;
+				node->len += 2;
+				continue;
+			}
+
+			if (!strchr("%}cdelmntCDGHIMSTYv", p[1])) {
 				talloc_free(node);
 				*error = "Invalid variable expansion";
 				p++;
@@ -1629,7 +1641,9 @@ static void xlat_tokenize_debug(xlat_exp
 				DEBUG("%.*sref  %d", lvl + 1, xlat_tabs, node->attr.tmpl_request);
 				DEBUG("%.*slist %d", lvl + 1, xlat_tabs, node->attr.tmpl_list);
 
-				if (node->attr.tmpl_tag != TAG_ANY) {
+				if (node->attr.tmpl_tag == TAG_VALUE) {
+					DEBUG("%.*stag V", lvl + 1, xlat_tabs);
+				} else if (node->attr.tmpl_tag != TAG_ANY) {
 					DEBUG("%.*stag %d", lvl + 1, xlat_tabs, node->attr.tmpl_tag);
 				}
 				if (node->attr.tmpl_num != NUM_ANY) {
diff -urpN freeradius-server-3.2.7/src/modules/rlm_cache/rlm_cache.c freeradius-server-3.2.8/src/modules/rlm_cache/rlm_cache.c
--- freeradius-server-3.2.7/src/modules/rlm_cache/rlm_cache.c	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/modules/rlm_cache/rlm_cache.c	2025-08-20 23:29:15.000000000 +0700
@@ -15,13 +15,13 @@
  */
 
 /**
- * $Id: 345bedd25dfe5645b66ca87f684f28c962de4286 $
+ * $Id: fd2d4112b0696c91a4fed8c0db20f8ff74c02db4 $
  * @file rlm_cache.c
  * @brief Cache values and merge them back into future requests.
  *
  * @copyright 2012-2014 The FreeRADIUS server project
  */
-RCSID("$Id: 345bedd25dfe5645b66ca87f684f28c962de4286 $")
+RCSID("$Id: fd2d4112b0696c91a4fed8c0db20f8ff74c02db4 $")
 
 #include <freeradius-devel/radiusd.h>
 #include <freeradius-devel/modules.h>
@@ -598,7 +598,7 @@ static ssize_t cache_xlat(void *instance
 
 	if (cache_acquire(&handle, inst, request) < 0) return -1;
 
-	switch (cache_find(&c, inst, request, handle, fmt)) {
+	switch (cache_find(&c, inst, request, &handle, fmt)) {
 	case RLM_MODULE_OK:		/* found */
 		break;
 
diff -urpN freeradius-server-3.2.7/src/modules/rlm_dpsk/README.md freeradius-server-3.2.8/src/modules/rlm_dpsk/README.md
--- freeradius-server-3.2.7/src/modules/rlm_dpsk/README.md	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/modules/rlm_dpsk/README.md	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,9 @@
+# rlm_dpsk
+## Metadata
+<dl>
+  <dt>category</dt><dd>datastore</dd>
+</dl>
+
+## Summary
+
+The DPSK module implements dynamic PSK (or personal PSK) for WPA-PSK.
diff -urpN freeradius-server-3.2.7/src/modules/rlm_dpsk/rlm_dpsk.c freeradius-server-3.2.8/src/modules/rlm_dpsk/rlm_dpsk.c
--- freeradius-server-3.2.7/src/modules/rlm_dpsk/rlm_dpsk.c	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/modules/rlm_dpsk/rlm_dpsk.c	2025-08-20 23:29:15.000000000 +0700
@@ -18,13 +18,13 @@
  */
 
 /**
- * $Id: 35773056b3d080b3dff4e3f5a9a229dc645bca41 $
+ * $Id: 4b818d08a500716ec7560abfc44a0c4a33290e38 $
  * @file rlm_dpsk.c
  * @brief Dynamic PSK for WiFi
  *
  * @copyright 2023 Network RADIUS SAS (legal@networkradius.com)
  */
-RCSID("$Id: 35773056b3d080b3dff4e3f5a9a229dc645bca41 $")
+RCSID("$Id: 4b818d08a500716ec7560abfc44a0c4a33290e38 $")
 
 #include <freeradius-devel/radiusd.h>
 #include <freeradius-devel/modules.h>
@@ -44,7 +44,7 @@ RCSID("$Id: 35773056b3d080b3dff4e3f5a9a2
 
 #define VENDORPEC_RUCKUS	(25053)
 #define PW_RUCKUS_BSSID		(14)
-#define PW_RUCKUS_DPSK_PARAMS	(152)
+#define PW_RUCKUS_DPSK_PARAMS	(153)
 
 //#define PW_RUCKUS_DPSK_CIPHER	(PW_RUCKUS_DPSK_PARAMS | (2 << 8))
 #define PW_RUCKUS_DPSK_ANONCE	(PW_RUCKUS_DPSK_PARAMS | (3 << 8))
@@ -110,7 +110,7 @@ typedef struct {
 	char			*identity;
 	size_t			identity_len;
 
-	uint8_t			*psk;
+	char			*psk;
 	size_t			psk_len;
 	time_t			expires;
 
@@ -273,52 +273,16 @@ static rlm_dpsk_cache_t *dpsk_cache_find
 }
 
 
-static int generate_pmk(REQUEST *request, rlm_dpsk_t const *inst, uint8_t *buffer, size_t buflen, VALUE_PAIR *ssid, uint8_t const *mac, char const *psk, size_t psk_len)
+static int generate_pmk(REQUEST *request, uint8_t *buffer, size_t buflen, VALUE_PAIR *ssid, char const *psk, size_t psk_len)
 {
-	VALUE_PAIR *vp;
-
 	fr_assert(buflen == 32);
 
-	if (!ssid) {
-		ssid = fr_pair_find_by_da(request->packet->vps, inst->ssid, TAG_ANY);
-		if (!ssid) {
-			RDEBUG("No %s in the request", inst->ssid->name);
-			return 0;
-		}
-	}
-
-	/*
-	 *	No provided PSK.  Try to look it up in the cache.  If
-	 *	it isn't there, find it in the config items.
-	 */
-	if (!psk) {
-		if (inst->cache && mac) {
-			rlm_dpsk_cache_t *entry;
-
-			entry = dpsk_cache_find(request, inst, buffer, buflen, ssid, mac);
-			if (entry) {
-				memcpy(buffer, entry->pmk, buflen);
-				return 1;
-			}
-			RDEBUG3("Cache entry not found");
-		} /* else no caching */
-
-		vp = fr_pair_find_by_num(request->config, PW_PRE_SHARED_KEY, 0, TAG_ANY);
-		if (!vp) {
-			RDEBUG("No &config:Pre-Shared-Key");
-			return 0;
-		}
-
-		psk = vp->vp_strvalue;
-		psk_len = vp->vp_length;
-	}
-
 	if (PKCS5_PBKDF2_HMAC_SHA1((const char *) psk, psk_len, (const unsigned char *) ssid->vp_strvalue, ssid->vp_length, 4096, buflen, buffer) == 0) {
 		RDEBUG("Failed calling OpenSSL to calculate the PMK");
-		return 0;
+		return -1;
 	}
 
-	return 1;
+	return 0;
 }
 
 /*
@@ -327,15 +291,18 @@ static int generate_pmk(REQUEST *request
 static rlm_rcode_t CC_HINT(nonnull) mod_authenticate(void *instance, REQUEST *request)
 {
 	rlm_dpsk_t *inst = instance;
-	VALUE_PAIR *anonce, *key_msg, *ssid, *vp;
-	rlm_dpsk_cache_t *entry;
+	VALUE_PAIR *anonce, *key_msg, *vp, *vp_psk = NULL, *vp_id = NULL, *vp_ssid = NULL;
+	rlm_dpsk_cache_t *entry = NULL;
 	int lineno = 0;
-	size_t len, psk_len;
+	int stage = 0;
+	rlm_rcode_t rcode = RLM_MODULE_OK;
+	size_t len, psk_len = 0;
 	unsigned int digest_len, mic_len;
 	eapol_attr_t const *eapol;
 	eapol_attr_t *zeroed;
 	FILE *fp = NULL;
-	char const *psk_identity = NULL, *psk;
+	char const *filename = inst->filename;
+	char const *psk_identity = NULL, *psk = NULL;
 	uint8_t *p;
 	uint8_t const *snonce, *ap_mac;
 	uint8_t const *min_mac, *max_mac;
@@ -344,6 +311,8 @@ static rlm_rcode_t CC_HINT(nonnull) mod_
 	uint8_t s_mac[6], message[sizeof("Pairwise key expansion") + 6 + 6 + 32 + 32 + 1], frame[128];
 	uint8_t digest[EVP_MAX_MD_SIZE], mic[EVP_MAX_MD_SIZE];
 	char token_identity[256];
+	char token_psk[256];
+	char filename_buffer[1024];
 
 	/*
 	 *	Search for the information in a bunch of attributes.
@@ -375,40 +344,40 @@ static rlm_rcode_t CC_HINT(nonnull) mod_
 		return RLM_MODULE_NOOP;
 	}
 
-	ssid = fr_pair_find_by_da(request->packet->vps, inst->ssid, TAG_ANY);
-	if (!ssid) {
+	vp_ssid = fr_pair_find_by_da(request->packet->vps, inst->ssid, TAG_ANY);
+	if (!vp_ssid) {
 		RDEBUG("No %s in the request", inst->ssid->name);
-		return 0;
+		return RLM_MODULE_NOOP;
 	}
 
 	/*
-	 *	Get supplicant MAC address.
+	 *	At this point, the request has the relevant DPSK
+	 *	attributes.  The module now should return FAIL for
+	 *	missing / invalid attributes, or REJECT for
+	 *	authentication failure.
+	 *
+	 *	If the entry is found in a VP or a cache, the module
+	 *	returns OK.  This means that the caller should not
+	 *	save &control:Pre-Shared-Key somewhere.
+	 *
+	 *	If the module found a matching entry in the file, it
+	 *	returns UPDATED to indicate that the caller should
+	 *	update the database with the PSK which was found.
+	 */
+
+	/*
+	 *	Get supplicant MAC address from the User-Name
 	 */
 	vp = fr_pair_find_by_num(request->packet->vps, PW_USER_NAME, 0, TAG_ANY);
 	if (!vp) {
-		RDEBUG("No &User-Name");
-		return RLM_MODULE_NOOP;
+		RDEBUG("Missing &User-Name");
+		return RLM_MODULE_FAIL;
 	}
 
 	len = fr_hex2bin(s_mac, sizeof(s_mac), vp->vp_strvalue, vp->vp_length);
 	if (len != 6) {
 		RDEBUG("&User-Name is not a recognizable hex MAC address");
-		return RLM_MODULE_NOOP;
-	}
-
-	/*
-	 *	In case we're not reading from a file.
-	 */
-	vp = fr_pair_find_by_num(request->config, PW_PSK_IDENTITY, 0, TAG_ANY);
-	if (vp) psk_identity = vp->vp_strvalue;
-
-	vp = fr_pair_find_by_num(request->config, PW_PRE_SHARED_KEY, 0, TAG_ANY);
-	if (vp) {
-		psk = vp->vp_strvalue;
-		psk_len = vp->vp_length;
-	} else {
-		psk = NULL;
-		psk_len = 0;
+		return RLM_MODULE_FAIL;
 	}
 
 	/*
@@ -416,13 +385,13 @@ static rlm_rcode_t CC_HINT(nonnull) mod_
 	 */
 	vp = fr_pair_find_by_num(request->packet->vps, PW_CALLED_STATION_MAC, 0, TAG_ANY);
 	if (!vp) {
-		RDEBUG("No &Called-Station-MAC");
-		return RLM_MODULE_NOOP;
+		RDEBUG("Missing &Called-Station-MAC");
+		return RLM_MODULE_FAIL;
 	}
 
 	if (vp->length != 6) {
 		RDEBUG("&Called-Station-MAC is not a recognizable MAC address");
-		return RLM_MODULE_NOOP;
+		return RLM_MODULE_FAIL;
 	}
 
 	ap_mac = vp->vp_octets;
@@ -470,32 +439,99 @@ static rlm_rcode_t CC_HINT(nonnull) mod_
 	*p = '\0';
 	fr_assert(sizeof(message) == (p + 1 - message));
 
-	if (inst->filename && !psk) {
-		FR_TOKEN token;
-		char const *q, *filename;
-		char token_psk[256];
-		char token_mac[256];
-		char buffer[1024];
-		char filename_buffer[1024];
-
-		/*
-		 *	If there's a cached entry, we don't read the file.
-		 */
-		entry = dpsk_cache_find(request, inst, pmk, sizeof(pmk), ssid, s_mac);
+	/*
+	 *	If we're caching, then check the cache first, before
+	 *	trying the file.  This check allows us to avoid the
+	 *	PMK calculation in many situations, as that can be
+	 *	expensive.
+	 */
+	if (inst->cache) {
+		entry = dpsk_cache_find(request, inst, pmk, sizeof(pmk), vp_ssid, s_mac);
 		if (entry) {
 			psk_identity = entry->identity;
+			psk = entry->psk;
+			psk_len = entry->psk_len;
 			goto make_digest;
 		}
+	}
+
+	/*
+	 *	No cache, or no cache entry.  Look for an external PMK
+	 *	taken from a database.
+	 */
+stage1:
+	stage = 1;
+
+	vp = fr_pair_find_by_num(request->config, PW_PAIRWISE_MASTER_KEY, 0, TAG_ANY);
+	if (vp && (vp->vp_length != sizeof(pmk))) {
+		RDEBUG("&control:Pairwise-Master-Key has incorrect length (%zu != %zu) - ignoring it", vp->vp_length, sizeof(pmk));
+		vp = NULL;
+	}
+
+	if (vp) {
+		RDEBUG("Using &control:Pairwise-Master-Key");
+		memcpy(pmk, vp->vp_octets, sizeof(pmk));
+		goto make_digest;
+	}
+
+	/*
+	 *	No external PMK.  Try an external PSK.
+	 */
+	vp_psk = fr_pair_find_by_num(request->config, PW_PRE_SHARED_KEY, 0, TAG_ANY);
+	if (vp_psk) {
+		RDEBUG("Trying &control:Pre-Shared-Key");
+		if (generate_pmk(request, pmk, sizeof(pmk), vp_ssid, vp_psk->vp_strvalue, vp_psk->vp_length) < 0) {
+			fr_assert(!fp);
+			return RLM_MODULE_FAIL;
+		}
 
-		if (!inst->dynamic) {
-			filename = inst->filename;
+		vp_id = fr_pair_find_by_num(request->config, PW_PSK_IDENTITY, 0, TAG_ANY);
+		if (vp_id) {
+			psk_identity = vp_id->vp_strvalue;
 		} else {
+			vp = fr_pair_find_by_num(request->packet->vps, PW_USER_NAME, 0, TAG_ANY);
+			if (!vp) return RLM_MODULE_REJECT;
+
+			psk_identity = vp->vp_strvalue;
+		}
+
+		psk = vp_psk->vp_strvalue;
+		psk_len = vp_psk->vp_length;
+
+		goto make_digest;
+	}
+
+	/*
+	 *	No external PSK was found.  If there's no file, then
+	 *	we can't do anything else.
+	 */
+stage2:
+	stage = 2;
+
+	if (!inst->filename) {
+		RDEBUG("No &control:Pre-Shared-Key was found, and no 'filename' was configured");
+		return RLM_MODULE_FAIL;
+	}
+
+	/*
+	 *	If there's an PSK from an external database, then we
+	 *	never read the filename.
+	 */
+	if (inst->filename) {
+		FR_TOKEN token;
+		char const *q;
+		char token_mac[256];
+		char buffer[1024];
+
+		if (inst->dynamic) {
 			if (radius_xlat(filename_buffer, sizeof(filename_buffer),
 					request, inst->filename, NULL, NULL) < 0) {
 				return RLM_MODULE_FAIL;
 			}
 
 			filename = filename_buffer;
+		} else {
+			fr_assert(filename == inst->filename);
 		}
 
 		RDEBUG3("Looking for PSK in file %s", filename);
@@ -506,11 +542,11 @@ static rlm_rcode_t CC_HINT(nonnull) mod_
 			return RLM_MODULE_FAIL;
 		}
 
-get_next_psk:
+stage2a:
 		q = fgets(buffer, sizeof(buffer), fp);
 		if (!q) {
-			RDEBUG("Failed to find matching key in %s", filename);
-		fail:
+			RDEBUG("Failed to find matching PSK or MAC in %s", filename);
+		fail_file:
 			fclose(fp);
 			return RLM_MODULE_FAIL;
 		}
@@ -521,28 +557,33 @@ get_next_psk:
 		token = getstring(&q, token_identity, sizeof(token_identity), true);
 		if (token == T_INVALID) {
 			RDEBUG("%s[%d] Failed parsing identity", filename, lineno);
-			goto fail;
+			goto fail_file;
 		}
 
 		if (*q != ',') {
 			RDEBUG("%s[%d] Failed to find ',' after identity", filename, lineno);
-			goto fail;
+			goto fail_file;
 		}
 		q++;
 
 		token = getstring(&q, token_psk, sizeof(token_psk), true);
 		if (token == T_INVALID) {
 			RDEBUG("%s[%d] Failed parsing PSK", filename, lineno);
-			goto fail;
+			goto fail_file;
 		}
 
+		/*
+		 *	The MAC is optional.  If there is a MAC, we
+		 *	loop over the file until we find a matching
+		 *	one.
+		 */
 		if (*q == ',') {
 			q++;
 
 			token = getstring(&q, token_mac, sizeof(token_mac), true);
 			if (token == T_INVALID) {
 				RDEBUG("%s[%d] Failed parsing MAC", filename, lineno);
-				goto fail;
+				goto fail_file;
 			}
 
 			/*
@@ -552,61 +593,31 @@ get_next_psk:
 			if ((strlen(token_mac) != 12) ||
 			    (fr_hex2bin((uint8_t *) token_mac, 6, token_mac, 12) != 12)) {
 				RDEBUG("%s[%d] Failed parsing MAC", filename, lineno);
-				goto fail;
-			}
-
-			if (memcmp(s_mac, token_mac, 6) != 0) {
-				psk_identity = NULL;
-				goto get_next_psk;
+				goto fail_file;
 			}
 
 			/*
-			 *	Close the file so that we don't check any other entries.
+			 *	The MAC doesn't match, don't even bother trying to generate the PMK.
 			 */
-			MEM(vp = fr_pair_afrom_num(request, PW_PRE_SHARED_KEY, 0));
-			fr_pair_value_bstrncpy(vp, token_psk, strlen(token_psk));
-
-			fr_pair_add(&request->config, vp);
-			fclose(fp);
-			fp = NULL;
+			if (memcmp(s_mac, token_mac, 6) != 0) {
+				goto stage2a;
+			}
 
 			RDEBUG3("Found matching MAC");
+			stage = 3;
 		}
 
 		/*
 		 *	Generate the PMK using the SSID, this MAC, and the PSK we just read.
 		 */
-		RDEBUG3("%s[%d] Trying PSK %s", filename, lineno, token_psk);
-		if (generate_pmk(request, inst, pmk, sizeof(pmk), ssid, s_mac, token_psk, strlen(token_psk)) == 0) {
-			RDEBUG("No &config:Pairwise-Master-Key or &config:Pre-Shared-Key found");
-			return RLM_MODULE_NOOP;
-		}
-
-		/*
-		 *	Remember which identity we had
-		 */
+		psk = token_psk;
+		psk_len = strlen(token_psk);
 		psk_identity = token_identity;
-		goto make_digest;
-	}
 
-	/*
-	 *	Use the PMK if it already exists.  Otherwise calculate it from the PSK.
-	 */
-	vp = fr_pair_find_by_num(request->config, PW_PAIRWISE_MASTER_KEY, 0, TAG_ANY);
-	if (!vp) {
-		if (generate_pmk(request, inst, pmk, sizeof(pmk), ssid, s_mac, psk, psk_len) == 0) {
-			RDEBUG("No &config:Pairwise-Master-Key or &config:Pre-Shared-Key found");
-			fr_assert(!fp);
-			return RLM_MODULE_NOOP;
+		RDEBUG3("%s[%d] Trying PSK %s", filename, lineno, token_psk);
+		if (generate_pmk(request, pmk, sizeof(pmk), vp_ssid, psk, psk_len) < 0) {
+			goto fail_file;
 		}
-
-	} else if (vp->vp_length != sizeof(pmk)) {
-		RDEBUG("Pairwise-Master-Key has incorrect length (%zu != %zu)", vp->vp_length, sizeof(pmk));
-		fr_assert(!fp);
-		return RLM_MODULE_NOOP;
-
-	} else {
-		memcpy(pmk, vp->vp_octets, sizeof(pmk));
 	}
 
 	/*
@@ -635,58 +646,116 @@ make_digest:
 	HMAC(EVP_sha1(), digest, 16, frame, key_msg->vp_length, mic, &mic_len);
 
 	/*
-	 *	Do the MICs match?
+	 *	The MICs don't match.
 	 */
 	if (memcmp(&eapol->frame.mic[0], mic, 16) != 0) {
-		if (fp) {
-			psk_identity = NULL;
-			goto get_next_psk;
-		}
-
+		RDEBUG3("Stage %d", stage);
 		RDEBUG_HEX(request, "calculated mic:", mic, 16);
 		RDEBUG_HEX(request, "packet mic    :", &eapol->frame.mic[0], 16);
+
+		psk_identity = NULL;
+		psk = NULL;
+		psk_len = 0;
+
+		/*
+		 *	Found a cached entry, but it didn't match.  Go
+		 *	check external PMK / PSK.
+		 */
+		if (stage == 0) {
+			fr_assert(entry != NULL);
+			rbtree_deletebydata(inst->cache, entry); /* locks and unlinks the entry */
+			entry = NULL;
+			goto stage1;
+		}
+
+		/*
+		 *	Found an external PMK or PSK, but it didn't
+		 *	match.  Go check the file.
+		 */
+		if (stage == 1) {
+			if (vp_psk) RDEBUG("&control:Pre-Shared-Key did not match");
+
+			if (inst->filename) {
+				RDEBUG("Checking file %s for PSK and MAC", inst->filename);
+				goto stage2;
+			}
+
+			RDEBUG("No 'filename' was configured.");
+			return RLM_MODULE_REJECT;
+		}
+
+		/*
+		 *	The file is open, so we keep reading it until
+		 *	we find a matching entry.
+		 */
+		fr_assert(fp);
+
+		if (stage == 2) goto stage2a;
+
+		fclose(fp);
+
+		/*
+		 *	We found a PSK associated with this MAC in the
+		 *	file.  But it didn't match, so we're done.
+		 */
+		fr_assert(stage == 3);
+
+		RDEBUG("Found matching MAC in %s, but the PSK does not match", inst->filename);
 		return RLM_MODULE_FAIL;
 	}
 
 	/*
-	 *	It matches.  Close the input file if necessary.
-	 */
-	if (fp) fclose(fp);
+	 *	We found a matching PSK.  If we read it from the file,
+	 *	then close the file, and ensure that we return
+	 *	UPDATED.  This tells the caller to write the entry
+	 *	into the database, so that we don't need to scan the
+	 *	file again.
+	 */
+	if (fp) {
+		rcode = RLM_MODULE_UPDATED;
+		fr_assert(psk == token_psk);
+		fr_assert(psk_identity == token_identity);
+		fclose(fp);
+	}
 
 	/*
 	 *	Extend the lifetime of the cache entry, or add the
-	 *	cache entry if necessary.
+	 *	cache entry if necessary.  We only add / update the
+	 *	cache entry if the PSK was not found in a VP.
+	 *
+	 *	If the caller gave us only a PMK, then don't cache anything.
 	 */
-	if (inst->cache) {
+	if (inst->cache && psk && psk_identity) {
 		rlm_dpsk_cache_t my_entry;
 
 		/*
-		 *	Find the entry (again), and update the expiry time.
-		 *
-		 *	Create the entry if neessary.
+		 *	We've found an entry. Just update it.
 		 */
-		memcpy(my_entry.mac, s_mac, sizeof(my_entry.mac));
+		if (entry) goto update_entry;
 
-		vp = fr_pair_find_by_da(request->packet->vps, inst->ssid, TAG_ANY);
-		if (!vp) goto save_psk; /* should never really happen, but just to be safe */
-
-		memcpy(&my_entry.ssid, &vp->vp_octets, sizeof(my_entry.ssid)); /* const issues */
-		my_entry.ssid_len = vp->vp_length;
+		/*
+		 *	No cached entry, or the PSK in the cached
+		 *	entry didn't match.  We need to create one.
+		 */
+		memcpy(my_entry.mac, s_mac, sizeof(my_entry.mac));
+		memcpy(&my_entry.ssid, &vp_ssid->vp_octets, sizeof(my_entry.ssid)); /* const ptr issues */
+		my_entry.ssid_len = vp_ssid->vp_length;
 
 		entry = rbtree_finddata(inst->cache, &my_entry);
 		if (!entry) {
 			/*
-			 *	Too many entries in the cache.  Delete the oldest one.
+			 *	Maybe there are oo many entries in the
+			 *	cache.  If so, delete the oldest one.
 			 */
 			if (rbtree_num_elements(inst->cache) > inst->cache_size) {
 				PTHREAD_MUTEX_LOCK(&inst->mutex);
 				entry = fr_dlist_head(&inst->head);
 				PTHREAD_MUTEX_UNLOCK(&inst->mutex);
 
-				rbtree_deletebydata(inst->cache, entry);
+				rbtree_deletebydata(inst->cache, entry); /* locks and unlinks the entry */
 			}
 
-			MEM(entry = talloc_zero(NULL, rlm_dpsk_cache_t));
+			MEM(entry = talloc_zero(inst->cache, rlm_dpsk_cache_t));
 
 			memcpy(entry->mac, s_mac, sizeof(entry->mac));
 			memcpy(entry->pmk, pmk, sizeof(entry->pmk));
@@ -695,41 +764,30 @@ make_digest:
 			entry->inst = inst;
 
 			/*
-			 *	Save the variable-length SSID.
+			 *	Save the SSID, PSK, and PSK identity in the cache entry.
 			 */
-			MEM(entry->ssid = talloc_memdup(entry, vp->vp_octets, vp->vp_length));
-			entry->ssid_len = vp->vp_length;
+			MEM(entry->ssid = talloc_memdup(entry, vp_ssid->vp_octets, vp_ssid->vp_length));
+			entry->ssid_len = vp_ssid->vp_length;
 
-			/*
-			 *	Save the PSK.  If we just have the
-			 *	PMK, then we can still cache that.
-			 */
-			vp = fr_pair_find_by_num(request->config, PW_PRE_SHARED_KEY, 0, TAG_ANY);
-			if (vp) {
-				MEM(entry->psk = talloc_memdup(entry, vp->vp_octets, vp->vp_length));
-				entry->psk_len = vp->vp_length;
-			}
+			MEM(entry->psk = talloc_memdup(entry, psk, psk_len));
+			entry->psk_len = psk_len;
 
-			/*
-			 *	Save the identity.
-			 */
-			if (psk_identity) {
-				MEM(entry->identity = talloc_memdup(entry, psk_identity, strlen(psk_identity)));
-				entry->identity_len = strlen(psk_identity);
-			}
+			entry->identity_len = strlen(psk_identity);
+			MEM(entry->identity = talloc_memdup(entry, psk_identity, entry->identity_len));
 
 			/*
 			 *	Cache it.
 			 */
 			if (!rbtree_insert(inst->cache, entry)) {
-				talloc_free(entry);
-				goto save_found_psk;
+				TALLOC_FREE(entry);
+				goto update_attributes;
 			}
 			RDEBUG3("Cache entry saved");
 		}
-		entry->expires = request->timestamp + inst->cache_lifetime;
 
+	update_entry:
 		PTHREAD_MUTEX_LOCK(&inst->mutex);
+		entry->expires = request->timestamp + inst->cache_lifetime;
 		fr_dlist_entry_unlink(&entry->dlist);
 		fr_dlist_insert_tail(&inst->head, &entry->dlist);
 		PTHREAD_MUTEX_UNLOCK(&inst->mutex);
@@ -743,33 +801,32 @@ make_digest:
 
 			fr_pair_add(&request->reply->vps, vp);
 		}
-
-		goto save_psk_identity;
 	}
 
+update_attributes:
 	/*
-	 *	Save a copy of the found PSK in the reply;
+	 *	We found a cache entry, or an external PSK.  Don't
+	 *	create new attributes.
 	 */
-save_psk:
-	vp = fr_pair_find_by_num(request->config, PW_PRE_SHARED_KEY, 0, TAG_ANY);
-
-save_found_psk:
-	if (!vp) return RLM_MODULE_OK;
+	if (rcode == RLM_MODULE_OK) return RLM_MODULE_OK;
 
-	fr_pair_add(&request->reply->vps, fr_pair_copy(request->reply, vp));
+	fr_assert(psk != NULL);
+	fr_assert(psk_identity != NULL);
 
-save_psk_identity:
 	/*
-	 *	Save which identity matched.
+	 *	Create the attributes which the caller can then save
+	 *	in the database.
 	 */
-	if (psk_identity) {
-		MEM(vp = fr_pair_afrom_num(request->reply, PW_PSK_IDENTITY, 0));
-		fr_pair_value_bstrncpy(vp, psk_identity, strlen(psk_identity));
+	RDEBUG("Creating &reply:PSK-Identity and &reply:Pre-Shared-Key");
+	MEM(vp = fr_pair_afrom_num(request->reply, PW_PRE_SHARED_KEY, 0));
+	fr_pair_value_bstrncpy(vp, psk, psk_len);
+	fr_pair_add(&request->reply->vps, vp);
 
-		fr_pair_add(&request->reply->vps, vp);
-	}
+	MEM(vp = fr_pair_afrom_num(request->reply, PW_PSK_IDENTITY, 0));
+	fr_pair_value_bstrncpy(vp, psk_identity, strlen(psk_identity));
+	fr_pair_add(&request->reply->vps, vp);
 
-	return RLM_MODULE_OK;
+	return RLM_MODULE_UPDATED;
 }
 
 /*
@@ -790,10 +847,27 @@ static ssize_t dpsk_xlat(void *instance,
 	while (isspace((uint8_t) *p)) p++;
 
 	if (!*p) {
-		if (generate_pmk(request, inst, buffer, sizeof(buffer), NULL, NULL, NULL, 0) == 0) {
-			RDEBUG("No &request:Called-Station-SSID or &config:Pre-Shared-Key found");
+		VALUE_PAIR *vp_ssid, *vp_psk;
+
+		vp_ssid = fr_pair_find_by_da(request->packet->vps, inst->ssid, TAG_ANY);
+		if (!vp_ssid) {
+			RDEBUG("No %s in the request", inst->ssid->name);
+			return 0;
+		}
+
+		vp_psk = fr_pair_find_by_num(request->config, PW_PRE_SHARED_KEY, 0, TAG_ANY);
+		if (!vp_psk) {
+			RDEBUG("No &config:Pre-Shared-Key");
 			return 0;
 		}
+
+		psk = vp_psk->vp_strvalue;
+		psk_len = vp_psk->vp_length;
+
+		ssid = vp_ssid->vp_strvalue;
+		ssid_len = vp_ssid->vp_length;
+		goto get_pmk;
+
 	} else {
 		ssid = p;
 
@@ -812,6 +886,7 @@ static ssize_t dpsk_xlat(void *instance,
 
 		psk_len = p - psk;
 
+	get_pmk:
 		if (PKCS5_PBKDF2_HMAC_SHA1(psk, psk_len, (const unsigned char *) ssid, ssid_len, 4096, sizeof(buffer), buffer) == 0) {
 			RDEBUG("Failed calling OpenSSL to calculate the PMK");
 			return 0;
@@ -889,12 +964,15 @@ static int mod_instantiate(CONF_SECTION
 {
 	rlm_dpsk_t *inst = instance;
 
+	/*
+	 *	We can still use a cache if we're getting PSKs from a
+	 *	database.  The PMK calculation can take time, so
+	 *	caching the PMK still saves us time.
+	 */
 	if (!inst->cache_size) return 0;
 
 	FR_INTEGER_BOUND_CHECK("cache_size", inst->cache_size, <=, ((uint32_t) 1) << 16);
 
-	if (!inst->cache_size) return 0;
-
 	FR_INTEGER_BOUND_CHECK("cache_lifetime", inst->cache_lifetime, <=, (7 * 86400));
 	FR_INTEGER_BOUND_CHECK("cache_lifetime", inst->cache_lifetime, >=, 3600);
 
@@ -915,17 +993,20 @@ static int mod_instantiate(CONF_SECTION
 	return 0;
 }
 
-#ifdef HAVE_PTHREAD_H
 static int mod_detach(void *instance)
 {
 	rlm_dpsk_t *inst = instance;
 
 	if (!inst->cache_size) return 0;
 
+	rbtree_free(inst->cache);
+
+#ifdef HAVE_PTHREAD_H
 	pthread_mutex_destroy(&inst->mutex);
+#endif
+
 	return 0;
 }
-#endif
 
 /*
  *	The module name should be the only globally exported symbol.
@@ -945,9 +1026,7 @@ module_t rlm_dpsk = {
 	.config		= module_config,
 	.bootstrap	= mod_bootstrap,
 	.instantiate	= mod_instantiate,
-#ifdef HAVE_PTHREAD_H
 	.detach		= mod_detach,
-#endif
 	.methods = {
 		[MOD_AUTHORIZE]		= mod_authorize,
 		[MOD_AUTHENTICATE]	= mod_authenticate,
diff -urpN freeradius-server-3.2.7/src/modules/rlm_eap/libeap/eap_chbind.c freeradius-server-3.2.8/src/modules/rlm_eap/libeap/eap_chbind.c
--- freeradius-server-3.2.7/src/modules/rlm_eap/libeap/eap_chbind.c	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/modules/rlm_eap/libeap/eap_chbind.c	2025-08-20 23:29:15.000000000 +0700
@@ -1,7 +1,7 @@
 /*
  * eap_chbind.c
  *
- * Version:     $Id: 21b258410cf2b4293a37aebb49d2adeaeba74ca2 $
+ * Version:     $Id: 5237b2a8cea72f7970f59edc5e698553ca9c47c5 $
  *
  *   This program is free software; you can redistribute it and/or modify
  *   it under the terms of the GNU General Public License as published by
@@ -22,7 +22,7 @@
  */
 
 
-RCSID("$Id: 21b258410cf2b4293a37aebb49d2adeaeba74ca2 $")
+RCSID("$Id: 5237b2a8cea72f7970f59edc5e698553ca9c47c5 $")
 
 #include "eap_chbind.h"
 
@@ -207,7 +207,7 @@ PW_CODE chbind_process(REQUEST *request,
 	fake->server = "channel_bindings";
 	fake->packet->code = PW_CODE_ACCESS_REQUEST;
 
-	switch (rad_virtual_server(fake)) {
+	switch (rad_virtual_server(fake, true)) {
 		/* If rad_authenticate succeeded, build a reply */
 	case RLM_MODULE_OK:
 	case RLM_MODULE_HANDLED:
diff -urpN freeradius-server-3.2.7/src/modules/rlm_eap/libeap/mppe_keys.c freeradius-server-3.2.8/src/modules/rlm_eap/libeap/mppe_keys.c
--- freeradius-server-3.2.7/src/modules/rlm_eap/libeap/mppe_keys.c	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/modules/rlm_eap/libeap/mppe_keys.c	2025-08-20 23:29:15.000000000 +0700
@@ -1,7 +1,7 @@
 /*
  * mppe_keys.c
  *
- * Version:     $Id: 43561641920d14c46a55a87946aa1a7c6bd8ac3d $
+ * Version:     $Id: 6ecae94aa42108552f950ad177e003a6e23f51b9 $
  *
  *   This program is free software; you can redistribute it and/or modify
  *   it under the terms of the GNU General Public License as published by
@@ -22,7 +22,7 @@
  * Authors: Henrik Eriksson <henriken@axis.com> & Lars Viklund <larsv@axis.com>
  */
 
-RCSID("$Id: 43561641920d14c46a55a87946aa1a7c6bd8ac3d $")
+RCSID("$Id: 6ecae94aa42108552f950ad177e003a6e23f51b9 $")
 USES_APPLE_DEPRECATED_API	/* OpenSSL API has been deprecated by Apple */
 
 #include "eap_tls.h"
@@ -296,13 +296,16 @@ void eaptls_gen_mppe_keys(REQUEST *reque
 
 	eaptls_gen_keys_only(request, s, label, context, context_size, out, sizeof(out));
 
+	/*
+	 *	Add these before the MPPE keys for TEAP.
+	 */
+	eap_add_reply(request, "EAP-MSK", out, 64);
+	eap_add_reply(request, "EAP-EMSK", out + 64, 64);
+
 	p = out;
 	eap_add_reply(request, "MS-MPPE-Recv-Key", p, EAPTLS_MPPE_KEY_LEN);
 	p += EAPTLS_MPPE_KEY_LEN;
 	eap_add_reply(request, "MS-MPPE-Send-Key", p, EAPTLS_MPPE_KEY_LEN);
-
-	eap_add_reply(request, "EAP-MSK", out, 64);
-	eap_add_reply(request, "EAP-EMSK", out + 64, 64);
 }
 
 #define FR_TLS_PRF_CHALLENGE		"ttls challenge"
diff -urpN freeradius-server-3.2.7/src/modules/rlm_eap/radeapclient.c freeradius-server-3.2.8/src/modules/rlm_eap/radeapclient.c
--- freeradius-server-3.2.7/src/modules/rlm_eap/radeapclient.c	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/modules/rlm_eap/radeapclient.c	2025-08-20 23:29:15.000000000 +0700
@@ -1,7 +1,7 @@
 /*
  * radeapclient.c	EAP specific radius packet debug tool.
  *
- * Version:	$Id: 66d9f040f924a56bd92169663dccf8cbdae3f7d2 $
+ * Version:	$Id: 82b17a0b48cdee3bb0fda1d8037e1c69681e0cae $
  *
  *   This program is free software; you can redistribute it and/or modify
  *   it under the terms of the GNU General Public License as published by
@@ -22,7 +22,7 @@
  * Copyright 2000  Alan DeKok <aland@ox.org>
  */
 
-RCSID("$Id: 66d9f040f924a56bd92169663dccf8cbdae3f7d2 $")
+RCSID("$Id: 82b17a0b48cdee3bb0fda1d8037e1c69681e0cae $")
 
 #include <freeradius-devel/libradius.h>
 
@@ -246,7 +246,7 @@ static const FR_NAME_NUMBER rc_request_t
 	{ NULL, 0}
 };
 
-int rad_virtual_server(REQUEST UNUSED *request)
+int rad_virtual_server(REQUEST UNUSED *request, bool UNUSED check_username)
 {
   /*We're not the server so we cannot do this*/
   abort();
@@ -1996,7 +1996,7 @@ int main(int argc, char **argv)
 			timeout = atof(optarg);
 			break;
 		case 'v':
-			printf("$Id: 66d9f040f924a56bd92169663dccf8cbdae3f7d2 $"
+			printf("$Id: 82b17a0b48cdee3bb0fda1d8037e1c69681e0cae $"
 #ifndef ENABLE_REPRODUCIBLE_BUILDS
 			", built on " __DATE__ " at " __TIME__
 #endif
diff -urpN freeradius-server-3.2.7/src/modules/rlm_eap/rlm_eap.c freeradius-server-3.2.8/src/modules/rlm_eap/rlm_eap.c
--- freeradius-server-3.2.7/src/modules/rlm_eap/rlm_eap.c	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/modules/rlm_eap/rlm_eap.c	2025-08-20 23:29:15.000000000 +0700
@@ -15,7 +15,7 @@
  */
 
 /**
- * $Id: f94c4928a1e172cec27f7770d58b1dca7904e938 $
+ * $Id: 3c1d2776ab02ebf8a3aa4c4970ad312b9997f82d $
  * @file rlm_eap.c
  * @brief Implements the EAP framework.
  *
@@ -23,7 +23,7 @@
  * @copyright 2001  hereUare Communications, Inc. <raghud@hereuare.com>
  * @copyright 2003  Alan DeKok <aland@freeradius.org>
  */
-RCSID("$Id: f94c4928a1e172cec27f7770d58b1dca7904e938 $")
+RCSID("$Id: 3c1d2776ab02ebf8a3aa4c4970ad312b9997f82d $")
 
 #include <freeradius-devel/radiusd.h>
 #include <freeradius-devel/modules.h>
@@ -40,7 +40,7 @@ static const CONF_PARSER module_config[]
 	{ "cisco_accounting_username_bug", FR_CONF_OFFSET(PW_TYPE_BOOLEAN, rlm_eap_t, mod_accounting_username_bug), "no" },
 	{ "allow_empty_identities", FR_CONF_OFFSET(PW_TYPE_BOOLEAN, rlm_eap_t, allow_empty_identities), NULL },
 	{ "max_sessions", FR_CONF_OFFSET(PW_TYPE_INTEGER, rlm_eap_t, max_sessions), "2048" },
-	{ "dedup_key", FR_CONF_OFFSET(PW_TYPE_STRING, rlm_eap_t, dedup_key), "" },
+	{ "dedup_key", FR_CONF_OFFSET(PW_TYPE_STRING | PW_TYPE_XLAT, rlm_eap_t, dedup_key), "" },
 	CONF_PARSER_TERMINATOR
 };
 
diff -urpN freeradius-server-3.2.7/src/modules/rlm_eap/types/rlm_eap_fast/eap_fast.c freeradius-server-3.2.8/src/modules/rlm_eap/types/rlm_eap_fast/eap_fast.c
--- freeradius-server-3.2.7/src/modules/rlm_eap/types/rlm_eap_fast/eap_fast.c	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/modules/rlm_eap/types/rlm_eap_fast/eap_fast.c	2025-08-20 23:29:15.000000000 +0700
@@ -1,7 +1,7 @@
 /*
  * eap_fast.c  contains the interfaces that are called from the main handler
  *
- * Version:     $Id: 0d0b6c970cee8806ac3480f02509c8bdfa291098 $
+ * Version:     $Id: 39c2725a352e8dd5c4df048967468ecd06f421bb $
  *
  *   This program is free software; you can redistribute it and/or modify
  *   it under the terms of the GNU General Public License as published by
@@ -21,7 +21,7 @@
  *   Copyright 2016 The FreeRADIUS server project
  */
 
-RCSID("$Id: 0d0b6c970cee8806ac3480f02509c8bdfa291098 $")
+RCSID("$Id: 39c2725a352e8dd5c4df048967468ecd06f421bb $")
 
 #include "eap_fast.h"
 #include "eap_fast_crypto.h"
@@ -834,7 +834,7 @@ static rlm_rcode_t CC_HINT(nonnull) proc
 					rad_assert(!reply->vps);
 				}
 				break;
-				
+
 			default:
 				break;
 			}
@@ -1014,7 +1014,7 @@ static PW_CODE eap_fast_eap_payload(REQU
 	 * Call authentication recursively, which will
 	 * do PAP, CHAP, MS-CHAP, etc.
 	 */
-	rad_virtual_server(fake);
+	rad_virtual_server(fake, true);
 
 	/*
 	 * Decide what to do with the reply.
diff -urpN freeradius-server-3.2.7/src/modules/rlm_eap/types/rlm_eap_fast/eap_fast_crypto.c freeradius-server-3.2.8/src/modules/rlm_eap/types/rlm_eap_fast/eap_fast_crypto.c
--- freeradius-server-3.2.7/src/modules/rlm_eap/types/rlm_eap_fast/eap_fast_crypto.c	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/modules/rlm_eap/types/rlm_eap_fast/eap_fast_crypto.c	2025-08-20 23:29:15.000000000 +0700
@@ -1,7 +1,7 @@
 /*
  * fast-crypto.c  Cryptographic functions for EAP-FAST.
  *
- * Version:     $Id: e386e7041c4d1d88760c53de35831242093a29d5 $
+ * Version:     $Id: c517623cf22c7258aa1bc8b3b5e4b2e745ffdf26 $
  *
  *   This program is free software; you can redistribute it and/or modify
  *   it under the terms of the GNU General Public License as published by
@@ -21,7 +21,7 @@
  * Copyright 2016 The FreeRADIUS server project
  */
 
-RCSID("$Id: e386e7041c4d1d88760c53de35831242093a29d5 $")
+RCSID("$Id: c517623cf22c7258aa1bc8b3b5e4b2e745ffdf26 $")
 USES_APPLE_DEPRECATED_API	/* OpenSSL API has been deprecated by Apple */
 
 #include <stdio.h>
@@ -190,7 +190,7 @@ int eap_fast_decrypt(uint8_t const *ciph
 	/* Clean up */
 	EVP_CIPHER_CTX_free(ctx);
 
-	if (ret < 0) return -1;
+	if (ret == 0) return -1;
 
 	/* Success */
 	plaintext_len += len;
diff -urpN freeradius-server-3.2.7/src/modules/rlm_eap/types/rlm_eap_peap/peap.c freeradius-server-3.2.8/src/modules/rlm_eap/types/rlm_eap_peap/peap.c
--- freeradius-server-3.2.7/src/modules/rlm_eap/types/rlm_eap_peap/peap.c	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/modules/rlm_eap/types/rlm_eap_peap/peap.c	2025-08-20 23:29:15.000000000 +0700
@@ -1,7 +1,7 @@
 /*
  * peap.c contains the interfaces that are called from eap
  *
- * Version:     $Id: 24e7a664f5e871fb3d26c7b52f6603c3e048d7db $
+ * Version:     $Id: 3e745bfa21c1f944e5f7252d5f08bb7ebc9cbb65 $
  *
  *   This program is free software; you can redistribute it and/or modify
  *   it under the terms of the GNU General Public License as published by
@@ -21,7 +21,7 @@
  *   Copyright 2006 The FreeRADIUS server project
  */
 
-RCSID("$Id: 24e7a664f5e871fb3d26c7b52f6603c3e048d7db $")
+RCSID("$Id: 3e745bfa21c1f944e5f7252d5f08bb7ebc9cbb65 $")
 USES_APPLE_DEPRECATED_API	/* OpenSSL API has been deprecated by Apple */
 
 #include "eap_peap.h"
@@ -621,7 +621,7 @@ static int CC_HINT(nonnull) eappeap_post
 		fake->reply = NULL;
 
 		request->proxy->dst_port = 0; /* hacks for state.c lookups */
-		
+
 		/*
 		 *	And we're done with this request.
 		 */
@@ -836,7 +836,7 @@ rlm_rcode_t eappeap_process(eap_handler_
 			fake->server = t->soh_virtual_server;
 		}
 		RDEBUG("Sending SoH request to server %s", fake->server ? fake->server : "NULL");
-		rad_virtual_server(fake);
+		rad_virtual_server(fake, true);
 
 		if (fake->reply->code != PW_CODE_ACCESS_ACCEPT) {
 			RDEBUG2("SoH was rejected");
@@ -1029,7 +1029,7 @@ rlm_rcode_t eappeap_process(eap_handler_
 	 *	Call authentication recursively, which will
 	 *	do PAP, CHAP, MS-CHAP, etc.
 	 */
-	rad_virtual_server(fake);
+	rad_virtual_server(fake, true);
 
 	/*
 	 *	Note that we don't do *anything* with the reply
diff -urpN freeradius-server-3.2.7/src/modules/rlm_eap/types/rlm_eap_teap/README.md freeradius-server-3.2.8/src/modules/rlm_eap/types/rlm_eap_teap/README.md
--- freeradius-server-3.2.7/src/modules/rlm_eap/types/rlm_eap_teap/README.md	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/modules/rlm_eap/types/rlm_eap_teap/README.md	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,10 @@
+# rlm_eap_teap
+## Metadata
+<dl>
+  <dt>category</dt><dd>authentication</dd>
+</dl>
+
+## Summary
+Implements [RFC 7170](https://tools.ietf.org/html/rfc7170) EAP-TEAP authentication.  EAP-TEAP provides mutual
+authentication and session keying material for 802.11i (WPA/2 Enterprise) using an inner method, and optionally,
+client certificates.
diff -urpN freeradius-server-3.2.7/src/modules/rlm_eap/types/rlm_eap_teap/eap_teap.c freeradius-server-3.2.8/src/modules/rlm_eap/types/rlm_eap_teap/eap_teap.c
--- freeradius-server-3.2.7/src/modules/rlm_eap/types/rlm_eap_teap/eap_teap.c	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/modules/rlm_eap/types/rlm_eap_teap/eap_teap.c	2025-08-20 23:29:15.000000000 +0700
@@ -1,7 +1,7 @@
 /*
  * eap_teap.c  contains the interfaces that are called from the main handler
  *
- * Version:     $Id: 8e372c69f311eb9e05015ff259bd0903d652d99e $
+ * Version:     $Id: 20646c5ba13d461f02f0f5a2afdfd13f2b0638c1 $
  *
  * Copyright (C) 2022 Network RADIUS SARL <legal@networkradius.com>
  *
@@ -21,7 +21,7 @@
  * SUCH DAMAGE.
  */
 
-RCSID("$Id: 8e372c69f311eb9e05015ff259bd0903d652d99e $")
+RCSID("$Id: 20646c5ba13d461f02f0f5a2afdfd13f2b0638c1 $")
 
 #include "eap_teap.h"
 #include "eap_teap_crypto.h"
@@ -168,26 +168,41 @@ static void eap_teap_derive_imck(REQUEST
 	memcpy(&t->imck_msk, &imck_msk, sizeof(imck_msk));
 }
 
-static void eap_teap_tlv_append(tls_session_t *tls_session, int tlv, bool mandatory, int length, const void *data)
+static void eap_teap_tlv_append(REQUEST *request, tls_session_t *tls_session, int tlv, bool mandatory, int length, const void *data)
 {
 	uint16_t hdr[2];
 
 	hdr[0] = htons(tlv | (mandatory ? EAP_TEAP_TLV_MANDATORY : 0));
 	hdr[1] = htons(length);
 
+	if ((rad_debug_lvl > 1) && (length < 256)) {
+		DICT_ATTR const *da;
+
+		da = dict_attrbyvalue((tlv << 8) | PW_FREERADIUS_EAP_TEAP_TLV, VENDORPEC_FREERADIUS);
+		if (da) {
+			char buf[1024];
+
+			for (size_t i = 0; i < (size_t) length; i++) {
+				sprintf(&buf[2*i], "%02x", ((const uint8_t *)data)[i]);
+			}
+
+			RDEBUG("  %s = 0x%s", da->name, buf);
+		}
+	}
+
 	tls_session->record_plus(&tls_session->clean_in, &hdr, 4);
 	tls_session->record_plus(&tls_session->clean_in, data, length);
 }
 
-static void eap_teap_send_error(tls_session_t *tls_session, int error)
+static void eap_teap_send_error(REQUEST *request, tls_session_t *tls_session, int error)
 {
 	uint32_t value;
 	value = htonl(error);
 
-	eap_teap_tlv_append(tls_session, EAP_TEAP_TLV_ERROR, true, sizeof(value), &value);
+	eap_teap_tlv_append(request, tls_session, EAP_TEAP_TLV_ERROR, true, sizeof(value), &value);
 }
 
-static void eap_teap_append_identity_type(tls_session_t *tls_session, int value)
+static void eap_teap_append_identity_type(REQUEST *request, tls_session_t *tls_session, int value)
 {
 	uint16_t identity;
 	identity = htons(value);
@@ -202,7 +217,7 @@ static void eap_teap_append_identity_typ
 	t->auths[value].required = true;
 	t->auths[value].sent = true;
 
-	eap_teap_tlv_append(tls_session, EAP_TEAP_TLV_IDENTITY_TYPE, false, sizeof(identity), &identity);
+	eap_teap_tlv_append(request, tls_session, EAP_TEAP_TLV_IDENTITY_TYPE, false, sizeof(identity), &identity);
 }
 
 static void eap_teap_append_result(REQUEST *request, tls_session_t *tls_session, PW_CODE code)
@@ -224,7 +239,7 @@ static void eap_teap_append_result(REQUE
 
 	RDEBUG("Phase 2: %s = %s", name, state_name);
 
-	eap_teap_tlv_append(tls_session, type, true, sizeof(state), &state);
+	eap_teap_tlv_append(request, tls_session, type, true, sizeof(state), &state);
 }
 
 static void eap_teap_append_eap_identity_request(REQUEST *request, tls_session_t *tls_session, eap_handler_t *eap_session)
@@ -239,7 +254,7 @@ static void eap_teap_append_eap_identity
 	eap_packet.length[1] = EAP_HEADER_LEN + 1;
 	eap_packet.data[0] = PW_EAP_IDENTITY;
 
-	eap_teap_tlv_append(tls_session, EAP_TEAP_TLV_EAP_PAYLOAD, true, sizeof(eap_packet), &eap_packet);
+	eap_teap_tlv_append(request, tls_session, EAP_TEAP_TLV_EAP_PAYLOAD, true, sizeof(eap_packet), &eap_packet);
 }
 
 /*
@@ -259,8 +274,6 @@ static void eap_teap_append_crypto_bindi
 	struct crypto_binding_buffer	*cbb;
 	uint8_t				*outer_tlvs;
 
-	RDEBUG("Phase 2: Sending Cryptobinding");
-
 	eap_teap_derive_imck(request, tls_session, msk, msklen, emsk, emsklen);
 
 	t->imck_emsk_available = emsklen > 0;
@@ -281,10 +294,26 @@ static void eap_teap_append_crypto_bindi
 
 	cbb->binding.subtype = ((emsklen ? EAP_TEAP_TLV_CRYPTO_BINDING_FLAGS_CMAC_BOTH : EAP_TEAP_TLV_CRYPTO_BINDING_FLAGS_CMAC_MSK) << 4) | EAP_TEAP_TLV_CRYPTO_BINDING_SUBTYPE_REQUEST;
 
+	RDEBUG("Phase 2: Sending Crypto-Binding Flags=%d", emsklen ? EAP_TEAP_TLV_CRYPTO_BINDING_FLAGS_CMAC_BOTH : EAP_TEAP_TLV_CRYPTO_BINDING_FLAGS_CMAC_MSK);
+
 	rad_assert(sizeof(cbb->binding.nonce) % sizeof(uint32_t) == 0);
 	RANDFILL(cbb->binding.nonce);
 	cbb->binding.nonce[sizeof(cbb->binding.nonce) - 1] &= ~0x01; /* RFC 7170, Section 4.2.13 */
 
+	/*
+	 *	RFC7170bis:
+	 *
+	 *	> The Nonce field is 32 octets.  It contains a 256-bit nonce that is
+	 *	> temporally unique, used for Compound-MAC key derivation at each
+	 *	> end.  The nonce in a request MUST have its least significant bit
+	 *	> set to zero (0), and the nonce in a response MUST have the same
+	 *	> value as the request nonce except the least significant bit MUST
+	 *	> be set to one (1).
+	 *
+	 *	Uh.... it looks like we don't do this?  The Nonce
+	 *	field is actually not used for anything in RFC7170, either.
+	 */
+
 	outer_tlvs = &cbb->outer_tlvs[0];
 
 	if (tls_session->outer_tlvs_octets_server) {
@@ -312,7 +341,7 @@ static void eap_teap_append_crypto_bindi
 		memcpy(cbb->binding.emsk_compound_mac, &mac_emsk, sizeof(cbb->binding.emsk_compound_mac));
 	}
 
-	eap_teap_tlv_append(tls_session, EAP_TEAP_TLV_CRYPTO_BINDING, true, sizeof(cbb->binding), (uint8_t *)&cbb->binding);
+	eap_teap_tlv_append(request, tls_session, EAP_TEAP_TLV_CRYPTO_BINDING, true, sizeof(cbb->binding), (uint8_t *)&cbb->binding);
 }
 
 static int eap_teap_verify(REQUEST *request, tls_session_t *tls_session, uint8_t const *data, unsigned int data_len)
@@ -365,7 +394,7 @@ unexpected:
 						RDEBUG("Phase 2: - attribute %d is present", i);
 					}
 				}
-				eap_teap_send_error(tls_session, EAP_TEAP_ERR_UNEXPECTED_TLV);
+				eap_teap_send_error(request, tls_session, EAP_TEAP_ERR_UNEXPECTED_TLV);
 				return 0;
 			}
 
@@ -501,22 +530,34 @@ unexpected:
 	 */
 	if (status) {
 		if (status == EAP_TEAP_TLV_RESULT_FAILURE) {
-			if (!error) {
-				REDEBUG("Phase 2: Received Result from peer which indicates failure with error %u.  Rejecting request.", error);
+			if (error) {
+				REDEBUG("Phase 2: Received Result TLV from peer which indicates failure with error %u.  Rejecting request.", error);
 			} else {
-				REDEBUG("Phase 2: Received Result from peer which indicates failure.  Rejecting request.");
+				REDEBUG("Phase 2: Received Result TLV from peer which indicates failure.  Rejecting request.");
 			}
 			return 0;
 		}
 
 		if (status != EAP_TEAP_TLV_RESULT_SUCCESS) {
 		unknown_value:
-			REDEBUG("Phase 2: Received Result from peer with unknown value %u.  Rejecting request.", status);
+			REDEBUG("Phase 2: Received Result TLV from peer with unknown value %u.  Rejecting request.", status);
 			goto unexpected;
 		}
 	}
 
 	/*
+	 *	Success + fatal Error = Failure
+	 *
+	 *	A fatal error MUST be accompanied by a Result TLV indicating Failure.  But if the other end
+	 *	doesn't do that, we still tear down the session on Success + fatal error.
+	 */
+	if ((error >= 2000) && (error <= 2999)) {
+		REDEBUG("Phase 2: Received Error TLV from peer which indicates fatal error %u.  Rejecting request.",
+			error);
+		return 0;
+	}
+
+	/*
 	 * Check if the peer mixed & matched TLVs.
 	 */
 	if ((num[EAP_TEAP_TLV_NAK] > 0) && (num[EAP_TEAP_TLV_NAK] != total)) {
@@ -873,9 +914,9 @@ static rlm_rcode_t CC_HINT(nonnull) proc
 	rlm_rcode_t			rcode = RLM_MODULE_REJECT;
 	VALUE_PAIR			*vp;
 	vp_cursor_t			cursor;
-	uint8_t				msk[2 * CHAP_VALUE_LENGTH] = {0}, emsk[2 * EAPTLS_MPPE_KEY_LEN] = {0};
+	uint8_t				msk[2 * EAPTLS_MPPE_KEY_LEN] = {0}, emsk[2 * EAPTLS_MPPE_KEY_LEN] = {0};
 	size_t				msklen = 0, emsklen = 0;
-	bool				doing_eap;
+	bool				doing_eap, msk1, msk2;
 
 	teap_tunnel_t	*t = tls_session->opaque;
 
@@ -893,27 +934,44 @@ static rlm_rcode_t CC_HINT(nonnull) proc
 	switch (reply->code) {
 	case PW_CODE_ACCESS_ACCEPT:
 		RDEBUG("Phase 2: Got tunneled Access-Accept");
+		msk1 = msk2 = false;
 
 		for (vp = fr_cursor_init(&cursor, &reply->vps); vp; vp = fr_cursor_next(&cursor)) {
-			if (vp->da->attr == PW_EAP_EMSK) {
-				// FIXME check if we should be generating an emsk from MPPE keys below
-				emsklen = MIN(vp->vp_length, sizeof(emsk));
-				memcpy(emsk, vp->vp_octets, emsklen);
-				break;
+			debug_pair(vp);
+
+			if (vp->da->vendor == 0) {
+				if (vp->da->attr == PW_EAP_EMSK) {
+					emsklen = MIN(vp->vp_length, sizeof(emsk));
+					memcpy(emsk, vp->vp_octets, emsklen);
+					continue;
+				}
+
+				if (vp->da->attr == PW_EAP_MSK) {
+					msk1 = msk2 = true;
+					msklen = MIN(vp->vp_length, sizeof(msk));
+					memcpy(msk, vp->vp_octets, msklen);
+					continue;
+				}
 			}
 
+			if (msk1 && msk2 && emsklen) break;
+
 			if (vp->da->vendor != VENDORPEC_MICROSOFT) continue;
 
-			/* like for EAP-FAST, the keying material is used reversed */
 			switch (vp->da->attr) {
 			case PW_MSCHAP_MPPE_SEND_KEY:
 				if (vp->vp_length == EAPTLS_MPPE_KEY_LEN) {
-					/* do not set emsklen here so not to blat EAP-EMSK */
-					// emsklen = sizeof(emsk);
-					memcpy(emsk, vp->vp_octets, EAPTLS_MPPE_KEY_LEN);
-				} else if (vp->vp_length == CHAP_VALUE_LENGTH) {
-					msklen = sizeof(msk);
+					if (msk2) {
+						fr_assert(memcmp(&msk[EAPTLS_MPPE_KEY_LEN], vp->vp_octets, EAPTLS_MPPE_KEY_LEN) == 0);
+					} else {
+						memcpy(&msk[EAPTLS_MPPE_KEY_LEN], vp->vp_octets, EAPTLS_MPPE_KEY_LEN);
+						msk2 = true;
+					}
+
+				} else if (vp->vp_length == CHAP_VALUE_LENGTH) { /* reversed, like EAP-FAST */
+					msk2 = true;
 					memcpy(msk, vp->vp_octets, CHAP_VALUE_LENGTH);
+
 				} else {
 				wrong_length:
 					REDEBUG("Phase 2: Found %s with incorrect length.  Expected %u or %u, got %zu",
@@ -921,24 +979,28 @@ static rlm_rcode_t CC_HINT(nonnull) proc
 					return RLM_MODULE_INVALID;
 				}
 
-				RDEBUGHEX("Phase 2: MSCHAP-MPPE-SEND-KEY [low MSK]", vp->vp_octets, vp->length);
+				RDEBUGHEX("Phase 2: MSCHAP-MPPE-Send-Key", vp->vp_octets, vp->length);
+				msklen += vp->length;
 				break;
 
 			case PW_MSCHAP_MPPE_RECV_KEY:
-				/* only do this if there is no EAP-EMSK */
-				if (vp->vp_length == EAPTLS_MPPE_KEY_LEN && emsklen == 0) {
-					msklen = sizeof(msk);
-					memcpy(msk, vp->vp_octets, EAPTLS_MPPE_KEY_LEN);
-					emsklen = sizeof(emsk);
-					memcpy(&emsk[EAPTLS_MPPE_KEY_LEN], vp->vp_octets, EAPTLS_MPPE_KEY_LEN);
+				if (vp->vp_length == EAPTLS_MPPE_KEY_LEN) {
+					if (msk1) {
+						fr_assert(memcmp(msk, vp->vp_octets, EAPTLS_MPPE_KEY_LEN) == 0);
+					} else {
+						memcpy(msk, vp->vp_octets, EAPTLS_MPPE_KEY_LEN);
+						msk1 = true;
+					}
+
 				} else if (vp->vp_length == CHAP_VALUE_LENGTH) {
-					msklen = sizeof(msk);
+					msk1 = true;
 					memcpy(&msk[CHAP_VALUE_LENGTH], vp->vp_octets, CHAP_VALUE_LENGTH);
 				} else {
 					goto wrong_length;
 				}
 
-				RDEBUGHEX("Phase 2: MSCHAP-MPPE-RECV-KEY [high MSK]", vp->vp_octets, vp->vp_length);
+				RDEBUGHEX("Phase 2: MSCHAP-MPPE-Recv-Key", vp->vp_octets, vp->vp_length);
+				msklen += vp->length;
 				break;
 
 			case PW_MSCHAP2_SUCCESS:
@@ -977,6 +1039,7 @@ static rlm_rcode_t CC_HINT(nonnull) proc
 			 *	Clean up the tunneled reply.
 			 */
 			fr_pair_delete_by_num(&reply->vps, PW_EAP_EMSK, 0, TAG_ANY);
+			fr_pair_delete_by_num(&reply->vps, PW_EAP_MSK, 0, TAG_ANY);
 			fr_pair_delete_by_num(&reply->vps, PW_EAP_SESSION_ID, 0, TAG_ANY);
 		}
 
@@ -1003,7 +1066,7 @@ static rlm_rcode_t CC_HINT(nonnull) proc
 			t->identity_types[t->num_identities++] = vp->vp_short;
 
 			/* RFC7170, Appendix C.6 */
-			eap_teap_append_identity_type(tls_session, vp->vp_short);
+			eap_teap_append_identity_type(request, tls_session, vp->vp_short);
 
 			if (t->default_method || t->eap_method[vp->vp_short]) {
 				eap_teap_append_eap_identity_request(request, tls_session, eap_session);
@@ -1103,7 +1166,7 @@ challenge:
 		vp = fr_pair_find_by_num(reply->vps, PW_EAP_MESSAGE, 0, TAG_ANY);
 		if (vp) {
 			doing_eap = true;
-			eap_teap_tlv_append(tls_session, EAP_TEAP_TLV_EAP_PAYLOAD, true, vp->vp_length, vp->vp_octets);
+			eap_teap_tlv_append(request, tls_session, EAP_TEAP_TLV_EAP_PAYLOAD, true, vp->vp_length, vp->vp_octets);
 		}
 
 		/*
@@ -1124,7 +1187,7 @@ challenge:
 			t->sent_basic_password = true;
 
 			RDEBUG("Phase 2: Sending Basic-Password-Auth-Req");
-			eap_teap_tlv_append(tls_session, EAP_TEAP_TLV_BASIC_PASSWORD_AUTH_REQ, true, vp->vp_length, vp->vp_strvalue);
+			eap_teap_tlv_append(request, tls_session, EAP_TEAP_TLV_BASIC_PASSWORD_AUTH_REQ, true, vp->vp_length, vp->vp_strvalue);
 		}
 
 		break;
@@ -1329,7 +1392,7 @@ static PW_CODE eap_teap_phase2(REQUEST *
 	 * Call authentication recursively, which will
 	 * do PAP, CHAP, MS-CHAP, etc.
 	 */
-	rad_virtual_server(fake);
+	rad_virtual_server(fake, true);
 
 	/*
 	 * Decide what to do with the reply.
@@ -1375,8 +1438,8 @@ static PW_CODE eap_teap_phase2(REQUEST *
 	return code;
 }
 
-static PW_CODE eap_teap_crypto_binding(REQUEST *request, UNUSED eap_handler_t *eap_session,
-				       tls_session_t *tls_session, eap_tlv_crypto_binding_tlv_t const *binding)
+static PW_CODE eap_teap_validate_crypto_binding(REQUEST *request, UNUSED eap_handler_t *eap_session,
+						tls_session_t *tls_session, eap_tlv_crypto_binding_tlv_t const *binding)
 {
 	teap_tunnel_t			*t = tls_session->opaque;
 	uint8_t				*buf;
@@ -1406,18 +1469,33 @@ static PW_CODE eap_teap_crypto_binding(R
 	 *	binding->received_version is what they got from us.
 	 */
 	if (binding->version != t->received_version || binding->received_version != EAP_TEAP_VERSION) {
-		RDEBUG2("Phase 2: Crypto-Binding TLV version mis-match (possible downgrade attack!)");
-		RDEBUG2("Phase 2: Expected client to send %d, got %d.  We sent %d, they echoed back %d",
+		RWDEBUG2("Phase 2: Crypto-Binding TLV version mis-match (possible downgrade attack!)");
+		RWDEBUG2("Phase 2: Expected client to send %d, got %d.  We sent %d, they echoed back %d",
 			t->received_version, binding->version,
 			EAP_TEAP_VERSION, binding->received_version);
 		return PW_CODE_ACCESS_REJECT;
 	}
 	if ((binding->subtype & 0xf) != EAP_TEAP_TLV_CRYPTO_BINDING_SUBTYPE_RESPONSE) {
-		RDEBUG2("Phase 2: Crypto-Binding TLV contains unexpected response");
+		RWDEBUG2("Phase 2: Crypto-Binding TLV contains unexpected response");
 		return PW_CODE_ACCESS_REJECT;
 	}
 	flags = binding->subtype >> 4;
 
+	/*
+	 *	The Flags field is 4 bits:
+	 *
+	 *		0 - EMSK (may or may not be set)
+	 *		1 - MSK (always set)
+	 *		2 - MUST be zero
+	 *		3 - MUST be zero
+	 */
+	if ((flags == 0) || (flags > 3)) {
+		RWDEBUG2("Phase 2: Invalid Crypto-Binding Flags=%d", flags);
+		return PW_CODE_ACCESS_REJECT;
+	}
+
+	RDEBUG("Phase 2: Received Crypto-Binding Flags=%d", flags);
+
 	CRYPTO_BINDING_BUFFER_INIT(cbb);
 	memcpy(&cbb->binding, binding, sizeof(cbb->binding) - sizeof(cbb->binding.emsk_compound_mac) - sizeof(cbb->binding.msk_compound_mac));
 
@@ -1453,16 +1531,20 @@ static PW_CODE eap_teap_crypto_binding(R
 	if ((flags & EAP_TEAP_TLV_CRYPTO_BINDING_FLAGS_CMAC_MSK) != 0) {
 		HMAC(md, &t->imck_msk.cmk, sizeof(t->imck_msk.cmk), buf, buflen, mac, &maclen);
 		if (memcmp(binding->msk_compound_mac, mac, sizeof(binding->msk_compound_mac))) {
-			RDEBUG2("Phase 2: Crypto-Binding TLV (MSK) mis-match");
+			RWDEBUG2("Phase 2: Crypto-Binding TLV (MSK) mis-match");
 			return PW_CODE_ACCESS_REJECT;
 		}
 		imck = &t->imck_msk;
 	}
 
+	if (((flags & EAP_TEAP_TLV_CRYPTO_BINDING_FLAGS_CMAC_EMSK) != 0) && !t->imck_emsk_available) {
+		fr_assert(0);
+	}
+
 	if (((flags & EAP_TEAP_TLV_CRYPTO_BINDING_FLAGS_CMAC_EMSK) != 0) && t->imck_emsk_available) {
 		HMAC(md, &t->imck_emsk.cmk, sizeof(t->imck_emsk.cmk), buf, buflen, mac, &maclen);
 		if (memcmp(binding->emsk_compound_mac, mac, sizeof(binding->emsk_compound_mac))) {
-			RDEBUG2("Phase 2: Crypto-Binding TLV (EMSK) mis-match");
+			RWDEBUG2("Phase 2: Crypto-Binding TLV (EMSK) mis-match");
 			return PW_CODE_ACCESS_REJECT;
 		}
 
@@ -1607,8 +1689,8 @@ static PW_CODE eap_teap_process_tlvs(REQ
 			case EAP_TEAP_TLV_CRYPTO_BINDING:
 				gotcryptobinding = true;
 
-				code = eap_teap_crypto_binding(request, eap_session, tls_session,
-							       (eap_tlv_crypto_binding_tlv_t const *)vp->vp_octets);
+				code = eap_teap_validate_crypto_binding(request, eap_session, tls_session,
+									(eap_tlv_crypto_binding_tlv_t const *)vp->vp_octets);
 				break;
 
 			default:
@@ -1714,9 +1796,11 @@ PW_CODE eap_teap_process(eap_handler_t *
 	if (!eap_teap_verify(request, tls_session, data, data_len)) return PW_CODE_ACCESS_REJECT;
 
 	if (t->stage == TLS_SESSION_HANDSHAKE) {
+		char buf[256];
+		int identity_type = 0;
+
 		rad_assert(t->mode == EAP_TEAP_UNKNOWN);
 
-		char buf[256];
 		if (strstr(SSL_CIPHER_description(SSL_get_current_cipher(tls_session->ssl),
 						  buf, sizeof(buf)), "Au=None")) {
 			/* FIXME enforce MSCHAPv2 - RFC 7170 */
@@ -1734,34 +1818,34 @@ PW_CODE eap_teap_process(eap_handler_t *
 
 		eap_teap_init_keys(request, tls_session);
 
-
 		/* RFC7170, Appendix C.6 */
 		vp = fr_pair_find_by_num(request->state, PW_EAP_TEAP_TLV_IDENTITY_TYPE, VENDORPEC_FREERADIUS, TAG_ANY);
 		if (vp) {
 			RDEBUG("Phase 2: Sending Identity-Type = %s", (vp->vp_short == 1) ? "User" : "Machine");
-			eap_teap_append_identity_type(tls_session, vp->vp_short);
+			eap_teap_append_identity_type(request, tls_session, vp->vp_short);
 
 			if (t->num_identities == 2) {
 				RDEBUG("Phase 2: Configured to send too many identities, failing the session");
 				goto fail;
 			}
 
-			t->identity_types[t->num_identities++] = vp->vp_short;
+			identity_type = t->identity_types[t->num_identities++] = vp->vp_short;
 
 			RDEBUG("Phase 2: Deleting &session-state:FreeRADIUS-EAP-TEAP-Identity-Type += %s",
 			       (vp->vp_short == 1) ? "User" : "Machine");
 			fr_pair_delete(&request->state, vp);
+			vp = NULL;
 		}
 
 		/*
 		 *	We always start off with an EAP-Identity-Request.
 		 */
-		if (t->default_method || (vp && t->eap_method[vp->vp_short])) {
+		if (t->default_method || (identity_type && t->eap_method[identity_type])) {
 			eap_teap_append_eap_identity_request(request, tls_session, eap_session);
 		} else {
-			RDEBUG("Phase 2: No %s EAP method configured - sending Basic-Password-Auth-Req = \"\"",
-			       !vp ? "" : (vp->vp_short == 1) ? "User" : "Machine");
-			eap_teap_tlv_append(tls_session, EAP_TEAP_TLV_BASIC_PASSWORD_AUTH_REQ, true, 0, "");
+			RDEBUG("Phase 2: No %sEAP method configured - sending Basic-Password-Auth-Req = \"\"",
+			       !identity_type ? "" : (identity_type == 1) ? "User " : "Machine ");
+			eap_teap_tlv_append(request, tls_session, EAP_TEAP_TLV_BASIC_PASSWORD_AUTH_REQ, true, 0, "");
 		}
 
 		t->stage = AUTHENTICATION;
diff -urpN freeradius-server-3.2.7/src/modules/rlm_eap/types/rlm_eap_teap/rlm_eap_teap.c freeradius-server-3.2.8/src/modules/rlm_eap/types/rlm_eap_teap/rlm_eap_teap.c
--- freeradius-server-3.2.7/src/modules/rlm_eap/types/rlm_eap_teap/rlm_eap_teap.c	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/modules/rlm_eap/types/rlm_eap_teap/rlm_eap_teap.c	2025-08-20 23:29:15.000000000 +0700
@@ -1,7 +1,7 @@
 /*
  * rlm_eap_teap.c  contains the interfaces that are called from eap
  *
- * Version:     $Id: f2e2cc3d40612adcc9cc50fe3f6a49650f596b45 $
+ * Version:     $Id: fcf9717257a17b39495fe9a646d4d57724187adf $
  *
  * Copyright (C) 2022 Network RADIUS SARL <legal@networkradius.com>
  *
@@ -21,7 +21,7 @@
  * SUCH DAMAGE.
  */
 
-RCSID("$Id: f2e2cc3d40612adcc9cc50fe3f6a49650f596b45 $")
+RCSID("$Id: fcf9717257a17b39495fe9a646d4d57724187adf $")
 USES_APPLE_DEPRECATED_API	/* OpenSSL API has been deprecated by Apple */
 
 #include "eap_teap.h"
@@ -223,6 +223,12 @@ static int mod_instantiate(CONF_SECTION
 					      inst->identity_type_name, p);
 				return -1;
 			}
+
+			if ((i == 1) && (inst->identity_type[0] == inst->identity_type[1])) {
+				cf_log_err_cs(cs, "Duplicate value in identity_types = '%s' at %s",
+					      inst->identity_type_name, p);
+				return -1;
+			}
 
 			i++;
 
diff -urpN freeradius-server-3.2.7/src/modules/rlm_eap/types/rlm_eap_tls/rlm_eap_tls.c freeradius-server-3.2.8/src/modules/rlm_eap/types/rlm_eap_tls/rlm_eap_tls.c
--- freeradius-server-3.2.7/src/modules/rlm_eap/types/rlm_eap_tls/rlm_eap_tls.c	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/modules/rlm_eap/types/rlm_eap_tls/rlm_eap_tls.c	2025-08-20 23:29:15.000000000 +0700
@@ -1,7 +1,7 @@
 /*
  * rlm_eap_tls.c  contains the interfaces that are called from eap
  *
- * Version:     $Id: 0eaf063421cc52f21103361973cf91f8cc1f18b5 $
+ * Version:     $Id: 6a0b46dc325025d0a36787a337c1e079d9967ea7 $
  *
  *   This program is free software; you can redistribute it and/or modify
  *   it under the terms of the GNU General Public License as published by
@@ -23,7 +23,7 @@
  *
  */
 
-RCSID("$Id: 0eaf063421cc52f21103361973cf91f8cc1f18b5 $")
+RCSID("$Id: 6a0b46dc325025d0a36787a337c1e079d9967ea7 $")
 USES_APPLE_DEPRECATED_API	/* OpenSSL API has been deprecated by Apple */
 
 #ifdef HAVE_OPENSSL_RAND_H
@@ -184,7 +184,7 @@ static int CC_HINT(nonnull) mod_process(
 			}
 
 			RDEBUG2("Validating certificate");
-			rad_virtual_server(fake);
+			rad_virtual_server(fake, false);
 
 			/* copy the reply vps back to our reply */
 			fr_pair_list_mcopy_by_num(request->reply, &request->reply->vps,
diff -urpN freeradius-server-3.2.7/src/modules/rlm_eap/types/rlm_eap_ttls/ttls.c freeradius-server-3.2.8/src/modules/rlm_eap/types/rlm_eap_ttls/ttls.c
--- freeradius-server-3.2.7/src/modules/rlm_eap/types/rlm_eap_ttls/ttls.c	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/modules/rlm_eap/types/rlm_eap_ttls/ttls.c	2025-08-20 23:29:15.000000000 +0700
@@ -1,7 +1,7 @@
 /*
  * rlm_eap_ttls.c  contains the interfaces that are called from eap
  *
- * Version:     $Id: 4a27fcc63df8d0adb7278c7356d1bc7dc6ba2a52 $
+ * Version:     $Id: 5fe54d1c3f93352fc76262ea51c397b3a39bd8b5 $
  *
  *   This program is free software; you can redistribute it and/or modify
  *   it under the terms of the GNU General Public License as published by
@@ -21,7 +21,7 @@
  *   Copyright 2006 The FreeRADIUS server project
  */
 
-RCSID("$Id: 4a27fcc63df8d0adb7278c7356d1bc7dc6ba2a52 $")
+RCSID("$Id: 5fe54d1c3f93352fc76262ea51c397b3a39bd8b5 $")
 
 #include "eap_ttls.h"
 #include "eap_chbind.h"
@@ -1215,7 +1215,7 @@ int eapttls_process(eap_handler_t *handl
 	 *	Call authentication recursively, which will
 	 *	do PAP, CHAP, MS-CHAP, etc.
 	 */
-	rad_virtual_server(fake);
+	rad_virtual_server(fake, true);
 
 	/*
 	 *	Decide what to do with the reply.
diff -urpN freeradius-server-3.2.7/src/modules/rlm_json/json.c freeradius-server-3.2.8/src/modules/rlm_json/json.c
--- freeradius-server-3.2.7/src/modules/rlm_json/json.c	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/modules/rlm_json/json.c	2025-08-20 23:29:15.000000000 +0700
@@ -15,7 +15,7 @@
  */
 
 /**
- * $Id: 83bcba5842f2918fab14f53abca319bd05d25e30 $
+ * $Id: e8647f49bac197e349cee6460ecb3038ddcb27e1 $
  * @file json.c
  * @brief Common functions for working with json-c
  *
@@ -63,9 +63,10 @@ void json_object_put_assert(json_object
  * @param[in] vp VALUE_PAIR to convert.
  * @param[in] always_string create all values as strings
  * @param[in] enum_as_int output enum attribute values as integers not strings
+ * @param[in] dates_as_int output date values as seconds since the epoch
  * @return Newly allocated JSON object, or NULL on error
  */
-json_object *json_object_from_attr_value(TALLOC_CTX *ctx, VALUE_PAIR const *vp, bool always_string, bool enum_as_int)
+json_object *json_object_from_attr_value(TALLOC_CTX *ctx, VALUE_PAIR const *vp, bool always_string, bool enum_as_int, bool dates_as_int)
 {
 	char buf[2048];
 	ssize_t len;
@@ -107,6 +108,11 @@ json_object *json_object_from_attr_value
 		}
 	}
 
+	/*
+	 *  We handle dates as epoch seconds here and dates as strings later.
+	 */
+	if (vp->da->type == PW_TYPE_DATE && dates_as_int)
+		return json_object_new_int(vp->vp_date);
 
 	/*
 	 *  If always_string is set then we print everything to a string and
@@ -229,7 +235,7 @@ static int json_afrom_value_pair(TALLOC_
 	fr_assert(vp);
 	fr_assert(inst);
 
-	MEM(obj = json_object_from_attr_value(ctx, vp, inst->always_string, inst->enum_as_int));
+	MEM(obj = json_object_from_attr_value(ctx, vp, inst->always_string, inst->enum_as_int, inst->dates_as_int));
 
 	*out = obj;
 	return is_enum;
@@ -302,6 +308,10 @@ bool fr_json_format_verify(rlm_json_t co
 			if (verbose) WARN("'enum_as_int' not valid in output_mode 'array_of_names' and will be ignored");
 			ret = false;
 		}
+		if (inst->dates_as_int) {
+			if (verbose) WARN("'dates_as_int' not valid in output_mode 'array_of_names' and will be ignored");
+			ret = false;
+		}
 		if (inst->always_string) {
 			if (verbose) WARN("'always_string' not valid in output_mode 'array_of_names' and will be ignored");
 			ret = false;
diff -urpN freeradius-server-3.2.7/src/modules/rlm_json/json.h freeradius-server-3.2.8/src/modules/rlm_json/json.h
--- freeradius-server-3.2.7/src/modules/rlm_json/json.h	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/modules/rlm_json/json.h	2025-08-20 23:29:15.000000000 +0700
@@ -16,7 +16,7 @@
  */
 
 /**
- * $Id: d05ae120af65d637a8205d5da71df5955e8e873a $
+ * $Id: 132db6f2fa50364ebb04c0f4122f1202a84464c6 $
  * @file lib/json/base.h
  * @brief Implements the evaluation and parsing functions for the FreeRADIUS version of jpath.
  *
@@ -27,7 +27,7 @@
  * @copyright 2015,2021 Network RADIUS SARL (legal@networkradius.com)
  * @copyright 2015 The FreeRADIUS Server Project
  */
-RCSIDH(json_h, "$Id: d05ae120af65d637a8205d5da71df5955e8e873a $")
+RCSIDH(json_h, "$Id: 132db6f2fa50364ebb04c0f4122f1202a84464c6 $")
 
 #include <freeradius-devel/radiusd.h>
 #include "config.h"
@@ -78,6 +78,7 @@ typedef struct {
 	char const		*attr_prefix;	//!< Prefix to add to all attribute names
 	bool			value_as_array;	//!< Use JSON array for multiple attribute values.
 	bool			enum_as_int;	//!< Output enums as value, not their string representation.
+	bool			dates_as_int;	//!< Output dates as epoch seconds, not their string representation.
 	bool			always_string;	//!< Output all data types as strings.
 
 
@@ -90,7 +91,7 @@ typedef struct {
 } rlm_json_t;
 
 
-json_object	*json_object_from_attr_value(TALLOC_CTX *ctx, VALUE_PAIR const *vp, bool always_string, bool enum_as_int);
+json_object	*json_object_from_attr_value(TALLOC_CTX *ctx, VALUE_PAIR const *vp, bool always_string, bool enum_as_int, bool dates_as_int);
 void		fr_json_version_print(void);
 char		*fr_json_afrom_pair_list(TALLOC_CTX *ctx, VALUE_PAIR *vps,
 					 rlm_json_t const *format);
diff -urpN freeradius-server-3.2.7/src/modules/rlm_json/rlm_json.c freeradius-server-3.2.8/src/modules/rlm_json/rlm_json.c
--- freeradius-server-3.2.7/src/modules/rlm_json/rlm_json.c	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/modules/rlm_json/rlm_json.c	2025-08-20 23:29:15.000000000 +0700
@@ -15,7 +15,7 @@
  */
 
 /**
- * $Id: a2476e8f1fa858177a2952384dc19dd9d58081b6 $
+ * $Id: 3a785f9fd5b53a615d5db97d767825fa19fb7e16 $
  * @file rlm_json.c
  * @brief Parses JSON responses
  *
@@ -26,7 +26,7 @@
  * @copyright 2015,2021 Network RADIUS SARL (legal@networkradius.com)
  * @copyright 2015 The FreeRADIUS Server Project
  */
-RCSID("$Id: a2476e8f1fa858177a2952384dc19dd9d58081b6 $")
+RCSID("$Id: 3a785f9fd5b53a615d5db97d767825fa19fb7e16 $")
 
 #include <freeradius-devel/radiusd.h>
 #include <freeradius-devel/modules.h>
@@ -48,6 +48,7 @@ static CONF_PARSER const json_format_att
 static CONF_PARSER const json_format_value_config[] = {
 	{ "single_value_as_array", FR_CONF_OFFSET(PW_TYPE_BOOLEAN, rlm_json_t, value_as_array), "no" },
 	{ "enum_as_integer", FR_CONF_OFFSET(PW_TYPE_BOOLEAN, rlm_json_t, enum_as_int), "no" },
+	{ "dates_as_integer", FR_CONF_OFFSET(PW_TYPE_BOOLEAN, rlm_json_t, dates_as_int), "no" },
 	{ "always_string", FR_CONF_OFFSET(PW_TYPE_BOOLEAN, rlm_json_t, always_string), "no" },
 
 	CONF_PARSER_TERMINATOR
diff -urpN freeradius-server-3.2.7/src/modules/rlm_kafka/.gitignore freeradius-server-3.2.8/src/modules/rlm_kafka/.gitignore
--- freeradius-server-3.2.7/src/modules/rlm_kafka/.gitignore	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/modules/rlm_kafka/.gitignore	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1 @@
+all.mk
diff -urpN freeradius-server-3.2.7/src/modules/rlm_kafka/README.md freeradius-server-3.2.8/src/modules/rlm_kafka/README.md
--- freeradius-server-3.2.7/src/modules/rlm_kafka/README.md	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/modules/rlm_kafka/README.md	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,9 @@
+# rlm_kafka
+## Metadata
+<dl>
+  <dt>category</dt><dd>datastore</dd>
+</dl>
+
+## Summary
+
+Produces messages to a Kafka messaging queue.
diff -urpN freeradius-server-3.2.7/src/modules/rlm_kafka/all.mk.in freeradius-server-3.2.8/src/modules/rlm_kafka/all.mk.in
--- freeradius-server-3.2.7/src/modules/rlm_kafka/all.mk.in	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/modules/rlm_kafka/all.mk.in	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,10 @@
+TARGETNAME	:= @targetname@
+
+ifneq "$(TARGETNAME)" ""
+TARGET		:= $(TARGETNAME).a
+endif
+
+SOURCES		:= $(TARGETNAME).c
+
+SRC_CFLAGS	:= @mod_cflags@
+TGT_LDLIBS	:= @mod_ldflags@
diff -urpN freeradius-server-3.2.7/src/modules/rlm_kafka/configure freeradius-server-3.2.8/src/modules/rlm_kafka/configure
--- freeradius-server-3.2.7/src/modules/rlm_kafka/configure	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/modules/rlm_kafka/configure	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,5161 @@
+#! /bin/sh
+# From configure.ac Revision.
+# Guess values for system-dependent variables and create Makefiles.
+# Generated by GNU Autoconf 2.71.
+#
+#
+# Copyright (C) 1992-1996, 1998-2017, 2020-2021 Free Software Foundation,
+# Inc.
+#
+#
+# This configure script is free software; the Free Software Foundation
+# gives unlimited permission to copy, distribute and modify it.
+## -------------------- ##
+## M4sh Initialization. ##
+## -------------------- ##
+
+# Be more Bourne compatible
+DUALCASE=1; export DUALCASE # for MKS sh
+as_nop=:
+if test ${ZSH_VERSION+y} && (emulate sh) >/dev/null 2>&1
+then :
+  emulate sh
+  NULLCMD=:
+  # Pre-4.2 versions of Zsh do word splitting on ${1+"$@"}, which
+  # is contrary to our usage.  Disable this feature.
+  alias -g '${1+"$@"}'='"$@"'
+  setopt NO_GLOB_SUBST
+else $as_nop
+  case `(set -o) 2>/dev/null` in #(
+  *posix*) :
+    set -o posix ;; #(
+  *) :
+     ;;
+esac
+fi
+
+
+
+# Reset variables that may have inherited troublesome values from
+# the environment.
+
+# IFS needs to be set, to space, tab, and newline, in precisely that order.
+# (If _AS_PATH_WALK were called with IFS unset, it would have the
+# side effect of setting IFS to empty, thus disabling word splitting.)
+# Quoting is to prevent editors from complaining about space-tab.
+as_nl='
+'
+export as_nl
+IFS=" ""	$as_nl"
+
+PS1='$ '
+PS2='> '
+PS4='+ '
+
+# Ensure predictable behavior from utilities with locale-dependent output.
+LC_ALL=C
+export LC_ALL
+LANGUAGE=C
+export LANGUAGE
+
+# We cannot yet rely on "unset" to work, but we need these variables
+# to be unset--not just set to an empty or harmless value--now, to
+# avoid bugs in old shells (e.g. pre-3.0 UWIN ksh).  This construct
+# also avoids known problems related to "unset" and subshell syntax
+# in other old shells (e.g. bash 2.01 and pdksh 5.2.14).
+for as_var in BASH_ENV ENV MAIL MAILPATH CDPATH
+do eval test \${$as_var+y} \
+  && ( (unset $as_var) || exit 1) >/dev/null 2>&1 && unset $as_var || :
+done
+
+# Ensure that fds 0, 1, and 2 are open.
+if (exec 3>&0) 2>/dev/null; then :; else exec 0</dev/null; fi
+if (exec 3>&1) 2>/dev/null; then :; else exec 1>/dev/null; fi
+if (exec 3>&2)            ; then :; else exec 2>/dev/null; fi
+
+# The user is always right.
+if ${PATH_SEPARATOR+false} :; then
+  PATH_SEPARATOR=:
+  (PATH='/bin;/bin'; FPATH=$PATH; sh -c :) >/dev/null 2>&1 && {
+    (PATH='/bin:/bin'; FPATH=$PATH; sh -c :) >/dev/null 2>&1 ||
+      PATH_SEPARATOR=';'
+  }
+fi
+
+
+# Find who we are.  Look in the path if we contain no directory separator.
+as_myself=
+case $0 in #((
+  *[\\/]* ) as_myself=$0 ;;
+  *) as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH
+do
+  IFS=$as_save_IFS
+  case $as_dir in #(((
+    '') as_dir=./ ;;
+    */) ;;
+    *) as_dir=$as_dir/ ;;
+  esac
+    test -r "$as_dir$0" && as_myself=$as_dir$0 && break
+  done
+IFS=$as_save_IFS
+
+     ;;
+esac
+# We did not find ourselves, most probably we were run as `sh COMMAND'
+# in which case we are not to be found in the path.
+if test "x$as_myself" = x; then
+  as_myself=$0
+fi
+if test ! -f "$as_myself"; then
+  printf "%s\n" "$as_myself: error: cannot find myself; rerun with an absolute file name" >&2
+  exit 1
+fi
+
+
+# Use a proper internal environment variable to ensure we don't fall
+  # into an infinite loop, continuously re-executing ourselves.
+  if test x"${_as_can_reexec}" != xno && test "x$CONFIG_SHELL" != x; then
+    _as_can_reexec=no; export _as_can_reexec;
+    # We cannot yet assume a decent shell, so we have to provide a
+# neutralization value for shells without unset; and this also
+# works around shells that cannot unset nonexistent variables.
+# Preserve -v and -x to the replacement shell.
+BASH_ENV=/dev/null
+ENV=/dev/null
+(unset BASH_ENV) >/dev/null 2>&1 && unset BASH_ENV ENV
+case $- in # ((((
+  *v*x* | *x*v* ) as_opts=-vx ;;
+  *v* ) as_opts=-v ;;
+  *x* ) as_opts=-x ;;
+  * ) as_opts= ;;
+esac
+exec $CONFIG_SHELL $as_opts "$as_myself" ${1+"$@"}
+# Admittedly, this is quite paranoid, since all the known shells bail
+# out after a failed `exec'.
+printf "%s\n" "$0: could not re-execute with $CONFIG_SHELL" >&2
+exit 255
+  fi
+  # We don't want this to propagate to other subprocesses.
+          { _as_can_reexec=; unset _as_can_reexec;}
+if test "x$CONFIG_SHELL" = x; then
+  as_bourne_compatible="as_nop=:
+if test \${ZSH_VERSION+y} && (emulate sh) >/dev/null 2>&1
+then :
+  emulate sh
+  NULLCMD=:
+  # Pre-4.2 versions of Zsh do word splitting on \${1+\"\$@\"}, which
+  # is contrary to our usage.  Disable this feature.
+  alias -g '\${1+\"\$@\"}'='\"\$@\"'
+  setopt NO_GLOB_SUBST
+else \$as_nop
+  case \`(set -o) 2>/dev/null\` in #(
+  *posix*) :
+    set -o posix ;; #(
+  *) :
+     ;;
+esac
+fi
+"
+  as_required="as_fn_return () { (exit \$1); }
+as_fn_success () { as_fn_return 0; }
+as_fn_failure () { as_fn_return 1; }
+as_fn_ret_success () { return 0; }
+as_fn_ret_failure () { return 1; }
+
+exitcode=0
+as_fn_success || { exitcode=1; echo as_fn_success failed.; }
+as_fn_failure && { exitcode=1; echo as_fn_failure succeeded.; }
+as_fn_ret_success || { exitcode=1; echo as_fn_ret_success failed.; }
+as_fn_ret_failure && { exitcode=1; echo as_fn_ret_failure succeeded.; }
+if ( set x; as_fn_ret_success y && test x = \"\$1\" )
+then :
+
+else \$as_nop
+  exitcode=1; echo positional parameters were not saved.
+fi
+test x\$exitcode = x0 || exit 1
+blah=\$(echo \$(echo blah))
+test x\"\$blah\" = xblah || exit 1
+test -x / || exit 1"
+  as_suggested="  as_lineno_1=";as_suggested=$as_suggested$LINENO;as_suggested=$as_suggested" as_lineno_1a=\$LINENO
+  as_lineno_2=";as_suggested=$as_suggested$LINENO;as_suggested=$as_suggested" as_lineno_2a=\$LINENO
+  eval 'test \"x\$as_lineno_1'\$as_run'\" != \"x\$as_lineno_2'\$as_run'\" &&
+  test \"x\`expr \$as_lineno_1'\$as_run' + 1\`\" = \"x\$as_lineno_2'\$as_run'\"' || exit 1
+test \$(( 1 + 1 )) = 2 || exit 1"
+  if (eval "$as_required") 2>/dev/null
+then :
+  as_have_required=yes
+else $as_nop
+  as_have_required=no
+fi
+  if test x$as_have_required = xyes && (eval "$as_suggested") 2>/dev/null
+then :
+
+else $as_nop
+  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+as_found=false
+for as_dir in /bin$PATH_SEPARATOR/usr/bin$PATH_SEPARATOR$PATH
+do
+  IFS=$as_save_IFS
+  case $as_dir in #(((
+    '') as_dir=./ ;;
+    */) ;;
+    *) as_dir=$as_dir/ ;;
+  esac
+  as_found=:
+  case $as_dir in #(
+	 /*)
+	   for as_base in sh bash ksh sh5; do
+	     # Try only shells that exist, to save several forks.
+	     as_shell=$as_dir$as_base
+	     if { test -f "$as_shell" || test -f "$as_shell.exe"; } &&
+		    as_run=a "$as_shell" -c "$as_bourne_compatible""$as_required" 2>/dev/null
+then :
+  CONFIG_SHELL=$as_shell as_have_required=yes
+		   if as_run=a "$as_shell" -c "$as_bourne_compatible""$as_suggested" 2>/dev/null
+then :
+  break 2
+fi
+fi
+	   done;;
+       esac
+  as_found=false
+done
+IFS=$as_save_IFS
+if $as_found
+then :
+
+else $as_nop
+  if { test -f "$SHELL" || test -f "$SHELL.exe"; } &&
+	      as_run=a "$SHELL" -c "$as_bourne_compatible""$as_required" 2>/dev/null
+then :
+  CONFIG_SHELL=$SHELL as_have_required=yes
+fi
+fi
+
+
+      if test "x$CONFIG_SHELL" != x
+then :
+  export CONFIG_SHELL
+             # We cannot yet assume a decent shell, so we have to provide a
+# neutralization value for shells without unset; and this also
+# works around shells that cannot unset nonexistent variables.
+# Preserve -v and -x to the replacement shell.
+BASH_ENV=/dev/null
+ENV=/dev/null
+(unset BASH_ENV) >/dev/null 2>&1 && unset BASH_ENV ENV
+case $- in # ((((
+  *v*x* | *x*v* ) as_opts=-vx ;;
+  *v* ) as_opts=-v ;;
+  *x* ) as_opts=-x ;;
+  * ) as_opts= ;;
+esac
+exec $CONFIG_SHELL $as_opts "$as_myself" ${1+"$@"}
+# Admittedly, this is quite paranoid, since all the known shells bail
+# out after a failed `exec'.
+printf "%s\n" "$0: could not re-execute with $CONFIG_SHELL" >&2
+exit 255
+fi
+
+    if test x$as_have_required = xno
+then :
+  printf "%s\n" "$0: This script requires a shell more modern than all"
+  printf "%s\n" "$0: the shells that I found on your system."
+  if test ${ZSH_VERSION+y} ; then
+    printf "%s\n" "$0: In particular, zsh $ZSH_VERSION has bugs and should"
+    printf "%s\n" "$0: be upgraded to zsh 4.3.4 or later."
+  else
+    printf "%s\n" "$0: Please tell bug-autoconf@gnu.org about your system,
+$0: including any error possibly output before this
+$0: message. Then install a modern shell, or manually run
+$0: the script under such a shell if you do have one."
+  fi
+  exit 1
+fi
+fi
+fi
+SHELL=${CONFIG_SHELL-/bin/sh}
+export SHELL
+# Unset more variables known to interfere with behavior of common tools.
+CLICOLOR_FORCE= GREP_OPTIONS=
+unset CLICOLOR_FORCE GREP_OPTIONS
+
+## --------------------- ##
+## M4sh Shell Functions. ##
+## --------------------- ##
+# as_fn_unset VAR
+# ---------------
+# Portably unset VAR.
+as_fn_unset ()
+{
+  { eval $1=; unset $1;}
+}
+as_unset=as_fn_unset
+
+
+# as_fn_set_status STATUS
+# -----------------------
+# Set $? to STATUS, without forking.
+as_fn_set_status ()
+{
+  return $1
+} # as_fn_set_status
+
+# as_fn_exit STATUS
+# -----------------
+# Exit the shell with STATUS, even in a "trap 0" or "set -e" context.
+as_fn_exit ()
+{
+  set +e
+  as_fn_set_status $1
+  exit $1
+} # as_fn_exit
+# as_fn_nop
+# ---------
+# Do nothing but, unlike ":", preserve the value of $?.
+as_fn_nop ()
+{
+  return $?
+}
+as_nop=as_fn_nop
+
+# as_fn_mkdir_p
+# -------------
+# Create "$as_dir" as a directory, including parents if necessary.
+as_fn_mkdir_p ()
+{
+
+  case $as_dir in #(
+  -*) as_dir=./$as_dir;;
+  esac
+  test -d "$as_dir" || eval $as_mkdir_p || {
+    as_dirs=
+    while :; do
+      case $as_dir in #(
+      *\'*) as_qdir=`printf "%s\n" "$as_dir" | sed "s/'/'\\\\\\\\''/g"`;; #'(
+      *) as_qdir=$as_dir;;
+      esac
+      as_dirs="'$as_qdir' $as_dirs"
+      as_dir=`$as_dirname -- "$as_dir" ||
+$as_expr X"$as_dir" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
+	 X"$as_dir" : 'X\(//\)[^/]' \| \
+	 X"$as_dir" : 'X\(//\)$' \| \
+	 X"$as_dir" : 'X\(/\)' \| . 2>/dev/null ||
+printf "%s\n" X"$as_dir" |
+    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{
+	    s//\1/
+	    q
+	  }
+	  /^X\(\/\/\)[^/].*/{
+	    s//\1/
+	    q
+	  }
+	  /^X\(\/\/\)$/{
+	    s//\1/
+	    q
+	  }
+	  /^X\(\/\).*/{
+	    s//\1/
+	    q
+	  }
+	  s/.*/./; q'`
+      test -d "$as_dir" && break
+    done
+    test -z "$as_dirs" || eval "mkdir $as_dirs"
+  } || test -d "$as_dir" || as_fn_error $? "cannot create directory $as_dir"
+
+
+} # as_fn_mkdir_p
+
+# as_fn_executable_p FILE
+# -----------------------
+# Test if FILE is an executable regular file.
+as_fn_executable_p ()
+{
+  test -f "$1" && test -x "$1"
+} # as_fn_executable_p
+# as_fn_append VAR VALUE
+# ----------------------
+# Append the text in VALUE to the end of the definition contained in VAR. Take
+# advantage of any shell optimizations that allow amortized linear growth over
+# repeated appends, instead of the typical quadratic growth present in naive
+# implementations.
+if (eval "as_var=1; as_var+=2; test x\$as_var = x12") 2>/dev/null
+then :
+  eval 'as_fn_append ()
+  {
+    eval $1+=\$2
+  }'
+else $as_nop
+  as_fn_append ()
+  {
+    eval $1=\$$1\$2
+  }
+fi # as_fn_append
+
+# as_fn_arith ARG...
+# ------------------
+# Perform arithmetic evaluation on the ARGs, and store the result in the
+# global $as_val. Take advantage of shells that can avoid forks. The arguments
+# must be portable across $(()) and expr.
+if (eval "test \$(( 1 + 1 )) = 2") 2>/dev/null
+then :
+  eval 'as_fn_arith ()
+  {
+    as_val=$(( $* ))
+  }'
+else $as_nop
+  as_fn_arith ()
+  {
+    as_val=`expr "$@" || test $? -eq 1`
+  }
+fi # as_fn_arith
+
+# as_fn_nop
+# ---------
+# Do nothing but, unlike ":", preserve the value of $?.
+as_fn_nop ()
+{
+  return $?
+}
+as_nop=as_fn_nop
+
+# as_fn_error STATUS ERROR [LINENO LOG_FD]
+# ----------------------------------------
+# Output "`basename $0`: error: ERROR" to stderr. If LINENO and LOG_FD are
+# provided, also output the error to LOG_FD, referencing LINENO. Then exit the
+# script with STATUS, using 1 if that was 0.
+as_fn_error ()
+{
+  as_status=$1; test $as_status -eq 0 && as_status=1
+  if test "$4"; then
+    as_lineno=${as_lineno-"$3"} as_lineno_stack=as_lineno_stack=$as_lineno_stack
+    printf "%s\n" "$as_me:${as_lineno-$LINENO}: error: $2" >&$4
+  fi
+  printf "%s\n" "$as_me: error: $2" >&2
+  as_fn_exit $as_status
+} # as_fn_error
+
+if expr a : '\(a\)' >/dev/null 2>&1 &&
+   test "X`expr 00001 : '.*\(...\)'`" = X001; then
+  as_expr=expr
+else
+  as_expr=false
+fi
+
+if (basename -- /) >/dev/null 2>&1 && test "X`basename -- / 2>&1`" = "X/"; then
+  as_basename=basename
+else
+  as_basename=false
+fi
+
+if (as_dir=`dirname -- /` && test "X$as_dir" = X/) >/dev/null 2>&1; then
+  as_dirname=dirname
+else
+  as_dirname=false
+fi
+
+as_me=`$as_basename -- "$0" ||
+$as_expr X/"$0" : '.*/\([^/][^/]*\)/*$' \| \
+	 X"$0" : 'X\(//\)$' \| \
+	 X"$0" : 'X\(/\)' \| . 2>/dev/null ||
+printf "%s\n" X/"$0" |
+    sed '/^.*\/\([^/][^/]*\)\/*$/{
+	    s//\1/
+	    q
+	  }
+	  /^X\/\(\/\/\)$/{
+	    s//\1/
+	    q
+	  }
+	  /^X\/\(\/\).*/{
+	    s//\1/
+	    q
+	  }
+	  s/.*/./; q'`
+
+# Avoid depending upon Character Ranges.
+as_cr_letters='abcdefghijklmnopqrstuvwxyz'
+as_cr_LETTERS='ABCDEFGHIJKLMNOPQRSTUVWXYZ'
+as_cr_Letters=$as_cr_letters$as_cr_LETTERS
+as_cr_digits='0123456789'
+as_cr_alnum=$as_cr_Letters$as_cr_digits
+
+
+  as_lineno_1=$LINENO as_lineno_1a=$LINENO
+  as_lineno_2=$LINENO as_lineno_2a=$LINENO
+  eval 'test "x$as_lineno_1'$as_run'" != "x$as_lineno_2'$as_run'" &&
+  test "x`expr $as_lineno_1'$as_run' + 1`" = "x$as_lineno_2'$as_run'"' || {
+  # Blame Lee E. McMahon (1931-1989) for sed's syntax.  :-)
+  sed -n '
+    p
+    /[$]LINENO/=
+  ' <$as_myself |
+    sed '
+      s/[$]LINENO.*/&-/
+      t lineno
+      b
+      :lineno
+      N
+      :loop
+      s/[$]LINENO\([^'$as_cr_alnum'_].*\n\)\(.*\)/\2\1\2/
+      t loop
+      s/-\n.*//
+    ' >$as_me.lineno &&
+  chmod +x "$as_me.lineno" ||
+    { printf "%s\n" "$as_me: error: cannot create $as_me.lineno; rerun with a POSIX shell" >&2; as_fn_exit 1; }
+
+  # If we had to re-execute with $CONFIG_SHELL, we're ensured to have
+  # already done that, so ensure we don't try to do so again and fall
+  # in an infinite loop.  This has already happened in practice.
+  _as_can_reexec=no; export _as_can_reexec
+  # Don't try to exec as it changes $[0], causing all sort of problems
+  # (the dirname of $[0] is not the place where we might find the
+  # original and so on.  Autoconf is especially sensitive to this).
+  . "./$as_me.lineno"
+  # Exit status is that of the last command.
+  exit
+}
+
+
+# Determine whether it's possible to make 'echo' print without a newline.
+# These variables are no longer used directly by Autoconf, but are AC_SUBSTed
+# for compatibility with existing Makefiles.
+ECHO_C= ECHO_N= ECHO_T=
+case `echo -n x` in #(((((
+-n*)
+  case `echo 'xy\c'` in
+  *c*) ECHO_T='	';;	# ECHO_T is single tab character.
+  xy)  ECHO_C='\c';;
+  *)   echo `echo ksh88 bug on AIX 6.1` > /dev/null
+       ECHO_T='	';;
+  esac;;
+*)
+  ECHO_N='-n';;
+esac
+
+# For backward compatibility with old third-party macros, we provide
+# the shell variables $as_echo and $as_echo_n.  New code should use
+# AS_ECHO(["message"]) and AS_ECHO_N(["message"]), respectively.
+as_echo='printf %s\n'
+as_echo_n='printf %s'
+
+
+rm -f conf$$ conf$$.exe conf$$.file
+if test -d conf$$.dir; then
+  rm -f conf$$.dir/conf$$.file
+else
+  rm -f conf$$.dir
+  mkdir conf$$.dir 2>/dev/null
+fi
+if (echo >conf$$.file) 2>/dev/null; then
+  if ln -s conf$$.file conf$$ 2>/dev/null; then
+    as_ln_s='ln -s'
+    # ... but there are two gotchas:
+    # 1) On MSYS, both `ln -s file dir' and `ln file dir' fail.
+    # 2) DJGPP < 2.04 has no symlinks; `ln -s' creates a wrapper executable.
+    # In both cases, we have to default to `cp -pR'.
+    ln -s conf$$.file conf$$.dir 2>/dev/null && test ! -f conf$$.exe ||
+      as_ln_s='cp -pR'
+  elif ln conf$$.file conf$$ 2>/dev/null; then
+    as_ln_s=ln
+  else
+    as_ln_s='cp -pR'
+  fi
+else
+  as_ln_s='cp -pR'
+fi
+rm -f conf$$ conf$$.exe conf$$.dir/conf$$.file conf$$.file
+rmdir conf$$.dir 2>/dev/null
+
+if mkdir -p . 2>/dev/null; then
+  as_mkdir_p='mkdir -p "$as_dir"'
+else
+  test -d ./-p && rmdir ./-p
+  as_mkdir_p=false
+fi
+
+as_test_x='test -x'
+as_executable_p=as_fn_executable_p
+
+# Sed expression to map a string onto a valid CPP name.
+as_tr_cpp="eval sed 'y%*$as_cr_letters%P$as_cr_LETTERS%;s%[^_$as_cr_alnum]%_%g'"
+
+# Sed expression to map a string onto a valid variable name.
+as_tr_sh="eval sed 'y%*+%pp%;s%[^_$as_cr_alnum]%_%g'"
+
+
+test -n "$DJDIR" || exec 7<&0 </dev/null
+exec 6>&1
+
+# Name of the host.
+# hostname on some systems (SVR3.2, old GNU/Linux) returns a bogus exit status,
+# so uname gets run too.
+ac_hostname=`(hostname || uname -n) 2>/dev/null | sed 1q`
+
+#
+# Initializations.
+#
+ac_default_prefix=/usr/local
+ac_clean_files=
+ac_config_libobj_dir=.
+LIBOBJS=
+cross_compiling=no
+subdirs=
+MFLAGS=
+MAKEFLAGS=
+
+# Identity of this package.
+PACKAGE_NAME=''
+PACKAGE_TARNAME=''
+PACKAGE_VERSION=''
+PACKAGE_STRING=''
+PACKAGE_BUGREPORT=''
+PACKAGE_URL=''
+
+ac_unique_file="rlm_kafka.c"
+ac_subst_vars='LTLIBOBJS
+LIBOBJS
+mod_cflags
+mod_ldflags
+targetname
+EGREP
+GREP
+CPP
+OBJEXT
+EXEEXT
+ac_ct_CC
+CPPFLAGS
+LDFLAGS
+CFLAGS
+CC
+target_alias
+host_alias
+build_alias
+LIBS
+ECHO_T
+ECHO_N
+ECHO_C
+DEFS
+mandir
+localedir
+libdir
+psdir
+pdfdir
+dvidir
+htmldir
+infodir
+docdir
+oldincludedir
+includedir
+runstatedir
+localstatedir
+sharedstatedir
+sysconfdir
+datadir
+datarootdir
+libexecdir
+sbindir
+bindir
+program_transform_name
+prefix
+exec_prefix
+PACKAGE_URL
+PACKAGE_BUGREPORT
+PACKAGE_STRING
+PACKAGE_VERSION
+PACKAGE_TARNAME
+PACKAGE_NAME
+PATH_SEPARATOR
+SHELL'
+ac_subst_files=''
+ac_user_opts='
+enable_option_checking
+with_rlm_kafka
+with_kafka_include_dir
+with_kafka_lib_dir
+with_kafka_dir
+with_openssl_lib_dir
+with_openssl_include_dir
+'
+      ac_precious_vars='build_alias
+host_alias
+target_alias
+CC
+CFLAGS
+LDFLAGS
+LIBS
+CPPFLAGS
+CPP'
+
+
+# Initialize some variables set by options.
+ac_init_help=
+ac_init_version=false
+ac_unrecognized_opts=
+ac_unrecognized_sep=
+# The variables have the same names as the options, with
+# dashes changed to underlines.
+cache_file=/dev/null
+exec_prefix=NONE
+no_create=
+no_recursion=
+prefix=NONE
+program_prefix=NONE
+program_suffix=NONE
+program_transform_name=s,x,x,
+silent=
+site=
+srcdir=
+verbose=
+x_includes=NONE
+x_libraries=NONE
+
+# Installation directory options.
+# These are left unexpanded so users can "make install exec_prefix=/foo"
+# and all the variables that are supposed to be based on exec_prefix
+# by default will actually change.
+# Use braces instead of parens because sh, perl, etc. also accept them.
+# (The list follows the same order as the GNU Coding Standards.)
+bindir='${exec_prefix}/bin'
+sbindir='${exec_prefix}/sbin'
+libexecdir='${exec_prefix}/libexec'
+datarootdir='${prefix}/share'
+datadir='${datarootdir}'
+sysconfdir='${prefix}/etc'
+sharedstatedir='${prefix}/com'
+localstatedir='${prefix}/var'
+runstatedir='${localstatedir}/run'
+includedir='${prefix}/include'
+oldincludedir='/usr/include'
+docdir='${datarootdir}/doc/${PACKAGE}'
+infodir='${datarootdir}/info'
+htmldir='${docdir}'
+dvidir='${docdir}'
+pdfdir='${docdir}'
+psdir='${docdir}'
+libdir='${exec_prefix}/lib'
+localedir='${datarootdir}/locale'
+mandir='${datarootdir}/man'
+
+ac_prev=
+ac_dashdash=
+for ac_option
+do
+  # If the previous option needs an argument, assign it.
+  if test -n "$ac_prev"; then
+    eval $ac_prev=\$ac_option
+    ac_prev=
+    continue
+  fi
+
+  case $ac_option in
+  *=?*) ac_optarg=`expr "X$ac_option" : '[^=]*=\(.*\)'` ;;
+  *=)   ac_optarg= ;;
+  *)    ac_optarg=yes ;;
+  esac
+
+  case $ac_dashdash$ac_option in
+  --)
+    ac_dashdash=yes ;;
+
+  -bindir | --bindir | --bindi | --bind | --bin | --bi)
+    ac_prev=bindir ;;
+  -bindir=* | --bindir=* | --bindi=* | --bind=* | --bin=* | --bi=*)
+    bindir=$ac_optarg ;;
+
+  -build | --build | --buil | --bui | --bu)
+    ac_prev=build_alias ;;
+  -build=* | --build=* | --buil=* | --bui=* | --bu=*)
+    build_alias=$ac_optarg ;;
+
+  -cache-file | --cache-file | --cache-fil | --cache-fi \
+  | --cache-f | --cache- | --cache | --cach | --cac | --ca | --c)
+    ac_prev=cache_file ;;
+  -cache-file=* | --cache-file=* | --cache-fil=* | --cache-fi=* \
+  | --cache-f=* | --cache-=* | --cache=* | --cach=* | --cac=* | --ca=* | --c=*)
+    cache_file=$ac_optarg ;;
+
+  --config-cache | -C)
+    cache_file=config.cache ;;
+
+  -datadir | --datadir | --datadi | --datad)
+    ac_prev=datadir ;;
+  -datadir=* | --datadir=* | --datadi=* | --datad=*)
+    datadir=$ac_optarg ;;
+
+  -datarootdir | --datarootdir | --datarootdi | --datarootd | --dataroot \
+  | --dataroo | --dataro | --datar)
+    ac_prev=datarootdir ;;
+  -datarootdir=* | --datarootdir=* | --datarootdi=* | --datarootd=* \
+  | --dataroot=* | --dataroo=* | --dataro=* | --datar=*)
+    datarootdir=$ac_optarg ;;
+
+  -disable-* | --disable-*)
+    ac_useropt=`expr "x$ac_option" : 'x-*disable-\(.*\)'`
+    # Reject names that are not valid shell variable names.
+    expr "x$ac_useropt" : ".*[^-+._$as_cr_alnum]" >/dev/null &&
+      as_fn_error $? "invalid feature name: \`$ac_useropt'"
+    ac_useropt_orig=$ac_useropt
+    ac_useropt=`printf "%s\n" "$ac_useropt" | sed 's/[-+.]/_/g'`
+    case $ac_user_opts in
+      *"
+"enable_$ac_useropt"
+"*) ;;
+      *) ac_unrecognized_opts="$ac_unrecognized_opts$ac_unrecognized_sep--disable-$ac_useropt_orig"
+	 ac_unrecognized_sep=', ';;
+    esac
+    eval enable_$ac_useropt=no ;;
+
+  -docdir | --docdir | --docdi | --doc | --do)
+    ac_prev=docdir ;;
+  -docdir=* | --docdir=* | --docdi=* | --doc=* | --do=*)
+    docdir=$ac_optarg ;;
+
+  -dvidir | --dvidir | --dvidi | --dvid | --dvi | --dv)
+    ac_prev=dvidir ;;
+  -dvidir=* | --dvidir=* | --dvidi=* | --dvid=* | --dvi=* | --dv=*)
+    dvidir=$ac_optarg ;;
+
+  -enable-* | --enable-*)
+    ac_useropt=`expr "x$ac_option" : 'x-*enable-\([^=]*\)'`
+    # Reject names that are not valid shell variable names.
+    expr "x$ac_useropt" : ".*[^-+._$as_cr_alnum]" >/dev/null &&
+      as_fn_error $? "invalid feature name: \`$ac_useropt'"
+    ac_useropt_orig=$ac_useropt
+    ac_useropt=`printf "%s\n" "$ac_useropt" | sed 's/[-+.]/_/g'`
+    case $ac_user_opts in
+      *"
+"enable_$ac_useropt"
+"*) ;;
+      *) ac_unrecognized_opts="$ac_unrecognized_opts$ac_unrecognized_sep--enable-$ac_useropt_orig"
+	 ac_unrecognized_sep=', ';;
+    esac
+    eval enable_$ac_useropt=\$ac_optarg ;;
+
+  -exec-prefix | --exec_prefix | --exec-prefix | --exec-prefi \
+  | --exec-pref | --exec-pre | --exec-pr | --exec-p | --exec- \
+  | --exec | --exe | --ex)
+    ac_prev=exec_prefix ;;
+  -exec-prefix=* | --exec_prefix=* | --exec-prefix=* | --exec-prefi=* \
+  | --exec-pref=* | --exec-pre=* | --exec-pr=* | --exec-p=* | --exec-=* \
+  | --exec=* | --exe=* | --ex=*)
+    exec_prefix=$ac_optarg ;;
+
+  -gas | --gas | --ga | --g)
+    # Obsolete; use --with-gas.
+    with_gas=yes ;;
+
+  -help | --help | --hel | --he | -h)
+    ac_init_help=long ;;
+  -help=r* | --help=r* | --hel=r* | --he=r* | -hr*)
+    ac_init_help=recursive ;;
+  -help=s* | --help=s* | --hel=s* | --he=s* | -hs*)
+    ac_init_help=short ;;
+
+  -host | --host | --hos | --ho)
+    ac_prev=host_alias ;;
+  -host=* | --host=* | --hos=* | --ho=*)
+    host_alias=$ac_optarg ;;
+
+  -htmldir | --htmldir | --htmldi | --htmld | --html | --htm | --ht)
+    ac_prev=htmldir ;;
+  -htmldir=* | --htmldir=* | --htmldi=* | --htmld=* | --html=* | --htm=* \
+  | --ht=*)
+    htmldir=$ac_optarg ;;
+
+  -includedir | --includedir | --includedi | --included | --include \
+  | --includ | --inclu | --incl | --inc)
+    ac_prev=includedir ;;
+  -includedir=* | --includedir=* | --includedi=* | --included=* | --include=* \
+  | --includ=* | --inclu=* | --incl=* | --inc=*)
+    includedir=$ac_optarg ;;
+
+  -infodir | --infodir | --infodi | --infod | --info | --inf)
+    ac_prev=infodir ;;
+  -infodir=* | --infodir=* | --infodi=* | --infod=* | --info=* | --inf=*)
+    infodir=$ac_optarg ;;
+
+  -libdir | --libdir | --libdi | --libd)
+    ac_prev=libdir ;;
+  -libdir=* | --libdir=* | --libdi=* | --libd=*)
+    libdir=$ac_optarg ;;
+
+  -libexecdir | --libexecdir | --libexecdi | --libexecd | --libexec \
+  | --libexe | --libex | --libe)
+    ac_prev=libexecdir ;;
+  -libexecdir=* | --libexecdir=* | --libexecdi=* | --libexecd=* | --libexec=* \
+  | --libexe=* | --libex=* | --libe=*)
+    libexecdir=$ac_optarg ;;
+
+  -localedir | --localedir | --localedi | --localed | --locale)
+    ac_prev=localedir ;;
+  -localedir=* | --localedir=* | --localedi=* | --localed=* | --locale=*)
+    localedir=$ac_optarg ;;
+
+  -localstatedir | --localstatedir | --localstatedi | --localstated \
+  | --localstate | --localstat | --localsta | --localst | --locals)
+    ac_prev=localstatedir ;;
+  -localstatedir=* | --localstatedir=* | --localstatedi=* | --localstated=* \
+  | --localstate=* | --localstat=* | --localsta=* | --localst=* | --locals=*)
+    localstatedir=$ac_optarg ;;
+
+  -mandir | --mandir | --mandi | --mand | --man | --ma | --m)
+    ac_prev=mandir ;;
+  -mandir=* | --mandir=* | --mandi=* | --mand=* | --man=* | --ma=* | --m=*)
+    mandir=$ac_optarg ;;
+
+  -nfp | --nfp | --nf)
+    # Obsolete; use --without-fp.
+    with_fp=no ;;
+
+  -no-create | --no-create | --no-creat | --no-crea | --no-cre \
+  | --no-cr | --no-c | -n)
+    no_create=yes ;;
+
+  -no-recursion | --no-recursion | --no-recursio | --no-recursi \
+  | --no-recurs | --no-recur | --no-recu | --no-rec | --no-re | --no-r)
+    no_recursion=yes ;;
+
+  -oldincludedir | --oldincludedir | --oldincludedi | --oldincluded \
+  | --oldinclude | --oldinclud | --oldinclu | --oldincl | --oldinc \
+  | --oldin | --oldi | --old | --ol | --o)
+    ac_prev=oldincludedir ;;
+  -oldincludedir=* | --oldincludedir=* | --oldincludedi=* | --oldincluded=* \
+  | --oldinclude=* | --oldinclud=* | --oldinclu=* | --oldincl=* | --oldinc=* \
+  | --oldin=* | --oldi=* | --old=* | --ol=* | --o=*)
+    oldincludedir=$ac_optarg ;;
+
+  -prefix | --prefix | --prefi | --pref | --pre | --pr | --p)
+    ac_prev=prefix ;;
+  -prefix=* | --prefix=* | --prefi=* | --pref=* | --pre=* | --pr=* | --p=*)
+    prefix=$ac_optarg ;;
+
+  -program-prefix | --program-prefix | --program-prefi | --program-pref \
+  | --program-pre | --program-pr | --program-p)
+    ac_prev=program_prefix ;;
+  -program-prefix=* | --program-prefix=* | --program-prefi=* \
+  | --program-pref=* | --program-pre=* | --program-pr=* | --program-p=*)
+    program_prefix=$ac_optarg ;;
+
+  -program-suffix | --program-suffix | --program-suffi | --program-suff \
+  | --program-suf | --program-su | --program-s)
+    ac_prev=program_suffix ;;
+  -program-suffix=* | --program-suffix=* | --program-suffi=* \
+  | --program-suff=* | --program-suf=* | --program-su=* | --program-s=*)
+    program_suffix=$ac_optarg ;;
+
+  -program-transform-name | --program-transform-name \
+  | --program-transform-nam | --program-transform-na \
+  | --program-transform-n | --program-transform- \
+  | --program-transform | --program-transfor \
+  | --program-transfo | --program-transf \
+  | --program-trans | --program-tran \
+  | --progr-tra | --program-tr | --program-t)
+    ac_prev=program_transform_name ;;
+  -program-transform-name=* | --program-transform-name=* \
+  | --program-transform-nam=* | --program-transform-na=* \
+  | --program-transform-n=* | --program-transform-=* \
+  | --program-transform=* | --program-transfor=* \
+  | --program-transfo=* | --program-transf=* \
+  | --program-trans=* | --program-tran=* \
+  | --progr-tra=* | --program-tr=* | --program-t=*)
+    program_transform_name=$ac_optarg ;;
+
+  -pdfdir | --pdfdir | --pdfdi | --pdfd | --pdf | --pd)
+    ac_prev=pdfdir ;;
+  -pdfdir=* | --pdfdir=* | --pdfdi=* | --pdfd=* | --pdf=* | --pd=*)
+    pdfdir=$ac_optarg ;;
+
+  -psdir | --psdir | --psdi | --psd | --ps)
+    ac_prev=psdir ;;
+  -psdir=* | --psdir=* | --psdi=* | --psd=* | --ps=*)
+    psdir=$ac_optarg ;;
+
+  -q | -quiet | --quiet | --quie | --qui | --qu | --q \
+  | -silent | --silent | --silen | --sile | --sil)
+    silent=yes ;;
+
+  -runstatedir | --runstatedir | --runstatedi | --runstated \
+  | --runstate | --runstat | --runsta | --runst | --runs \
+  | --run | --ru | --r)
+    ac_prev=runstatedir ;;
+  -runstatedir=* | --runstatedir=* | --runstatedi=* | --runstated=* \
+  | --runstate=* | --runstat=* | --runsta=* | --runst=* | --runs=* \
+  | --run=* | --ru=* | --r=*)
+    runstatedir=$ac_optarg ;;
+
+  -sbindir | --sbindir | --sbindi | --sbind | --sbin | --sbi | --sb)
+    ac_prev=sbindir ;;
+  -sbindir=* | --sbindir=* | --sbindi=* | --sbind=* | --sbin=* \
+  | --sbi=* | --sb=*)
+    sbindir=$ac_optarg ;;
+
+  -sharedstatedir | --sharedstatedir | --sharedstatedi \
+  | --sharedstated | --sharedstate | --sharedstat | --sharedsta \
+  | --sharedst | --shareds | --shared | --share | --shar \
+  | --sha | --sh)
+    ac_prev=sharedstatedir ;;
+  -sharedstatedir=* | --sharedstatedir=* | --sharedstatedi=* \
+  | --sharedstated=* | --sharedstate=* | --sharedstat=* | --sharedsta=* \
+  | --sharedst=* | --shareds=* | --shared=* | --share=* | --shar=* \
+  | --sha=* | --sh=*)
+    sharedstatedir=$ac_optarg ;;
+
+  -site | --site | --sit)
+    ac_prev=site ;;
+  -site=* | --site=* | --sit=*)
+    site=$ac_optarg ;;
+
+  -srcdir | --srcdir | --srcdi | --srcd | --src | --sr)
+    ac_prev=srcdir ;;
+  -srcdir=* | --srcdir=* | --srcdi=* | --srcd=* | --src=* | --sr=*)
+    srcdir=$ac_optarg ;;
+
+  -sysconfdir | --sysconfdir | --sysconfdi | --sysconfd | --sysconf \
+  | --syscon | --sysco | --sysc | --sys | --sy)
+    ac_prev=sysconfdir ;;
+  -sysconfdir=* | --sysconfdir=* | --sysconfdi=* | --sysconfd=* | --sysconf=* \
+  | --syscon=* | --sysco=* | --sysc=* | --sys=* | --sy=*)
+    sysconfdir=$ac_optarg ;;
+
+  -target | --target | --targe | --targ | --tar | --ta | --t)
+    ac_prev=target_alias ;;
+  -target=* | --target=* | --targe=* | --targ=* | --tar=* | --ta=* | --t=*)
+    target_alias=$ac_optarg ;;
+
+  -v | -verbose | --verbose | --verbos | --verbo | --verb)
+    verbose=yes ;;
+
+  -version | --version | --versio | --versi | --vers | -V)
+    ac_init_version=: ;;
+
+  -with-* | --with-*)
+    ac_useropt=`expr "x$ac_option" : 'x-*with-\([^=]*\)'`
+    # Reject names that are not valid shell variable names.
+    expr "x$ac_useropt" : ".*[^-+._$as_cr_alnum]" >/dev/null &&
+      as_fn_error $? "invalid package name: \`$ac_useropt'"
+    ac_useropt_orig=$ac_useropt
+    ac_useropt=`printf "%s\n" "$ac_useropt" | sed 's/[-+.]/_/g'`
+    case $ac_user_opts in
+      *"
+"with_$ac_useropt"
+"*) ;;
+      *) ac_unrecognized_opts="$ac_unrecognized_opts$ac_unrecognized_sep--with-$ac_useropt_orig"
+	 ac_unrecognized_sep=', ';;
+    esac
+    eval with_$ac_useropt=\$ac_optarg ;;
+
+  -without-* | --without-*)
+    ac_useropt=`expr "x$ac_option" : 'x-*without-\(.*\)'`
+    # Reject names that are not valid shell variable names.
+    expr "x$ac_useropt" : ".*[^-+._$as_cr_alnum]" >/dev/null &&
+      as_fn_error $? "invalid package name: \`$ac_useropt'"
+    ac_useropt_orig=$ac_useropt
+    ac_useropt=`printf "%s\n" "$ac_useropt" | sed 's/[-+.]/_/g'`
+    case $ac_user_opts in
+      *"
+"with_$ac_useropt"
+"*) ;;
+      *) ac_unrecognized_opts="$ac_unrecognized_opts$ac_unrecognized_sep--without-$ac_useropt_orig"
+	 ac_unrecognized_sep=', ';;
+    esac
+    eval with_$ac_useropt=no ;;
+
+  --x)
+    # Obsolete; use --with-x.
+    with_x=yes ;;
+
+  -x-includes | --x-includes | --x-include | --x-includ | --x-inclu \
+  | --x-incl | --x-inc | --x-in | --x-i)
+    ac_prev=x_includes ;;
+  -x-includes=* | --x-includes=* | --x-include=* | --x-includ=* | --x-inclu=* \
+  | --x-incl=* | --x-inc=* | --x-in=* | --x-i=*)
+    x_includes=$ac_optarg ;;
+
+  -x-libraries | --x-libraries | --x-librarie | --x-librari \
+  | --x-librar | --x-libra | --x-libr | --x-lib | --x-li | --x-l)
+    ac_prev=x_libraries ;;
+  -x-libraries=* | --x-libraries=* | --x-librarie=* | --x-librari=* \
+  | --x-librar=* | --x-libra=* | --x-libr=* | --x-lib=* | --x-li=* | --x-l=*)
+    x_libraries=$ac_optarg ;;
+
+  -*) as_fn_error $? "unrecognized option: \`$ac_option'
+Try \`$0 --help' for more information"
+    ;;
+
+  *=*)
+    ac_envvar=`expr "x$ac_option" : 'x\([^=]*\)='`
+    # Reject names that are not valid shell variable names.
+    case $ac_envvar in #(
+      '' | [0-9]* | *[!_$as_cr_alnum]* )
+      as_fn_error $? "invalid variable name: \`$ac_envvar'" ;;
+    esac
+    eval $ac_envvar=\$ac_optarg
+    export $ac_envvar ;;
+
+  *)
+    # FIXME: should be removed in autoconf 3.0.
+    printf "%s\n" "$as_me: WARNING: you should use --build, --host, --target" >&2
+    expr "x$ac_option" : ".*[^-._$as_cr_alnum]" >/dev/null &&
+      printf "%s\n" "$as_me: WARNING: invalid host type: $ac_option" >&2
+    : "${build_alias=$ac_option} ${host_alias=$ac_option} ${target_alias=$ac_option}"
+    ;;
+
+  esac
+done
+
+if test -n "$ac_prev"; then
+  ac_option=--`echo $ac_prev | sed 's/_/-/g'`
+  as_fn_error $? "missing argument to $ac_option"
+fi
+
+if test -n "$ac_unrecognized_opts"; then
+  case $enable_option_checking in
+    no) ;;
+    fatal) as_fn_error $? "unrecognized options: $ac_unrecognized_opts" ;;
+    *)     printf "%s\n" "$as_me: WARNING: unrecognized options: $ac_unrecognized_opts" >&2 ;;
+  esac
+fi
+
+# Check all directory arguments for consistency.
+for ac_var in	exec_prefix prefix bindir sbindir libexecdir datarootdir \
+		datadir sysconfdir sharedstatedir localstatedir includedir \
+		oldincludedir docdir infodir htmldir dvidir pdfdir psdir \
+		libdir localedir mandir runstatedir
+do
+  eval ac_val=\$$ac_var
+  # Remove trailing slashes.
+  case $ac_val in
+    */ )
+      ac_val=`expr "X$ac_val" : 'X\(.*[^/]\)' \| "X$ac_val" : 'X\(.*\)'`
+      eval $ac_var=\$ac_val;;
+  esac
+  # Be sure to have absolute directory names.
+  case $ac_val in
+    [\\/$]* | ?:[\\/]* )  continue;;
+    NONE | '' ) case $ac_var in *prefix ) continue;; esac;;
+  esac
+  as_fn_error $? "expected an absolute directory name for --$ac_var: $ac_val"
+done
+
+# There might be people who depend on the old broken behavior: `$host'
+# used to hold the argument of --host etc.
+# FIXME: To remove some day.
+build=$build_alias
+host=$host_alias
+target=$target_alias
+
+# FIXME: To remove some day.
+if test "x$host_alias" != x; then
+  if test "x$build_alias" = x; then
+    cross_compiling=maybe
+  elif test "x$build_alias" != "x$host_alias"; then
+    cross_compiling=yes
+  fi
+fi
+
+ac_tool_prefix=
+test -n "$host_alias" && ac_tool_prefix=$host_alias-
+
+test "$silent" = yes && exec 6>/dev/null
+
+
+ac_pwd=`pwd` && test -n "$ac_pwd" &&
+ac_ls_di=`ls -di .` &&
+ac_pwd_ls_di=`cd "$ac_pwd" && ls -di .` ||
+  as_fn_error $? "working directory cannot be determined"
+test "X$ac_ls_di" = "X$ac_pwd_ls_di" ||
+  as_fn_error $? "pwd does not report name of working directory"
+
+
+# Find the source files, if location was not specified.
+if test -z "$srcdir"; then
+  ac_srcdir_defaulted=yes
+  # Try the directory containing this script, then the parent directory.
+  ac_confdir=`$as_dirname -- "$as_myself" ||
+$as_expr X"$as_myself" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
+	 X"$as_myself" : 'X\(//\)[^/]' \| \
+	 X"$as_myself" : 'X\(//\)$' \| \
+	 X"$as_myself" : 'X\(/\)' \| . 2>/dev/null ||
+printf "%s\n" X"$as_myself" |
+    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{
+	    s//\1/
+	    q
+	  }
+	  /^X\(\/\/\)[^/].*/{
+	    s//\1/
+	    q
+	  }
+	  /^X\(\/\/\)$/{
+	    s//\1/
+	    q
+	  }
+	  /^X\(\/\).*/{
+	    s//\1/
+	    q
+	  }
+	  s/.*/./; q'`
+  srcdir=$ac_confdir
+  if test ! -r "$srcdir/$ac_unique_file"; then
+    srcdir=..
+  fi
+else
+  ac_srcdir_defaulted=no
+fi
+if test ! -r "$srcdir/$ac_unique_file"; then
+  test "$ac_srcdir_defaulted" = yes && srcdir="$ac_confdir or .."
+  as_fn_error $? "cannot find sources ($ac_unique_file) in $srcdir"
+fi
+ac_msg="sources are in $srcdir, but \`cd $srcdir' does not work"
+ac_abs_confdir=`(
+	cd "$srcdir" && test -r "./$ac_unique_file" || as_fn_error $? "$ac_msg"
+	pwd)`
+# When building in place, set srcdir=.
+if test "$ac_abs_confdir" = "$ac_pwd"; then
+  srcdir=.
+fi
+# Remove unnecessary trailing slashes from srcdir.
+# Double slashes in file names in object file debugging info
+# mess up M-x gdb in Emacs.
+case $srcdir in
+*/) srcdir=`expr "X$srcdir" : 'X\(.*[^/]\)' \| "X$srcdir" : 'X\(.*\)'`;;
+esac
+for ac_var in $ac_precious_vars; do
+  eval ac_env_${ac_var}_set=\${${ac_var}+set}
+  eval ac_env_${ac_var}_value=\$${ac_var}
+  eval ac_cv_env_${ac_var}_set=\${${ac_var}+set}
+  eval ac_cv_env_${ac_var}_value=\$${ac_var}
+done
+
+#
+# Report the --help message.
+#
+if test "$ac_init_help" = "long"; then
+  # Omit some internal or obsolete options to make the list less imposing.
+  # This message is too long to be a string in the A/UX 3.1 sh.
+  cat <<_ACEOF
+\`configure' configures this package to adapt to many kinds of systems.
+
+Usage: $0 [OPTION]... [VAR=VALUE]...
+
+To assign environment variables (e.g., CC, CFLAGS...), specify them as
+VAR=VALUE.  See below for descriptions of some of the useful variables.
+
+Defaults for the options are specified in brackets.
+
+Configuration:
+  -h, --help              display this help and exit
+      --help=short        display options specific to this package
+      --help=recursive    display the short help of all the included packages
+  -V, --version           display version information and exit
+  -q, --quiet, --silent   do not print \`checking ...' messages
+      --cache-file=FILE   cache test results in FILE [disabled]
+  -C, --config-cache      alias for \`--cache-file=config.cache'
+  -n, --no-create         do not create output files
+      --srcdir=DIR        find the sources in DIR [configure dir or \`..']
+
+Installation directories:
+  --prefix=PREFIX         install architecture-independent files in PREFIX
+                          [$ac_default_prefix]
+  --exec-prefix=EPREFIX   install architecture-dependent files in EPREFIX
+                          [PREFIX]
+
+By default, \`make install' will install all the files in
+\`$ac_default_prefix/bin', \`$ac_default_prefix/lib' etc.  You can specify
+an installation prefix other than \`$ac_default_prefix' using \`--prefix',
+for instance \`--prefix=\$HOME'.
+
+For better control, use the options below.
+
+Fine tuning of the installation directories:
+  --bindir=DIR            user executables [EPREFIX/bin]
+  --sbindir=DIR           system admin executables [EPREFIX/sbin]
+  --libexecdir=DIR        program executables [EPREFIX/libexec]
+  --sysconfdir=DIR        read-only single-machine data [PREFIX/etc]
+  --sharedstatedir=DIR    modifiable architecture-independent data [PREFIX/com]
+  --localstatedir=DIR     modifiable single-machine data [PREFIX/var]
+  --runstatedir=DIR       modifiable per-process data [LOCALSTATEDIR/run]
+  --libdir=DIR            object code libraries [EPREFIX/lib]
+  --includedir=DIR        C header files [PREFIX/include]
+  --oldincludedir=DIR     C header files for non-gcc [/usr/include]
+  --datarootdir=DIR       read-only arch.-independent data root [PREFIX/share]
+  --datadir=DIR           read-only architecture-independent data [DATAROOTDIR]
+  --infodir=DIR           info documentation [DATAROOTDIR/info]
+  --localedir=DIR         locale-dependent data [DATAROOTDIR/locale]
+  --mandir=DIR            man documentation [DATAROOTDIR/man]
+  --docdir=DIR            documentation root [DATAROOTDIR/doc/PACKAGE]
+  --htmldir=DIR           html documentation [DOCDIR]
+  --dvidir=DIR            dvi documentation [DOCDIR]
+  --pdfdir=DIR            pdf documentation [DOCDIR]
+  --psdir=DIR             ps documentation [DOCDIR]
+_ACEOF
+
+  cat <<\_ACEOF
+_ACEOF
+fi
+
+if test -n "$ac_init_help"; then
+
+  cat <<\_ACEOF
+
+Optional Packages:
+  --with-PACKAGE[=ARG]    use PACKAGE [ARG=yes]
+  --without-PACKAGE       do not use PACKAGE (same as --with-PACKAGE=no)
+  --without-rlm_kafka     build without Kafka event processing platform
+                          support
+  --with-kafka-include-dir=DIR
+                          Directory where the kafka includes may be found
+  --with-kafka-lib-dir=DIR
+                          Directory where the kafka libraries may be found
+  --with-kafka-dir=DIR    Base directory where kafka is installed
+  --with-openssl-lib-dir=DIR
+                          directory for OpenSSL library files
+  --with-openssl-include-dir=DIR
+                          directory for OpenSSL include files
+
+Some influential environment variables:
+  CC          C compiler command
+  CFLAGS      C compiler flags
+  LDFLAGS     linker flags, e.g. -L<lib dir> if you have libraries in a
+              nonstandard directory <lib dir>
+  LIBS        libraries to pass to the linker, e.g. -l<library>
+  CPPFLAGS    (Objective) C/C++ preprocessor flags, e.g. -I<include dir> if
+              you have headers in a nonstandard directory <include dir>
+  CPP         C preprocessor
+
+Use these variables to override the choices made by `configure' or to help
+it to find libraries and programs with nonstandard names/locations.
+
+Report bugs to the package provider.
+_ACEOF
+ac_status=$?
+fi
+
+if test "$ac_init_help" = "recursive"; then
+  # If there are subdirs, report their specific --help.
+  for ac_dir in : $ac_subdirs_all; do test "x$ac_dir" = x: && continue
+    test -d "$ac_dir" ||
+      { cd "$srcdir" && ac_pwd=`pwd` && srcdir=. && test -d "$ac_dir"; } ||
+      continue
+    ac_builddir=.
+
+case "$ac_dir" in
+.) ac_dir_suffix= ac_top_builddir_sub=. ac_top_build_prefix= ;;
+*)
+  ac_dir_suffix=/`printf "%s\n" "$ac_dir" | sed 's|^\.[\\/]||'`
+  # A ".." for each directory in $ac_dir_suffix.
+  ac_top_builddir_sub=`printf "%s\n" "$ac_dir_suffix" | sed 's|/[^\\/]*|/..|g;s|/||'`
+  case $ac_top_builddir_sub in
+  "") ac_top_builddir_sub=. ac_top_build_prefix= ;;
+  *)  ac_top_build_prefix=$ac_top_builddir_sub/ ;;
+  esac ;;
+esac
+ac_abs_top_builddir=$ac_pwd
+ac_abs_builddir=$ac_pwd$ac_dir_suffix
+# for backward compatibility:
+ac_top_builddir=$ac_top_build_prefix
+
+case $srcdir in
+  .)  # We are building in place.
+    ac_srcdir=.
+    ac_top_srcdir=$ac_top_builddir_sub
+    ac_abs_top_srcdir=$ac_pwd ;;
+  [\\/]* | ?:[\\/]* )  # Absolute name.
+    ac_srcdir=$srcdir$ac_dir_suffix;
+    ac_top_srcdir=$srcdir
+    ac_abs_top_srcdir=$srcdir ;;
+  *) # Relative name.
+    ac_srcdir=$ac_top_build_prefix$srcdir$ac_dir_suffix
+    ac_top_srcdir=$ac_top_build_prefix$srcdir
+    ac_abs_top_srcdir=$ac_pwd/$srcdir ;;
+esac
+ac_abs_srcdir=$ac_abs_top_srcdir$ac_dir_suffix
+
+    cd "$ac_dir" || { ac_status=$?; continue; }
+    # Check for configure.gnu first; this name is used for a wrapper for
+    # Metaconfig's "Configure" on case-insensitive file systems.
+    if test -f "$ac_srcdir/configure.gnu"; then
+      echo &&
+      $SHELL "$ac_srcdir/configure.gnu" --help=recursive
+    elif test -f "$ac_srcdir/configure"; then
+      echo &&
+      $SHELL "$ac_srcdir/configure" --help=recursive
+    else
+      printf "%s\n" "$as_me: WARNING: no configuration information is in $ac_dir" >&2
+    fi || ac_status=$?
+    cd "$ac_pwd" || { ac_status=$?; break; }
+  done
+fi
+
+test -n "$ac_init_help" && exit $ac_status
+if $ac_init_version; then
+  cat <<\_ACEOF
+configure
+generated by GNU Autoconf 2.71
+
+Copyright (C) 2021 Free Software Foundation, Inc.
+This configure script is free software; the Free Software Foundation
+gives unlimited permission to copy, distribute and modify it.
+_ACEOF
+  exit
+fi
+
+## ------------------------ ##
+## Autoconf initialization. ##
+## ------------------------ ##
+
+echo
+echo Running tests for rlm_kafka
+echo
+
+
+# ac_fn_c_try_compile LINENO
+# --------------------------
+# Try to compile conftest.$ac_ext, and return whether this succeeded.
+ac_fn_c_try_compile ()
+{
+  as_lineno=${as_lineno-"$1"} as_lineno_stack=as_lineno_stack=$as_lineno_stack
+  rm -f conftest.$ac_objext conftest.beam
+  if { { ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
+printf "%s\n" "$ac_try_echo"; } >&5
+  (eval "$ac_compile") 2>conftest.err
+  ac_status=$?
+  if test -s conftest.err; then
+    grep -v '^ *+' conftest.err >conftest.er1
+    cat conftest.er1 >&5
+    mv -f conftest.er1 conftest.err
+  fi
+  printf "%s\n" "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
+  test $ac_status = 0; } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext
+then :
+  ac_retval=0
+else $as_nop
+  printf "%s\n" "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+	ac_retval=1
+fi
+  eval $as_lineno_stack; ${as_lineno_stack:+:} unset as_lineno
+  as_fn_set_status $ac_retval
+
+} # ac_fn_c_try_compile
+
+# ac_fn_c_try_cpp LINENO
+# ----------------------
+# Try to preprocess conftest.$ac_ext, and return whether this succeeded.
+ac_fn_c_try_cpp ()
+{
+  as_lineno=${as_lineno-"$1"} as_lineno_stack=as_lineno_stack=$as_lineno_stack
+  if { { ac_try="$ac_cpp conftest.$ac_ext"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
+printf "%s\n" "$ac_try_echo"; } >&5
+  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  ac_status=$?
+  if test -s conftest.err; then
+    grep -v '^ *+' conftest.err >conftest.er1
+    cat conftest.er1 >&5
+    mv -f conftest.er1 conftest.err
+  fi
+  printf "%s\n" "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
+  test $ac_status = 0; } > conftest.i && {
+	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       }
+then :
+  ac_retval=0
+else $as_nop
+  printf "%s\n" "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+    ac_retval=1
+fi
+  eval $as_lineno_stack; ${as_lineno_stack:+:} unset as_lineno
+  as_fn_set_status $ac_retval
+
+} # ac_fn_c_try_cpp
+
+# ac_fn_c_try_link LINENO
+# -----------------------
+# Try to link conftest.$ac_ext, and return whether this succeeded.
+ac_fn_c_try_link ()
+{
+  as_lineno=${as_lineno-"$1"} as_lineno_stack=as_lineno_stack=$as_lineno_stack
+  rm -f conftest.$ac_objext conftest.beam conftest$ac_exeext
+  if { { ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
+printf "%s\n" "$ac_try_echo"; } >&5
+  (eval "$ac_link") 2>conftest.err
+  ac_status=$?
+  if test -s conftest.err; then
+    grep -v '^ *+' conftest.err >conftest.er1
+    cat conftest.er1 >&5
+    mv -f conftest.er1 conftest.err
+  fi
+  printf "%s\n" "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
+  test $ac_status = 0; } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest$ac_exeext && {
+	 test "$cross_compiling" = yes ||
+	 test -x conftest$ac_exeext
+       }
+then :
+  ac_retval=0
+else $as_nop
+  printf "%s\n" "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+	ac_retval=1
+fi
+  # Delete the IPA/IPO (Inter Procedural Analysis/Optimization) information
+  # created by the PGI compiler (conftest_ipa8_conftest.oo), as it would
+  # interfere with the next link command; also delete a directory that is
+  # left behind by Apple's compiler.  We do this before executing the actions.
+  rm -rf conftest.dSYM conftest_ipa8_conftest.oo
+  eval $as_lineno_stack; ${as_lineno_stack:+:} unset as_lineno
+  as_fn_set_status $ac_retval
+
+} # ac_fn_c_try_link
+ac_configure_args_raw=
+for ac_arg
+do
+  case $ac_arg in
+  *\'*)
+    ac_arg=`printf "%s\n" "$ac_arg" | sed "s/'/'\\\\\\\\''/g"` ;;
+  esac
+  as_fn_append ac_configure_args_raw " '$ac_arg'"
+done
+
+case $ac_configure_args_raw in
+  *$as_nl*)
+    ac_safe_unquote= ;;
+  *)
+    ac_unsafe_z='|&;<>()$`\\"*?[ ''	' # This string ends in space, tab.
+    ac_unsafe_a="$ac_unsafe_z#~"
+    ac_safe_unquote="s/ '\\([^$ac_unsafe_a][^$ac_unsafe_z]*\\)'/ \\1/g"
+    ac_configure_args_raw=`      printf "%s\n" "$ac_configure_args_raw" | sed "$ac_safe_unquote"`;;
+esac
+
+cat >config.log <<_ACEOF
+This file contains any messages produced by compilers while
+running configure, to aid debugging if configure makes a mistake.
+
+It was created by $as_me, which was
+generated by GNU Autoconf 2.71.  Invocation command line was
+
+  $ $0$ac_configure_args_raw
+
+_ACEOF
+exec 5>>config.log
+{
+cat <<_ASUNAME
+## --------- ##
+## Platform. ##
+## --------- ##
+
+hostname = `(hostname || uname -n) 2>/dev/null | sed 1q`
+uname -m = `(uname -m) 2>/dev/null || echo unknown`
+uname -r = `(uname -r) 2>/dev/null || echo unknown`
+uname -s = `(uname -s) 2>/dev/null || echo unknown`
+uname -v = `(uname -v) 2>/dev/null || echo unknown`
+
+/usr/bin/uname -p = `(/usr/bin/uname -p) 2>/dev/null || echo unknown`
+/bin/uname -X     = `(/bin/uname -X) 2>/dev/null     || echo unknown`
+
+/bin/arch              = `(/bin/arch) 2>/dev/null              || echo unknown`
+/usr/bin/arch -k       = `(/usr/bin/arch -k) 2>/dev/null       || echo unknown`
+/usr/convex/getsysinfo = `(/usr/convex/getsysinfo) 2>/dev/null || echo unknown`
+/usr/bin/hostinfo      = `(/usr/bin/hostinfo) 2>/dev/null      || echo unknown`
+/bin/machine           = `(/bin/machine) 2>/dev/null           || echo unknown`
+/usr/bin/oslevel       = `(/usr/bin/oslevel) 2>/dev/null       || echo unknown`
+/bin/universe          = `(/bin/universe) 2>/dev/null          || echo unknown`
+
+_ASUNAME
+
+as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH
+do
+  IFS=$as_save_IFS
+  case $as_dir in #(((
+    '') as_dir=./ ;;
+    */) ;;
+    *) as_dir=$as_dir/ ;;
+  esac
+    printf "%s\n" "PATH: $as_dir"
+  done
+IFS=$as_save_IFS
+
+} >&5
+
+cat >&5 <<_ACEOF
+
+
+## ----------- ##
+## Core tests. ##
+## ----------- ##
+
+_ACEOF
+
+
+# Keep a trace of the command line.
+# Strip out --no-create and --no-recursion so they do not pile up.
+# Strip out --silent because we don't want to record it for future runs.
+# Also quote any args containing shell meta-characters.
+# Make two passes to allow for proper duplicate-argument suppression.
+ac_configure_args=
+ac_configure_args0=
+ac_configure_args1=
+ac_must_keep_next=false
+for ac_pass in 1 2
+do
+  for ac_arg
+  do
+    case $ac_arg in
+    -no-create | --no-c* | -n | -no-recursion | --no-r*) continue ;;
+    -q | -quiet | --quiet | --quie | --qui | --qu | --q \
+    | -silent | --silent | --silen | --sile | --sil)
+      continue ;;
+    *\'*)
+      ac_arg=`printf "%s\n" "$ac_arg" | sed "s/'/'\\\\\\\\''/g"` ;;
+    esac
+    case $ac_pass in
+    1) as_fn_append ac_configure_args0 " '$ac_arg'" ;;
+    2)
+      as_fn_append ac_configure_args1 " '$ac_arg'"
+      if test $ac_must_keep_next = true; then
+	ac_must_keep_next=false # Got value, back to normal.
+      else
+	case $ac_arg in
+	  *=* | --config-cache | -C | -disable-* | --disable-* \
+	  | -enable-* | --enable-* | -gas | --g* | -nfp | --nf* \
+	  | -q | -quiet | --q* | -silent | --sil* | -v | -verb* \
+	  | -with-* | --with-* | -without-* | --without-* | --x)
+	    case "$ac_configure_args0 " in
+	      "$ac_configure_args1"*" '$ac_arg' "* ) continue ;;
+	    esac
+	    ;;
+	  -* ) ac_must_keep_next=true ;;
+	esac
+      fi
+      as_fn_append ac_configure_args " '$ac_arg'"
+      ;;
+    esac
+  done
+done
+{ ac_configure_args0=; unset ac_configure_args0;}
+{ ac_configure_args1=; unset ac_configure_args1;}
+
+# When interrupted or exit'd, cleanup temporary files, and complete
+# config.log.  We remove comments because anyway the quotes in there
+# would cause problems or look ugly.
+# WARNING: Use '\'' to represent an apostrophe within the trap.
+# WARNING: Do not start the trap code with a newline, due to a FreeBSD 4.0 bug.
+trap 'exit_status=$?
+  # Sanitize IFS.
+  IFS=" ""	$as_nl"
+  # Save into config.log some information that might help in debugging.
+  {
+    echo
+
+    printf "%s\n" "## ---------------- ##
+## Cache variables. ##
+## ---------------- ##"
+    echo
+    # The following way of writing the cache mishandles newlines in values,
+(
+  for ac_var in `(set) 2>&1 | sed -n '\''s/^\([a-zA-Z_][a-zA-Z0-9_]*\)=.*/\1/p'\''`; do
+    eval ac_val=\$$ac_var
+    case $ac_val in #(
+    *${as_nl}*)
+      case $ac_var in #(
+      *_cv_*) { printf "%s\n" "$as_me:${as_lineno-$LINENO}: WARNING: cache variable $ac_var contains a newline" >&5
+printf "%s\n" "$as_me: WARNING: cache variable $ac_var contains a newline" >&2;} ;;
+      esac
+      case $ac_var in #(
+      _ | IFS | as_nl) ;; #(
+      BASH_ARGV | BASH_SOURCE) eval $ac_var= ;; #(
+      *) { eval $ac_var=; unset $ac_var;} ;;
+      esac ;;
+    esac
+  done
+  (set) 2>&1 |
+    case $as_nl`(ac_space='\'' '\''; set) 2>&1` in #(
+    *${as_nl}ac_space=\ *)
+      sed -n \
+	"s/'\''/'\''\\\\'\'''\''/g;
+	  s/^\\([_$as_cr_alnum]*_cv_[_$as_cr_alnum]*\\)=\\(.*\\)/\\1='\''\\2'\''/p"
+      ;; #(
+    *)
+      sed -n "/^[_$as_cr_alnum]*_cv_[_$as_cr_alnum]*=/p"
+      ;;
+    esac |
+    sort
+)
+    echo
+
+    printf "%s\n" "## ----------------- ##
+## Output variables. ##
+## ----------------- ##"
+    echo
+    for ac_var in $ac_subst_vars
+    do
+      eval ac_val=\$$ac_var
+      case $ac_val in
+      *\'\''*) ac_val=`printf "%s\n" "$ac_val" | sed "s/'\''/'\''\\\\\\\\'\'''\''/g"`;;
+      esac
+      printf "%s\n" "$ac_var='\''$ac_val'\''"
+    done | sort
+    echo
+
+    if test -n "$ac_subst_files"; then
+      printf "%s\n" "## ------------------- ##
+## File substitutions. ##
+## ------------------- ##"
+      echo
+      for ac_var in $ac_subst_files
+      do
+	eval ac_val=\$$ac_var
+	case $ac_val in
+	*\'\''*) ac_val=`printf "%s\n" "$ac_val" | sed "s/'\''/'\''\\\\\\\\'\'''\''/g"`;;
+	esac
+	printf "%s\n" "$ac_var='\''$ac_val'\''"
+      done | sort
+      echo
+    fi
+
+    if test -s confdefs.h; then
+      printf "%s\n" "## ----------- ##
+## confdefs.h. ##
+## ----------- ##"
+      echo
+      cat confdefs.h
+      echo
+    fi
+    test "$ac_signal" != 0 &&
+      printf "%s\n" "$as_me: caught signal $ac_signal"
+    printf "%s\n" "$as_me: exit $exit_status"
+  } >&5
+  rm -f core *.core core.conftest.* &&
+    rm -f -r conftest* confdefs* conf$$* $ac_clean_files &&
+    exit $exit_status
+' 0
+for ac_signal in 1 2 13 15; do
+  trap 'ac_signal='$ac_signal'; as_fn_exit 1' $ac_signal
+done
+ac_signal=0
+
+# confdefs.h avoids OS command line length limits that DEFS can exceed.
+rm -f -r conftest* confdefs.h
+
+printf "%s\n" "/* confdefs.h */" > confdefs.h
+
+# Predefined preprocessor variables.
+
+printf "%s\n" "#define PACKAGE_NAME \"$PACKAGE_NAME\"" >>confdefs.h
+
+printf "%s\n" "#define PACKAGE_TARNAME \"$PACKAGE_TARNAME\"" >>confdefs.h
+
+printf "%s\n" "#define PACKAGE_VERSION \"$PACKAGE_VERSION\"" >>confdefs.h
+
+printf "%s\n" "#define PACKAGE_STRING \"$PACKAGE_STRING\"" >>confdefs.h
+
+printf "%s\n" "#define PACKAGE_BUGREPORT \"$PACKAGE_BUGREPORT\"" >>confdefs.h
+
+printf "%s\n" "#define PACKAGE_URL \"$PACKAGE_URL\"" >>confdefs.h
+
+
+# Let the site file select an alternate cache file if it wants to.
+# Prefer an explicitly selected file to automatically selected ones.
+if test -n "$CONFIG_SITE"; then
+  ac_site_files="$CONFIG_SITE"
+elif test "x$prefix" != xNONE; then
+  ac_site_files="$prefix/share/config.site $prefix/etc/config.site"
+else
+  ac_site_files="$ac_default_prefix/share/config.site $ac_default_prefix/etc/config.site"
+fi
+
+for ac_site_file in $ac_site_files
+do
+  case $ac_site_file in #(
+  */*) :
+     ;; #(
+  *) :
+    ac_site_file=./$ac_site_file ;;
+esac
+  if test -f "$ac_site_file" && test -r "$ac_site_file"; then
+    { printf "%s\n" "$as_me:${as_lineno-$LINENO}: loading site script $ac_site_file" >&5
+printf "%s\n" "$as_me: loading site script $ac_site_file" >&6;}
+    sed 's/^/| /' "$ac_site_file" >&5
+    . "$ac_site_file" \
+      || { { printf "%s\n" "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
+printf "%s\n" "$as_me: error: in \`$ac_pwd':" >&2;}
+as_fn_error $? "failed to load site script $ac_site_file
+See \`config.log' for more details" "$LINENO" 5; }
+  fi
+done
+
+if test -r "$cache_file"; then
+  # Some versions of bash will fail to source /dev/null (special files
+  # actually), so we avoid doing that.  DJGPP emulates it as a regular file.
+  if test /dev/null != "$cache_file" && test -f "$cache_file"; then
+    { printf "%s\n" "$as_me:${as_lineno-$LINENO}: loading cache $cache_file" >&5
+printf "%s\n" "$as_me: loading cache $cache_file" >&6;}
+    case $cache_file in
+      [\\/]* | ?:[\\/]* ) . "$cache_file";;
+      *)                      . "./$cache_file";;
+    esac
+  fi
+else
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: creating cache $cache_file" >&5
+printf "%s\n" "$as_me: creating cache $cache_file" >&6;}
+  >$cache_file
+fi
+
+# Test code for whether the C compiler supports C89 (global declarations)
+ac_c_conftest_c89_globals='
+/* Does the compiler advertise C89 conformance?
+   Do not test the value of __STDC__, because some compilers set it to 0
+   while being otherwise adequately conformant. */
+#if !defined __STDC__
+# error "Compiler does not advertise C89 conformance"
+#endif
+
+#include <stddef.h>
+#include <stdarg.h>
+struct stat;
+/* Most of the following tests are stolen from RCS 5.7 src/conf.sh.  */
+struct buf { int x; };
+struct buf * (*rcsopen) (struct buf *, struct stat *, int);
+static char *e (p, i)
+     char **p;
+     int i;
+{
+  return p[i];
+}
+static char *f (char * (*g) (char **, int), char **p, ...)
+{
+  char *s;
+  va_list v;
+  va_start (v,p);
+  s = g (p, va_arg (v,int));
+  va_end (v);
+  return s;
+}
+
+/* OSF 4.0 Compaq cc is some sort of almost-ANSI by default.  It has
+   function prototypes and stuff, but not \xHH hex character constants.
+   These do not provoke an error unfortunately, instead are silently treated
+   as an "x".  The following induces an error, until -std is added to get
+   proper ANSI mode.  Curiously \x00 != x always comes out true, for an
+   array size at least.  It is necessary to write \x00 == 0 to get something
+   that is true only with -std.  */
+int osf4_cc_array ['\''\x00'\'' == 0 ? 1 : -1];
+
+/* IBM C 6 for AIX is almost-ANSI by default, but it replaces macro parameters
+   inside strings and character constants.  */
+#define FOO(x) '\''x'\''
+int xlc6_cc_array[FOO(a) == '\''x'\'' ? 1 : -1];
+
+int test (int i, double x);
+struct s1 {int (*f) (int a);};
+struct s2 {int (*f) (double a);};
+int pairnames (int, char **, int *(*)(struct buf *, struct stat *, int),
+               int, int);'
+
+# Test code for whether the C compiler supports C89 (body of main).
+ac_c_conftest_c89_main='
+ok |= (argc == 0 || f (e, argv, 0) != argv[0] || f (e, argv, 1) != argv[1]);
+'
+
+# Test code for whether the C compiler supports C99 (global declarations)
+ac_c_conftest_c99_globals='
+// Does the compiler advertise C99 conformance?
+#if !defined __STDC_VERSION__ || __STDC_VERSION__ < 199901L
+# error "Compiler does not advertise C99 conformance"
+#endif
+
+#include <stdbool.h>
+extern int puts (const char *);
+extern int printf (const char *, ...);
+extern int dprintf (int, const char *, ...);
+extern void *malloc (size_t);
+
+// Check varargs macros.  These examples are taken from C99 6.10.3.5.
+// dprintf is used instead of fprintf to avoid needing to declare
+// FILE and stderr.
+#define debug(...) dprintf (2, __VA_ARGS__)
+#define showlist(...) puts (#__VA_ARGS__)
+#define report(test,...) ((test) ? puts (#test) : printf (__VA_ARGS__))
+static void
+test_varargs_macros (void)
+{
+  int x = 1234;
+  int y = 5678;
+  debug ("Flag");
+  debug ("X = %d\n", x);
+  showlist (The first, second, and third items.);
+  report (x>y, "x is %d but y is %d", x, y);
+}
+
+// Check long long types.
+#define BIG64 18446744073709551615ull
+#define BIG32 4294967295ul
+#define BIG_OK (BIG64 / BIG32 == 4294967297ull && BIG64 % BIG32 == 0)
+#if !BIG_OK
+  #error "your preprocessor is broken"
+#endif
+#if BIG_OK
+#else
+  #error "your preprocessor is broken"
+#endif
+static long long int bignum = -9223372036854775807LL;
+static unsigned long long int ubignum = BIG64;
+
+struct incomplete_array
+{
+  int datasize;
+  double data[];
+};
+
+struct named_init {
+  int number;
+  const wchar_t *name;
+  double average;
+};
+
+typedef const char *ccp;
+
+static inline int
+test_restrict (ccp restrict text)
+{
+  // See if C++-style comments work.
+  // Iterate through items via the restricted pointer.
+  // Also check for declarations in for loops.
+  for (unsigned int i = 0; *(text+i) != '\''\0'\''; ++i)
+    continue;
+  return 0;
+}
+
+// Check varargs and va_copy.
+static bool
+test_varargs (const char *format, ...)
+{
+  va_list args;
+  va_start (args, format);
+  va_list args_copy;
+  va_copy (args_copy, args);
+
+  const char *str = "";
+  int number = 0;
+  float fnumber = 0;
+
+  while (*format)
+    {
+      switch (*format++)
+	{
+	case '\''s'\'': // string
+	  str = va_arg (args_copy, const char *);
+	  break;
+	case '\''d'\'': // int
+	  number = va_arg (args_copy, int);
+	  break;
+	case '\''f'\'': // float
+	  fnumber = va_arg (args_copy, double);
+	  break;
+	default:
+	  break;
+	}
+    }
+  va_end (args_copy);
+  va_end (args);
+
+  return *str && number && fnumber;
+}
+'
+
+# Test code for whether the C compiler supports C99 (body of main).
+ac_c_conftest_c99_main='
+  // Check bool.
+  _Bool success = false;
+  success |= (argc != 0);
+
+  // Check restrict.
+  if (test_restrict ("String literal") == 0)
+    success = true;
+  char *restrict newvar = "Another string";
+
+  // Check varargs.
+  success &= test_varargs ("s, d'\'' f .", "string", 65, 34.234);
+  test_varargs_macros ();
+
+  // Check flexible array members.
+  struct incomplete_array *ia =
+    malloc (sizeof (struct incomplete_array) + (sizeof (double) * 10));
+  ia->datasize = 10;
+  for (int i = 0; i < ia->datasize; ++i)
+    ia->data[i] = i * 1.234;
+
+  // Check named initializers.
+  struct named_init ni = {
+    .number = 34,
+    .name = L"Test wide string",
+    .average = 543.34343,
+  };
+
+  ni.number = 58;
+
+  int dynamic_array[ni.number];
+  dynamic_array[0] = argv[0][0];
+  dynamic_array[ni.number - 1] = 543;
+
+  // work around unused variable warnings
+  ok |= (!success || bignum == 0LL || ubignum == 0uLL || newvar[0] == '\''x'\''
+	 || dynamic_array[ni.number - 1] != 543);
+'
+
+# Test code for whether the C compiler supports C11 (global declarations)
+ac_c_conftest_c11_globals='
+// Does the compiler advertise C11 conformance?
+#if !defined __STDC_VERSION__ || __STDC_VERSION__ < 201112L
+# error "Compiler does not advertise C11 conformance"
+#endif
+
+// Check _Alignas.
+char _Alignas (double) aligned_as_double;
+char _Alignas (0) no_special_alignment;
+extern char aligned_as_int;
+char _Alignas (0) _Alignas (int) aligned_as_int;
+
+// Check _Alignof.
+enum
+{
+  int_alignment = _Alignof (int),
+  int_array_alignment = _Alignof (int[100]),
+  char_alignment = _Alignof (char)
+};
+_Static_assert (0 < -_Alignof (int), "_Alignof is signed");
+
+// Check _Noreturn.
+int _Noreturn does_not_return (void) { for (;;) continue; }
+
+// Check _Static_assert.
+struct test_static_assert
+{
+  int x;
+  _Static_assert (sizeof (int) <= sizeof (long int),
+                  "_Static_assert does not work in struct");
+  long int y;
+};
+
+// Check UTF-8 literals.
+#define u8 syntax error!
+char const utf8_literal[] = u8"happens to be ASCII" "another string";
+
+// Check duplicate typedefs.
+typedef long *long_ptr;
+typedef long int *long_ptr;
+typedef long_ptr long_ptr;
+
+// Anonymous structures and unions -- taken from C11 6.7.2.1 Example 1.
+struct anonymous
+{
+  union {
+    struct { int i; int j; };
+    struct { int k; long int l; } w;
+  };
+  int m;
+} v1;
+'
+
+# Test code for whether the C compiler supports C11 (body of main).
+ac_c_conftest_c11_main='
+  _Static_assert ((offsetof (struct anonymous, i)
+		   == offsetof (struct anonymous, w.k)),
+		  "Anonymous union alignment botch");
+  v1.i = 2;
+  v1.w.k = 5;
+  ok |= v1.i != 5;
+'
+
+# Test code for whether the C compiler supports C11 (complete).
+ac_c_conftest_c11_program="${ac_c_conftest_c89_globals}
+${ac_c_conftest_c99_globals}
+${ac_c_conftest_c11_globals}
+
+int
+main (int argc, char **argv)
+{
+  int ok = 0;
+  ${ac_c_conftest_c89_main}
+  ${ac_c_conftest_c99_main}
+  ${ac_c_conftest_c11_main}
+  return ok;
+}
+"
+
+# Test code for whether the C compiler supports C99 (complete).
+ac_c_conftest_c99_program="${ac_c_conftest_c89_globals}
+${ac_c_conftest_c99_globals}
+
+int
+main (int argc, char **argv)
+{
+  int ok = 0;
+  ${ac_c_conftest_c89_main}
+  ${ac_c_conftest_c99_main}
+  return ok;
+}
+"
+
+# Test code for whether the C compiler supports C89 (complete).
+ac_c_conftest_c89_program="${ac_c_conftest_c89_globals}
+
+int
+main (int argc, char **argv)
+{
+  int ok = 0;
+  ${ac_c_conftest_c89_main}
+  return ok;
+}
+"
+
+# Check that the precious variables saved in the cache have kept the same
+# value.
+ac_cache_corrupted=false
+for ac_var in $ac_precious_vars; do
+  eval ac_old_set=\$ac_cv_env_${ac_var}_set
+  eval ac_new_set=\$ac_env_${ac_var}_set
+  eval ac_old_val=\$ac_cv_env_${ac_var}_value
+  eval ac_new_val=\$ac_env_${ac_var}_value
+  case $ac_old_set,$ac_new_set in
+    set,)
+      { printf "%s\n" "$as_me:${as_lineno-$LINENO}: error: \`$ac_var' was set to \`$ac_old_val' in the previous run" >&5
+printf "%s\n" "$as_me: error: \`$ac_var' was set to \`$ac_old_val' in the previous run" >&2;}
+      ac_cache_corrupted=: ;;
+    ,set)
+      { printf "%s\n" "$as_me:${as_lineno-$LINENO}: error: \`$ac_var' was not set in the previous run" >&5
+printf "%s\n" "$as_me: error: \`$ac_var' was not set in the previous run" >&2;}
+      ac_cache_corrupted=: ;;
+    ,);;
+    *)
+      if test "x$ac_old_val" != "x$ac_new_val"; then
+	# differences in whitespace do not lead to failure.
+	ac_old_val_w=`echo x $ac_old_val`
+	ac_new_val_w=`echo x $ac_new_val`
+	if test "$ac_old_val_w" != "$ac_new_val_w"; then
+	  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: error: \`$ac_var' has changed since the previous run:" >&5
+printf "%s\n" "$as_me: error: \`$ac_var' has changed since the previous run:" >&2;}
+	  ac_cache_corrupted=:
+	else
+	  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: warning: ignoring whitespace changes in \`$ac_var' since the previous run:" >&5
+printf "%s\n" "$as_me: warning: ignoring whitespace changes in \`$ac_var' since the previous run:" >&2;}
+	  eval $ac_var=\$ac_old_val
+	fi
+	{ printf "%s\n" "$as_me:${as_lineno-$LINENO}:   former value:  \`$ac_old_val'" >&5
+printf "%s\n" "$as_me:   former value:  \`$ac_old_val'" >&2;}
+	{ printf "%s\n" "$as_me:${as_lineno-$LINENO}:   current value: \`$ac_new_val'" >&5
+printf "%s\n" "$as_me:   current value: \`$ac_new_val'" >&2;}
+      fi;;
+  esac
+  # Pass precious variables to config.status.
+  if test "$ac_new_set" = set; then
+    case $ac_new_val in
+    *\'*) ac_arg=$ac_var=`printf "%s\n" "$ac_new_val" | sed "s/'/'\\\\\\\\''/g"` ;;
+    *) ac_arg=$ac_var=$ac_new_val ;;
+    esac
+    case " $ac_configure_args " in
+      *" '$ac_arg' "*) ;; # Avoid dups.  Use of quotes ensures accuracy.
+      *) as_fn_append ac_configure_args " '$ac_arg'" ;;
+    esac
+  fi
+done
+if $ac_cache_corrupted; then
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
+printf "%s\n" "$as_me: error: in \`$ac_pwd':" >&2;}
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: error: changes in the environment can compromise the build" >&5
+printf "%s\n" "$as_me: error: changes in the environment can compromise the build" >&2;}
+  as_fn_error $? "run \`${MAKE-make} distclean' and/or \`rm $cache_file'
+	    and start over" "$LINENO" 5
+fi
+## -------------------- ##
+## Main body of script. ##
+## -------------------- ##
+
+ac_ext=c
+ac_cpp='$CPP $CPPFLAGS'
+ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
+ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
+ac_compiler_gnu=$ac_cv_c_compiler_gnu
+
+
+
+
+
+
+
+
+
+# Check whether --with-rlm_kafka was given.
+if test ${with_rlm_kafka+y}
+then :
+  withval=$with_rlm_kafka;
+fi
+
+
+
+SMART_LIBS=
+SMART_CLFAGS=
+
+
+fail=
+fr_status=
+fr_features=
+: > "config.report"
+: > "config.report.tmp"
+
+
+
+if test x"$with_rlm_kafka" != xno; then
+
+
+
+kafka_include_dir=
+
+# Check whether --with-kafka-include-dir was given.
+if test ${with_kafka_include_dir+y}
+then :
+  withval=$with_kafka_include_dir; case "$withval" in
+	no)
+		as_fn_error $? "Need kafka-include-dir" "$LINENO" 5
+		;;
+	yes)
+		;;
+	*)
+		kafka_include_dir="$withval"
+		;;
+	esac
+fi
+
+
+kafka_lib_dir=
+
+# Check whether --with-kafka-lib-dir was given.
+if test ${with_kafka_lib_dir+y}
+then :
+  withval=$with_kafka_lib_dir; case "$withval" in
+	no)
+		as_fn_error $? "Need kafka-lib-dir" "$LINENO" 5
+		;;
+	yes)
+		;;
+	*)
+		kafka_lib_dir="$withval"
+		;;
+	esac
+fi
+
+
+
+# Check whether --with-kafka-dir was given.
+if test ${with_kafka_dir+y}
+then :
+  withval=$with_kafka_dir; case "$withval" in
+	no)
+		as_fn_error $? "Need kafka-dir" "$LINENO" 5
+		;;
+	yes)
+		;;
+	*)
+		kafka_lib_dir="$withval/lib"
+		kafka_include_dir="$withval/include"
+		;;
+	esac
+fi
+
+
+openssl_lib_dir=
+
+# Check whether --with-openssl-lib-dir was given.
+if test ${with_openssl_lib_dir+y}
+then :
+  withval=$with_openssl_lib_dir; case "$withval" in
+	no)
+		as_fn_error $? "Need openssl-lib-dir" "$LINENO" 5
+		;;
+	yes)
+		;;
+	*)
+		openssl_lib_dir="$withval"
+		;;
+	esac
+fi
+
+
+openssl_include_dir=
+
+# Check whether --with-openssl-include-dir was given.
+if test ${with_openssl_include_dir+y}
+then :
+  withval=$with_openssl_include_dir; case "$withval" in
+	no)
+		as_fn_error $? "Need openssl-include-dir" "$LINENO" 5
+		;;
+	yes)
+		;;
+	*)
+		openssl_include_dir="$withval"
+		;;
+	esac
+fi
+
+
+
+
+
+
+
+
+
+
+
+
+ac_ext=c
+ac_cpp='$CPP $CPPFLAGS'
+ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
+ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
+ac_compiler_gnu=$ac_cv_c_compiler_gnu
+if test -n "$ac_tool_prefix"; then
+  # Extract the first word of "${ac_tool_prefix}gcc", so it can be a program name with args.
+set dummy ${ac_tool_prefix}gcc; ac_word=$2
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for $ac_word" >&5
+printf %s "checking for $ac_word... " >&6; }
+if test ${ac_cv_prog_CC+y}
+then :
+  printf %s "(cached) " >&6
+else $as_nop
+  if test -n "$CC"; then
+  ac_cv_prog_CC="$CC" # Let the user override the test.
+else
+as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH
+do
+  IFS=$as_save_IFS
+  case $as_dir in #(((
+    '') as_dir=./ ;;
+    */) ;;
+    *) as_dir=$as_dir/ ;;
+  esac
+    for ac_exec_ext in '' $ac_executable_extensions; do
+  if as_fn_executable_p "$as_dir$ac_word$ac_exec_ext"; then
+    ac_cv_prog_CC="${ac_tool_prefix}gcc"
+    printf "%s\n" "$as_me:${as_lineno-$LINENO}: found $as_dir$ac_word$ac_exec_ext" >&5
+    break 2
+  fi
+done
+  done
+IFS=$as_save_IFS
+
+fi
+fi
+CC=$ac_cv_prog_CC
+if test -n "$CC"; then
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $CC" >&5
+printf "%s\n" "$CC" >&6; }
+else
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: no" >&5
+printf "%s\n" "no" >&6; }
+fi
+
+
+fi
+if test -z "$ac_cv_prog_CC"; then
+  ac_ct_CC=$CC
+  # Extract the first word of "gcc", so it can be a program name with args.
+set dummy gcc; ac_word=$2
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for $ac_word" >&5
+printf %s "checking for $ac_word... " >&6; }
+if test ${ac_cv_prog_ac_ct_CC+y}
+then :
+  printf %s "(cached) " >&6
+else $as_nop
+  if test -n "$ac_ct_CC"; then
+  ac_cv_prog_ac_ct_CC="$ac_ct_CC" # Let the user override the test.
+else
+as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH
+do
+  IFS=$as_save_IFS
+  case $as_dir in #(((
+    '') as_dir=./ ;;
+    */) ;;
+    *) as_dir=$as_dir/ ;;
+  esac
+    for ac_exec_ext in '' $ac_executable_extensions; do
+  if as_fn_executable_p "$as_dir$ac_word$ac_exec_ext"; then
+    ac_cv_prog_ac_ct_CC="gcc"
+    printf "%s\n" "$as_me:${as_lineno-$LINENO}: found $as_dir$ac_word$ac_exec_ext" >&5
+    break 2
+  fi
+done
+  done
+IFS=$as_save_IFS
+
+fi
+fi
+ac_ct_CC=$ac_cv_prog_ac_ct_CC
+if test -n "$ac_ct_CC"; then
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_ct_CC" >&5
+printf "%s\n" "$ac_ct_CC" >&6; }
+else
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: no" >&5
+printf "%s\n" "no" >&6; }
+fi
+
+  if test "x$ac_ct_CC" = x; then
+    CC=""
+  else
+    case $cross_compiling:$ac_tool_warned in
+yes:)
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: WARNING: using cross tools not prefixed with host triplet" >&5
+printf "%s\n" "$as_me: WARNING: using cross tools not prefixed with host triplet" >&2;}
+ac_tool_warned=yes ;;
+esac
+    CC=$ac_ct_CC
+  fi
+else
+  CC="$ac_cv_prog_CC"
+fi
+
+if test -z "$CC"; then
+          if test -n "$ac_tool_prefix"; then
+    # Extract the first word of "${ac_tool_prefix}cc", so it can be a program name with args.
+set dummy ${ac_tool_prefix}cc; ac_word=$2
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for $ac_word" >&5
+printf %s "checking for $ac_word... " >&6; }
+if test ${ac_cv_prog_CC+y}
+then :
+  printf %s "(cached) " >&6
+else $as_nop
+  if test -n "$CC"; then
+  ac_cv_prog_CC="$CC" # Let the user override the test.
+else
+as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH
+do
+  IFS=$as_save_IFS
+  case $as_dir in #(((
+    '') as_dir=./ ;;
+    */) ;;
+    *) as_dir=$as_dir/ ;;
+  esac
+    for ac_exec_ext in '' $ac_executable_extensions; do
+  if as_fn_executable_p "$as_dir$ac_word$ac_exec_ext"; then
+    ac_cv_prog_CC="${ac_tool_prefix}cc"
+    printf "%s\n" "$as_me:${as_lineno-$LINENO}: found $as_dir$ac_word$ac_exec_ext" >&5
+    break 2
+  fi
+done
+  done
+IFS=$as_save_IFS
+
+fi
+fi
+CC=$ac_cv_prog_CC
+if test -n "$CC"; then
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $CC" >&5
+printf "%s\n" "$CC" >&6; }
+else
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: no" >&5
+printf "%s\n" "no" >&6; }
+fi
+
+
+  fi
+fi
+if test -z "$CC"; then
+  # Extract the first word of "cc", so it can be a program name with args.
+set dummy cc; ac_word=$2
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for $ac_word" >&5
+printf %s "checking for $ac_word... " >&6; }
+if test ${ac_cv_prog_CC+y}
+then :
+  printf %s "(cached) " >&6
+else $as_nop
+  if test -n "$CC"; then
+  ac_cv_prog_CC="$CC" # Let the user override the test.
+else
+  ac_prog_rejected=no
+as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH
+do
+  IFS=$as_save_IFS
+  case $as_dir in #(((
+    '') as_dir=./ ;;
+    */) ;;
+    *) as_dir=$as_dir/ ;;
+  esac
+    for ac_exec_ext in '' $ac_executable_extensions; do
+  if as_fn_executable_p "$as_dir$ac_word$ac_exec_ext"; then
+    if test "$as_dir$ac_word$ac_exec_ext" = "/usr/ucb/cc"; then
+       ac_prog_rejected=yes
+       continue
+     fi
+    ac_cv_prog_CC="cc"
+    printf "%s\n" "$as_me:${as_lineno-$LINENO}: found $as_dir$ac_word$ac_exec_ext" >&5
+    break 2
+  fi
+done
+  done
+IFS=$as_save_IFS
+
+if test $ac_prog_rejected = yes; then
+  # We found a bogon in the path, so make sure we never use it.
+  set dummy $ac_cv_prog_CC
+  shift
+  if test $# != 0; then
+    # We chose a different compiler from the bogus one.
+    # However, it has the same basename, so the bogon will be chosen
+    # first if we set CC to just the basename; use the full file name.
+    shift
+    ac_cv_prog_CC="$as_dir$ac_word${1+' '}$@"
+  fi
+fi
+fi
+fi
+CC=$ac_cv_prog_CC
+if test -n "$CC"; then
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $CC" >&5
+printf "%s\n" "$CC" >&6; }
+else
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: no" >&5
+printf "%s\n" "no" >&6; }
+fi
+
+
+fi
+if test -z "$CC"; then
+  if test -n "$ac_tool_prefix"; then
+  for ac_prog in cl.exe
+  do
+    # Extract the first word of "$ac_tool_prefix$ac_prog", so it can be a program name with args.
+set dummy $ac_tool_prefix$ac_prog; ac_word=$2
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for $ac_word" >&5
+printf %s "checking for $ac_word... " >&6; }
+if test ${ac_cv_prog_CC+y}
+then :
+  printf %s "(cached) " >&6
+else $as_nop
+  if test -n "$CC"; then
+  ac_cv_prog_CC="$CC" # Let the user override the test.
+else
+as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH
+do
+  IFS=$as_save_IFS
+  case $as_dir in #(((
+    '') as_dir=./ ;;
+    */) ;;
+    *) as_dir=$as_dir/ ;;
+  esac
+    for ac_exec_ext in '' $ac_executable_extensions; do
+  if as_fn_executable_p "$as_dir$ac_word$ac_exec_ext"; then
+    ac_cv_prog_CC="$ac_tool_prefix$ac_prog"
+    printf "%s\n" "$as_me:${as_lineno-$LINENO}: found $as_dir$ac_word$ac_exec_ext" >&5
+    break 2
+  fi
+done
+  done
+IFS=$as_save_IFS
+
+fi
+fi
+CC=$ac_cv_prog_CC
+if test -n "$CC"; then
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $CC" >&5
+printf "%s\n" "$CC" >&6; }
+else
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: no" >&5
+printf "%s\n" "no" >&6; }
+fi
+
+
+    test -n "$CC" && break
+  done
+fi
+if test -z "$CC"; then
+  ac_ct_CC=$CC
+  for ac_prog in cl.exe
+do
+  # Extract the first word of "$ac_prog", so it can be a program name with args.
+set dummy $ac_prog; ac_word=$2
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for $ac_word" >&5
+printf %s "checking for $ac_word... " >&6; }
+if test ${ac_cv_prog_ac_ct_CC+y}
+then :
+  printf %s "(cached) " >&6
+else $as_nop
+  if test -n "$ac_ct_CC"; then
+  ac_cv_prog_ac_ct_CC="$ac_ct_CC" # Let the user override the test.
+else
+as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH
+do
+  IFS=$as_save_IFS
+  case $as_dir in #(((
+    '') as_dir=./ ;;
+    */) ;;
+    *) as_dir=$as_dir/ ;;
+  esac
+    for ac_exec_ext in '' $ac_executable_extensions; do
+  if as_fn_executable_p "$as_dir$ac_word$ac_exec_ext"; then
+    ac_cv_prog_ac_ct_CC="$ac_prog"
+    printf "%s\n" "$as_me:${as_lineno-$LINENO}: found $as_dir$ac_word$ac_exec_ext" >&5
+    break 2
+  fi
+done
+  done
+IFS=$as_save_IFS
+
+fi
+fi
+ac_ct_CC=$ac_cv_prog_ac_ct_CC
+if test -n "$ac_ct_CC"; then
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_ct_CC" >&5
+printf "%s\n" "$ac_ct_CC" >&6; }
+else
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: no" >&5
+printf "%s\n" "no" >&6; }
+fi
+
+
+  test -n "$ac_ct_CC" && break
+done
+
+  if test "x$ac_ct_CC" = x; then
+    CC=""
+  else
+    case $cross_compiling:$ac_tool_warned in
+yes:)
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: WARNING: using cross tools not prefixed with host triplet" >&5
+printf "%s\n" "$as_me: WARNING: using cross tools not prefixed with host triplet" >&2;}
+ac_tool_warned=yes ;;
+esac
+    CC=$ac_ct_CC
+  fi
+fi
+
+fi
+if test -z "$CC"; then
+  if test -n "$ac_tool_prefix"; then
+  # Extract the first word of "${ac_tool_prefix}clang", so it can be a program name with args.
+set dummy ${ac_tool_prefix}clang; ac_word=$2
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for $ac_word" >&5
+printf %s "checking for $ac_word... " >&6; }
+if test ${ac_cv_prog_CC+y}
+then :
+  printf %s "(cached) " >&6
+else $as_nop
+  if test -n "$CC"; then
+  ac_cv_prog_CC="$CC" # Let the user override the test.
+else
+as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH
+do
+  IFS=$as_save_IFS
+  case $as_dir in #(((
+    '') as_dir=./ ;;
+    */) ;;
+    *) as_dir=$as_dir/ ;;
+  esac
+    for ac_exec_ext in '' $ac_executable_extensions; do
+  if as_fn_executable_p "$as_dir$ac_word$ac_exec_ext"; then
+    ac_cv_prog_CC="${ac_tool_prefix}clang"
+    printf "%s\n" "$as_me:${as_lineno-$LINENO}: found $as_dir$ac_word$ac_exec_ext" >&5
+    break 2
+  fi
+done
+  done
+IFS=$as_save_IFS
+
+fi
+fi
+CC=$ac_cv_prog_CC
+if test -n "$CC"; then
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $CC" >&5
+printf "%s\n" "$CC" >&6; }
+else
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: no" >&5
+printf "%s\n" "no" >&6; }
+fi
+
+
+fi
+if test -z "$ac_cv_prog_CC"; then
+  ac_ct_CC=$CC
+  # Extract the first word of "clang", so it can be a program name with args.
+set dummy clang; ac_word=$2
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for $ac_word" >&5
+printf %s "checking for $ac_word... " >&6; }
+if test ${ac_cv_prog_ac_ct_CC+y}
+then :
+  printf %s "(cached) " >&6
+else $as_nop
+  if test -n "$ac_ct_CC"; then
+  ac_cv_prog_ac_ct_CC="$ac_ct_CC" # Let the user override the test.
+else
+as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH
+do
+  IFS=$as_save_IFS
+  case $as_dir in #(((
+    '') as_dir=./ ;;
+    */) ;;
+    *) as_dir=$as_dir/ ;;
+  esac
+    for ac_exec_ext in '' $ac_executable_extensions; do
+  if as_fn_executable_p "$as_dir$ac_word$ac_exec_ext"; then
+    ac_cv_prog_ac_ct_CC="clang"
+    printf "%s\n" "$as_me:${as_lineno-$LINENO}: found $as_dir$ac_word$ac_exec_ext" >&5
+    break 2
+  fi
+done
+  done
+IFS=$as_save_IFS
+
+fi
+fi
+ac_ct_CC=$ac_cv_prog_ac_ct_CC
+if test -n "$ac_ct_CC"; then
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_ct_CC" >&5
+printf "%s\n" "$ac_ct_CC" >&6; }
+else
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: no" >&5
+printf "%s\n" "no" >&6; }
+fi
+
+  if test "x$ac_ct_CC" = x; then
+    CC=""
+  else
+    case $cross_compiling:$ac_tool_warned in
+yes:)
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: WARNING: using cross tools not prefixed with host triplet" >&5
+printf "%s\n" "$as_me: WARNING: using cross tools not prefixed with host triplet" >&2;}
+ac_tool_warned=yes ;;
+esac
+    CC=$ac_ct_CC
+  fi
+else
+  CC="$ac_cv_prog_CC"
+fi
+
+fi
+
+
+test -z "$CC" && { { printf "%s\n" "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
+printf "%s\n" "$as_me: error: in \`$ac_pwd':" >&2;}
+as_fn_error $? "no acceptable C compiler found in \$PATH
+See \`config.log' for more details" "$LINENO" 5; }
+
+# Provide some information about the compiler.
+printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for C compiler version" >&5
+set X $ac_compile
+ac_compiler=$2
+for ac_option in --version -v -V -qversion -version; do
+  { { ac_try="$ac_compiler $ac_option >&5"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
+printf "%s\n" "$ac_try_echo"; } >&5
+  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  ac_status=$?
+  if test -s conftest.err; then
+    sed '10a\
+... rest of stderr output deleted ...
+         10q' conftest.err >conftest.er1
+    cat conftest.er1 >&5
+  fi
+  rm -f conftest.er1 conftest.err
+  printf "%s\n" "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
+  test $ac_status = 0; }
+done
+
+cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+
+int
+main (void)
+{
+
+  ;
+  return 0;
+}
+_ACEOF
+ac_clean_files_save=$ac_clean_files
+ac_clean_files="$ac_clean_files a.out a.out.dSYM a.exe b.out"
+# Try to create an executable without -o first, disregard a.out.
+# It will help us diagnose broken compilers, and finding out an intuition
+# of exeext.
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether the C compiler works" >&5
+printf %s "checking whether the C compiler works... " >&6; }
+ac_link_default=`printf "%s\n" "$ac_link" | sed 's/ -o *conftest[^ ]*//'`
+
+# The possible output files:
+ac_files="a.out conftest.exe conftest a.exe a_out.exe b.out conftest.*"
+
+ac_rmfiles=
+for ac_file in $ac_files
+do
+  case $ac_file in
+    *.$ac_ext | *.xcoff | *.tds | *.d | *.pdb | *.xSYM | *.bb | *.bbg | *.map | *.inf | *.dSYM | *.o | *.obj ) ;;
+    * ) ac_rmfiles="$ac_rmfiles $ac_file";;
+  esac
+done
+rm -f $ac_rmfiles
+
+if { { ac_try="$ac_link_default"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
+printf "%s\n" "$ac_try_echo"; } >&5
+  (eval "$ac_link_default") 2>&5
+  ac_status=$?
+  printf "%s\n" "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
+  test $ac_status = 0; }
+then :
+  # Autoconf-2.13 could set the ac_cv_exeext variable to `no'.
+# So ignore a value of `no', otherwise this would lead to `EXEEXT = no'
+# in a Makefile.  We should not override ac_cv_exeext if it was cached,
+# so that the user can short-circuit this test for compilers unknown to
+# Autoconf.
+for ac_file in $ac_files ''
+do
+  test -f "$ac_file" || continue
+  case $ac_file in
+    *.$ac_ext | *.xcoff | *.tds | *.d | *.pdb | *.xSYM | *.bb | *.bbg | *.map | *.inf | *.dSYM | *.o | *.obj )
+	;;
+    [ab].out )
+	# We found the default executable, but exeext='' is most
+	# certainly right.
+	break;;
+    *.* )
+	if test ${ac_cv_exeext+y} && test "$ac_cv_exeext" != no;
+	then :; else
+	   ac_cv_exeext=`expr "$ac_file" : '[^.]*\(\..*\)'`
+	fi
+	# We set ac_cv_exeext here because the later test for it is not
+	# safe: cross compilers may not add the suffix if given an `-o'
+	# argument, so we may need to know it at that point already.
+	# Even if this section looks crufty: it has the advantage of
+	# actually working.
+	break;;
+    * )
+	break;;
+  esac
+done
+test "$ac_cv_exeext" = no && ac_cv_exeext=
+
+else $as_nop
+  ac_file=''
+fi
+if test -z "$ac_file"
+then :
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: no" >&5
+printf "%s\n" "no" >&6; }
+printf "%s\n" "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+{ { printf "%s\n" "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
+printf "%s\n" "$as_me: error: in \`$ac_pwd':" >&2;}
+as_fn_error 77 "C compiler cannot create executables
+See \`config.log' for more details" "$LINENO" 5; }
+else $as_nop
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: yes" >&5
+printf "%s\n" "yes" >&6; }
+fi
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for C compiler default output file name" >&5
+printf %s "checking for C compiler default output file name... " >&6; }
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_file" >&5
+printf "%s\n" "$ac_file" >&6; }
+ac_exeext=$ac_cv_exeext
+
+rm -f -r a.out a.out.dSYM a.exe conftest$ac_cv_exeext b.out
+ac_clean_files=$ac_clean_files_save
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for suffix of executables" >&5
+printf %s "checking for suffix of executables... " >&6; }
+if { { ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
+printf "%s\n" "$ac_try_echo"; } >&5
+  (eval "$ac_link") 2>&5
+  ac_status=$?
+  printf "%s\n" "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
+  test $ac_status = 0; }
+then :
+  # If both `conftest.exe' and `conftest' are `present' (well, observable)
+# catch `conftest.exe'.  For instance with Cygwin, `ls conftest' will
+# work properly (i.e., refer to `conftest.exe'), while it won't with
+# `rm'.
+for ac_file in conftest.exe conftest conftest.*; do
+  test -f "$ac_file" || continue
+  case $ac_file in
+    *.$ac_ext | *.xcoff | *.tds | *.d | *.pdb | *.xSYM | *.bb | *.bbg | *.map | *.inf | *.dSYM | *.o | *.obj ) ;;
+    *.* ) ac_cv_exeext=`expr "$ac_file" : '[^.]*\(\..*\)'`
+	  break;;
+    * ) break;;
+  esac
+done
+else $as_nop
+  { { printf "%s\n" "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
+printf "%s\n" "$as_me: error: in \`$ac_pwd':" >&2;}
+as_fn_error $? "cannot compute suffix of executables: cannot compile and link
+See \`config.log' for more details" "$LINENO" 5; }
+fi
+rm -f conftest conftest$ac_cv_exeext
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_exeext" >&5
+printf "%s\n" "$ac_cv_exeext" >&6; }
+
+rm -f conftest.$ac_ext
+EXEEXT=$ac_cv_exeext
+ac_exeext=$EXEEXT
+cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+#include <stdio.h>
+int
+main (void)
+{
+FILE *f = fopen ("conftest.out", "w");
+ return ferror (f) || fclose (f) != 0;
+
+  ;
+  return 0;
+}
+_ACEOF
+ac_clean_files="$ac_clean_files conftest.out"
+# Check that the compiler produces executables we can run.  If not, either
+# the compiler is broken, or we cross compile.
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether we are cross compiling" >&5
+printf %s "checking whether we are cross compiling... " >&6; }
+if test "$cross_compiling" != yes; then
+  { { ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
+printf "%s\n" "$ac_try_echo"; } >&5
+  (eval "$ac_link") 2>&5
+  ac_status=$?
+  printf "%s\n" "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
+  test $ac_status = 0; }
+  if { ac_try='./conftest$ac_cv_exeext'
+  { { case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
+printf "%s\n" "$ac_try_echo"; } >&5
+  (eval "$ac_try") 2>&5
+  ac_status=$?
+  printf "%s\n" "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
+  test $ac_status = 0; }; }; then
+    cross_compiling=no
+  else
+    if test "$cross_compiling" = maybe; then
+	cross_compiling=yes
+    else
+	{ { printf "%s\n" "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
+printf "%s\n" "$as_me: error: in \`$ac_pwd':" >&2;}
+as_fn_error 77 "cannot run C compiled programs.
+If you meant to cross compile, use \`--host'.
+See \`config.log' for more details" "$LINENO" 5; }
+    fi
+  fi
+fi
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $cross_compiling" >&5
+printf "%s\n" "$cross_compiling" >&6; }
+
+rm -f conftest.$ac_ext conftest$ac_cv_exeext conftest.out
+ac_clean_files=$ac_clean_files_save
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for suffix of object files" >&5
+printf %s "checking for suffix of object files... " >&6; }
+if test ${ac_cv_objext+y}
+then :
+  printf %s "(cached) " >&6
+else $as_nop
+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+
+int
+main (void)
+{
+
+  ;
+  return 0;
+}
+_ACEOF
+rm -f conftest.o conftest.obj
+if { { ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
+printf "%s\n" "$ac_try_echo"; } >&5
+  (eval "$ac_compile") 2>&5
+  ac_status=$?
+  printf "%s\n" "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
+  test $ac_status = 0; }
+then :
+  for ac_file in conftest.o conftest.obj conftest.*; do
+  test -f "$ac_file" || continue;
+  case $ac_file in
+    *.$ac_ext | *.xcoff | *.tds | *.d | *.pdb | *.xSYM | *.bb | *.bbg | *.map | *.inf | *.dSYM ) ;;
+    *) ac_cv_objext=`expr "$ac_file" : '.*\.\(.*\)'`
+       break;;
+  esac
+done
+else $as_nop
+  printf "%s\n" "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+{ { printf "%s\n" "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
+printf "%s\n" "$as_me: error: in \`$ac_pwd':" >&2;}
+as_fn_error $? "cannot compute suffix of object files: cannot compile
+See \`config.log' for more details" "$LINENO" 5; }
+fi
+rm -f conftest.$ac_cv_objext conftest.$ac_ext
+fi
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_objext" >&5
+printf "%s\n" "$ac_cv_objext" >&6; }
+OBJEXT=$ac_cv_objext
+ac_objext=$OBJEXT
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether the compiler supports GNU C" >&5
+printf %s "checking whether the compiler supports GNU C... " >&6; }
+if test ${ac_cv_c_compiler_gnu+y}
+then :
+  printf %s "(cached) " >&6
+else $as_nop
+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+
+int
+main (void)
+{
+#ifndef __GNUC__
+       choke me
+#endif
+
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_compile "$LINENO"
+then :
+  ac_compiler_gnu=yes
+else $as_nop
+  ac_compiler_gnu=no
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
+ac_cv_c_compiler_gnu=$ac_compiler_gnu
+
+fi
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_c_compiler_gnu" >&5
+printf "%s\n" "$ac_cv_c_compiler_gnu" >&6; }
+ac_compiler_gnu=$ac_cv_c_compiler_gnu
+
+if test $ac_compiler_gnu = yes; then
+  GCC=yes
+else
+  GCC=
+fi
+ac_test_CFLAGS=${CFLAGS+y}
+ac_save_CFLAGS=$CFLAGS
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking whether $CC accepts -g" >&5
+printf %s "checking whether $CC accepts -g... " >&6; }
+if test ${ac_cv_prog_cc_g+y}
+then :
+  printf %s "(cached) " >&6
+else $as_nop
+  ac_save_c_werror_flag=$ac_c_werror_flag
+   ac_c_werror_flag=yes
+   ac_cv_prog_cc_g=no
+   CFLAGS="-g"
+   cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+
+int
+main (void)
+{
+
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_compile "$LINENO"
+then :
+  ac_cv_prog_cc_g=yes
+else $as_nop
+  CFLAGS=""
+      cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+
+int
+main (void)
+{
+
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_compile "$LINENO"
+then :
+
+else $as_nop
+  ac_c_werror_flag=$ac_save_c_werror_flag
+	 CFLAGS="-g"
+	 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+
+int
+main (void)
+{
+
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_compile "$LINENO"
+then :
+  ac_cv_prog_cc_g=yes
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
+   ac_c_werror_flag=$ac_save_c_werror_flag
+fi
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_prog_cc_g" >&5
+printf "%s\n" "$ac_cv_prog_cc_g" >&6; }
+if test $ac_test_CFLAGS; then
+  CFLAGS=$ac_save_CFLAGS
+elif test $ac_cv_prog_cc_g = yes; then
+  if test "$GCC" = yes; then
+    CFLAGS="-g -O2"
+  else
+    CFLAGS="-g"
+  fi
+else
+  if test "$GCC" = yes; then
+    CFLAGS="-O2"
+  else
+    CFLAGS=
+  fi
+fi
+ac_prog_cc_stdc=no
+if test x$ac_prog_cc_stdc = xno
+then :
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for $CC option to enable C11 features" >&5
+printf %s "checking for $CC option to enable C11 features... " >&6; }
+if test ${ac_cv_prog_cc_c11+y}
+then :
+  printf %s "(cached) " >&6
+else $as_nop
+  ac_cv_prog_cc_c11=no
+ac_save_CC=$CC
+cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+$ac_c_conftest_c11_program
+_ACEOF
+for ac_arg in '' -std=gnu11
+do
+  CC="$ac_save_CC $ac_arg"
+  if ac_fn_c_try_compile "$LINENO"
+then :
+  ac_cv_prog_cc_c11=$ac_arg
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.beam
+  test "x$ac_cv_prog_cc_c11" != "xno" && break
+done
+rm -f conftest.$ac_ext
+CC=$ac_save_CC
+fi
+
+if test "x$ac_cv_prog_cc_c11" = xno
+then :
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: unsupported" >&5
+printf "%s\n" "unsupported" >&6; }
+else $as_nop
+  if test "x$ac_cv_prog_cc_c11" = x
+then :
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: none needed" >&5
+printf "%s\n" "none needed" >&6; }
+else $as_nop
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_prog_cc_c11" >&5
+printf "%s\n" "$ac_cv_prog_cc_c11" >&6; }
+     CC="$CC $ac_cv_prog_cc_c11"
+fi
+  ac_cv_prog_cc_stdc=$ac_cv_prog_cc_c11
+  ac_prog_cc_stdc=c11
+fi
+fi
+if test x$ac_prog_cc_stdc = xno
+then :
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for $CC option to enable C99 features" >&5
+printf %s "checking for $CC option to enable C99 features... " >&6; }
+if test ${ac_cv_prog_cc_c99+y}
+then :
+  printf %s "(cached) " >&6
+else $as_nop
+  ac_cv_prog_cc_c99=no
+ac_save_CC=$CC
+cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+$ac_c_conftest_c99_program
+_ACEOF
+for ac_arg in '' -std=gnu99 -std=c99 -c99 -qlanglvl=extc1x -qlanglvl=extc99 -AC99 -D_STDC_C99=
+do
+  CC="$ac_save_CC $ac_arg"
+  if ac_fn_c_try_compile "$LINENO"
+then :
+  ac_cv_prog_cc_c99=$ac_arg
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.beam
+  test "x$ac_cv_prog_cc_c99" != "xno" && break
+done
+rm -f conftest.$ac_ext
+CC=$ac_save_CC
+fi
+
+if test "x$ac_cv_prog_cc_c99" = xno
+then :
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: unsupported" >&5
+printf "%s\n" "unsupported" >&6; }
+else $as_nop
+  if test "x$ac_cv_prog_cc_c99" = x
+then :
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: none needed" >&5
+printf "%s\n" "none needed" >&6; }
+else $as_nop
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_prog_cc_c99" >&5
+printf "%s\n" "$ac_cv_prog_cc_c99" >&6; }
+     CC="$CC $ac_cv_prog_cc_c99"
+fi
+  ac_cv_prog_cc_stdc=$ac_cv_prog_cc_c99
+  ac_prog_cc_stdc=c99
+fi
+fi
+if test x$ac_prog_cc_stdc = xno
+then :
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for $CC option to enable C89 features" >&5
+printf %s "checking for $CC option to enable C89 features... " >&6; }
+if test ${ac_cv_prog_cc_c89+y}
+then :
+  printf %s "(cached) " >&6
+else $as_nop
+  ac_cv_prog_cc_c89=no
+ac_save_CC=$CC
+cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+$ac_c_conftest_c89_program
+_ACEOF
+for ac_arg in '' -qlanglvl=extc89 -qlanglvl=ansi -std -Ae "-Aa -D_HPUX_SOURCE" "-Xc -D__EXTENSIONS__"
+do
+  CC="$ac_save_CC $ac_arg"
+  if ac_fn_c_try_compile "$LINENO"
+then :
+  ac_cv_prog_cc_c89=$ac_arg
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.beam
+  test "x$ac_cv_prog_cc_c89" != "xno" && break
+done
+rm -f conftest.$ac_ext
+CC=$ac_save_CC
+fi
+
+if test "x$ac_cv_prog_cc_c89" = xno
+then :
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: unsupported" >&5
+printf "%s\n" "unsupported" >&6; }
+else $as_nop
+  if test "x$ac_cv_prog_cc_c89" = x
+then :
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: none needed" >&5
+printf "%s\n" "none needed" >&6; }
+else $as_nop
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_prog_cc_c89" >&5
+printf "%s\n" "$ac_cv_prog_cc_c89" >&6; }
+     CC="$CC $ac_cv_prog_cc_c89"
+fi
+  ac_cv_prog_cc_stdc=$ac_cv_prog_cc_c89
+  ac_prog_cc_stdc=c89
+fi
+fi
+
+ac_ext=c
+ac_cpp='$CPP $CPPFLAGS'
+ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
+ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
+ac_compiler_gnu=$ac_cv_c_compiler_gnu
+
+
+
+smart_try_dir="${kafka_include_dir}"
+
+
+
+ac_safe=`echo "librdkafka/rdkafka.h" | sed 'y%./+-%__pm%'`
+old_CPPFLAGS="$CPPFLAGS"
+smart_include=
+smart_include_dir="/usr/local/include /opt/include"
+
+_smart_try_dir=
+_smart_include_dir=
+
+for _prefix in $smart_prefix ""; do
+  for _dir in $smart_try_dir; do
+    _smart_try_dir="${_smart_try_dir} ${_dir}/${_prefix}"
+  done
+
+  for _dir in $smart_include_dir; do
+    _smart_include_dir="${_smart_include_dir} ${_dir}/${_prefix}"
+  done
+done
+
+if test "x$_smart_try_dir" != "x"; then
+  for try in $_smart_try_dir; do
+    { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for librdkafka/rdkafka.h in $try" >&5
+printf %s "checking for librdkafka/rdkafka.h in $try... " >&6; }
+    CPPFLAGS="-isystem $try $old_CPPFLAGS"
+    cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+
+		    #include <librdkafka/rdkafka.h>
+int
+main (void)
+{
+int a = 1;
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_compile "$LINENO"
+then :
+
+		     smart_include="-isystem $try"
+		     { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: yes" >&5
+printf "%s\n" "yes" >&6; }
+		     break
+
+else $as_nop
+
+		     smart_include=
+		     { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: no" >&5
+printf "%s\n" "no" >&6; }
+
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
+  done
+  CPPFLAGS="$old_CPPFLAGS"
+fi
+
+if test "x$smart_include" = "x"; then
+  for _prefix in $smart_prefix; do
+    { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for ${_prefix}/librdkafka/rdkafka.h" >&5
+printf %s "checking for ${_prefix}/librdkafka/rdkafka.h... " >&6; }
+
+    cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+
+		    #include <librdkafka/rdkafka.h>
+int
+main (void)
+{
+int a = 1;
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_compile "$LINENO"
+then :
+
+		     smart_include="-isystem ${_prefix}/"
+		     { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: yes" >&5
+printf "%s\n" "yes" >&6; }
+		     break
+
+else $as_nop
+
+		     smart_include=
+		     { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: no" >&5
+printf "%s\n" "no" >&6; }
+
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
+  done
+fi
+
+if test "x$smart_include" = "x"; then
+    { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for librdkafka/rdkafka.h" >&5
+printf %s "checking for librdkafka/rdkafka.h... " >&6; }
+
+    cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+
+		    #include <librdkafka/rdkafka.h>
+int
+main (void)
+{
+int a = 1;
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_compile "$LINENO"
+then :
+
+		     smart_include=" "
+		     { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: yes" >&5
+printf "%s\n" "yes" >&6; }
+		     break
+
+else $as_nop
+
+		     smart_include=
+		     { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: no" >&5
+printf "%s\n" "no" >&6; }
+
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
+fi
+
+if test "x$smart_include" = "x"; then
+
+  for try in $_smart_include_dir; do
+    { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for librdkafka/rdkafka.h in $try" >&5
+printf %s "checking for librdkafka/rdkafka.h in $try... " >&6; }
+    CPPFLAGS="-isystem $try $old_CPPFLAGS"
+    cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+
+		    #include <librdkafka/rdkafka.h>
+int
+main (void)
+{
+int a = 1;
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_compile "$LINENO"
+then :
+
+		     smart_include="-isystem $try"
+		     { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: yes" >&5
+printf "%s\n" "yes" >&6; }
+		     break
+
+else $as_nop
+
+		     smart_include=
+		     { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: no" >&5
+printf "%s\n" "no" >&6; }
+
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.beam conftest.$ac_ext
+  done
+  CPPFLAGS="$old_CPPFLAGS"
+fi
+
+if test "x$smart_include" != "x"; then
+  eval "ac_cv_header_$ac_safe=yes"
+  CPPFLAGS="$smart_include $old_CPPFLAGS"
+  SMART_CPPFLAGS="$smart_include $SMART_CPPFLAGS"
+fi
+
+smart_prefix=
+
+if test "x$ac_cv_header_librdkafka_rdkafka_h" != "xyes"; then
+	{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: WARNING: kafka headers not found. Use --with-kafka-include-dir=<path>." >&5
+printf "%s\n" "$as_me: WARNING: kafka headers not found. Use --with-kafka-include-dir=<path>." >&2;}
+
+fail="$fail rdkafka.h"
+
+fi
+
+ac_ext=c
+ac_cpp='$CPP $CPPFLAGS'
+ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
+ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
+ac_compiler_gnu=$ac_cv_c_compiler_gnu
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking how to run the C preprocessor" >&5
+printf %s "checking how to run the C preprocessor... " >&6; }
+# On Suns, sometimes $CPP names a directory.
+if test -n "$CPP" && test -d "$CPP"; then
+  CPP=
+fi
+if test -z "$CPP"; then
+  if test ${ac_cv_prog_CPP+y}
+then :
+  printf %s "(cached) " >&6
+else $as_nop
+      # Double quotes because $CC needs to be expanded
+    for CPP in "$CC -E" "$CC -E -traditional-cpp" cpp /lib/cpp
+    do
+      ac_preproc_ok=false
+for ac_c_preproc_warn_flag in '' yes
+do
+  # Use a header file that comes with gcc, so configuring glibc
+  # with a fresh cross-compiler works.
+  # On the NeXT, cc -E runs the code through the compiler's parser,
+  # not just through cpp. "Syntax error" is here to catch this case.
+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+#include <limits.h>
+		     Syntax error
+_ACEOF
+if ac_fn_c_try_cpp "$LINENO"
+then :
+
+else $as_nop
+  # Broken: fails on valid input.
+continue
+fi
+rm -f conftest.err conftest.i conftest.$ac_ext
+
+  # OK, works on sane cases.  Now check whether nonexistent headers
+  # can be detected and how.
+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+#include <ac_nonexistent.h>
+_ACEOF
+if ac_fn_c_try_cpp "$LINENO"
+then :
+  # Broken: success on invalid input.
+continue
+else $as_nop
+  # Passes both tests.
+ac_preproc_ok=:
+break
+fi
+rm -f conftest.err conftest.i conftest.$ac_ext
+
+done
+# Because of `break', _AC_PREPROC_IFELSE's cleaning code was skipped.
+rm -f conftest.i conftest.err conftest.$ac_ext
+if $ac_preproc_ok
+then :
+  break
+fi
+
+    done
+    ac_cv_prog_CPP=$CPP
+
+fi
+  CPP=$ac_cv_prog_CPP
+else
+  ac_cv_prog_CPP=$CPP
+fi
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $CPP" >&5
+printf "%s\n" "$CPP" >&6; }
+ac_preproc_ok=false
+for ac_c_preproc_warn_flag in '' yes
+do
+  # Use a header file that comes with gcc, so configuring glibc
+  # with a fresh cross-compiler works.
+  # On the NeXT, cc -E runs the code through the compiler's parser,
+  # not just through cpp. "Syntax error" is here to catch this case.
+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+#include <limits.h>
+		     Syntax error
+_ACEOF
+if ac_fn_c_try_cpp "$LINENO"
+then :
+
+else $as_nop
+  # Broken: fails on valid input.
+continue
+fi
+rm -f conftest.err conftest.i conftest.$ac_ext
+
+  # OK, works on sane cases.  Now check whether nonexistent headers
+  # can be detected and how.
+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+#include <ac_nonexistent.h>
+_ACEOF
+if ac_fn_c_try_cpp "$LINENO"
+then :
+  # Broken: success on invalid input.
+continue
+else $as_nop
+  # Passes both tests.
+ac_preproc_ok=:
+break
+fi
+rm -f conftest.err conftest.i conftest.$ac_ext
+
+done
+# Because of `break', _AC_PREPROC_IFELSE's cleaning code was skipped.
+rm -f conftest.i conftest.err conftest.$ac_ext
+if $ac_preproc_ok
+then :
+
+else $as_nop
+  { { printf "%s\n" "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
+printf "%s\n" "$as_me: error: in \`$ac_pwd':" >&2;}
+as_fn_error $? "C preprocessor \"$CPP\" fails sanity check
+See \`config.log' for more details" "$LINENO" 5; }
+fi
+
+ac_ext=c
+ac_cpp='$CPP $CPPFLAGS'
+ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
+ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
+ac_compiler_gnu=$ac_cv_c_compiler_gnu
+
+
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for grep that handles long lines and -e" >&5
+printf %s "checking for grep that handles long lines and -e... " >&6; }
+if test ${ac_cv_path_GREP+y}
+then :
+  printf %s "(cached) " >&6
+else $as_nop
+  if test -z "$GREP"; then
+  ac_path_GREP_found=false
+  # Loop through the user's path and test for each of PROGNAME-LIST
+  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH$PATH_SEPARATOR/usr/xpg4/bin
+do
+  IFS=$as_save_IFS
+  case $as_dir in #(((
+    '') as_dir=./ ;;
+    */) ;;
+    *) as_dir=$as_dir/ ;;
+  esac
+    for ac_prog in grep ggrep
+   do
+    for ac_exec_ext in '' $ac_executable_extensions; do
+      ac_path_GREP="$as_dir$ac_prog$ac_exec_ext"
+      as_fn_executable_p "$ac_path_GREP" || continue
+# Check for GNU ac_path_GREP and select it if it is found.
+  # Check for GNU $ac_path_GREP
+case `"$ac_path_GREP" --version 2>&1` in
+*GNU*)
+  ac_cv_path_GREP="$ac_path_GREP" ac_path_GREP_found=:;;
+*)
+  ac_count=0
+  printf %s 0123456789 >"conftest.in"
+  while :
+  do
+    cat "conftest.in" "conftest.in" >"conftest.tmp"
+    mv "conftest.tmp" "conftest.in"
+    cp "conftest.in" "conftest.nl"
+    printf "%s\n" 'GREP' >> "conftest.nl"
+    "$ac_path_GREP" -e 'GREP$' -e '-(cannot match)-' < "conftest.nl" >"conftest.out" 2>/dev/null || break
+    diff "conftest.out" "conftest.nl" >/dev/null 2>&1 || break
+    as_fn_arith $ac_count + 1 && ac_count=$as_val
+    if test $ac_count -gt ${ac_path_GREP_max-0}; then
+      # Best one so far, save it but keep looking for a better one
+      ac_cv_path_GREP="$ac_path_GREP"
+      ac_path_GREP_max=$ac_count
+    fi
+    # 10*(2^10) chars as input seems more than enough
+    test $ac_count -gt 10 && break
+  done
+  rm -f conftest.in conftest.tmp conftest.nl conftest.out;;
+esac
+
+      $ac_path_GREP_found && break 3
+    done
+  done
+  done
+IFS=$as_save_IFS
+  if test -z "$ac_cv_path_GREP"; then
+    as_fn_error $? "no acceptable grep could be found in $PATH$PATH_SEPARATOR/usr/xpg4/bin" "$LINENO" 5
+  fi
+else
+  ac_cv_path_GREP=$GREP
+fi
+
+fi
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_path_GREP" >&5
+printf "%s\n" "$ac_cv_path_GREP" >&6; }
+ GREP="$ac_cv_path_GREP"
+
+
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for egrep" >&5
+printf %s "checking for egrep... " >&6; }
+if test ${ac_cv_path_EGREP+y}
+then :
+  printf %s "(cached) " >&6
+else $as_nop
+  if echo a | $GREP -E '(a|b)' >/dev/null 2>&1
+   then ac_cv_path_EGREP="$GREP -E"
+   else
+     if test -z "$EGREP"; then
+  ac_path_EGREP_found=false
+  # Loop through the user's path and test for each of PROGNAME-LIST
+  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH$PATH_SEPARATOR/usr/xpg4/bin
+do
+  IFS=$as_save_IFS
+  case $as_dir in #(((
+    '') as_dir=./ ;;
+    */) ;;
+    *) as_dir=$as_dir/ ;;
+  esac
+    for ac_prog in egrep
+   do
+    for ac_exec_ext in '' $ac_executable_extensions; do
+      ac_path_EGREP="$as_dir$ac_prog$ac_exec_ext"
+      as_fn_executable_p "$ac_path_EGREP" || continue
+# Check for GNU ac_path_EGREP and select it if it is found.
+  # Check for GNU $ac_path_EGREP
+case `"$ac_path_EGREP" --version 2>&1` in
+*GNU*)
+  ac_cv_path_EGREP="$ac_path_EGREP" ac_path_EGREP_found=:;;
+*)
+  ac_count=0
+  printf %s 0123456789 >"conftest.in"
+  while :
+  do
+    cat "conftest.in" "conftest.in" >"conftest.tmp"
+    mv "conftest.tmp" "conftest.in"
+    cp "conftest.in" "conftest.nl"
+    printf "%s\n" 'EGREP' >> "conftest.nl"
+    "$ac_path_EGREP" 'EGREP$' < "conftest.nl" >"conftest.out" 2>/dev/null || break
+    diff "conftest.out" "conftest.nl" >/dev/null 2>&1 || break
+    as_fn_arith $ac_count + 1 && ac_count=$as_val
+    if test $ac_count -gt ${ac_path_EGREP_max-0}; then
+      # Best one so far, save it but keep looking for a better one
+      ac_cv_path_EGREP="$ac_path_EGREP"
+      ac_path_EGREP_max=$ac_count
+    fi
+    # 10*(2^10) chars as input seems more than enough
+    test $ac_count -gt 10 && break
+  done
+  rm -f conftest.in conftest.tmp conftest.nl conftest.out;;
+esac
+
+      $ac_path_EGREP_found && break 3
+    done
+  done
+  done
+IFS=$as_save_IFS
+  if test -z "$ac_cv_path_EGREP"; then
+    as_fn_error $? "no acceptable egrep could be found in $PATH$PATH_SEPARATOR/usr/xpg4/bin" "$LINENO" 5
+  fi
+else
+  ac_cv_path_EGREP=$EGREP
+fi
+
+   fi
+fi
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $ac_cv_path_EGREP" >&5
+printf "%s\n" "$ac_cv_path_EGREP" >&6; }
+ EGREP="$ac_cv_path_EGREP"
+
+
+cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+#include <openssl/crypto.h>
+		#if (OPENSSL_VERSION_NUMBER >= 0x10100000L)
+		yes
+		#endif
+
+_ACEOF
+if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+  $EGREP "yes" >/dev/null 2>&1
+then :
+
+		{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for OpenSSL version >= 1.1.0" >&5
+printf %s "checking for OpenSSL version >= 1.1.0... " >&6; }
+		{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: yes" >&5
+printf "%s\n" "yes" >&6; }
+
+else $as_nop
+
+		{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for OpenSSL version >= 1.1.0" >&5
+printf %s "checking for OpenSSL version >= 1.1.0... " >&6; }
+		{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: no" >&5
+printf "%s\n" "no" >&6; }
+
+fail="$fail OpenSSL>=1.1.0"
+
+
+
+fi
+rm -rf conftest*
+
+
+
+smart_try_dir="$kafka_lib_dir"
+
+
+sm_lib_safe=`echo "rdkafka" | sed 'y%./+-%__p_%'`
+sm_func_safe=`echo "rd_kafka_new" | sed 'y%./+-%__p_%'`
+
+old_LIBS="$LIBS"
+old_CPPFLAGS="$CPPFLAGS"
+smart_lib=
+smart_ldflags=
+smart_lib_dir=
+
+if test "x$smart_try_dir" != "x"; then
+  for try in $smart_try_dir; do
+    { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for rd_kafka_new in -lrdkafka in $try" >&5
+printf %s "checking for rd_kafka_new in -lrdkafka in $try... " >&6; }
+    LIBS="-lrdkafka $old_LIBS"
+    CPPFLAGS="-L$try -Wl,-rpath,$try $old_CPPFLAGS"
+    cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+extern char rd_kafka_new();
+int
+main (void)
+{
+rd_kafka_new()
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_link "$LINENO"
+then :
+
+		 smart_lib="-lrdkafka"
+		 smart_ldflags="-L$try -Wl,-rpath,$try"
+		 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: yes" >&5
+printf "%s\n" "yes" >&6; }
+		 break
+
+else $as_nop
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: no" >&5
+printf "%s\n" "no" >&6; }
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.beam \
+    conftest$ac_exeext conftest.$ac_ext
+  done
+  LIBS="$old_LIBS"
+  CPPFLAGS="$old_CPPFLAGS"
+fi
+
+if test "x$smart_lib" = "x"; then
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for rd_kafka_new in -lrdkafka" >&5
+printf %s "checking for rd_kafka_new in -lrdkafka... " >&6; }
+  LIBS="-lrdkafka $old_LIBS"
+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+extern char rd_kafka_new();
+int
+main (void)
+{
+rd_kafka_new()
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_link "$LINENO"
+then :
+
+	        smart_lib="-lrdkafka"
+	        { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: yes" >&5
+printf "%s\n" "yes" >&6; }
+
+else $as_nop
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: no" >&5
+printf "%s\n" "no" >&6; }
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.beam \
+    conftest$ac_exeext conftest.$ac_ext
+  LIBS="$old_LIBS"
+fi
+
+if test "x$smart_lib" = "x"; then
+  for try in /usr/local/lib /opt/lib; do
+    { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for rd_kafka_new in -lrdkafka in $try" >&5
+printf %s "checking for rd_kafka_new in -lrdkafka in $try... " >&6; }
+    LIBS="-lrdkafka $old_LIBS"
+    CPPFLAGS="-L$try -Wl,-rpath,$try $old_CPPFLAGS"
+    cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+extern char rd_kafka_new();
+int
+main (void)
+{
+rd_kafka_new()
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_link "$LINENO"
+then :
+
+		  smart_lib="-lrdkafka"
+		  smart_ldflags="-L$try -Wl,-rpath,$try"
+		  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: yes" >&5
+printf "%s\n" "yes" >&6; }
+		  break
+
+else $as_nop
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: no" >&5
+printf "%s\n" "no" >&6; }
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.beam \
+    conftest$ac_exeext conftest.$ac_ext
+  done
+  LIBS="$old_LIBS"
+  CPPFLAGS="$old_CPPFLAGS"
+fi
+
+if test "x$smart_lib" != "x"; then
+  eval "ac_cv_lib_${sm_lib_safe}_${sm_func_safe}=yes"
+  LIBS="$smart_ldflags $smart_lib $old_LIBS"
+  SMART_LIBS="$smart_ldflags $smart_lib $SMART_LIBS"
+fi
+
+if test "x$ac_cv_lib_rdkafka_rd_kafka_new" != "xyes"
+then
+	{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: WARNING: kafka libraries not found. Use --with-kafka-lib-dir=<path>." >&5
+printf "%s\n" "$as_me: WARNING: kafka libraries not found. Use --with-kafka-lib-dir=<path>." >&2;}
+
+fail="$fail librdkafka"
+
+fi
+
+
+
+	targetname=rlm_kafka
+else
+	targetname=
+	echo \*\*\* module rlm_kafka is disabled.
+
+
+fr_status="disabled"
+
+fi
+
+if test x"$fail" != x""; then
+	targetname=""
+
+
+	if test x"${enable_strict_dependencies}" = x"yes"; then
+		as_fn_error $? "set --without-rlm_kafka to disable it explicitly." "$LINENO" 5
+	else
+
+		{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: WARNING: silently not building rlm_kafka." >&5
+printf "%s\n" "$as_me: WARNING: silently not building rlm_kafka." >&2;}
+		{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: WARNING: FAILURE: rlm_kafka requires: $fail." >&5
+printf "%s\n" "$as_me: WARNING: FAILURE: rlm_kafka requires: $fail." >&2;};
+		fail="$(echo $fail)"
+
+
+fr_status="skipping (requires $fail)"
+
+		fr_features=
+
+	fi
+
+else
+
+
+fr_status="OK"
+
+fi
+
+if test x"$fr_features" = x""; then
+	$as_echo "$fr_status" > "config.report"
+else
+	$as_echo_n "$fr_status ... " > "config.report"
+	cat "config.report.tmp" >> "config.report"
+fi
+
+rm "config.report.tmp"
+
+
+
+
+mod_ldflags="$SMART_LIBS"
+mod_cflags="$SMART_CPPFLAGS"
+
+
+
+
+ac_config_files="$ac_config_files all.mk"
+
+cat >confcache <<\_ACEOF
+# This file is a shell script that caches the results of configure
+# tests run on this system so they can be shared between configure
+# scripts and configure runs, see configure's option --config-cache.
+# It is not useful on other systems.  If it contains results you don't
+# want to keep, you may remove or edit it.
+#
+# config.status only pays attention to the cache file if you give it
+# the --recheck option to rerun configure.
+#
+# `ac_cv_env_foo' variables (set or unset) will be overridden when
+# loading this file, other *unset* `ac_cv_foo' will be assigned the
+# following values.
+
+_ACEOF
+
+# The following way of writing the cache mishandles newlines in values,
+# but we know of no workaround that is simple, portable, and efficient.
+# So, we kill variables containing newlines.
+# Ultrix sh set writes to stderr and can't be redirected directly,
+# and sets the high bit in the cache file unless we assign to the vars.
+(
+  for ac_var in `(set) 2>&1 | sed -n 's/^\([a-zA-Z_][a-zA-Z0-9_]*\)=.*/\1/p'`; do
+    eval ac_val=\$$ac_var
+    case $ac_val in #(
+    *${as_nl}*)
+      case $ac_var in #(
+      *_cv_*) { printf "%s\n" "$as_me:${as_lineno-$LINENO}: WARNING: cache variable $ac_var contains a newline" >&5
+printf "%s\n" "$as_me: WARNING: cache variable $ac_var contains a newline" >&2;} ;;
+      esac
+      case $ac_var in #(
+      _ | IFS | as_nl) ;; #(
+      BASH_ARGV | BASH_SOURCE) eval $ac_var= ;; #(
+      *) { eval $ac_var=; unset $ac_var;} ;;
+      esac ;;
+    esac
+  done
+
+  (set) 2>&1 |
+    case $as_nl`(ac_space=' '; set) 2>&1` in #(
+    *${as_nl}ac_space=\ *)
+      # `set' does not quote correctly, so add quotes: double-quote
+      # substitution turns \\\\ into \\, and sed turns \\ into \.
+      sed -n \
+	"s/'/'\\\\''/g;
+	  s/^\\([_$as_cr_alnum]*_cv_[_$as_cr_alnum]*\\)=\\(.*\\)/\\1='\\2'/p"
+      ;; #(
+    *)
+      # `set' quotes correctly as required by POSIX, so do not add quotes.
+      sed -n "/^[_$as_cr_alnum]*_cv_[_$as_cr_alnum]*=/p"
+      ;;
+    esac |
+    sort
+) |
+  sed '
+     /^ac_cv_env_/b end
+     t clear
+     :clear
+     s/^\([^=]*\)=\(.*[{}].*\)$/test ${\1+y} || &/
+     t end
+     s/^\([^=]*\)=\(.*\)$/\1=${\1=\2}/
+     :end' >>confcache
+if diff "$cache_file" confcache >/dev/null 2>&1; then :; else
+  if test -w "$cache_file"; then
+    if test "x$cache_file" != "x/dev/null"; then
+      { printf "%s\n" "$as_me:${as_lineno-$LINENO}: updating cache $cache_file" >&5
+printf "%s\n" "$as_me: updating cache $cache_file" >&6;}
+      if test ! -f "$cache_file" || test -h "$cache_file"; then
+	cat confcache >"$cache_file"
+      else
+        case $cache_file in #(
+        */* | ?:*)
+	  mv -f confcache "$cache_file"$$ &&
+	  mv -f "$cache_file"$$ "$cache_file" ;; #(
+        *)
+	  mv -f confcache "$cache_file" ;;
+	esac
+      fi
+    fi
+  else
+    { printf "%s\n" "$as_me:${as_lineno-$LINENO}: not updating unwritable cache $cache_file" >&5
+printf "%s\n" "$as_me: not updating unwritable cache $cache_file" >&6;}
+  fi
+fi
+rm -f confcache
+
+test "x$prefix" = xNONE && prefix=$ac_default_prefix
+# Let make expand exec_prefix.
+test "x$exec_prefix" = xNONE && exec_prefix='${prefix}'
+
+# Transform confdefs.h into DEFS.
+# Protect against shell expansion while executing Makefile rules.
+# Protect against Makefile macro expansion.
+#
+# If the first sed substitution is executed (which looks for macros that
+# take arguments), then branch to the quote section.  Otherwise,
+# look for a macro that doesn't take arguments.
+ac_script='
+:mline
+/\\$/{
+ N
+ s,\\\n,,
+ b mline
+}
+t clear
+:clear
+s/^[	 ]*#[	 ]*define[	 ][	 ]*\([^	 (][^	 (]*([^)]*)\)[	 ]*\(.*\)/-D\1=\2/g
+t quote
+s/^[	 ]*#[	 ]*define[	 ][	 ]*\([^	 ][^	 ]*\)[	 ]*\(.*\)/-D\1=\2/g
+t quote
+b any
+:quote
+s/[	 `~#$^&*(){}\\|;'\''"<>?]/\\&/g
+s/\[/\\&/g
+s/\]/\\&/g
+s/\$/$$/g
+H
+:any
+${
+	g
+	s/^\n//
+	s/\n/ /g
+	p
+}
+'
+DEFS=`sed -n "$ac_script" confdefs.h`
+
+
+ac_libobjs=
+ac_ltlibobjs=
+U=
+for ac_i in : $LIBOBJS; do test "x$ac_i" = x: && continue
+  # 1. Remove the extension, and $U if already installed.
+  ac_script='s/\$U\././;s/\.o$//;s/\.obj$//'
+  ac_i=`printf "%s\n" "$ac_i" | sed "$ac_script"`
+  # 2. Prepend LIBOBJDIR.  When used with automake>=1.10 LIBOBJDIR
+  #    will be set to the directory where LIBOBJS objects are built.
+  as_fn_append ac_libobjs " \${LIBOBJDIR}$ac_i\$U.$ac_objext"
+  as_fn_append ac_ltlibobjs " \${LIBOBJDIR}$ac_i"'$U.lo'
+done
+LIBOBJS=$ac_libobjs
+
+LTLIBOBJS=$ac_ltlibobjs
+
+
+
+: "${CONFIG_STATUS=./config.status}"
+ac_write_fail=0
+ac_clean_files_save=$ac_clean_files
+ac_clean_files="$ac_clean_files $CONFIG_STATUS"
+{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: creating $CONFIG_STATUS" >&5
+printf "%s\n" "$as_me: creating $CONFIG_STATUS" >&6;}
+as_write_fail=0
+cat >$CONFIG_STATUS <<_ASEOF || as_write_fail=1
+#! $SHELL
+# Generated by $as_me.
+# Run this file to recreate the current configuration.
+# Compiler output produced by configure, useful for debugging
+# configure, is in config.log if it exists.
+
+debug=false
+ac_cs_recheck=false
+ac_cs_silent=false
+
+SHELL=\${CONFIG_SHELL-$SHELL}
+export SHELL
+_ASEOF
+cat >>$CONFIG_STATUS <<\_ASEOF || as_write_fail=1
+## -------------------- ##
+## M4sh Initialization. ##
+## -------------------- ##
+
+# Be more Bourne compatible
+DUALCASE=1; export DUALCASE # for MKS sh
+as_nop=:
+if test ${ZSH_VERSION+y} && (emulate sh) >/dev/null 2>&1
+then :
+  emulate sh
+  NULLCMD=:
+  # Pre-4.2 versions of Zsh do word splitting on ${1+"$@"}, which
+  # is contrary to our usage.  Disable this feature.
+  alias -g '${1+"$@"}'='"$@"'
+  setopt NO_GLOB_SUBST
+else $as_nop
+  case `(set -o) 2>/dev/null` in #(
+  *posix*) :
+    set -o posix ;; #(
+  *) :
+     ;;
+esac
+fi
+
+
+
+# Reset variables that may have inherited troublesome values from
+# the environment.
+
+# IFS needs to be set, to space, tab, and newline, in precisely that order.
+# (If _AS_PATH_WALK were called with IFS unset, it would have the
+# side effect of setting IFS to empty, thus disabling word splitting.)
+# Quoting is to prevent editors from complaining about space-tab.
+as_nl='
+'
+export as_nl
+IFS=" ""	$as_nl"
+
+PS1='$ '
+PS2='> '
+PS4='+ '
+
+# Ensure predictable behavior from utilities with locale-dependent output.
+LC_ALL=C
+export LC_ALL
+LANGUAGE=C
+export LANGUAGE
+
+# We cannot yet rely on "unset" to work, but we need these variables
+# to be unset--not just set to an empty or harmless value--now, to
+# avoid bugs in old shells (e.g. pre-3.0 UWIN ksh).  This construct
+# also avoids known problems related to "unset" and subshell syntax
+# in other old shells (e.g. bash 2.01 and pdksh 5.2.14).
+for as_var in BASH_ENV ENV MAIL MAILPATH CDPATH
+do eval test \${$as_var+y} \
+  && ( (unset $as_var) || exit 1) >/dev/null 2>&1 && unset $as_var || :
+done
+
+# Ensure that fds 0, 1, and 2 are open.
+if (exec 3>&0) 2>/dev/null; then :; else exec 0</dev/null; fi
+if (exec 3>&1) 2>/dev/null; then :; else exec 1>/dev/null; fi
+if (exec 3>&2)            ; then :; else exec 2>/dev/null; fi
+
+# The user is always right.
+if ${PATH_SEPARATOR+false} :; then
+  PATH_SEPARATOR=:
+  (PATH='/bin;/bin'; FPATH=$PATH; sh -c :) >/dev/null 2>&1 && {
+    (PATH='/bin:/bin'; FPATH=$PATH; sh -c :) >/dev/null 2>&1 ||
+      PATH_SEPARATOR=';'
+  }
+fi
+
+
+# Find who we are.  Look in the path if we contain no directory separator.
+as_myself=
+case $0 in #((
+  *[\\/]* ) as_myself=$0 ;;
+  *) as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH
+do
+  IFS=$as_save_IFS
+  case $as_dir in #(((
+    '') as_dir=./ ;;
+    */) ;;
+    *) as_dir=$as_dir/ ;;
+  esac
+    test -r "$as_dir$0" && as_myself=$as_dir$0 && break
+  done
+IFS=$as_save_IFS
+
+     ;;
+esac
+# We did not find ourselves, most probably we were run as `sh COMMAND'
+# in which case we are not to be found in the path.
+if test "x$as_myself" = x; then
+  as_myself=$0
+fi
+if test ! -f "$as_myself"; then
+  printf "%s\n" "$as_myself: error: cannot find myself; rerun with an absolute file name" >&2
+  exit 1
+fi
+
+
+
+# as_fn_error STATUS ERROR [LINENO LOG_FD]
+# ----------------------------------------
+# Output "`basename $0`: error: ERROR" to stderr. If LINENO and LOG_FD are
+# provided, also output the error to LOG_FD, referencing LINENO. Then exit the
+# script with STATUS, using 1 if that was 0.
+as_fn_error ()
+{
+  as_status=$1; test $as_status -eq 0 && as_status=1
+  if test "$4"; then
+    as_lineno=${as_lineno-"$3"} as_lineno_stack=as_lineno_stack=$as_lineno_stack
+    printf "%s\n" "$as_me:${as_lineno-$LINENO}: error: $2" >&$4
+  fi
+  printf "%s\n" "$as_me: error: $2" >&2
+  as_fn_exit $as_status
+} # as_fn_error
+
+
+
+# as_fn_set_status STATUS
+# -----------------------
+# Set $? to STATUS, without forking.
+as_fn_set_status ()
+{
+  return $1
+} # as_fn_set_status
+
+# as_fn_exit STATUS
+# -----------------
+# Exit the shell with STATUS, even in a "trap 0" or "set -e" context.
+as_fn_exit ()
+{
+  set +e
+  as_fn_set_status $1
+  exit $1
+} # as_fn_exit
+
+# as_fn_unset VAR
+# ---------------
+# Portably unset VAR.
+as_fn_unset ()
+{
+  { eval $1=; unset $1;}
+}
+as_unset=as_fn_unset
+
+# as_fn_append VAR VALUE
+# ----------------------
+# Append the text in VALUE to the end of the definition contained in VAR. Take
+# advantage of any shell optimizations that allow amortized linear growth over
+# repeated appends, instead of the typical quadratic growth present in naive
+# implementations.
+if (eval "as_var=1; as_var+=2; test x\$as_var = x12") 2>/dev/null
+then :
+  eval 'as_fn_append ()
+  {
+    eval $1+=\$2
+  }'
+else $as_nop
+  as_fn_append ()
+  {
+    eval $1=\$$1\$2
+  }
+fi # as_fn_append
+
+# as_fn_arith ARG...
+# ------------------
+# Perform arithmetic evaluation on the ARGs, and store the result in the
+# global $as_val. Take advantage of shells that can avoid forks. The arguments
+# must be portable across $(()) and expr.
+if (eval "test \$(( 1 + 1 )) = 2") 2>/dev/null
+then :
+  eval 'as_fn_arith ()
+  {
+    as_val=$(( $* ))
+  }'
+else $as_nop
+  as_fn_arith ()
+  {
+    as_val=`expr "$@" || test $? -eq 1`
+  }
+fi # as_fn_arith
+
+
+if expr a : '\(a\)' >/dev/null 2>&1 &&
+   test "X`expr 00001 : '.*\(...\)'`" = X001; then
+  as_expr=expr
+else
+  as_expr=false
+fi
+
+if (basename -- /) >/dev/null 2>&1 && test "X`basename -- / 2>&1`" = "X/"; then
+  as_basename=basename
+else
+  as_basename=false
+fi
+
+if (as_dir=`dirname -- /` && test "X$as_dir" = X/) >/dev/null 2>&1; then
+  as_dirname=dirname
+else
+  as_dirname=false
+fi
+
+as_me=`$as_basename -- "$0" ||
+$as_expr X/"$0" : '.*/\([^/][^/]*\)/*$' \| \
+	 X"$0" : 'X\(//\)$' \| \
+	 X"$0" : 'X\(/\)' \| . 2>/dev/null ||
+printf "%s\n" X/"$0" |
+    sed '/^.*\/\([^/][^/]*\)\/*$/{
+	    s//\1/
+	    q
+	  }
+	  /^X\/\(\/\/\)$/{
+	    s//\1/
+	    q
+	  }
+	  /^X\/\(\/\).*/{
+	    s//\1/
+	    q
+	  }
+	  s/.*/./; q'`
+
+# Avoid depending upon Character Ranges.
+as_cr_letters='abcdefghijklmnopqrstuvwxyz'
+as_cr_LETTERS='ABCDEFGHIJKLMNOPQRSTUVWXYZ'
+as_cr_Letters=$as_cr_letters$as_cr_LETTERS
+as_cr_digits='0123456789'
+as_cr_alnum=$as_cr_Letters$as_cr_digits
+
+
+# Determine whether it's possible to make 'echo' print without a newline.
+# These variables are no longer used directly by Autoconf, but are AC_SUBSTed
+# for compatibility with existing Makefiles.
+ECHO_C= ECHO_N= ECHO_T=
+case `echo -n x` in #(((((
+-n*)
+  case `echo 'xy\c'` in
+  *c*) ECHO_T='	';;	# ECHO_T is single tab character.
+  xy)  ECHO_C='\c';;
+  *)   echo `echo ksh88 bug on AIX 6.1` > /dev/null
+       ECHO_T='	';;
+  esac;;
+*)
+  ECHO_N='-n';;
+esac
+
+# For backward compatibility with old third-party macros, we provide
+# the shell variables $as_echo and $as_echo_n.  New code should use
+# AS_ECHO(["message"]) and AS_ECHO_N(["message"]), respectively.
+as_echo='printf %s\n'
+as_echo_n='printf %s'
+
+rm -f conf$$ conf$$.exe conf$$.file
+if test -d conf$$.dir; then
+  rm -f conf$$.dir/conf$$.file
+else
+  rm -f conf$$.dir
+  mkdir conf$$.dir 2>/dev/null
+fi
+if (echo >conf$$.file) 2>/dev/null; then
+  if ln -s conf$$.file conf$$ 2>/dev/null; then
+    as_ln_s='ln -s'
+    # ... but there are two gotchas:
+    # 1) On MSYS, both `ln -s file dir' and `ln file dir' fail.
+    # 2) DJGPP < 2.04 has no symlinks; `ln -s' creates a wrapper executable.
+    # In both cases, we have to default to `cp -pR'.
+    ln -s conf$$.file conf$$.dir 2>/dev/null && test ! -f conf$$.exe ||
+      as_ln_s='cp -pR'
+  elif ln conf$$.file conf$$ 2>/dev/null; then
+    as_ln_s=ln
+  else
+    as_ln_s='cp -pR'
+  fi
+else
+  as_ln_s='cp -pR'
+fi
+rm -f conf$$ conf$$.exe conf$$.dir/conf$$.file conf$$.file
+rmdir conf$$.dir 2>/dev/null
+
+
+# as_fn_mkdir_p
+# -------------
+# Create "$as_dir" as a directory, including parents if necessary.
+as_fn_mkdir_p ()
+{
+
+  case $as_dir in #(
+  -*) as_dir=./$as_dir;;
+  esac
+  test -d "$as_dir" || eval $as_mkdir_p || {
+    as_dirs=
+    while :; do
+      case $as_dir in #(
+      *\'*) as_qdir=`printf "%s\n" "$as_dir" | sed "s/'/'\\\\\\\\''/g"`;; #'(
+      *) as_qdir=$as_dir;;
+      esac
+      as_dirs="'$as_qdir' $as_dirs"
+      as_dir=`$as_dirname -- "$as_dir" ||
+$as_expr X"$as_dir" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
+	 X"$as_dir" : 'X\(//\)[^/]' \| \
+	 X"$as_dir" : 'X\(//\)$' \| \
+	 X"$as_dir" : 'X\(/\)' \| . 2>/dev/null ||
+printf "%s\n" X"$as_dir" |
+    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{
+	    s//\1/
+	    q
+	  }
+	  /^X\(\/\/\)[^/].*/{
+	    s//\1/
+	    q
+	  }
+	  /^X\(\/\/\)$/{
+	    s//\1/
+	    q
+	  }
+	  /^X\(\/\).*/{
+	    s//\1/
+	    q
+	  }
+	  s/.*/./; q'`
+      test -d "$as_dir" && break
+    done
+    test -z "$as_dirs" || eval "mkdir $as_dirs"
+  } || test -d "$as_dir" || as_fn_error $? "cannot create directory $as_dir"
+
+
+} # as_fn_mkdir_p
+if mkdir -p . 2>/dev/null; then
+  as_mkdir_p='mkdir -p "$as_dir"'
+else
+  test -d ./-p && rmdir ./-p
+  as_mkdir_p=false
+fi
+
+
+# as_fn_executable_p FILE
+# -----------------------
+# Test if FILE is an executable regular file.
+as_fn_executable_p ()
+{
+  test -f "$1" && test -x "$1"
+} # as_fn_executable_p
+as_test_x='test -x'
+as_executable_p=as_fn_executable_p
+
+# Sed expression to map a string onto a valid CPP name.
+as_tr_cpp="eval sed 'y%*$as_cr_letters%P$as_cr_LETTERS%;s%[^_$as_cr_alnum]%_%g'"
+
+# Sed expression to map a string onto a valid variable name.
+as_tr_sh="eval sed 'y%*+%pp%;s%[^_$as_cr_alnum]%_%g'"
+
+
+exec 6>&1
+## ----------------------------------- ##
+## Main body of $CONFIG_STATUS script. ##
+## ----------------------------------- ##
+_ASEOF
+test $as_write_fail = 0 && chmod +x $CONFIG_STATUS || ac_write_fail=1
+
+cat >>$CONFIG_STATUS <<\_ACEOF || ac_write_fail=1
+# Save the log message, to keep $0 and so on meaningful, and to
+# report actual input values of CONFIG_FILES etc. instead of their
+# values after options handling.
+ac_log="
+This file was extended by $as_me, which was
+generated by GNU Autoconf 2.71.  Invocation command line was
+
+  CONFIG_FILES    = $CONFIG_FILES
+  CONFIG_HEADERS  = $CONFIG_HEADERS
+  CONFIG_LINKS    = $CONFIG_LINKS
+  CONFIG_COMMANDS = $CONFIG_COMMANDS
+  $ $0 $@
+
+on `(hostname || uname -n) 2>/dev/null | sed 1q`
+"
+
+_ACEOF
+
+case $ac_config_files in *"
+"*) set x $ac_config_files; shift; ac_config_files=$*;;
+esac
+
+
+
+cat >>$CONFIG_STATUS <<_ACEOF || ac_write_fail=1
+# Files that config.status was made for.
+config_files="$ac_config_files"
+
+_ACEOF
+
+cat >>$CONFIG_STATUS <<\_ACEOF || ac_write_fail=1
+ac_cs_usage="\
+\`$as_me' instantiates files and other configuration actions
+from templates according to the current configuration.  Unless the files
+and actions are specified as TAGs, all are instantiated by default.
+
+Usage: $0 [OPTION]... [TAG]...
+
+  -h, --help       print this help, then exit
+  -V, --version    print version number and configuration settings, then exit
+      --config     print configuration, then exit
+  -q, --quiet, --silent
+                   do not print progress messages
+  -d, --debug      don't remove temporary files
+      --recheck    update $as_me by reconfiguring in the same conditions
+      --file=FILE[:TEMPLATE]
+                   instantiate the configuration file FILE
+
+Configuration files:
+$config_files
+
+Report bugs to the package provider."
+
+_ACEOF
+ac_cs_config=`printf "%s\n" "$ac_configure_args" | sed "$ac_safe_unquote"`
+ac_cs_config_escaped=`printf "%s\n" "$ac_cs_config" | sed "s/^ //; s/'/'\\\\\\\\''/g"`
+cat >>$CONFIG_STATUS <<_ACEOF || ac_write_fail=1
+ac_cs_config='$ac_cs_config_escaped'
+ac_cs_version="\\
+config.status
+configured by $0, generated by GNU Autoconf 2.71,
+  with options \\"\$ac_cs_config\\"
+
+Copyright (C) 2021 Free Software Foundation, Inc.
+This config.status script is free software; the Free Software Foundation
+gives unlimited permission to copy, distribute and modify it."
+
+ac_pwd='$ac_pwd'
+srcdir='$srcdir'
+test -n "\$AWK" || AWK=awk
+_ACEOF
+
+cat >>$CONFIG_STATUS <<\_ACEOF || ac_write_fail=1
+# The default lists apply if the user does not specify any file.
+ac_need_defaults=:
+while test $# != 0
+do
+  case $1 in
+  --*=?*)
+    ac_option=`expr "X$1" : 'X\([^=]*\)='`
+    ac_optarg=`expr "X$1" : 'X[^=]*=\(.*\)'`
+    ac_shift=:
+    ;;
+  --*=)
+    ac_option=`expr "X$1" : 'X\([^=]*\)='`
+    ac_optarg=
+    ac_shift=:
+    ;;
+  *)
+    ac_option=$1
+    ac_optarg=$2
+    ac_shift=shift
+    ;;
+  esac
+
+  case $ac_option in
+  # Handling of the options.
+  -recheck | --recheck | --rechec | --reche | --rech | --rec | --re | --r)
+    ac_cs_recheck=: ;;
+  --version | --versio | --versi | --vers | --ver | --ve | --v | -V )
+    printf "%s\n" "$ac_cs_version"; exit ;;
+  --config | --confi | --conf | --con | --co | --c )
+    printf "%s\n" "$ac_cs_config"; exit ;;
+  --debug | --debu | --deb | --de | --d | -d )
+    debug=: ;;
+  --file | --fil | --fi | --f )
+    $ac_shift
+    case $ac_optarg in
+    *\'*) ac_optarg=`printf "%s\n" "$ac_optarg" | sed "s/'/'\\\\\\\\''/g"` ;;
+    '') as_fn_error $? "missing file argument" ;;
+    esac
+    as_fn_append CONFIG_FILES " '$ac_optarg'"
+    ac_need_defaults=false;;
+  --he | --h |  --help | --hel | -h )
+    printf "%s\n" "$ac_cs_usage"; exit ;;
+  -q | -quiet | --quiet | --quie | --qui | --qu | --q \
+  | -silent | --silent | --silen | --sile | --sil | --si | --s)
+    ac_cs_silent=: ;;
+
+  # This is an error.
+  -*) as_fn_error $? "unrecognized option: \`$1'
+Try \`$0 --help' for more information." ;;
+
+  *) as_fn_append ac_config_targets " $1"
+     ac_need_defaults=false ;;
+
+  esac
+  shift
+done
+
+ac_configure_extra_args=
+
+if $ac_cs_silent; then
+  exec 6>/dev/null
+  ac_configure_extra_args="$ac_configure_extra_args --silent"
+fi
+
+_ACEOF
+cat >>$CONFIG_STATUS <<_ACEOF || ac_write_fail=1
+if \$ac_cs_recheck; then
+  set X $SHELL '$0' $ac_configure_args \$ac_configure_extra_args --no-create --no-recursion
+  shift
+  \printf "%s\n" "running CONFIG_SHELL=$SHELL \$*" >&6
+  CONFIG_SHELL='$SHELL'
+  export CONFIG_SHELL
+  exec "\$@"
+fi
+
+_ACEOF
+cat >>$CONFIG_STATUS <<\_ACEOF || ac_write_fail=1
+exec 5>>config.log
+{
+  echo
+  sed 'h;s/./-/g;s/^.../## /;s/...$/ ##/;p;x;p;x' <<_ASBOX
+## Running $as_me. ##
+_ASBOX
+  printf "%s\n" "$ac_log"
+} >&5
+
+_ACEOF
+cat >>$CONFIG_STATUS <<_ACEOF || ac_write_fail=1
+_ACEOF
+
+cat >>$CONFIG_STATUS <<\_ACEOF || ac_write_fail=1
+
+# Handling of arguments.
+for ac_config_target in $ac_config_targets
+do
+  case $ac_config_target in
+    "all.mk") CONFIG_FILES="$CONFIG_FILES all.mk" ;;
+
+  *) as_fn_error $? "invalid argument: \`$ac_config_target'" "$LINENO" 5;;
+  esac
+done
+
+
+# If the user did not use the arguments to specify the items to instantiate,
+# then the envvar interface is used.  Set only those that are not.
+# We use the long form for the default assignment because of an extremely
+# bizarre bug on SunOS 4.1.3.
+if $ac_need_defaults; then
+  test ${CONFIG_FILES+y} || CONFIG_FILES=$config_files
+fi
+
+# Have a temporary directory for convenience.  Make it in the build tree
+# simply because there is no reason against having it here, and in addition,
+# creating and moving files from /tmp can sometimes cause problems.
+# Hook for its removal unless debugging.
+# Note that there is a small window in which the directory will not be cleaned:
+# after its creation but before its name has been assigned to `$tmp'.
+$debug ||
+{
+  tmp= ac_tmp=
+  trap 'exit_status=$?
+  : "${ac_tmp:=$tmp}"
+  { test ! -d "$ac_tmp" || rm -fr "$ac_tmp"; } && exit $exit_status
+' 0
+  trap 'as_fn_exit 1' 1 2 13 15
+}
+# Create a (secure) tmp directory for tmp files.
+
+{
+  tmp=`(umask 077 && mktemp -d "./confXXXXXX") 2>/dev/null` &&
+  test -d "$tmp"
+}  ||
+{
+  tmp=./conf$$-$RANDOM
+  (umask 077 && mkdir "$tmp")
+} || as_fn_error $? "cannot create a temporary directory in ." "$LINENO" 5
+ac_tmp=$tmp
+
+# Set up the scripts for CONFIG_FILES section.
+# No need to generate them if there are no CONFIG_FILES.
+# This happens for instance with `./config.status config.h'.
+if test -n "$CONFIG_FILES"; then
+
+
+ac_cr=`echo X | tr X '\015'`
+# On cygwin, bash can eat \r inside `` if the user requested igncr.
+# But we know of no other shell where ac_cr would be empty at this
+# point, so we can use a bashism as a fallback.
+if test "x$ac_cr" = x; then
+  eval ac_cr=\$\'\\r\'
+fi
+ac_cs_awk_cr=`$AWK 'BEGIN { print "a\rb" }' </dev/null 2>/dev/null`
+if test "$ac_cs_awk_cr" = "a${ac_cr}b"; then
+  ac_cs_awk_cr='\\r'
+else
+  ac_cs_awk_cr=$ac_cr
+fi
+
+echo 'BEGIN {' >"$ac_tmp/subs1.awk" &&
+_ACEOF
+
+
+{
+  echo "cat >conf$$subs.awk <<_ACEOF" &&
+  echo "$ac_subst_vars" | sed 's/.*/&!$&$ac_delim/' &&
+  echo "_ACEOF"
+} >conf$$subs.sh ||
+  as_fn_error $? "could not make $CONFIG_STATUS" "$LINENO" 5
+ac_delim_num=`echo "$ac_subst_vars" | grep -c '^'`
+ac_delim='%!_!# '
+for ac_last_try in false false false false false :; do
+  . ./conf$$subs.sh ||
+    as_fn_error $? "could not make $CONFIG_STATUS" "$LINENO" 5
+
+  ac_delim_n=`sed -n "s/.*$ac_delim\$/X/p" conf$$subs.awk | grep -c X`
+  if test $ac_delim_n = $ac_delim_num; then
+    break
+  elif $ac_last_try; then
+    as_fn_error $? "could not make $CONFIG_STATUS" "$LINENO" 5
+  else
+    ac_delim="$ac_delim!$ac_delim _$ac_delim!! "
+  fi
+done
+rm -f conf$$subs.sh
+
+cat >>$CONFIG_STATUS <<_ACEOF || ac_write_fail=1
+cat >>"\$ac_tmp/subs1.awk" <<\\_ACAWK &&
+_ACEOF
+sed -n '
+h
+s/^/S["/; s/!.*/"]=/
+p
+g
+s/^[^!]*!//
+:repl
+t repl
+s/'"$ac_delim"'$//
+t delim
+:nl
+h
+s/\(.\{148\}\)..*/\1/
+t more1
+s/["\\]/\\&/g; s/^/"/; s/$/\\n"\\/
+p
+n
+b repl
+:more1
+s/["\\]/\\&/g; s/^/"/; s/$/"\\/
+p
+g
+s/.\{148\}//
+t nl
+:delim
+h
+s/\(.\{148\}\)..*/\1/
+t more2
+s/["\\]/\\&/g; s/^/"/; s/$/"/
+p
+b
+:more2
+s/["\\]/\\&/g; s/^/"/; s/$/"\\/
+p
+g
+s/.\{148\}//
+t delim
+' <conf$$subs.awk | sed '
+/^[^""]/{
+  N
+  s/\n//
+}
+' >>$CONFIG_STATUS || ac_write_fail=1
+rm -f conf$$subs.awk
+cat >>$CONFIG_STATUS <<_ACEOF || ac_write_fail=1
+_ACAWK
+cat >>"\$ac_tmp/subs1.awk" <<_ACAWK &&
+  for (key in S) S_is_set[key] = 1
+  FS = ""
+
+}
+{
+  line = $ 0
+  nfields = split(line, field, "@")
+  substed = 0
+  len = length(field[1])
+  for (i = 2; i < nfields; i++) {
+    key = field[i]
+    keylen = length(key)
+    if (S_is_set[key]) {
+      value = S[key]
+      line = substr(line, 1, len) "" value "" substr(line, len + keylen + 3)
+      len += length(value) + length(field[++i])
+      substed = 1
+    } else
+      len += 1 + keylen
+  }
+
+  print line
+}
+
+_ACAWK
+_ACEOF
+cat >>$CONFIG_STATUS <<\_ACEOF || ac_write_fail=1
+if sed "s/$ac_cr//" < /dev/null > /dev/null 2>&1; then
+  sed "s/$ac_cr\$//; s/$ac_cr/$ac_cs_awk_cr/g"
+else
+  cat
+fi < "$ac_tmp/subs1.awk" > "$ac_tmp/subs.awk" \
+  || as_fn_error $? "could not setup config files machinery" "$LINENO" 5
+_ACEOF
+
+# VPATH may cause trouble with some makes, so we remove sole $(srcdir),
+# ${srcdir} and @srcdir@ entries from VPATH if srcdir is ".", strip leading and
+# trailing colons and then remove the whole line if VPATH becomes empty
+# (actually we leave an empty line to preserve line numbers).
+if test "x$srcdir" = x.; then
+  ac_vpsub='/^[	 ]*VPATH[	 ]*=[	 ]*/{
+h
+s///
+s/^/:/
+s/[	 ]*$/:/
+s/:\$(srcdir):/:/g
+s/:\${srcdir}:/:/g
+s/:@srcdir@:/:/g
+s/^:*//
+s/:*$//
+x
+s/\(=[	 ]*\).*/\1/
+G
+s/\n//
+s/^[^=]*=[	 ]*$//
+}'
+fi
+
+cat >>$CONFIG_STATUS <<\_ACEOF || ac_write_fail=1
+fi # test -n "$CONFIG_FILES"
+
+
+eval set X "  :F $CONFIG_FILES      "
+shift
+for ac_tag
+do
+  case $ac_tag in
+  :[FHLC]) ac_mode=$ac_tag; continue;;
+  esac
+  case $ac_mode$ac_tag in
+  :[FHL]*:*);;
+  :L* | :C*:*) as_fn_error $? "invalid tag \`$ac_tag'" "$LINENO" 5;;
+  :[FH]-) ac_tag=-:-;;
+  :[FH]*) ac_tag=$ac_tag:$ac_tag.in;;
+  esac
+  ac_save_IFS=$IFS
+  IFS=:
+  set x $ac_tag
+  IFS=$ac_save_IFS
+  shift
+  ac_file=$1
+  shift
+
+  case $ac_mode in
+  :L) ac_source=$1;;
+  :[FH])
+    ac_file_inputs=
+    for ac_f
+    do
+      case $ac_f in
+      -) ac_f="$ac_tmp/stdin";;
+      *) # Look for the file first in the build tree, then in the source tree
+	 # (if the path is not absolute).  The absolute path cannot be DOS-style,
+	 # because $ac_f cannot contain `:'.
+	 test -f "$ac_f" ||
+	   case $ac_f in
+	   [\\/$]*) false;;
+	   *) test -f "$srcdir/$ac_f" && ac_f="$srcdir/$ac_f";;
+	   esac ||
+	   as_fn_error 1 "cannot find input file: \`$ac_f'" "$LINENO" 5;;
+      esac
+      case $ac_f in *\'*) ac_f=`printf "%s\n" "$ac_f" | sed "s/'/'\\\\\\\\''/g"`;; esac
+      as_fn_append ac_file_inputs " '$ac_f'"
+    done
+
+    # Let's still pretend it is `configure' which instantiates (i.e., don't
+    # use $as_me), people would be surprised to read:
+    #    /* config.h.  Generated by config.status.  */
+    configure_input='Generated from '`
+	  printf "%s\n" "$*" | sed 's|^[^:]*/||;s|:[^:]*/|, |g'
+	`' by configure.'
+    if test x"$ac_file" != x-; then
+      configure_input="$ac_file.  $configure_input"
+      { printf "%s\n" "$as_me:${as_lineno-$LINENO}: creating $ac_file" >&5
+printf "%s\n" "$as_me: creating $ac_file" >&6;}
+    fi
+    # Neutralize special characters interpreted by sed in replacement strings.
+    case $configure_input in #(
+    *\&* | *\|* | *\\* )
+       ac_sed_conf_input=`printf "%s\n" "$configure_input" |
+       sed 's/[\\\\&|]/\\\\&/g'`;; #(
+    *) ac_sed_conf_input=$configure_input;;
+    esac
+
+    case $ac_tag in
+    *:-:* | *:-) cat >"$ac_tmp/stdin" \
+      || as_fn_error $? "could not create $ac_file" "$LINENO" 5 ;;
+    esac
+    ;;
+  esac
+
+  ac_dir=`$as_dirname -- "$ac_file" ||
+$as_expr X"$ac_file" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
+	 X"$ac_file" : 'X\(//\)[^/]' \| \
+	 X"$ac_file" : 'X\(//\)$' \| \
+	 X"$ac_file" : 'X\(/\)' \| . 2>/dev/null ||
+printf "%s\n" X"$ac_file" |
+    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{
+	    s//\1/
+	    q
+	  }
+	  /^X\(\/\/\)[^/].*/{
+	    s//\1/
+	    q
+	  }
+	  /^X\(\/\/\)$/{
+	    s//\1/
+	    q
+	  }
+	  /^X\(\/\).*/{
+	    s//\1/
+	    q
+	  }
+	  s/.*/./; q'`
+  as_dir="$ac_dir"; as_fn_mkdir_p
+  ac_builddir=.
+
+case "$ac_dir" in
+.) ac_dir_suffix= ac_top_builddir_sub=. ac_top_build_prefix= ;;
+*)
+  ac_dir_suffix=/`printf "%s\n" "$ac_dir" | sed 's|^\.[\\/]||'`
+  # A ".." for each directory in $ac_dir_suffix.
+  ac_top_builddir_sub=`printf "%s\n" "$ac_dir_suffix" | sed 's|/[^\\/]*|/..|g;s|/||'`
+  case $ac_top_builddir_sub in
+  "") ac_top_builddir_sub=. ac_top_build_prefix= ;;
+  *)  ac_top_build_prefix=$ac_top_builddir_sub/ ;;
+  esac ;;
+esac
+ac_abs_top_builddir=$ac_pwd
+ac_abs_builddir=$ac_pwd$ac_dir_suffix
+# for backward compatibility:
+ac_top_builddir=$ac_top_build_prefix
+
+case $srcdir in
+  .)  # We are building in place.
+    ac_srcdir=.
+    ac_top_srcdir=$ac_top_builddir_sub
+    ac_abs_top_srcdir=$ac_pwd ;;
+  [\\/]* | ?:[\\/]* )  # Absolute name.
+    ac_srcdir=$srcdir$ac_dir_suffix;
+    ac_top_srcdir=$srcdir
+    ac_abs_top_srcdir=$srcdir ;;
+  *) # Relative name.
+    ac_srcdir=$ac_top_build_prefix$srcdir$ac_dir_suffix
+    ac_top_srcdir=$ac_top_build_prefix$srcdir
+    ac_abs_top_srcdir=$ac_pwd/$srcdir ;;
+esac
+ac_abs_srcdir=$ac_abs_top_srcdir$ac_dir_suffix
+
+
+  case $ac_mode in
+  :F)
+  #
+  # CONFIG_FILE
+  #
+
+_ACEOF
+
+cat >>$CONFIG_STATUS <<\_ACEOF || ac_write_fail=1
+# If the template does not know about datarootdir, expand it.
+# FIXME: This hack should be removed a few years after 2.60.
+ac_datarootdir_hack=; ac_datarootdir_seen=
+ac_sed_dataroot='
+/datarootdir/ {
+  p
+  q
+}
+/@datadir@/p
+/@docdir@/p
+/@infodir@/p
+/@localedir@/p
+/@mandir@/p'
+case `eval "sed -n \"\$ac_sed_dataroot\" $ac_file_inputs"` in
+*datarootdir*) ac_datarootdir_seen=yes;;
+*@datadir@*|*@docdir@*|*@infodir@*|*@localedir@*|*@mandir@*)
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: WARNING: $ac_file_inputs seems to ignore the --datarootdir setting" >&5
+printf "%s\n" "$as_me: WARNING: $ac_file_inputs seems to ignore the --datarootdir setting" >&2;}
+_ACEOF
+cat >>$CONFIG_STATUS <<_ACEOF || ac_write_fail=1
+  ac_datarootdir_hack='
+  s&@datadir@&$datadir&g
+  s&@docdir@&$docdir&g
+  s&@infodir@&$infodir&g
+  s&@localedir@&$localedir&g
+  s&@mandir@&$mandir&g
+  s&\\\${datarootdir}&$datarootdir&g' ;;
+esac
+_ACEOF
+
+# Neutralize VPATH when `$srcdir' = `.'.
+# Shell code in configure.ac might set extrasub.
+# FIXME: do we really want to maintain this feature?
+cat >>$CONFIG_STATUS <<_ACEOF || ac_write_fail=1
+ac_sed_extra="$ac_vpsub
+$extrasub
+_ACEOF
+cat >>$CONFIG_STATUS <<\_ACEOF || ac_write_fail=1
+:t
+/@[a-zA-Z_][a-zA-Z_0-9]*@/!b
+s|@configure_input@|$ac_sed_conf_input|;t t
+s&@top_builddir@&$ac_top_builddir_sub&;t t
+s&@top_build_prefix@&$ac_top_build_prefix&;t t
+s&@srcdir@&$ac_srcdir&;t t
+s&@abs_srcdir@&$ac_abs_srcdir&;t t
+s&@top_srcdir@&$ac_top_srcdir&;t t
+s&@abs_top_srcdir@&$ac_abs_top_srcdir&;t t
+s&@builddir@&$ac_builddir&;t t
+s&@abs_builddir@&$ac_abs_builddir&;t t
+s&@abs_top_builddir@&$ac_abs_top_builddir&;t t
+$ac_datarootdir_hack
+"
+eval sed \"\$ac_sed_extra\" "$ac_file_inputs" | $AWK -f "$ac_tmp/subs.awk" \
+  >$ac_tmp/out || as_fn_error $? "could not create $ac_file" "$LINENO" 5
+
+test -z "$ac_datarootdir_hack$ac_datarootdir_seen" &&
+  { ac_out=`sed -n '/\${datarootdir}/p' "$ac_tmp/out"`; test -n "$ac_out"; } &&
+  { ac_out=`sed -n '/^[	 ]*datarootdir[	 ]*:*=/p' \
+      "$ac_tmp/out"`; test -z "$ac_out"; } &&
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: WARNING: $ac_file contains a reference to the variable \`datarootdir'
+which seems to be undefined.  Please make sure it is defined" >&5
+printf "%s\n" "$as_me: WARNING: $ac_file contains a reference to the variable \`datarootdir'
+which seems to be undefined.  Please make sure it is defined" >&2;}
+
+  rm -f "$ac_tmp/stdin"
+  case $ac_file in
+  -) cat "$ac_tmp/out" && rm -f "$ac_tmp/out";;
+  *) rm -f "$ac_file" && mv "$ac_tmp/out" "$ac_file";;
+  esac \
+  || as_fn_error $? "could not create $ac_file" "$LINENO" 5
+ ;;
+
+
+
+  esac
+
+done # for ac_tag
+
+
+as_fn_exit 0
+_ACEOF
+ac_clean_files=$ac_clean_files_save
+
+test $ac_write_fail = 0 ||
+  as_fn_error $? "write failure creating $CONFIG_STATUS" "$LINENO" 5
+
+
+# configure is writing to config.log, and then calls config.status.
+# config.status does its own redirection, appending to config.log.
+# Unfortunately, on DOS this fails, as config.log is still kept open
+# by configure, so config.status won't be able to write to it; its
+# output is simply discarded.  So we exec the FD to /dev/null,
+# effectively closing config.log, so it can be properly (re)opened and
+# appended to by config.status.  When coming back to configure, we
+# need to make the FD available again.
+if test "$no_create" != yes; then
+  ac_cs_success=:
+  ac_config_status_args=
+  test "$silent" = yes &&
+    ac_config_status_args="$ac_config_status_args --quiet"
+  exec 5>/dev/null
+  $SHELL $CONFIG_STATUS $ac_config_status_args || ac_cs_success=false
+  exec 5>>config.log
+  # Use ||, not &&, to avoid exiting from the if with $? = 1, which
+  # would make configure fail if this is the last instruction.
+  $ac_cs_success || as_fn_exit 1
+fi
+if test -n "$ac_unrecognized_opts" && test "$enable_option_checking" != no; then
+  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: WARNING: unrecognized options: $ac_unrecognized_opts" >&5
+printf "%s\n" "$as_me: WARNING: unrecognized options: $ac_unrecognized_opts" >&2;}
+fi
+
+
diff -urpN freeradius-server-3.2.7/src/modules/rlm_kafka/configure.ac freeradius-server-3.2.8/src/modules/rlm_kafka/configure.ac
--- freeradius-server-3.2.7/src/modules/rlm_kafka/configure.ac	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/modules/rlm_kafka/configure.ac	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,155 @@
+AC_PREREQ([2.69])
+AC_INIT
+AC_CONFIG_SRCDIR([rlm_kafka.c])
+AC_REVISION($Revision$)
+FR_INIT_MODULE([rlm_kafka], [Kafka event processing platform support])
+
+SMART_LIBS=
+SMART_CLFAGS=
+
+FR_MODULE_START_TESTS
+
+dnl ############################################################
+dnl # Check for command line options
+dnl ############################################################
+
+dnl extra argument: --with-kafka-include-dir=DIR
+kafka_include_dir=
+AC_ARG_WITH(kafka-include-dir,
+	[AS_HELP_STRING([--with-kafka-include-dir=DIR],
+		[Directory where the kafka includes may be found])],
+	[case "$withval" in
+	no)
+		AC_MSG_ERROR(Need kafka-include-dir)
+		;;
+	yes)
+		;;
+	*)
+		kafka_include_dir="$withval"
+		;;
+	esac])
+
+dnl extra argument: --with-kafka-lib-dir=DIR
+kafka_lib_dir=
+AC_ARG_WITH(kafka-lib-dir,
+	[AS_HELP_STRING([--with-kafka-lib-dir=DIR],
+		[Directory where the kafka libraries may be found])],
+	[case "$withval" in
+	no)
+		AC_MSG_ERROR(Need kafka-lib-dir)
+		;;
+	yes)
+		;;
+	*)
+		kafka_lib_dir="$withval"
+		;;
+	esac])
+
+dnl extra argument: --with-kafka-dir=DIR
+AC_ARG_WITH(kafka-dir,
+	[AS_HELP_STRING([--with-kafka-dir=DIR],
+		[Base directory where kafka is installed])],
+	[case "$withval" in
+	no)
+		AC_MSG_ERROR(Need kafka-dir)
+		;;
+	yes)
+		;;
+	*)
+		kafka_lib_dir="$withval/lib"
+		kafka_include_dir="$withval/include"
+		;;
+	esac])
+
+dnl extra argument: --with-openssl-lib-dir
+openssl_lib_dir=
+AC_ARG_WITH(openssl-lib-dir,
+	[AS_HELP_STRING([--with-openssl-lib-dir=DIR],
+		[directory for OpenSSL library files])],
+	[case "$withval" in
+	no)
+		AC_MSG_ERROR(Need openssl-lib-dir)
+		;;
+	yes)
+		;;
+	*)
+		openssl_lib_dir="$withval"
+		;;
+	esac])
+
+dnl extra argument: --with-openssl-include-dir
+openssl_include_dir=
+AC_ARG_WITH(openssl-include-dir,
+	[AS_HELP_STRING([--with-openssl-include-dir=DIR],
+		[directory for OpenSSL include files])],
+	[case "$withval" in
+	no)
+		AC_MSG_ERROR(Need openssl-include-dir)
+		;;
+	yes)
+		;;
+	*)
+		openssl_include_dir="$withval"
+		;;
+	esac])
+
+dnl ############################################################
+dnl # Check for programs
+dnl ############################################################
+
+AC_PROG_CC
+
+dnl ############################################################
+dnl # Check for header files
+dnl ############################################################
+
+smart_try_dir="${kafka_include_dir}"
+FR_SMART_CHECK_INCLUDE([librdkafka/rdkafka.h])
+if test "x$ac_cv_header_librdkafka_rdkafka_h" != "xyes"; then
+	AC_MSG_WARN([kafka headers not found. Use --with-kafka-include-dir=<path>.])
+	FR_MODULE_FAIL([rdkafka.h])
+fi
+
+AC_EGREP_CPP(yes,
+	[#include <openssl/crypto.h>
+		#if (OPENSSL_VERSION_NUMBER >= 0x10100000L)
+		yes
+		#endif
+	],
+	[
+		AC_MSG_CHECKING([for OpenSSL version >= 1.1.0])
+		AC_MSG_RESULT(yes)
+	],
+	[
+		AC_MSG_CHECKING([for OpenSSL version >= 1.1.0])
+		AC_MSG_RESULT(no)
+		FR_MODULE_FAIL([OpenSSL>=1.1.0])
+	]
+)
+
+dnl ############################################################
+dnl # Check for librdkafka library
+dnl ############################################################
+
+smart_try_dir="$kafka_lib_dir"
+FR_SMART_CHECK_LIB(rdkafka, rd_kafka_new)
+if test "x$ac_cv_lib_rdkafka_rd_kafka_new" != "xyes"
+then
+	AC_MSG_WARN([kafka libraries not found. Use --with-kafka-lib-dir=<path>.])
+	FR_MODULE_FAIL([librdkafka])
+fi
+
+dnl ############################################################
+dnl # Checks done - set targetname
+dnl ############################################################
+
+FR_MODULE_END_TESTS
+
+mod_ldflags="$SMART_LIBS"
+mod_cflags="$SMART_CPPFLAGS"
+
+AC_SUBST(mod_ldflags)
+AC_SUBST(mod_cflags)
+
+AC_CONFIG_FILES([all.mk])
+AC_OUTPUT
diff -urpN freeradius-server-3.2.7/src/modules/rlm_kafka/rlm_kafka.c freeradius-server-3.2.8/src/modules/rlm_kafka/rlm_kafka.c
--- freeradius-server-3.2.7/src/modules/rlm_kafka/rlm_kafka.c	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/modules/rlm_kafka/rlm_kafka.c	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,1069 @@
+/*
+ *   This program is is free software; you can redistribute it and/or modify
+ *   it under the terms of the GNU General Public License as published by
+ *   the Free Software Foundation; either version 2 of the License, or (at
+ *   your option) any later version.
+ *
+ *   This program is distributed in the hope that it will be useful,
+ *   but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ *   GNU General Public License for more details.
+ *
+ *   You should have received a copy of the GNU General Public License
+ *   along with this program; if not, write to the Free Software
+ *   Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301, USA
+ */
+
+/**
+ * $Id: 67ecb56ac657c374a5b24748fd2b312e5d39219c $
+ * @file rlm_kafka.c
+ * @brief Produces messages to a Kafka messaging queue.
+ *
+ * @copyright 2021  TheBinary <binary4bytes@gmail.com>
+ * @copyright 2025  The FreeRADIUS server project
+ * @copyright 2025  NetworkRADIUS SAS
+ */
+RCSID("$Id: 67ecb56ac657c374a5b24748fd2b312e5d39219c $")
+
+#include <freeradius-devel/radiusd.h>
+#include <freeradius-devel/modules.h>
+#include <freeradius-devel/rad_assert.h>
+#include <librdkafka/rdkafka.h>
+#include <ctype.h>
+
+#define LOG_PREFIX "rlm_kafka"
+
+#define RLM_KAFKA_PROP_SET(CONF, PROP, VALUE, BUF_ERRSTR) 								\
+	do {														\
+		if (rd_kafka_conf_set(CONF, PROP, VALUE, BUF_ERRSTR, sizeof(BUF_ERRSTR)) != RD_KAFKA_CONF_OK )		\
+			ERROR("Error setting Kafka global property: '%s=%s' : %s\n", PROP, VALUE, BUF_ERRSTR);		\
+	} while (0)
+
+#define RLM_KAFKA_TOPIC_PROP_SET(CONF, PROP, VALUE, BUF_ERRSTR)								\
+	do {														\
+		if (rd_kafka_topic_conf_set(CONF, PROP, VALUE, BUF_ERRSTR, sizeof(BUF_ERRSTR)) != RD_KAFKA_CONF_OK )	\
+			ERROR("Error setting Kafka topic property: '%s=%s' : %s\n", PROP, VALUE, BUF_ERRSTR);		\
+	} while (0)
+
+typedef struct rlm_kafka_section_config {
+
+	CONF_SECTION *cs;
+	char const *reference;
+	char const *key;
+	char const *headers;
+
+	/*
+	 *  Topic handle to avoid rbtree lookups for section-based calls
+	 *
+	 */
+	rd_kafka_topic_t *rkt;
+
+} rlm_kafka_section_config_t;
+
+typedef struct rlm_kafka_rkt_by_name {
+
+	const char *name;
+	rd_kafka_topic_t *rkt;
+
+	/*
+	 *  Only one entry is the "owner" for a topic, and all others are
+	 *  references to it (having ref = true)
+	 */
+	bool ref;
+
+} rlm_kafka_rkt_by_name_t;
+
+typedef struct rlm_kafka_t {
+
+	char const *name;
+
+	bool async;
+
+	char const *bootstrap;
+	char const *schema;
+
+	char const *stats_filename;
+	FILE *stats_file;
+
+	rd_kafka_t *rk;
+
+	rbtree_t *rkt_by_name_tree;
+
+	rlm_kafka_section_config_t authorize;
+	rlm_kafka_section_config_t postauth;
+	rlm_kafka_section_config_t accounting;
+
+} rlm_kafka_t;
+
+static const CONF_PARSER global_config[] = {
+	CONF_PARSER_TERMINATOR
+};
+
+static const CONF_PARSER topic_config[] = {
+	CONF_PARSER_TERMINATOR
+};
+
+static const CONF_PARSER authorize_config[] = {
+	{ "reference", FR_CONF_OFFSET(PW_TYPE_STRING | PW_TYPE_XLAT, rlm_kafka_t, authorize.reference), ".message" },
+	{ "key", FR_CONF_OFFSET(PW_TYPE_STRING | PW_TYPE_XLAT, rlm_kafka_t, authorize.key), NULL},
+	{ "headers", FR_CONF_OFFSET(PW_TYPE_STRING | PW_TYPE_XLAT, rlm_kafka_t, authorize.headers), NULL},
+	CONF_PARSER_TERMINATOR
+};
+
+static const CONF_PARSER postauth_config[] = {
+	{ "reference", FR_CONF_OFFSET(PW_TYPE_STRING | PW_TYPE_XLAT, rlm_kafka_t, postauth.reference), ".message" },
+	{ "key", FR_CONF_OFFSET(PW_TYPE_STRING | PW_TYPE_XLAT, rlm_kafka_t, postauth.key), NULL},
+	{ "headers", FR_CONF_OFFSET(PW_TYPE_STRING | PW_TYPE_XLAT, rlm_kafka_t, postauth.headers), NULL},
+	CONF_PARSER_TERMINATOR
+};
+
+static const CONF_PARSER accounting_config[] = {
+	{ "reference", FR_CONF_OFFSET(PW_TYPE_STRING | PW_TYPE_XLAT, rlm_kafka_t, accounting.reference), ".message" },
+	{ "key", FR_CONF_OFFSET(PW_TYPE_STRING | PW_TYPE_XLAT, rlm_kafka_t, accounting.key), NULL},
+	{ "headers", FR_CONF_OFFSET(PW_TYPE_STRING | PW_TYPE_XLAT, rlm_kafka_t, accounting.headers), NULL},
+	CONF_PARSER_TERMINATOR
+};
+
+static const CONF_PARSER stats_config[] = {
+	{"file", FR_CONF_OFFSET(PW_TYPE_STRING, rlm_kafka_t, stats_filename), NULL},
+	CONF_PARSER_TERMINATOR
+};
+
+/*
+ *  It would be nice to have a/synchronous delivery be a property set for each
+ *  topic, but unfortunately this is not possible.
+ *
+ *  High-throughput asynchronous requires a sufficiently large linger.ms to
+ *  ensure batched message delivery.
+ *
+ *  Synchronous delivery requires linger.ms = 0 to avoid unnecessary delays.
+ *
+ *  However, linger.ms is a global property, and rd_kafka_flush() purges the
+ *  queue of all topics.
+ *
+ */
+static const CONF_PARSER module_config[] = {
+	{ "bootstrap-servers", FR_CONF_OFFSET(PW_TYPE_STRING | PW_TYPE_REQUIRED, rlm_kafka_t, bootstrap), NULL },
+	{ "asynchronous", FR_CONF_OFFSET(PW_TYPE_BOOLEAN, rlm_kafka_t, async), "no" },
+	{ "global-config", FR_CONF_POINTER(PW_TYPE_SUBSECTION, NULL), (void const*) global_config },
+	{ "topic-config", FR_CONF_POINTER(PW_TYPE_SUBSECTION, NULL), (void const*) topic_config },
+	{ "authorize", FR_CONF_POINTER(PW_TYPE_SUBSECTION, NULL), (void const*) authorize_config },
+	{ "post-auth", FR_CONF_POINTER(PW_TYPE_SUBSECTION, NULL), (void const*) postauth_config },
+	{ "accounting", FR_CONF_POINTER(PW_TYPE_SUBSECTION, NULL), (void const*) accounting_config },
+	{ "statistics", FR_CONF_POINTER(PW_TYPE_SUBSECTION, NULL), (void const*) stats_config },
+	CONF_PARSER_TERMINATOR
+};
+
+static int stats_cb (UNUSED rd_kafka_t *rk, char *json, size_t json_len, void *opaque) {
+	rlm_kafka_t	*inst = opaque;
+
+	/*
+	 *  Apparently this callback does not need to be re-entrant...
+	 */
+	DEBUG3("stats callback");
+	fprintf(inst->stats_file, "%.*s\n", (int)json_len, json);
+	fflush(inst->stats_file);
+
+	return 0;
+}
+
+/*
+ * This callback is triggered exactly once per message from either
+ * rd_kafka_poll() or rd_kafka_flush() and executes on the application's
+ * thread.
+ */
+static void dr_msg_cb(UNUSED rd_kafka_t *rk, const rd_kafka_message_t *rkmessage, UNUSED void *opaque) {
+	rd_kafka_resp_err_t	*status;
+	int32_t 		broker_id = -1;
+	const char		*persisted = "unknown";
+
+	/*
+	 *  For synchronous send, acknowledge by writing err into the message's opaque.
+	 *
+	 *  Any error is reported immediately by the thread that was waiting for this.
+	 */
+	if (rkmessage->_private) {
+		status = (rd_kafka_resp_err_t *)rkmessage->_private;
+		*status = rkmessage->err;
+		return;
+	}
+
+	/*
+	 *  Message must have been sent asynchronously if we get this far.
+	 */
+	if (!rkmessage->err) return;
+
+#if RD_KAFKA_VERSION >= 0x010500ff
+        broker_id = rd_kafka_message_broker_id(rkmessage);
+#endif
+
+#if RD_KAFKA_VERSION >= 0x010000ff
+	switch (rd_kafka_message_status(rkmessage)) {
+	case RD_KAFKA_MSG_STATUS_PERSISTED:
+		persisted = "definately";
+		break;
+
+	case RD_KAFKA_MSG_STATUS_NOT_PERSISTED:
+		persisted = "not";
+		break;
+
+	case RD_KAFKA_MSG_STATUS_POSSIBLY_PERSISTED:
+		persisted = "possibly";
+		break;
+
+	}
+#endif
+
+	ERROR("Kafka delivery report '%s' for key: %.*s (%s persisted to broker %" PRId32 ")\n",
+	      rd_kafka_err2str(rkmessage->err),
+	      (int)rkmessage->key_len, (char *)rkmessage->key,
+	      persisted,
+	      broker_id
+	     );
+}
+
+/*
+ * This callback may be triggered spontaneously from any thread at any time.
+ *
+ */
+static void log_cb(const rd_kafka_t *rk, int level, UNUSED const char *facility, const char *buf)
+{
+
+	rlm_kafka_t *inst = rd_kafka_opaque(rk);
+
+	/*
+	 *  Map Kafka error levels (based on syslog severities) to FR log levels
+	 */
+	switch (level) {
+	case 4:
+		WARN(LOG_PREFIX " (%s): %s", inst->name, buf);
+		break;
+	case 5:
+	case 6:
+		INFO(LOG_PREFIX " (%s): %s", inst->name, buf);
+		break;
+	case 7:
+		DEBUG(LOG_PREFIX " (%s): %s", inst->name, buf);
+		break;
+	default:
+		ERROR(LOG_PREFIX " (%s): %s", inst->name, buf);
+	}
+}
+
+/*
+ *  Note: No error_cb function: "If no error_cb is registered ... then the
+ *  errors will be logged [log_cb] instead."
+ *
+ */
+
+/*
+ * A wrapper around rd_kafka_producev() that implements synchronous semantics
+ * and retries on queue full.
+ *
+ */
+#define NO_DELIVERY_REPORT INT_MIN
+#define RETRIES 2
+static int kafka_produce(rlm_kafka_t *inst, UNUSED REQUEST *request, rd_kafka_topic_t *rkt,
+			 char* const key, const size_t key_len, char* const message, const size_t len,
+			 rd_kafka_headers_t *hdrs, const bool async) {
+
+	rd_kafka_resp_err_t	status = NO_DELIVERY_REPORT;
+	rd_kafka_resp_err_t	err;
+	int			attempt;
+
+	/*
+	 *  Non-blocking poll to service queue callbacks
+	 */
+	rd_kafka_poll(inst->rk, 0);
+
+	/*
+	 * This is an asynchronous call, on success it will only enqueue the
+	 * message on the internal producer queue.
+	 *
+	 * The actual delivery attempts to the broker are handled by background
+	 * threads.
+	 *
+	 * RD_KAFKA_MSG_F_COPY is set for async delivery to ensure that the
+	 * message persists even after the request is cleaned up.
+	 *
+	 * key is always copied.
+	 *
+	 */
+	for (attempt = 1; attempt <= RETRIES + 1; attempt++) {
+		err = rd_kafka_producev(inst->rk,
+					RD_KAFKA_V_RKT(rkt),
+					RD_KAFKA_V_MSGFLAGS(async ? RD_KAFKA_MSG_F_COPY : 0),
+					RD_KAFKA_V_KEY(key, key_len),
+					RD_KAFKA_V_VALUE(message, len),
+					RD_KAFKA_V_HEADERS(hdrs),
+					RD_KAFKA_V_OPAQUE(async ? NULL : &status),
+					RD_KAFKA_V_END
+				       );
+
+		if (err != RD_KAFKA_RESP_ERR__QUEUE_FULL) break;
+
+		RERROR("Kafka queue full: %s. Produce attempt %d/%d\n",
+		       rd_kafka_err2str(err), attempt, RETRIES + 1);
+		rd_kafka_poll(inst->rk, 1000);
+	}
+
+	/*
+	 *  If rd_kafka_producev() failed then we still own any headers.
+	 *
+	 */
+	if (err != RD_KAFKA_RESP_ERR_NO_ERROR && hdrs)
+		rd_kafka_headers_destroy(hdrs);
+
+	/*
+	 *  If the delivery is specified as synchronous and we did not
+	 *  encounter an immediate error when producing to the queue then
+	 *  enforce synchronous behaviour. We do this by polling for changes to
+	 *  the stack-allocated err component of the message's opaque made by
+	 *  the delivery report callback once the message is durably received
+	 *  by brokers.
+	 *
+	 *  Note: We cannot implement a local timeout here, otherwise we
+	 *  invalidate the message's stack-allocated opaque as soon as this
+	 *  function exits such that a later callback would write into invalid
+	 *  memory! Instead, we rely on the delivery report callback firing
+	 *  after the topic's message.timeout.ms.
+	 *
+	 */
+	if (!async && err == RD_KAFKA_RESP_ERR_NO_ERROR) {
+		while (status == NO_DELIVERY_REPORT)
+			rd_kafka_poll(inst->rk, 1000);	/* Timeout avoids busy waiting */
+		err = status;
+	}
+
+	if (err != RD_KAFKA_RESP_ERR_NO_ERROR) {
+		RERROR("Failed to produce to Kafka topic: %s: %s\n",
+		       rd_kafka_topic_name(rkt), rd_kafka_err2str(err));
+		return -1;
+	}
+
+	return 0;
+
+}
+#undef NO_DELIVERY_REPORT
+
+static int create_headers(REQUEST *request, const char *in, rd_kafka_headers_t **out)
+{
+	rd_kafka_headers_t	*hdrs = NULL;
+	const char		*p;
+	VALUE_PAIR		*header_vps = NULL, *vps, *vp;
+	int			num_vps;
+	vp_cursor_t		cursor;
+
+	if (!in)
+		return 0;
+
+	/*
+	 *  Decode the headers string to derive a set of VPs from which to
+	 *  create Kafka headers
+	 *
+	 */
+	p = in;
+
+	while (isspace((uint8_t) *p)) p++;
+	if (*p == '\0') return -1;
+
+	while (*p) {
+		bool		negate = false;
+		vp_tmpl_t	*vpt = NULL;
+		ssize_t		slen;
+
+		while (isspace((uint8_t) *p)) p++;
+
+		if (*p == '\0') break;
+
+		/* Check if we should be removing attributes */
+		if (*p == '!') {
+			p++;
+			negate = true;
+		}
+
+		if (*p == '\0') {
+			/* May happen e.g. with '!' on its own at the end */
+			REMARKER(in, (p - in), "Missing attribute name");
+		error:
+			fr_pair_list_free(&header_vps);
+			talloc_free(vpt);
+			return -1;
+		}
+
+		/* Decode next attr template */
+		slen = tmpl_afrom_attr_substr(request, &vpt, p, REQUEST_CURRENT, PAIR_LIST_REQUEST, false, false);
+
+		if (slen <= 0) {
+			REMARKER(in, (p - in) - slen, fr_strerror());
+			goto error;
+		}
+
+		/*
+		 * Get attributes from the template.
+		 * Missing attribute isn't an error (so -1, not 0).
+		 */
+		if (tmpl_copy_vps(request, &vps, request, vpt) < -1) {
+			REDEBUG("Error copying attributes");
+			goto error;
+		}
+
+		if (negate) {
+			/* Remove all template attributes from header list */
+			for (vp = vps; vp; vp = vp->next)
+				fr_pair_delete_by_da(&header_vps, vp->da);
+
+			fr_pair_list_free(&vps);
+		} else {
+			/* Add template VPs to header list */
+			fr_pair_add(&header_vps, vps);
+		}
+
+		TALLOC_FREE(vpt);
+
+		/* Jump forward to next attr */
+		p += slen;
+
+		if (*p != '\0' && !isspace((uint8_t)*p)) {
+			REMARKER(in, (p - in), "Missing whitespace");
+			goto error;
+		}
+
+	}
+
+	/*
+	 *  Create the Kafka headers for the derived VPs
+	 *
+	 */
+	for (vp = header_vps, num_vps = 0; vp; vp = vp->next, num_vps++);
+	if (num_vps == 0) return 0;
+
+	hdrs = rd_kafka_headers_new(num_vps);
+	for (vp = fr_cursor_init(&cursor, &header_vps);
+	     vp;
+	     vp = fr_cursor_next(&cursor)) {
+		rd_kafka_resp_err_t err;
+		const char *attr = vp->da->name;
+		char *value;
+
+		value = vp_aprints_value(NULL, vp, '\0');
+		err = rd_kafka_header_add(hdrs, attr, -1, value, -1);
+		talloc_free(value);
+		if (err) {
+			rd_kafka_headers_destroy(hdrs);
+			return -1;
+		}
+	}
+
+	*out = hdrs;
+	return 0;
+
+}
+
+/*
+ *  Format is one of the following:
+ *
+ *  - "%{kafka:<topic> (<header-list>) &Key-Attr-Ref <message data>}"
+ *  - "%{kafka:<topic> (<header-list>)  <message data>}"  (no key => space)
+ *  - "%{kafka:<topic> &Key-Attr-Ref <message data>}"
+ *  - "%{kafka:<topic>  <message data>}"                  (no key => space)
+ *
+ */
+static ssize_t kafka_xlat(void *instance, REQUEST *request, char const *fmt, char *out, UNUSED size_t outlen)
+{
+	rlm_kafka_t		*inst = instance;
+	char const		*p = fmt, *q;
+	ssize_t			key_len = 0;
+	char			*expanded = NULL;
+	char			*headers = NULL;
+	char 			buf[256];
+	rlm_kafka_rkt_by_name_t	*entry, my_topic;
+	rd_kafka_headers_t	*hdrs = NULL;
+
+	union {
+		const uint8_t *key_const;
+		char* const key_unconst;
+	} k;
+	k.key_const = NULL;
+
+	*out = '\0';
+
+	/*
+	 *  Extract and lookup the topic.
+	 *
+	 */
+	p = strchr(fmt, ' ');
+        if (!p || *fmt == ' ' || *(p+1) == '\0') {
+		REDEBUG("Kafka xlat must begin with a topic, optionally followed by headers, then the payload");
+error:
+		talloc_free(expanded);
+		if (hdrs) rd_kafka_headers_destroy(hdrs);
+		return -1;
+	}
+	if ((size_t)(p - fmt) >= sizeof(buf)) {
+		REDEBUG("Insufficient space to store Kafka topic name, needed %zu bytes, have %zu bytes",
+			(p - fmt) + 1, sizeof(buf));
+		goto error;
+	}
+	strlcpy(buf, fmt, (p - fmt) + 1);
+	p++;
+
+	my_topic.name = buf;
+	entry = rbtree_finddata(inst->rkt_by_name_tree, &my_topic);
+	if (!entry || !entry->rkt) {
+		RWARN("No configuration section exists for kafka topic \"%s\"", buf);
+		goto error;
+	}
+
+	/*
+	 *  Extract the header specification, and generate the headers
+	 *
+	 */
+	q = p;
+	if (*p == '(') {
+		p = strchr(p, ')');
+		if (!p) {
+			REDEBUG("Header list is missing closing parenthesis)");
+			goto error;
+		}
+		MEM(headers = talloc_strndup(NULL, q + 1, p - q - 1));
+		if (*headers && create_headers(request, headers, &hdrs) < 0) {
+			REDEBUG("Failed to create headers");
+			talloc_free(headers);
+			goto error;
+		}
+		talloc_free(headers);
+		p++;
+		if (*p != ' ') {
+			REDEBUG("Kafka xlat must begin with a topic, optionally followed by headers, then the payload");
+			goto error;
+		}
+		p++;
+	}
+
+	/*
+	 *  Extract the key, if there is one, otherwise expect a space.
+	 *
+	 */
+	q = p;
+	if (*p == '&') {
+		p = strchr(p, ' ');
+		if (!p) {
+			REDEBUG("Key attribute form requires a message after the key (... &Key-Attr-Ref <message data>)");
+			goto error;
+		}
+
+		if ((size_t)(p - q) >= sizeof(buf)) {
+			REDEBUG("Insufficient space to store key attribute ref, needed %zu bytes, have %zu bytes",
+			        (p - q) + 1, sizeof(buf));
+			goto error;
+		}
+		strlcpy(buf, q, (p - q) + 1);
+
+		key_len = xlat_fmt_to_ref(&k.key_const, request, buf);
+		if (key_len < 0) goto error;
+
+		RDEBUG3("message key=%.*s\n", (int)key_len, k.key_const);
+	} else if (*p != ' ') {
+		/*
+		 * Require a space to disambiguate data starting with "&"
+		 *
+		 */
+		REDEBUG("Kafka payload must begin with an attribute reference or a space");
+		goto error;
+	}
+
+	p++;
+
+	/*
+	 *  The remainder is the message.
+	 *
+	 */
+	if (radius_axlat(&expanded, request, p, NULL, NULL) < 0) {
+		REDEBUG("Message expansion failed");
+		goto error;
+	}
+
+	kafka_produce(inst, request, entry->rkt, k.key_unconst, key_len,
+		      expanded, strlen(expanded), hdrs, inst->async);
+
+	talloc_free(expanded);
+
+	return 0;
+}
+
+static int mod_bootstrap(CONF_SECTION *conf, void *instance)
+{
+	rlm_kafka_t *inst = instance;
+
+	inst->name = cf_section_name2(conf);
+	if (!inst->name) {
+		inst->name = cf_section_name1(conf);
+	}
+
+	xlat_register(inst->name, kafka_xlat, NULL, inst);
+
+	return 0;
+}
+
+static int rkt_by_name_cmp(void const *one, void const *two)
+{
+	rlm_kafka_rkt_by_name_t const *a = (rlm_kafka_rkt_by_name_t const *) one;
+	rlm_kafka_rkt_by_name_t const *b = (rlm_kafka_rkt_by_name_t const *) two;
+
+	return strcmp(a->name, b->name);
+}
+
+static int destruct_entry(rlm_kafka_rkt_by_name_t *entry) {
+	/*
+	 *  Destroy rkt only if we are the owner (not a reference)
+	 *
+	 */
+	if (!entry->ref && entry->rkt)
+		rd_kafka_topic_destroy(entry->rkt);
+	entry->rkt = NULL;
+	return 0;
+}
+
+static void free_rkt_by_name_entry(void *data)
+{
+	rlm_kafka_rkt_by_name_t *entry = (rlm_kafka_rkt_by_name_t *) data;
+	talloc_free(entry);
+}
+
+static int instantiate_topic(CONF_SECTION *cs, rlm_kafka_t *inst, char *errstr) {
+
+	CONF_PAIR		*cp;
+	rd_kafka_topic_conf_t	*tconf;
+	rd_kafka_topic_t	*rkt;
+	bool			ref = false;
+	rlm_kafka_rkt_by_name_t	*entry = NULL;
+	const char		*name = cf_section_name2(cs);
+
+	/*
+	 *  Short circuit for when we are given a reference to an existing topic
+	 *
+	 */
+	cp = cf_pair_find_next(cs, NULL, NULL);
+	if (cp) {
+		char const *attr = cf_pair_attr(cp);
+		char const *value = cf_pair_value(cp);
+
+		if (strcmp(attr, "reference") == 0) {
+			rlm_kafka_rkt_by_name_t my_topic;
+
+			my_topic.name = value;
+			entry = rbtree_finddata(inst->rkt_by_name_tree, &my_topic);
+			if (!entry || !entry->rkt) {
+				ERROR("Couldn't reference Kafka topic \"%s\" for \"%s\"",
+				      value, cf_section_name2(cs));
+				return -1;
+			}
+			if (cf_pair_find_next(cs, cp, NULL)) {
+				ERROR("A reference for another Kafka topic must be the only attribute");
+				return -1;
+			}
+			DEBUG3("Kafka topic \"%s\" configured as a reference to \"%s\"",
+			       cf_section_name2(cs), value);
+			rkt = entry->rkt;
+			ref = true;
+			goto finalise;
+		}
+	}
+
+	/*
+	 *  Configuration for the new topic
+	 *
+	 */
+	tconf = rd_kafka_topic_conf_new();
+
+	/*
+	 *  When synchronous, don't block for longer than a typical request timeout.
+	 *
+	 *  Can be overridden by message.timeout.ms in the topic conf_section
+	 */
+	if (!inst->async)
+		RLM_KAFKA_TOPIC_PROP_SET(tconf, "message.timeout.ms", "30000", errstr);
+
+	/*
+	 *  Set topic properties from the topic conf_section
+	 */
+	cp = NULL;
+	do {
+
+		cp = cf_pair_find_next(cs, cp, NULL);
+		if (cp) {
+			char const *attr = cf_pair_attr(cp);
+			char const *value = cf_pair_value(cp);
+			if (strcmp(attr, "name") == 0) {  /* Override section name */
+				name = value;
+				continue;
+			} else if (strcmp(attr, "reference") == 0) {
+				ERROR("A reference for another Kafka topic must be the only attribute");
+				rd_kafka_topic_conf_destroy(tconf);
+				return -1;
+			}
+			RLM_KAFKA_TOPIC_PROP_SET(tconf, attr, value, errstr);
+		}
+	} while (cp != NULL);
+
+	/*
+	 *  Show the topic configurations for debugging
+	 */
+	if (rad_debug_lvl >= L_DBG_LVL_3) {
+		size_t		cnt, i;
+		const char	**arr;
+
+		DEBUG3("Configuration for Kafka topic \"%s\":", name);
+		for (i = 0, arr = rd_kafka_topic_conf_dump(tconf, &cnt); i < cnt; i += 2)
+			DEBUG3("\t%s = %s", arr[i], arr[i + 1]);
+	}
+
+	/*
+	 *  And create the topic according to the configuration.
+	 *
+	 *  Upon success, the rkt assumes responsibility for tconf
+	 *
+	 */
+	rkt = rd_kafka_topic_new(inst->rk, name, tconf);
+	if (!rkt) {
+		ERROR("Failed to create Kafka topic \"%s\"", name);
+		rd_kafka_topic_conf_destroy(tconf);
+		return -1;
+	}
+
+finalise:
+
+	/*
+	 *  Finally insert the entry into the rbtree.
+	 *
+	 */
+	entry = talloc(NULL, rlm_kafka_rkt_by_name_t);
+	if (!entry)
+		return -1;
+	talloc_set_destructor(entry, destruct_entry);
+	entry->name = talloc_strdup(entry, cf_section_name2(cs));
+	if (!entry->name) {
+	fail:
+		talloc_free(entry);
+		return -1;
+	}
+	entry->rkt = rkt;
+	entry->ref = ref;
+
+	if (!rbtree_insert(inst->rkt_by_name_tree, entry))
+		goto fail;
+
+	DEBUG("Created Kafka topic for \"%s\"", name);
+
+	return 0;
+
+}
+
+static inline void set_section_rkt(rlm_kafka_t *inst, rlm_kafka_section_config_t *section)
+{
+	rlm_kafka_rkt_by_name_t	*entry, my_topic;
+
+	my_topic.name = cf_section_name1(section->cs);
+	entry = rbtree_finddata(inst->rkt_by_name_tree, &my_topic);
+	section->rkt = entry && entry->rkt ? entry->rkt : NULL;
+}
+
+static int mod_instantiate(CONF_SECTION *conf, void *instance)
+{
+	rlm_kafka_t		*inst = instance;
+	rd_kafka_conf_t		*kconf;
+	char			errstr[512];
+	CONF_PAIR		*cp = NULL;
+	CONF_SECTION		*cs;
+
+	/*
+	 *  Configuration for the global producer
+	 */
+	kconf = rd_kafka_conf_new();
+
+	rd_kafka_conf_set_opaque(kconf, inst);
+
+	DEBUG3("Registering Kafka logging callback");
+	rd_kafka_conf_set_log_cb(kconf, log_cb);
+
+	DEBUG3("Registering Kafka delivery report callback");
+	rd_kafka_conf_set_dr_msg_cb(kconf, dr_msg_cb);
+
+	if (inst->stats_filename) {
+		DEBUG3("Opening Kafka statistics file for writing: %s", inst->stats_filename);
+		inst->stats_file = fopen(inst->stats_filename, "a");
+		if (!inst->stats_file) {
+			ERROR("Error opening Kafka statistics file: %s", inst->stats_filename);
+			/* Carry on, just don't log stats */
+		} else {
+			DEBUG3("Registering Kafka statistics callback");
+			rd_kafka_conf_set_stats_cb(kconf, stats_cb);
+		}
+	}
+
+	RLM_KAFKA_PROP_SET(kconf, "bootstrap.servers", inst->bootstrap, errstr);
+
+	/*
+	 *  Set global properties from the global conf_section
+	 */
+	do {
+		CONF_SECTION	*gc = cf_section_sub_find(conf, "global-config");
+
+		cp = cf_pair_find_next(gc, cp, NULL);
+		if (cp) {
+			char const *attr, *value;
+			attr = cf_pair_attr(cp);
+			value = cf_pair_value(cp);
+			RLM_KAFKA_PROP_SET(kconf, attr, value, errstr);
+		}
+	} while (cp != NULL);
+
+	/*
+	 *  When configured to send synchronously, avoid plugging the requests
+	 *  since we are not batching and desire immediate responses.
+	 *
+	 *  Overrides and linger.ms that is set in the global conf_section.
+	 */
+	if (!inst->async)
+		RLM_KAFKA_PROP_SET(kconf, "linger.ms", "0", errstr);
+
+	/*
+	 *  Show the global configuration for debugging
+	 */
+	if (rad_debug_lvl >= L_DBG_LVL_3) {
+		size_t		cnt, i;
+		const char	**arr;
+
+		DEBUG3("Kafka global configuration:");
+		for (i = 0, arr = rd_kafka_conf_dump(kconf, &cnt); i < cnt; i += 2)
+			DEBUG3("\t%s = %s", arr[i], arr[i + 1]);
+	}
+
+	/*
+	 *  And create the producer according to the configuration, which sets
+	 *  up a separate handler ("rdk:main") thread and a set of
+	 *  "rdk:brokerN" threads, one per broker.
+	 *
+	 *  librdkafka attempts a lot of blunt (unconfigurable), global
+	 *  initialisation of dependent libraries here:
+	 *
+	 *    - cJSON library has it's allocation functions overridden, but
+	 *      just to wrappers around malloc / realloc / free, etc. so this
+	 *      is harmless.
+	 *    - An attempt is made to initialise cURL, however the cURL library
+	 *      maintains a reference count that prevents duplicate
+	 *      reinitialisation.
+	 *    - Cyrus SASL is similarly reference counted.
+	 *    - For OpenSSL < 1.1.0 there is an attempted reinitialisation that
+	 *      would clobber settings so at build time we enforce a minimum
+	 *      version that no longer requires global initialisation.
+	 *
+	 *  There may still be unknown cases where other module's configuration
+	 *  is trampled on, so best to test overall server functionality
+	 *  carefully when enabling this module.
+	 *
+	 */
+	inst->rk = rd_kafka_new(RD_KAFKA_PRODUCER, kconf, errstr, sizeof(errstr));
+	if (!inst->rk) {
+		ERROR("Failed to create new Kafka producer: %s\n", errstr);
+		rd_kafka_conf_destroy(kconf);
+		return -1;
+	}
+
+	/*
+	 *  Instantiate a topic for each named topic-config section
+	 *
+	 */
+	inst->rkt_by_name_tree = rbtree_create(instance, rkt_by_name_cmp, free_rkt_by_name_entry, 0);
+	if (!inst->rkt_by_name_tree) return -1;
+
+	for (cs = cf_subsection_find_next(conf, NULL, "topic-config");
+		cs != NULL;
+		cs = cf_subsection_find_next(conf, cs, "topic-config")) {
+
+		if (!cf_section_name2(cs)) {
+			WARN("Ignoring unnamed Kafka topic-config");
+			continue;
+		}
+
+		if (instantiate_topic(cs, inst, errstr) != 0) {
+			ERROR("Failed to instantiate new Kafka topic for %s\n",
+			      cf_section_name2(cs));
+			rbtree_free(inst->rkt_by_name_tree);
+			rd_kafka_destroy(inst->rk);
+			return -1;
+		}
+
+	}
+
+	/*
+	 *  Capture a self-reference for the sections
+	 */
+	inst->authorize.cs = cf_section_sub_find(conf, "authorize");
+	inst->postauth.cs = cf_section_sub_find(conf, "post-auth");
+	inst->accounting.cs = cf_section_sub_find(conf, "accounting");
+
+	/*
+	 *  Set the rkt for each section, where such configuration exists
+	 */
+	set_section_rkt(inst, &inst->authorize);
+	set_section_rkt(inst, &inst->postauth);
+	set_section_rkt(inst, &inst->accounting);
+
+	return 0;
+}
+
+static int mod_detach(UNUSED void *instance)
+{
+	rd_kafka_resp_err_t	err;
+	rlm_kafka_t		*inst = instance;
+
+	if (inst->stats_file) {
+		DEBUG3("Closing Kafka statistics file");
+		fclose(inst->stats_file);
+	}
+
+	DEBUG3("Flushing Kafka queues");
+	if ((err = rd_kafka_flush(inst->rk, 10*1000)) == RD_KAFKA_RESP_ERR__TIMED_OUT)
+		ERROR("Flush failed: %s\n", rd_kafka_err2str(err));
+
+	rbtree_free(inst->rkt_by_name_tree);
+
+	rd_kafka_destroy(inst->rk);
+
+	return 0;
+}
+
+/*
+ *      Common code called by everything below.
+ */
+static rlm_rcode_t CC_HINT(nonnull) kafka_common(void *instance, REQUEST *request, rlm_kafka_section_config_t *section)
+{
+
+	rlm_kafka_t		*inst = instance;
+	char			*key = NULL;
+	char			*message = NULL;
+	rd_kafka_headers_t	*hdrs = NULL;
+	CONF_ITEM		*item;
+	CONF_PAIR		*cp;
+	const char		*schema;
+	rlm_rcode_t		ret = RLM_MODULE_OK;
+	char			path[MAX_STRING_LEN];
+	char			*p = path;
+
+	if (!section->rkt) {
+		RWARN("No configuration exists for Kafka topic for %s section",
+			cf_section_name1(section->cs));
+		return RLM_MODULE_NOOP;
+	}
+
+	if (section->reference[0] != '.') {
+		*p++ = '.';
+	}
+
+	if (radius_xlat(p, sizeof(path) - (p - path), request, section->reference, NULL, NULL) < 0) {
+		return RLM_MODULE_FAIL;
+	}
+
+	item = cf_reference_item(NULL, section->cs, path);
+	if (!item) {
+		RDEBUG3("No such configuration item %s", path);
+		return RLM_MODULE_NOOP;
+	}
+	if (cf_item_is_section(item)) {
+		RDEBUG3("Sections are not supported as references");
+		return RLM_MODULE_NOOP;
+	}
+
+	cp = cf_item_to_pair(item);
+	schema = cf_pair_value(cp);
+
+	if (radius_axlat(&message, request, schema, NULL, NULL) < 0) {
+		REDEBUG("Failed to expand message schema");
+		return RLM_MODULE_FAIL;
+	}
+
+	if (section->key) {
+		if (radius_axlat(&key, request, section->key, NULL, NULL) < 0) {
+			REDEBUG("Failed to expand key");
+			talloc_free(message);
+			return RLM_MODULE_FAIL;
+		}
+	}
+
+	if (section->headers) {
+		if (create_headers(request, section->headers, &hdrs) < 0) {
+			REDEBUG("Failed to create headers");
+			talloc_free(message);
+			return RLM_MODULE_FAIL;
+		}
+	}
+
+	if (kafka_produce(inst, request, section->rkt,
+			  key, key ? strlen(key) : 0,
+			  message, strlen(message),
+			  hdrs, inst->async
+			 ) != 0)
+		ret = RLM_MODULE_FAIL;
+
+	talloc_free(key);
+	talloc_free(message);
+
+	return ret;
+}
+
+static inline rlm_rcode_t CC_HINT(nonnull) mod_authorize(void *instance, REQUEST *request)
+{
+	if (!((rlm_kafka_t*)instance)->authorize.cs)
+		return RLM_MODULE_NOOP;
+
+	return kafka_common(instance, request, &((rlm_kafka_t*)instance)->authorize);
+}
+
+static inline rlm_rcode_t CC_HINT(nonnull) mod_post_auth(void *instance, REQUEST *request)
+{
+	if (!((rlm_kafka_t*)instance)->postauth.cs)
+		return RLM_MODULE_NOOP;
+
+	return kafka_common(instance, request, &((rlm_kafka_t*)instance)->postauth);
+}
+
+#ifdef WITH_ACCOUNTING
+static inline rlm_rcode_t CC_HINT(nonnull) mod_accounting(void *instance, REQUEST *request)
+{
+	if (!((rlm_kafka_t*)instance)->accounting.cs)
+		return RLM_MODULE_NOOP;
+
+	return kafka_common(instance, request, &((rlm_kafka_t*)instance)->accounting);
+}
+#endif
+
+
+/*
+ *	The module name should be the only globally exported symbol.
+ *	That is, everything else should be 'static'.
+ *
+ *	If the module needs to temporarily modify it's instantiation
+ *	data, the type should be changed to RLM_TYPE_THREAD_UNSAFE.
+ *	The server will then take care of ensuring that the module
+ *	is single-threaded.
+ */
+extern module_t rlm_kafka;
+module_t rlm_kafka = {
+	.magic		= RLM_MODULE_INIT,
+	.name		= "kafka",
+	.type		= RLM_TYPE_THREAD_SAFE,
+	.inst_size	= sizeof(rlm_kafka_t),
+	.config		= module_config,
+	.bootstrap	= mod_bootstrap,
+	.instantiate	= mod_instantiate,
+	.detach		= mod_detach,
+	.methods	= {
+		[MOD_AUTHORIZE]		= mod_authorize,
+		[MOD_POST_AUTH]		= mod_post_auth,
+#ifdef WITH_ACCOUNTING
+		[MOD_ACCOUNTING]	= mod_accounting,
+#endif
+	},
+};
diff -urpN freeradius-server-3.2.7/src/modules/rlm_ldap/attrmap.c freeradius-server-3.2.8/src/modules/rlm_ldap/attrmap.c
--- freeradius-server-3.2.7/src/modules/rlm_ldap/attrmap.c	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/modules/rlm_ldap/attrmap.c	2025-08-20 23:29:15.000000000 +0700
@@ -15,7 +15,7 @@
  */
 
 /**
- * $Id: 05896975b203b1f50097946cc565c38f00ae3360 $
+ * $Id: 8e3d1b71e5faeff5f151c24dbca1848a3f05bb95 $
  * @file ldap.c
  * @brief Functions for mapping between LDAP and FreeRADIUS attributes.
  *
@@ -115,6 +115,9 @@ int rlm_ldap_map_getvalue(TALLOC_CTX *ct
 			vp = fr_pair_afrom_da(ctx, map->lhs->tmpl_da);
 			rad_assert(vp);
 
+			vp->op = map->op;
+			vp->tag = map->lhs->tmpl_tag;
+
 			if (fr_pair_value_from_str(vp, self->values[i]->bv_val, self->values[i]->bv_len) < 0) {
 				char *escaped;
 
@@ -126,7 +129,6 @@ int rlm_ldap_map_getvalue(TALLOC_CTX *ct
 				continue;
 			}
 
-			vp->op = map->op;
 			fr_cursor_insert(&cursor, vp);
 
 			/*
diff -urpN freeradius-server-3.2.7/src/modules/rlm_ldap/ldap.c freeradius-server-3.2.8/src/modules/rlm_ldap/ldap.c
--- freeradius-server-3.2.7/src/modules/rlm_ldap/ldap.c	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/modules/rlm_ldap/ldap.c	2025-08-20 23:29:15.000000000 +0700
@@ -15,7 +15,7 @@
  */
 
 /**
- * $Id: d35cb20f36257f39c233e59e9fd2f5f21e155278 $
+ * $Id: 19ff0b33164b50083ef50c1f671d8f431fa59ea0 $
  * @file ldap.c
  * @brief LDAP module library functions.
  *
@@ -1382,6 +1382,9 @@ int rlm_ldap_global_init(rlm_ldap_t *ins
 				WARN("!! There may be random issues with TLS connections due to this conflict.");
 				WARN("!! The server may also crash.");
 				WARN("!! See https://wiki.freeradius.org/modules/Rlm_ldap for more information.");
+				WARN("!!");
+				WARN("!! Perhaps also see https://ltb-project.org/download.html");
+				WARN("!! Which may have a pre-build package of libldap which links to OpenSSL.");
 				WARN("!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!");
 			}
 #if defined(LDAP_OPT_X_TLS_CTX) && defined(HAVE_OPENSSL_SSL_H)
diff -urpN freeradius-server-3.2.7/src/modules/rlm_mschap/mschap.c freeradius-server-3.2.8/src/modules/rlm_mschap/mschap.c
--- freeradius-server-3.2.7/src/modules/rlm_mschap/mschap.c	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/modules/rlm_mschap/mschap.c	2025-08-20 23:29:15.000000000 +0700
@@ -1,7 +1,7 @@
 /*
  * mschap.c
  *
- * Version:	$Id: 4e088ed962169313d0338ff59eb23e2b975129f4 $
+ * Version:	$Id: 759db2b69c6952b8ef99c824c233245bd9d15e00 $
  *
  *   This program is free software; you can redistribute it and/or modify
  *   it under the terms of the GNU General Public License as published by
@@ -28,7 +28,7 @@
  *
  */
 
-RCSID("$Id: 4e088ed962169313d0338ff59eb23e2b975129f4 $")
+RCSID("$Id: 759db2b69c6952b8ef99c824c233245bd9d15e00 $")
 
 #include	<freeradius-devel/radiusd.h>
 #include	<freeradius-devel/modules.h>
@@ -52,8 +52,14 @@ int mschap_ntpwdhash(uint8_t *out, char
 	ssize_t len;
 	uint8_t ucs2_password[512];
 
+	if (!password || !*password) {
+		fr_strerror_printf("Password is missing or is empty");
+		return -1;
+	}
+
 	len = fr_utf8_to_ucs2(ucs2_password, sizeof(ucs2_password), password, strlen(password));
 	if (len < 0) {
+		fr_strerror_printf("Password contains invalid UTF-8 characters, and cannot be converted to UCS2");
 		*out = '\0';
 		return -1;
 	}
diff -urpN freeradius-server-3.2.7/src/modules/rlm_mschap/rlm_mschap.c freeradius-server-3.2.8/src/modules/rlm_mschap/rlm_mschap.c
--- freeradius-server-3.2.7/src/modules/rlm_mschap/rlm_mschap.c	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/modules/rlm_mschap/rlm_mschap.c	2025-08-20 23:29:15.000000000 +0700
@@ -15,7 +15,7 @@
  */
 
 /**
- * $Id: 4742f9f9630936193c838790056c125fe681cf6d $
+ * $Id: 7ac5f6ac09bbf708bb884133f3369f65997dc1af $
  * @file rlm_mschap.c
  * @brief Implemented mschap authentication.
  *
@@ -23,7 +23,7 @@
  */
 
 /*  MPPE support from Takahiro Wagatsuma <waga@sic.shibaura-it.ac.jp> */
-RCSID("$Id: 4742f9f9630936193c838790056c125fe681cf6d $")
+RCSID("$Id: 7ac5f6ac09bbf708bb884133f3369f65997dc1af $")
 
 #include <freeradius-devel/radiusd.h>
 #include <freeradius-devel/modules.h>
@@ -1743,7 +1743,7 @@ static rlm_rcode_t CC_HINT(nonnull) mod_
 			nt_password->vp_octets = p = talloc_array(nt_password, uint8_t, nt_password->vp_length);
 
 			if (mschap_ntpwdhash(p, password->vp_strvalue) < 0) {
-				RERROR("Failed generating NT-Password");
+				RERROR("Failed generating NT-Password - %s", fr_strerror());
 				return RLM_MODULE_FAIL;
 			}
 		} else if (auth_method == AUTH_INTERNAL) {
diff -urpN freeradius-server-3.2.7/src/modules/rlm_pap/rlm_pap.c freeradius-server-3.2.8/src/modules/rlm_pap/rlm_pap.c
--- freeradius-server-3.2.7/src/modules/rlm_pap/rlm_pap.c	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/modules/rlm_pap/rlm_pap.c	2025-08-20 23:29:15.000000000 +0700
@@ -15,7 +15,7 @@
  */
 
 /**
- * $Id: 463ff66b7100bf15656efb90b55adc28e21e5e1f $
+ * $Id: a51febaab3af68bdda852c3c8ba01cc188ab4552 $
  * @file rlm_pap.c
  * @brief Hashes plaintext passwords to compare against a prehashed reference.
  *
@@ -23,7 +23,7 @@
  * @copyright 2012       Matthew Newton <matthew@newtoncomputing.co.uk>
  * @copyright 2001       Kostas Kalevras <kkalev@noc.ntua.gr>
  */
-RCSID("$Id: 463ff66b7100bf15656efb90b55adc28e21e5e1f $")
+RCSID("$Id: a51febaab3af68bdda852c3c8ba01cc188ab4552 $")
 USES_APPLE_DEPRECATED_API
 
 #include <freeradius-devel/radiusd.h>
@@ -96,6 +96,10 @@ static const FR_NAME_NUMBER header_names
 	{ "{ssha384}",		PW_SSHA2_384_PASSWORD },
 	{ "{ssha512}",		PW_SSHA2_512_PASSWORD },
 	{ "{x-pbkdf2}",		PW_PBKDF2_PASSWORD },
+	{ "{pbkdf2-sha1}",	PW_PBKDF2_SHA1_PASSWORD },
+	{ "{pbkdf2-sha256}",	PW_PBKDF2_SHA256_PASSWORD },
+	{ "{pbkdf2-sha512}",	PW_PBKDF2_SHA512_PASSWORD },
+	{ "{pbkdf2_sha256}",	PW_PBKDF2_SHA256_LEGACY_PASSWORD },
 #endif
 	{ "{sha}",		PW_SHA_PASSWORD },
 	{ "{ssha}",		PW_SSHA_PASSWORD },
@@ -857,10 +861,9 @@ static rlm_rcode_t CC_HINT(nonnull) pap_
  *	- RLM_MODULE_REJECT
  *	- RLM_MODULE_OK
  */
-static inline rlm_rcode_t CC_HINT(nonnull) pap_auth_pbkdf2_parse(REQUEST *request, const uint8_t *str, size_t len,
-								 const FR_NAME_NUMBER hash_names[],
-								 char scheme_sep, char iter_sep, char salt_sep,
-								 bool iter_is_base64, VALUE_PAIR const *password)
+static inline rlm_rcode_t CC_HINT(nonnull) pap_auth_pbkdf2_parse_digest(REQUEST *request, const uint8_t *str, size_t len,
+									int digest_type, char iter_sep, char salt_sep,
+									bool iter_is_base64, VALUE_PAIR const *password)
 {
 	rlm_rcode_t		rcode = RLM_MODULE_INVALID;
 
@@ -868,7 +871,6 @@ static inline rlm_rcode_t CC_HINT(nonnul
 	ssize_t			slen;
 
 	EVP_MD const		*evp_md;
-	int			digest_type;
 	size_t			digest_len;
 
 	uint32_t		iterations;
@@ -878,36 +880,12 @@ static inline rlm_rcode_t CC_HINT(nonnul
 	uint8_t			hash[EVP_MAX_MD_SIZE];
 	uint8_t			digest[EVP_MAX_MD_SIZE];
 
-	char 			hash_token[128];
-
-	RDEBUG2("Comparing with \"known-good\" PBKDF2-Password");
-
-	if (len <= 1) {
-		REDEBUG("PBKDF2-Password is too short");
-		goto finish;
-	}
-
 	/*
-	 *	Parse PBKDF string = {hash_algorithm}<scheme_sep><iterations><iter_sep>b64(<salt>)<salt_sep>b64(<hash>)
+	 *	Parse PBKDF string for given digest = <iterations><iter_sep>b64(<salt>)<salt_sep>b64(<hash>)
 	 */
 	p = str;
 	end = p + len;
 
-	q = memchr(p, scheme_sep, end - p);
-	if (!q) {
-		REDEBUG("PBKDF2-Password has no component separators");
-		goto finish;
-	}
-
-	if ((q-p) >= (int)sizeof(hash_token)) {
-		REDEBUG("PBKDF2-Password has invalid hash token");
-		goto finish;
-	}
-
-	memcpy(hash_token, (char const *)p, (q - p));
-	hash_token[q - p] = '\0';
-
-	digest_type = fr_str2int(hash_names, hash_token, -1);
 	switch (digest_type) {
 	case PW_SSHA1_PASSWORD:
 		evp_md = EVP_sha1();
@@ -957,12 +935,10 @@ static inline rlm_rcode_t CC_HINT(nonnul
 #  endif
 
 	default:
-		REDEBUG("Unknown PBKDF2 hash method \"%.*s\"", (int)(q - p), p);
+		REDEBUG("Unknown PBKDF2 digest type \"%id\"", digest_type);
 		goto finish;
 	}
 
-	p = q + 1;
-
 	if (((end - p) < 1) || !(q = memchr(p, iter_sep, end - p))) {
 		REDEBUG("PBKDF2-Password missing iterations component");
 		goto finish;
@@ -1085,6 +1061,65 @@ finish:
 	return rcode;
 }
 
+/** Validates Crypt::PBKDF2 LDAP format strings
+ *
+ * @param[in] request	The current request.
+ * @param[in] str	Raw PBKDF2 string.
+ * @param[in] len	Length of string.
+ * @return
+ *	- RLM_MODULE_REJECT
+ *	- RLM_MODULE_OK
+ */
+static inline rlm_rcode_t CC_HINT(nonnull) pap_auth_pbkdf2_parse(REQUEST *request, const uint8_t *str, size_t len,
+								 const FR_NAME_NUMBER hash_names[],
+								 char scheme_sep, char iter_sep, char salt_sep,
+								 bool iter_is_base64, VALUE_PAIR const *password)
+{
+	rlm_rcode_t		rcode = RLM_MODULE_INVALID;
+
+	uint8_t const		*p, *q, *end;
+	int			digest_type;
+
+	char 			hash_token[128];
+
+	RDEBUG2("Comparing with \"known-good\" PBKDF2-Password");
+
+	if (len <= 1) {
+		REDEBUG("PBKDF2-Password is too short");
+		goto finish;
+	}
+
+	/*
+	 *	Parse PBKDF string = {hash_algorithm}<scheme_sep><iterations><iter_sep>b64(<salt>)<salt_sep>b64(<hash>)
+	 */
+	p = str;
+	end = p + len;
+
+	q = memchr(p, scheme_sep, end - p);
+	if (!q) {
+		REDEBUG("PBKDF2-Password has no component separators");
+		goto finish;
+	}
+
+	if ((q-p) >= (int)sizeof(hash_token)) {
+		REDEBUG("PBKDF2-Password has invalid hash token");
+		goto finish;
+	}
+
+	memcpy(hash_token, (char const *)p, (q - p));
+	hash_token[q - p] = '\0';
+
+	digest_type = fr_str2int(hash_names, hash_token, -1);
+
+	p = q + 1;
+
+	return pap_auth_pbkdf2_parse_digest(request, p, end - p, digest_type, iter_sep, salt_sep, iter_is_base64, password);
+
+finish:
+
+	return rcode;
+}
+
 static rlm_rcode_t CC_HINT(nonnull) pap_auth_pbkdf2(UNUSED rlm_pap_t *inst, REQUEST *request, VALUE_PAIR *password)
 {
 	uint8_t const *p = password->vp_octets, *q, *end = p + password->vp_length;
@@ -1099,20 +1134,30 @@ static rlm_rcode_t CC_HINT(nonnull) pap_
 
 	/*
 	 *	If it doesn't begin with a $ assume
-	 *	It's Crypt::PBKDF2 LDAP format
+	 *	it's Crypt::PBKDF2 LDAP format
 	 *
 	 *	{X-PBKDF2}<digest>:<b64 rounds>:<b64_salt>:<b64_hash>
+	 *
+	 *	or 389ds LDAP format
+	 *
+	 *	{PBKDF2-SHA512}<round>$<b64_salt>$<b64_hash>
 	 */
 	if (*p != '$') {
-		/*
-		 *	Strip the header if it's present
-		 */
-		if (*p == '{') {
-			q = memchr(p, '}', end - p);
-			p = q + 1;
+		if ((size_t)(end - p) >= sizeof("{PBKDF2-") && (memcmp(p, "{PBKDF2-", sizeof("{PBKDF2-") - 1) == 0)) {
+			p += sizeof("{PBKDF2-") - 1;
+			return pap_auth_pbkdf2_parse(request, p, end - p,
+						     pbkdf2_passlib_names, '}', '$', '$', false, request->password);
+		} else {
+			/*
+			 *	Strip the header if it's present
+			 */
+			if (*p == '{') {
+				q = memchr(p, '}', end - p);
+				p = q + 1;
+			}
+			return pap_auth_pbkdf2_parse(request, p, end - p,
+						     pbkdf2_crypt_names, ':', ':', ':', true, request->password);
 		}
-		return pap_auth_pbkdf2_parse(request, p, end - p,
-					     pbkdf2_crypt_names, ':', ':', ':', true, request->password);
 	}
 
 	/*
@@ -1143,6 +1188,132 @@ static rlm_rcode_t CC_HINT(nonnull) pap_
 
 	return RLM_MODULE_INVALID;
 }
+
+static rlm_rcode_t CC_HINT(nonnull) pap_auth_pbkdf2_sha1(UNUSED rlm_pap_t *inst, REQUEST *request, VALUE_PAIR *password)
+{
+	uint8_t const *p = password->vp_octets, *end = p + password->vp_length;
+
+	rad_assert(request->password != NULL);
+	rad_assert(request->password->da->attr == PW_USER_PASSWORD);
+
+	if ((end - p) < 2) {
+		REDEBUG("Password-With-Header {PBKDF2-SHA1} too short");
+		return RLM_MODULE_INVALID;
+	}
+
+	return pap_auth_pbkdf2_parse_digest(request, p, end - p, PW_SSHA1_PASSWORD, '$', '$', false, request->password);
+}
+
+static rlm_rcode_t CC_HINT(nonnull) pap_auth_pbkdf2_sha256(UNUSED rlm_pap_t *inst, REQUEST *request, VALUE_PAIR *password)
+{
+	uint8_t const *p = password->vp_octets, *end = p + password->vp_length;
+
+	rad_assert(request->password != NULL);
+	rad_assert(request->password->da->attr == PW_USER_PASSWORD);
+
+	if ((end - p) < 2) {
+		REDEBUG("Password-With-Header {PBKDF2-SHA256} too short");
+		return RLM_MODULE_INVALID;
+	}
+
+	return pap_auth_pbkdf2_parse_digest(request, p, end - p, PW_SSHA2_256_PASSWORD, '$', '$', false, request->password);
+}
+
+static rlm_rcode_t CC_HINT(nonnull) pap_auth_pbkdf2_sha512(UNUSED rlm_pap_t *inst, REQUEST *request, VALUE_PAIR *password)
+{
+	uint8_t const *p = password->vp_octets, *end = p + password->vp_length;
+
+	rad_assert(request->password != NULL);
+	rad_assert(request->password->da->attr == PW_USER_PASSWORD);
+
+	if ((end - p) < 2) {
+		REDEBUG("Password-With-Header {PBKDF2-SHA512} too short");
+		return RLM_MODULE_INVALID;
+	}
+
+	return pap_auth_pbkdf2_parse_digest(request, p, end - p, PW_SSHA2_512_PASSWORD, '$', '$', false, request->password);
+}
+
+/*
+ *	389ds pbkdf2 legacy password with header {PBKDF2_SHA256}
+ *
+ *	this was the first implementation in 389ds using a fixed length struct as base64.
+ *	at some point it was the default scheme, although it's not recommened anymore.
+ *
+ *      content struct is
+ *      4 bytes iterations (value 8192)
+ *      64 bytes salt
+ *	256 bytes hash
+ */
+static inline rlm_rcode_t CC_HINT(nonnull) pap_auth_pbkdf2_sha256_legacy(UNUSED rlm_pap_t *inst, REQUEST *request, VALUE_PAIR *password)
+{
+#define PBKDF2_SHA256_LEGACY_SALT_LENGTH 64
+#define PBKDF2_SHA256_LEGACY_ITERATIONS_LENGTH 4
+#define PBKDF2_SHA256_LEGACY_HASH_LENGTH 256
+#define PBKDF2_SHA256_LEGACY_TOTAL_LENGTH (PBKDF2_SHA256_LEGACY_ITERATIONS_LENGTH + PBKDF2_SHA256_LEGACY_SALT_LENGTH + PBKDF2_SHA256_LEGACY_HASH_LENGTH)
+#define PBKDF2_SHA256_LEGACY_ITERATIONS 8192
+#define PBKDF2_SHA256_LEGACY_B64_LENGTH (PBKDF2_SHA256_LEGACY_TOTAL_LENGTH * 4 / 3)
+
+	struct pbkdf2_bufs {
+		uint32_t	iterations;
+		uint8_t		salt[PBKDF2_SHA256_LEGACY_SALT_LENGTH];
+		uint8_t		hash[PBKDF2_SHA256_LEGACY_HASH_LENGTH];
+		uint8_t		padding[1]; /* extra padding because fr_base64_decode incorrectly determines minimal size */
+	};
+	struct pbkdf2_bufs 	pbkdf2_buf = { .iterations = PBKDF2_SHA256_LEGACY_ITERATIONS };
+
+	ssize_t			slen;
+	uint8_t const 		*p = password->vp_octets, *end = p + password->vp_length;
+
+	EVP_MD const		*evp_md = EVP_sha256();
+	size_t			digest_len = SHA256_DIGEST_LENGTH;
+	uint8_t			digest[SHA256_DIGEST_LENGTH];
+
+	rad_assert(request->password != NULL);
+	rad_assert(request->password->da->attr == PW_USER_PASSWORD);
+
+	if ((end - p) != PBKDF2_SHA256_LEGACY_B64_LENGTH) {
+		REDEBUG("Password-With-Header {PBKDF2_SHA256} has incorrect size %zd instead of %d.", password->vp_length, PBKDF2_SHA256_LEGACY_B64_LENGTH);
+		return RLM_MODULE_INVALID;
+	}
+
+	(void)fr_strerror();
+	slen = fr_base64_decode((uint8_t *)&pbkdf2_buf, sizeof(pbkdf2_buf), (char const *)p, end - p);
+
+	if (slen <= 0) {
+		REDEBUG("Failed decoding Password-With-Header {PBKDF2_SHA256}: \"%.*s\"", (int)(end - p), p);
+		return RLM_MODULE_INVALID;
+	}
+
+	if (slen != PBKDF2_SHA256_LEGACY_TOTAL_LENGTH) {
+		REDEBUG("Password-With-Header {PBKDF2_SHA256} has incorrect decoded size %zd instead of %d.", slen, PBKDF2_SHA256_LEGACY_TOTAL_LENGTH);
+		return RLM_MODULE_INVALID;
+	}
+
+	pbkdf2_buf.iterations = ntohl(pbkdf2_buf.iterations);
+
+	if (pbkdf2_buf.iterations != PBKDF2_SHA256_LEGACY_ITERATIONS) {
+		REDEBUG("Password-With-Header {PBKDF2_SHA256} has unexpected number of iterations %d instead of %d.", pbkdf2_buf.iterations, PBKDF2_SHA256_LEGACY_ITERATIONS);
+		return RLM_MODULE_INVALID;
+	}
+
+	if (PKCS5_PBKDF2_HMAC((char const *)request->password->vp_octets, (int)request->password->vp_length,
+			      (unsigned char const *)pbkdf2_buf.salt, (int)PBKDF2_SHA256_LEGACY_SALT_LENGTH,
+			      (int)pbkdf2_buf.iterations,
+			      evp_md,
+			      (int)digest_len, (unsigned char *)digest) == 0) {
+		REDEBUG("PBKDF2_SHA256 digest failure");
+		return RLM_MODULE_INVALID;
+	}
+
+	if (rad_digest_cmp(digest, pbkdf2_buf.hash, (size_t)digest_len) != 0) {
+		REDEBUG("PBKDF2_SHA256 digest does not match \"known good\" digest");
+		return RLM_MODULE_REJECT;
+	} else {
+		return RLM_MODULE_OK;
+	}
+}
+
 #endif
 
 static rlm_rcode_t CC_HINT(nonnull) pap_auth_nt(rlm_pap_t *inst, REQUEST *request, VALUE_PAIR *vp)
@@ -1344,6 +1515,22 @@ static rlm_rcode_t CC_HINT(nonnull) mod_
 		case PW_PBKDF2_PASSWORD:
 			auth_func = &pap_auth_pbkdf2;
 			break;
+
+		case PW_PBKDF2_SHA1_PASSWORD:
+			auth_func = &pap_auth_pbkdf2_sha1;
+			break;
+
+		case PW_PBKDF2_SHA256_PASSWORD:
+			auth_func = &pap_auth_pbkdf2_sha256;
+			break;
+
+		case PW_PBKDF2_SHA512_PASSWORD:
+			auth_func = &pap_auth_pbkdf2_sha512;
+			break;
+
+		case PW_PBKDF2_SHA256_LEGACY_PASSWORD:
+			auth_func = &pap_auth_pbkdf2_sha256_legacy;
+			break;
 #endif
 
 		case PW_SHA_PASSWORD:
diff -urpN freeradius-server-3.2.7/src/modules/rlm_proxy_rate_limit/rlm_proxy_rate_limit.c freeradius-server-3.2.8/src/modules/rlm_proxy_rate_limit/rlm_proxy_rate_limit.c
--- freeradius-server-3.2.7/src/modules/rlm_proxy_rate_limit/rlm_proxy_rate_limit.c	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/modules/rlm_proxy_rate_limit/rlm_proxy_rate_limit.c	2025-08-20 23:29:15.000000000 +0700
@@ -18,13 +18,13 @@
  */
 
 /**
- * $Id: 1fe5bcc7415247e903312b91b8b9c24b9b13ee41 $
+ * $Id: 1f8b348dc4802ecc7cde5f95e2cc96ccc0f7302d $
  * @file rlm_proxy_rate_limit.c
  * @brief Rate limiting when proxying requests
  *
  * @copyright 2024 Network RADIUS SAS (legal@networkradius.com)
  */
-RCSID("$Id: 1fe5bcc7415247e903312b91b8b9c24b9b13ee41 $")
+RCSID("$Id: 1f8b348dc4802ecc7cde5f95e2cc96ccc0f7302d $")
 
 #include <freeradius-devel/radiusd.h>
 #include <freeradius-devel/modules.h>
@@ -190,29 +190,28 @@ static rlm_proxy_rate_limit_table_t* der
  *	Check whether we have recently seen repeated Access-Rejects for this username
  *      and calling station, and if this is a new request then issue an Access-Reject
  */
-static rlm_rcode_t CC_HINT(nonnull) mod_pre_proxy(void * instance, REQUEST *request)
+static int CC_HINT(nonnull) mod_common(void * instance, REQUEST *request)
 {
 	rlm_proxy_rate_limit_t		*inst = instance;
 	char				key[512];
 	size_t				key_len = sizeof(key);
 	rlm_proxy_rate_limit_table_t	*table;
 	rlm_proxy_rate_limit_entry_t	*entry, my_entry;
-	VALUE_PAIR			*vp;
 
 	if (!(table = derive_key_and_table(inst, request, key, &key_len)))
-		return RLM_MODULE_OK;
+		return 0;
 
 	my_entry.key = key;
 	my_entry.key_len = key_len;
 	entry = rbtree_finddata(table->tree, &my_entry);
 
 	if (!entry)
-		return RLM_MODULE_OK;
+		return 0;
 
 	if (entry->expires <= request->timestamp) {
 		RDEBUG3("Rate limit entry %.*s (%d) has expired", 6, entry->key, entry->table->id);
 		rbtree_deletebydata(table->tree, entry);
-		return RLM_MODULE_OK;
+		return 0;
 	};
 
 	/*
@@ -224,7 +223,7 @@ static rlm_rcode_t CC_HINT(nonnull) mod_
 	 *	retransmissions.
 	 */
 	if (!entry->active || entry->last_id == request->packet->id)
-		return RLM_MODULE_OK;
+		return 0;
 
 	RDEBUG("Active rate limit entry %.*s (%d) matched for new request. Cancelling proxy "
 		"and sending Access-Reject. Instance %d.", 6, entry->key, entry->table->id, entry->count);
@@ -252,6 +251,14 @@ static rlm_rcode_t CC_HINT(nonnull) mod_
 
 	entry->last_request = request->timestamp;
 	entry->count++;
+	return -1;
+}
+
+static rlm_rcode_t CC_HINT(nonnull) mod_pre_proxy(void * instance, REQUEST *request)
+{
+	VALUE_PAIR			*vp;
+
+	if (mod_common(instance, request) == 0) return RLM_MODULE_NOOP;
 
 	/*
 	 *  This new request arrived within the suppression interval. Don't proxy but
@@ -269,7 +276,21 @@ static rlm_rcode_t CC_HINT(nonnull) mod_
 		REDEBUG("Failed creating Reply-Message");
 
 	return RLM_MODULE_FAIL;
+}
+
+static rlm_rcode_t CC_HINT(nonnull) mod_authorize(void * instance, REQUEST *request)
+{
+	VALUE_PAIR			*vp;
+
+	if (mod_common(instance, request) == 0) return RLM_MODULE_NOOP;
+
+	fr_pair_list_free(&request->reply->vps);
+
+	vp = pair_make_reply("Reply-Message", "Proxy rate limit exceeded", T_OP_EQ);
+	if (!vp)
+		REDEBUG("Failed creating Reply-Message");
 
+	return RLM_MODULE_REJECT;
 }
 
 /*
@@ -506,6 +527,7 @@ module_t rlm_proxy_rate_limit = {
 	.instantiate	= mod_instantiate,
 	.detach		= mod_detach,
 	.methods = {
+		[MOD_AUTHORIZE]		= mod_authorize,
 		[MOD_PRE_PROXY]		= mod_pre_proxy,
 		[MOD_POST_PROXY]	= mod_post_proxy,
 	},
diff -urpN freeradius-server-3.2.7/src/modules/rlm_python/rlm_python.c freeradius-server-3.2.8/src/modules/rlm_python/rlm_python.c
--- freeradius-server-3.2.7/src/modules/rlm_python/rlm_python.c	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/modules/rlm_python/rlm_python.c	2025-08-20 23:29:15.000000000 +0700
@@ -15,7 +15,7 @@
  */
 
 /**
- * $Id: 412859c06bc33a7485a5c61bfe045f4beb25b5aa $
+ * $Id: 88634cd30fb834f32092844ddfaf7b85d4703bf6 $
  * @file rlm_python.c
  * @brief Translates requests between the server an a python interpreter.
  *
@@ -25,7 +25,7 @@
  * @copyright 2002  Miguel A.L. Paraz <mparaz@mparaz.com>
  * @copyright 2002  Imperium Technology, Inc.
  */
-RCSID("$Id: 412859c06bc33a7485a5c61bfe045f4beb25b5aa $")
+RCSID("$Id: 88634cd30fb834f32092844ddfaf7b85d4703bf6 $")
 
 #define LOG_PREFIX "rlm_python - "
 
@@ -347,11 +347,7 @@ static void mod_vptuple(TALLOC_CTX *ctx,
 		}
 
 		vp->op = op;
-
-		/*
-		 *	@todo - use tmpl_cast_to_vp() instead ???
-		 */
-		if (vp->da->flags.has_tag) vp->tag = dst.tmpl_tag;
+		vp->tag = dst.tmpl_tag;
 
 		if (fr_pair_value_from_str(vp, s2, -1) < 0) {
 			DEBUG("%s - Failed: '%s:%s' %s '%s'", funcname, list_name, s1,
diff -urpN freeradius-server-3.2.7/src/modules/rlm_python3/rlm_python3.c freeradius-server-3.2.8/src/modules/rlm_python3/rlm_python3.c
--- freeradius-server-3.2.7/src/modules/rlm_python3/rlm_python3.c	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/modules/rlm_python3/rlm_python3.c	2025-08-20 23:29:15.000000000 +0700
@@ -15,7 +15,7 @@
  */
 
 /**
- * $Id: 4f0f68d7f3416ff362de68b87c09b05b5981826b $
+ * $Id: 6df12086a74ce57993ba62a682ec4a2a963f3098 $
  * @file rlm_python3.c
  * @brief Translates requests between the server an a python interpreter.
  *
@@ -25,7 +25,7 @@
  * @copyright 2002  Miguel A.L. Paraz <mparaz@mparaz.com>
  * @copyright 2002  Imperium Technology, Inc.
  */
-RCSID("$Id: 4f0f68d7f3416ff362de68b87c09b05b5981826b $")
+RCSID("$Id: 6df12086a74ce57993ba62a682ec4a2a963f3098 $")
 
 #define LOG_PREFIX "rlm_python3 - "
 
@@ -360,11 +360,7 @@ static void mod_vptuple(TALLOC_CTX *ctx,
 		}
 
 		vp->op = op;
-
-		/*
-		 *	@todo - use tmpl_cast_to_vp() instead ???
-		 */
-		if (vp->da->flags.has_tag) vp->tag = dst.tmpl_tag;
+		vp->tag = dst.tmpl_tag;
 
 		if (fr_pair_value_from_str(vp, s2, -1) < 0) {
 			DEBUG("%s - Failed: '%s:%s' %s '%s'", funcname, list_name, s1,
@@ -705,7 +701,6 @@ static void python_interpreter_free(PyTh
 	PyEval_RestoreThread(interp);
 	PyThreadState_Swap(interp);
 	Py_EndInterpreter(interp);
-	PyEval_SaveThread();
 }
 
 /** Destroy a thread state
@@ -1125,7 +1120,7 @@ static int python_interpreter_init(rlm_p
 	/*
 	 * prepare radiusd module to be loaded
 	 */
-	if (!inst->cext_compat || !main_module) {
+	if ((!inst->cext_compat || !main_module) && (python_instances == 0)) {
 		/*
 		 * This is ugly, but there is no other way to pass parameters to PyMODINIT_FUNC
 		 */
@@ -1188,7 +1183,7 @@ static int python_interpreter_init(rlm_p
 
 #if PY_VERSION_HEX <= 0x030a0000
 		Py_InitializeEx(0);			/* Don't override signal handlers - noop on subs calls */
-#if PY_VERSION_HEX <= 0x03060000
+#if PY_VERSION_HEX < 0x03070000
 		PyEval_InitThreads(); 			/* This also grabs a lock (which we then need to release) */
 #endif
 #endif
@@ -1210,6 +1205,7 @@ static int python_interpreter_init(rlm_p
 	 */
 	if (!inst->cext_compat) {
 		inst->sub_interpreter = Py_NewInterpreter();
+		locked = true;
 	} else {
 		inst->sub_interpreter = main_interpreter;
 	}
diff -urpN freeradius-server-3.2.7/src/modules/rlm_redis/rlm_redis.c freeradius-server-3.2.8/src/modules/rlm_redis/rlm_redis.c
--- freeradius-server-3.2.7/src/modules/rlm_redis/rlm_redis.c	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/modules/rlm_redis/rlm_redis.c	2025-08-20 23:29:15.000000000 +0700
@@ -15,7 +15,7 @@
  */
 
 /**
- * $Id: 31bf5bd44f26933a2fa22e6a7baf701bc673dac8 $
+ * $Id: e7eb9f527c5b994fcd74e9d3d412ba625dc67d4f $
  * @file rlm_redis.c
  * @brief Driver for the REDIS noSQL key value stores.
  *
@@ -23,7 +23,7 @@
  * @copyright 2011  TekSavvy Solutions <gabe@teksavvy.com>
  */
 
-RCSID("$Id: 31bf5bd44f26933a2fa22e6a7baf701bc673dac8 $")
+RCSID("$Id: e7eb9f527c5b994fcd74e9d3d412ba625dc67d4f $")
 
 #include <freeradius-devel/radiusd.h>
 #include <freeradius-devel/modules.h>
@@ -186,13 +186,15 @@ static ssize_t redis_xlat(void *instance
 		break;
 
 	default:
-		buffer_ptr = NULL;
-		break;
+		RDEBUG("rlm_redis (%s): Unsupported result %d from redis",
+		       inst->xlat_name, dissocket->reply->type);
+		ret = -1;
+		goto release;
 	}
 
-	if ((ret >= freespace) || (!buffer_ptr)) {
-		RDEBUG("rlm_redis (%s): Can't write result, insufficient space or unsupported result\n",
-		       inst->xlat_name);
+	if (ret >= freespace) {
+		RDEBUG("rlm_redis (%s): Can't write result (%zd), insufficient space (%zd)",
+		       inst->xlat_name, ret, freespace);
 		ret = -1;
 		goto release;
 	}
diff -urpN freeradius-server-3.2.7/src/modules/rlm_replicate/rlm_replicate.c freeradius-server-3.2.8/src/modules/rlm_replicate/rlm_replicate.c
--- freeradius-server-3.2.7/src/modules/rlm_replicate/rlm_replicate.c	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/modules/rlm_replicate/rlm_replicate.c	2025-08-20 23:29:15.000000000 +0700
@@ -15,13 +15,13 @@
  */
 
 /**
- * $Id: cee26cc97ad4409f08874a557ba46fbe36495fd9 $
+ * $Id: df6579b0c45c2b6c8d8d5fad15e5719de3db1d8b $
  * @file rlm_replicate.c
  * @brief Duplicate RADIUS requests.
  *
  * @copyright 2011-2013  The FreeRADIUS server project
  */
-RCSID("$Id: cee26cc97ad4409f08874a557ba46fbe36495fd9 $")
+RCSID("$Id: df6579b0c45c2b6c8d8d5fad15e5719de3db1d8b $")
 
 #include <freeradius-devel/radiusd.h>
 #include <freeradius-devel/modules.h>
@@ -197,7 +197,7 @@ static int replicate_packet(UNUSED void
 		 */
 		packet->dst_ipaddr = home->ipaddr;
 		packet->dst_port = home->port;
-		memset(&packet->src_ipaddr, 0, sizeof(packet->src_ipaddr));
+		packet->src_ipaddr = home->src_ipaddr;
 		packet->src_port = 0;
 
 		/*
diff -urpN freeradius-server-3.2.7/src/modules/rlm_rest/rest.c freeradius-server-3.2.8/src/modules/rlm_rest/rest.c
--- freeradius-server-3.2.7/src/modules/rlm_rest/rest.c	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/modules/rlm_rest/rest.c	2025-08-20 23:29:15.000000000 +0700
@@ -15,7 +15,7 @@
  */
 
 /**
- * $Id: d18c0084575951f3d27b8aa287c17cedc83527bf $
+ * $Id: 34a2952129afbace2b01a4bac62666fa117d663f $
  *
  * @brief Functions and datatypes for the REST (HTTP) transport.
  * @file rest.c
@@ -23,7 +23,7 @@
  * @copyright 2012-2014  Arran Cudbard-Bell <a.cudbard-bell@freeradius.org>
  */
 
-RCSID("$Id: d18c0084575951f3d27b8aa287c17cedc83527bf $")
+RCSID("$Id: 34a2952129afbace2b01a4bac62666fa117d663f $")
 
 #include <ctype.h>
 #include <string.h>
@@ -1294,6 +1294,9 @@ static VALUE_PAIR *json_pair_make_leaf(U
 		return NULL;
 	}
 
+	vp->op = flags->op;
+	vp->tag = flags->tag;
+
 	ret = fr_pair_value_from_str(vp, to_parse, -1);
 	talloc_free(expanded);
 	if (ret < 0) {
@@ -1303,9 +1306,6 @@ static VALUE_PAIR *json_pair_make_leaf(U
 		return NULL;
 	}
 
-	vp->op = flags->op;
-	vp->tag = flags->tag;
-
 	return vp;
 }
 
diff -urpN freeradius-server-3.2.7/src/modules/rlm_sql/drivers/rlm_sql_oracle/rlm_sql_oracle.c freeradius-server-3.2.8/src/modules/rlm_sql/drivers/rlm_sql_oracle/rlm_sql_oracle.c
--- freeradius-server-3.2.7/src/modules/rlm_sql/drivers/rlm_sql_oracle/rlm_sql_oracle.c	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/modules/rlm_sql/drivers/rlm_sql_oracle/rlm_sql_oracle.c	2025-08-20 23:29:15.000000000 +0700
@@ -19,7 +19,7 @@
  * Copyright 2000  David Kerry <davidk@snti.com>
  */
 
-RCSID("$Id: bfddcc5dea45d46b23cd63b49fda7d502a773c94 $")
+RCSID("$Id: db1b49f913498dc0702db46ba0a0bd41452a7a02 $")
 
 #include <freeradius-devel/radiusd.h>
 #include <freeradius-devel/rad_assert.h>
@@ -132,7 +132,6 @@ static int sql_check_error(rlm_sql_handl
 static int _sql_socket_destructor(rlm_sql_oracle_conn_t *conn)
 {
 	if (conn->ctx) OCILogoff(conn->ctx, conn->error);
-	if (conn->query) OCIHandleFree((dvoid *)conn->query, OCI_HTYPE_STMT);
 	if (conn->error) OCIHandleFree((dvoid *)conn->error, OCI_HTYPE_ERROR);
 	if (conn->env) OCIHandleFree((dvoid *)conn->env, OCI_HTYPE_ENV);
 
@@ -167,16 +166,6 @@ static sql_rcode_t sql_socket_init(rlm_s
 	}
 
 	/*
-	 *	Allocate handles for select and update queries
-	 */
-	if (OCIHandleAlloc((dvoid *)conn->env, (dvoid **)&conn->query, OCI_HTYPE_STMT, 0, NULL)) {
-		ERROR("rlm_sql_oracle: Couldn't init Oracle query handles: %s",
-		      (sql_prints_error(errbuff, sizeof(errbuff), handle, config) == 0) ? errbuff : "unknown");
-
-		return RLM_SQL_ERROR;
-	}
-
-	/*
 	 *	Login to the oracle server
 	 */
 	if (OCILogon(conn->env, conn->error, &conn->ctx,
@@ -219,8 +208,8 @@ static sql_rcode_t sql_query(rlm_sql_han
 		return RLM_SQL_RECONNECT;
 	}
 
-	if (OCIStmtPrepare(conn->query, conn->error, oracle_query, strlen(query),
-			   OCI_NTV_SYNTAX, OCI_DEFAULT)) {
+	if (OCIStmtPrepare2(conn->ctx, &conn->query, conn->error, oracle_query, strlen(query),
+			   NULL, 0, OCI_NTV_SYNTAX, OCI_DEFAULT)) {
 		ERROR("rlm_sql_oracle: prepare failed in sql_query");
 
 		return RLM_SQL_ERROR;
@@ -259,8 +248,8 @@ static sql_rcode_t sql_select_query(rlm_
 
 	memcpy(&oracle_query, &query, sizeof(oracle_query));
 
-	if (OCIStmtPrepare(conn->query, conn->error, oracle_query, strlen(query), OCI_NTV_SYNTAX,
-			   OCI_DEFAULT)) {
+	if (OCIStmtPrepare2(conn->ctx, &conn->query, conn->error, oracle_query, strlen(query),
+			    NULL, 0, OCI_NTV_SYNTAX, OCI_DEFAULT)) {
 		ERROR("rlm_sql_oracle: prepare failed in sql_select_query");
 
 		return RLM_SQL_ERROR;
diff -urpN freeradius-server-3.2.7/src/modules/rlm_sql/rlm_sql.c freeradius-server-3.2.8/src/modules/rlm_sql/rlm_sql.c
--- freeradius-server-3.2.7/src/modules/rlm_sql/rlm_sql.c	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/modules/rlm_sql/rlm_sql.c	2025-08-20 23:29:15.000000000 +0700
@@ -15,7 +15,7 @@
  */
 
 /**
- * $Id: 9d21243683894524f6e80096ecdda40a7fe3851f $
+ * $Id: 762654feb2d5365df8baa20fc9305df9e51f8de6 $
  * @file rlm_sql.c
  * @brief Implements SQL 'users' file, and SQL accounting.
  *
@@ -24,7 +24,7 @@
  * @copyright 2000  Mike Machado <mike@innercite.com>
  * @copyright 2000  Alan DeKok <aland@ox.org>
  */
-RCSID("$Id: 9d21243683894524f6e80096ecdda40a7fe3851f $")
+RCSID("$Id: 762654feb2d5365df8baa20fc9305df9e51f8de6 $")
 
 #include <ctype.h>
 
@@ -111,6 +111,7 @@ static const CONF_PARSER module_config[]
 	{ "safe-characters", FR_CONF_OFFSET(PW_TYPE_STRING | PW_TYPE_DEPRECATED, rlm_sql_config_t, allowed_chars), NULL },
 	{ "safe_characters", FR_CONF_OFFSET(PW_TYPE_STRING, rlm_sql_config_t, allowed_chars), "@abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789.-_: /" },
 	{ "auto_escape", FR_CONF_OFFSET(PW_TYPE_BOOLEAN, rlm_sql_config_t, driver_specific_escape), "no" },
+	{ "record_query_number", FR_CONF_OFFSET(PW_TYPE_BOOLEAN, rlm_sql_config_t, record_query_number), "no" },
 
 	/*
 	 *	This only works for a few drivers.
@@ -1396,6 +1397,7 @@ static int acct_redundant(rlm_sql_t *ins
 	rlm_sql_handle_t	*handle = NULL;
 	int			sql_ret;
 	int			numaffected = 0;
+	int			query_number = 1;
 
 	CONF_ITEM		*item;
 	CONF_PAIR 		*pair;
@@ -1523,7 +1525,14 @@ static int acct_redundant(rlm_sql_t *ins
 		(inst->module->sql_finish_query)(handle, inst->config);
 		RDEBUG("%i record(s) updated", numaffected);
 
-		if (numaffected > 0) break;	/* A query succeeded, we're done! */
+		if (numaffected > 0) {
+			if (inst->config->record_query_number) {
+				VALUE_PAIR *vp = fr_pair_find_by_num(request->config, PW_SQL_QUERY_NUMBER, 0, 0);
+				if (!vp) vp = radius_pair_create(request, &request->config, PW_SQL_QUERY_NUMBER, 0);
+				vp->vp_integer = query_number;
+			}
+			break;	/* A query succeeded, we're done! */
+		}
 	next:
 		/*
 		 *  We assume all entries with the same name form a redundant
@@ -1552,6 +1561,7 @@ static int acct_redundant(rlm_sql_t *ins
 			goto finish;
 		}
 
+		query_number ++;
 		RDEBUG("Trying next query...");
 	}
 
diff -urpN freeradius-server-3.2.7/src/modules/rlm_sql/rlm_sql.h freeradius-server-3.2.8/src/modules/rlm_sql/rlm_sql.h
--- freeradius-server-3.2.7/src/modules/rlm_sql/rlm_sql.h	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/modules/rlm_sql/rlm_sql.h	2025-08-20 23:29:15.000000000 +0700
@@ -15,7 +15,7 @@
  */
 
 /**
- * $Id: 78ab86b04112cdc1789828627b96612950547da6 $
+ * $Id: d5237a16055b47025b8ad9bd1cf2055a6510714b $
  * @file rlm_sql.h
  * @brief Prototypes and functions for the SQL module
  *
@@ -27,7 +27,7 @@
 #ifndef _RLM_SQL_H
 #define _RLM_SQL_H
 
-RCSIDH(rlm_sql_h, "$Id: 78ab86b04112cdc1789828627b96612950547da6 $")
+RCSIDH(rlm_sql_h, "$Id: d5237a16055b47025b8ad9bd1cf2055a6510714b $")
 
 #include <freeradius-devel/radiusd.h>
 #include <freeradius-devel/connection.h>
@@ -125,6 +125,9 @@ typedef struct sql_config {
 								//!< a fake stop packet, to terminate any
 								//!< stale sessions.
 
+	bool			record_query_number;		//!< Whether we should populate SQL-Query-Number
+								///< when an "acct_redundant" query succeeds
+
 	char const		*allowed_chars;			//!< Chars which done need escaping..
 	bool			driver_specific_escape;		//!< Use the driver specific SQL escape method
 	uint32_t		query_timeout;			//!< How long to allow queries to run for.
diff -urpN freeradius-server-3.2.7/src/modules/rlm_sql_map/rlm_sql_map.c freeradius-server-3.2.8/src/modules/rlm_sql_map/rlm_sql_map.c
--- freeradius-server-3.2.7/src/modules/rlm_sql_map/rlm_sql_map.c	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/modules/rlm_sql_map/rlm_sql_map.c	2025-08-20 23:29:15.000000000 +0700
@@ -15,14 +15,14 @@
  */
 
 /**
- * $Id: 28e263424835d515ac98b9b5fac238b89999a527 $
+ * $Id: 9c3f47606d267e683b0a564fc07b36740e5e760b $
  * @file rlm_sql_map.c
  * @brief Tracks data usage and other counters using SQL.
  *
  * @copyright 2021  The FreeRADIUS server project
  * @copyright 2021  Alan DeKok <aland@ox.org>
  */
-RCSID("$Id: 28e263424835d515ac98b9b5fac238b89999a527 $")
+RCSID("$Id: 9c3f47606d267e683b0a564fc07b36740e5e760b $")
 
 #include <freeradius-devel/radiusd.h>
 #include <freeradius-devel/modules.h>
@@ -181,6 +181,9 @@ static int sql_map_getvalue(TALLOC_CTX *
 		vp = fr_pair_afrom_da(ctx, map->lhs->tmpl_da);
 		rad_assert(vp);
 
+		vp->op = map->op;
+		vp->tag = map->lhs->tmpl_tag;
+
 		if (fr_pair_value_from_str(vp, value, -1) < 0) {
 			char *escaped;
 
@@ -191,7 +194,6 @@ static int sql_map_getvalue(TALLOC_CTX *
 			break;
 		}
 
-		vp->op = map->op;
 		fr_cursor_insert(&cursor, vp);
 		break;
 
diff -urpN freeradius-server-3.2.7/src/modules/rlm_totp/rlm_totp.c freeradius-server-3.2.8/src/modules/rlm_totp/rlm_totp.c
--- freeradius-server-3.2.7/src/modules/rlm_totp/rlm_totp.c	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/modules/rlm_totp/rlm_totp.c	2025-08-20 23:29:15.000000000 +0700
@@ -15,14 +15,14 @@
  */
 
 /**
- * $Id: d58e1ee56ffe08c6ec42d09e5210ea475877deb4 $
+ * $Id: 08929773430883e74b2986aaf228520248758665 $
  * @file rlm_totp.c
  * @brief Execute commands and parse the results.
  *
  * @copyright 2021  The FreeRADIUS server project
  * @copyright 2021  Network RADIUS SARL (legal@networkradius.com)
  */
-RCSID("$Id: d58e1ee56ffe08c6ec42d09e5210ea475877deb4 $")
+RCSID("$Id: 08929773430883e74b2986aaf228520248758665 $")
 
 #include <freeradius-devel/radiusd.h>
 #include <freeradius-devel/modules.h>
@@ -475,7 +475,10 @@ static rlm_rcode_t CC_HINT(nonnull) mod_
 	uint64_t now = time(NULL);
 
 	password = fr_pair_find_by_num(request->packet->vps, PW_TOTP_PASSWORD, 0, TAG_ANY);
-	if (!password) return RLM_MODULE_NOOP;
+	if (!password) {
+		RDEBUG2("No User-Password attribute in the request.  Cannot do TOTP");
+		return RLM_MODULE_NOOP;
+	}
 
 	if ((password->vp_length != 6) && (password->vp_length != 8)) {
 		RDEBUG("TOTP-Password has incorrect length %d", (int) password->vp_length);
diff -urpN freeradius-server-3.2.7/src/modules/stable freeradius-server-3.2.8/src/modules/stable
--- freeradius-server-3.2.7/src/modules/stable	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/modules/stable	2025-08-20 23:29:15.000000000 +0700
@@ -46,3 +46,4 @@ rlm_unbound
 rlm_yubikey
 rlm_redis
 rlm_rediswho
+rlm_kafka
diff -urpN freeradius-server-3.2.7/src/tests/auth/dpsk-pmk freeradius-server-3.2.8/src/tests/auth/dpsk-pmk
--- freeradius-server-3.2.7/src/tests/auth/dpsk-pmk	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/auth/dpsk-pmk	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,6 @@
+rewrite_called_station_id
+dpsk
+update control {
+	&Pairwise-Master-Key := &Class
+}
+
diff -urpN freeradius-server-3.2.7/src/tests/auth/dpsk-pmk.attrs freeradius-server-3.2.8/src/tests/auth/dpsk-pmk.attrs
--- freeradius-server-3.2.7/src/tests/auth/dpsk-pmk.attrs	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/auth/dpsk-pmk.attrs	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,10 @@
+User-Name = "cae78dfa6504"
+User-Password = "cae78dfa6504"
+Called-Station-Id = "5c:df:89:11L3bL3c:SSID"
+Calling-Station-Id = "ca:e7:8d:fa:65:04"
+FreeRADIUS-802.1X-Anonce = 0x43426fd6469d4254eb0d5ba449eb9895360894f1948cece9196751336d4c5daf
+FreeRADIUS-802.1X-EAPoL-Key-Msg = 0x0103007502010a00000000000000000001b16a8514b84d7843e53754f5c9131cb203fbe8277dbf216d6e87fd6e30b0577a0000000000000000000000000000000000000000000000000000000000000000dc81aec5a05ee8aa21a52947041fd2fc001630140100000fac040100000fac040100000fac028000
+Class = 0xd6175aed517504c40b8831d7ce7b7d1fe24c65ce0f92c2816ca14ba7acb47b13
+
+# and the response
+Response-Packet-Type == Access-Accept
diff -urpN freeradius-server-3.2.7/src/tests/auth/dpsk-psk freeradius-server-3.2.8/src/tests/auth/dpsk-psk
--- freeradius-server-3.2.7/src/tests/auth/dpsk-psk	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/auth/dpsk-psk	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,5 @@
+rewrite_called_station_id
+dpsk
+update control {
+	&Pre-Shared-Key := &Filter-Id
+}
diff -urpN freeradius-server-3.2.7/src/tests/auth/dpsk-psk.attrs freeradius-server-3.2.8/src/tests/auth/dpsk-psk.attrs
--- freeradius-server-3.2.7/src/tests/auth/dpsk-psk.attrs	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/auth/dpsk-psk.attrs	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,13 @@
+User-Name = "8ab3a0ebd5e5"
+User-Password = "8ab3a0ebd5e5"
+NAS-IP-Address = 127.0.0.1
+Called-Station-Id = "34:ef:b6:af:48:9e:Andrena_39_Lincoln"
+Calling-Station-Id = "8a:b3:a0:eb:d5:e5"
+NAS-Identifier = "34efb6af489e"
+FreeRADIUS-802.1X-Anonce = 0x4df70a4285c5c61f177cdbfc29d7e3cac94167f6101f1bcab420dd50c4f8809d
+FreeRADIUS-802.1X-EAPoL-Key-Msg = 0x0203007502010a00100000000000000001c3bb319516614aacfb44e933bf1671131fb1856e5b2721952d414ce3f5aa312b000000000000000000000000000000000000000000000000000000000000000035cddcedad0dfb6a12a2eca55c17c323001630140100000fac040100000fac040100000fac028c00
+Filter-ID = "Pancakes1124"
+
+# and the response
+Response-Packet-Type == Access-Accept
+Pre-Shared-Key == "Pancakes1124"
diff -urpN freeradius-server-3.2.7/src/tests/auth/radiusd.conf freeradius-server-3.2.8/src/tests/auth/radiusd.conf
--- freeradius-server-3.2.7/src/tests/auth/radiusd.conf	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/auth/radiusd.conf	2025-08-20 23:29:15.000000000 +0700
@@ -13,6 +13,10 @@ security {
 	allow_vulnerable_openssl = yes
 }
 
+policy {
+	$INCLUDE ${raddb}/policy.d/canonicalization
+}
+
 modules {
 	$INCLUDE ${raddb}/mods-enabled/always
 
@@ -23,6 +27,8 @@ modules {
 	$INCLUDE ${raddb}/mods-enabled/expr
 
 	$INCLUDE ${raddb}/mods-enabled/digest
+
+	$INCLUDE ${raddb}/mods-enabled/dpsk
 }
 
 server default {
@@ -46,5 +52,6 @@ server default {
 		digest
 		pap
 		chap
+		dpsk
 	}
 }
diff -urpN freeradius-server-3.2.7/src/tests/eap-teap-mschap-tls.conf freeradius-server-3.2.8/src/tests/eap-teap-mschap-tls.conf
--- freeradius-server-3.2.7/src/tests/eap-teap-mschap-tls.conf	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/eap-teap-mschap-tls.conf	2025-08-20 23:29:15.000000000 +0700
@@ -8,6 +8,7 @@ network={
 	anonymous_identity="anonymous"
 	ca_cert="../../raddb/certs/ca.pem"
 	phase1="teap_compat=freeradius,tls_disable_tlsv1_0=1,tls_disable_tlsv1_1=1"
+#	phase1="tls_disable_tlsv1_0=1,tls_disable_tlsv1_1=1"
 
 	#
 	#  User Credentials
@@ -26,3 +27,6 @@ network={
 	machine_private_key="../../raddb/certs/client.key"
 	machine_private_key_passwd="whatever"
 }
+
+# TEAP is known to *not* work with some versions of eapol_test.
+# You may need to compile from the devel git repository.
diff -urpN freeradius-server-3.2.7/src/tests/eap-teap-mschap-x2.conf freeradius-server-3.2.8/src/tests/eap-teap-mschap-x2.conf
--- freeradius-server-3.2.7/src/tests/eap-teap-mschap-x2.conf	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/eap-teap-mschap-x2.conf	2025-08-20 23:29:15.000000000 +0700
@@ -1,12 +1,12 @@
 #
-#   eapol_test -c eap-teap-mschapv2.conf -s testing123
+#   eapol_test -c eap-teap-mschap-x2.conf -s testing123
 #
 network={
 	key_mgmt=IEEE8021X
 	eap=TEAP
 
 	anonymous_identity="anonymous"
-	phase1="teap_compat=freeradius,tls_disable_tlsv1_0=1 tls_disable_tlsv1_1=1 tls_disable_tlsv1_2=1 tls_disable_tlsv1_3=0"
+	phase1="teap_compat=freeradius,tls_disable_tlsv1_0=1 tls_disable_tlsv1_1=1 tls_disable_tlsv1_2=0 tls_disable_tlsv1_3=0"
 	ca_cert="../../raddb/certs/ca.pem"
 
 	#
@@ -21,5 +21,8 @@ network={
 	#
 	machine_identity="machine"
 	machine_password="machine"
-	machine_phase2="auth=MSCHAPv2"
+	machine_phase2="autheap=MSCHAPv2"
 }
+
+# TEAP is known to *not* work with some versions of eapol_test.
+# You may need to compile from the devel git repository.
diff -urpN freeradius-server-3.2.7/src/tests/eap-teap-mschap.conf freeradius-server-3.2.8/src/tests/eap-teap-mschap.conf
--- freeradius-server-3.2.7/src/tests/eap-teap-mschap.conf	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/eap-teap-mschap.conf	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,21 @@
+#
+#   eapol_test -c eap-teap-mschap.conf -s testing123
+#
+network={
+	key_mgmt=IEEE8021X
+	eap=TEAP
+
+	anonymous_identity="anonymous"
+	phase1="teap_compat=freeradius,tls_disable_tlsv1_0=1 tls_disable_tlsv1_1=1 tls_disable_tlsv1_2=0 tls_disable_tlsv1_3=0"
+	ca_cert="../../raddb/certs/ca.pem"
+
+	#
+	#  User Credentials
+	#
+	identity="bob"
+	password="bob"
+	phase2="auth=MSCHAPV2"
+}
+
+# TEAP is known to *not* work with some versions of eapol_test.
+# You may need to compile from the devel git repository.
diff -urpN freeradius-server-3.2.7/src/tests/eap-teap-password.conf freeradius-server-3.2.8/src/tests/eap-teap-password.conf
--- freeradius-server-3.2.7/src/tests/eap-teap-password.conf	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/eap-teap-password.conf	2025-08-20 23:29:15.000000000 +0700
@@ -6,7 +6,8 @@ network={
 	eap=TEAP
 
 	anonymous_identity="anonymous"
-	phase1="teap_compat=freeradius,tls_disable_tlsv1_0=1,tls_disable_tlsv1_1=1"
+#	phase1="teap_compat=freeradius,tls_disable_tlsv1_0=1,tls_disable_tlsv1_1=1"
+	phase1="tls_disable_tlsv1_0=1,tls_disable_tlsv1_1=1"
 	ca_cert="../../raddb/certs/ca.pem"
 
 	#
@@ -15,3 +16,6 @@ network={
 	identity="bob"
 	password="bob"
 }
+
+# TEAP is known to *not* work with some versions of eapol_test.
+# You may need to compile from the devel git repository.
diff -urpN freeradius-server-3.2.7/src/tests/keywords/tag freeradius-server-3.2.8/src/tests/keywords/tag
--- freeradius-server-3.2.7/src/tests/keywords/tag	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/keywords/tag	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,8 @@
+update control {
+       Cleartext-Password := 'hello'
+}
+
+update reply {
+       Tunnel-Assignment-Id:1 = "foo"
+       Tunnel-Assignment-Id:V = ":2:bar"
+}
diff -urpN freeradius-server-3.2.7/src/tests/keywords/tag.attrs freeradius-server-3.2.8/src/tests/keywords/tag.attrs
--- freeradius-server-3.2.7/src/tests/keywords/tag.attrs	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/keywords/tag.attrs	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,13 @@
+#
+#  Input packet
+#
+User-Name = "bob"
+User-Password = "hello"
+
+#
+#  Expected answer
+#
+Response-Packet-Type == Access-Accept
+Tunnel-Assignment-Id:1 == "foo"
+Tunnel-Assignment-Id:2 == "bar"
+
diff -urpN freeradius-server-3.2.7/src/tests/modules/json/encode.attrs freeradius-server-3.2.8/src/tests/modules/json/encode.attrs
--- freeradius-server-3.2.7/src/tests/modules/json/encode.attrs	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/json/encode.attrs	2025-08-20 23:29:15.000000000 +0700
@@ -6,6 +6,7 @@ Filter-Id = "f1"
 Filter-Id += "f2"
 NAS-Port = 999
 Service-Type = Login-User
+Event-Timestamp = 1234
 
 #
 #  Expected answer
diff -urpN freeradius-server-3.2.7/src/tests/modules/json/encode.unlang freeradius-server-3.2.8/src/tests/modules/json/encode.unlang
--- freeradius-server-3.2.7/src/tests/modules/json/encode.unlang	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/json/encode.unlang	2025-08-20 23:29:15.000000000 +0700
@@ -18,7 +18,7 @@ update control {
 }
 
 
-if (&control:Tmp-String-1 != '{"User-Name":{"type":"string","value":"john"},"Filter-Id":{"type":"string","value":["f1","f2"]},"NAS-Port":{"type":"integer","value":999},"Service-Type":{"type":"integer","value":"Login-User"}}') {
+if (&control:Tmp-String-1 != '{"User-Name":{"type":"string","value":"john"},"Filter-Id":{"type":"string","value":["f1","f2"]},"NAS-Port":{"type":"integer","value":999},"Service-Type":{"type":"integer","value":"Login-User"},"Event-Timestamp":{"type":"date","value":"Jan  1 1970 00:20:34 UTC"}}') {
 	test_fail
 }
 
@@ -35,7 +35,7 @@ if (&control:Tmp-String-1 != &control:Tm
 	test_fail
 }
 
-if (&control:Tmp-String-5 != '{"User-Name":{"type":"string","value":"john"},"NAS-Port":{"type":"integer","value":999},"Service-Type":{"type":"integer","value":"Login-User"}}') {
+if (&control:Tmp-String-5 != '{"User-Name":{"type":"string","value":"john"},"NAS-Port":{"type":"integer","value":999},"Service-Type":{"type":"integer","value":"Login-User"},"Event-Timestamp":{"type":"date","value":"Jan  1 1970 00:20:34 UTC"}}') {
 	test_fail
 }
 
@@ -65,11 +65,11 @@ update control {
 	&Tmp-String-2 := "%{json_object_ex_encode:&request:[*]}"
 }
 
-if (&control:Tmp-String-1 != '{"User-Name":{"type":"string","value":"john"},"Filter-Id":{"type":"string","value":["f1","f2"]},"NAS-Port":{"type":"integer","value":999},"Service-Type":{"type":"integer","value":"Login-User"}}') {
+if (&control:Tmp-String-1 != '{"User-Name":{"type":"string","value":"john"},"Filter-Id":{"type":"string","value":["f1","f2"]},"NAS-Port":{"type":"integer","value":999},"Service-Type":{"type":"integer","value":"Login-User"},"Event-Timestamp":{"type":"date","value":"Jan  1 1970 00:20:34 UTC"}}') {
 	test_fail
 }
 
-if (&control:Tmp-String-2 != '{"pf:User-Name":{"type":"string","value":["john"]},"pf:Filter-Id":{"type":"string","value":["f1","f2"]},"pf:NAS-Port":{"type":"integer","value":["999"]},"pf:Service-Type":{"type":"integer","value":["1"]}}') {
+if (&control:Tmp-String-2 != '{"pf:User-Name":{"type":"string","value":["john"]},"pf:Filter-Id":{"type":"string","value":["f1","f2"]},"pf:NAS-Port":{"type":"integer","value":["999"]},"pf:Service-Type":{"type":"integer","value":["1"]},"pf:Event-Timestamp":{"type":"date","value":[1234]}}') {
 	test_fail
 }
 
@@ -97,11 +97,11 @@ update control {
 	&Tmp-String-2 := "%{json_object_simple_ex_encode:&request:[*]}"
 }
 
-if (&control:Tmp-String-1 != '{"User-Name":"john","Filter-Id":["f1","f2"],"NAS-Port":999,"Service-Type":"Login-User"}') {
+if (&control:Tmp-String-1 != '{"User-Name":"john","Filter-Id":["f1","f2"],"NAS-Port":999,"Service-Type":"Login-User","Event-Timestamp":"Jan  1 1970 00:20:34 UTC"}') {
 	test_fail
 }
 
-if (&control:Tmp-String-2 != '{"pf:User-Name":["john"],"pf:Filter-Id":["f1","f2"],"pf:NAS-Port":["999"],"pf:Service-Type":["1"]}') {
+if (&control:Tmp-String-2 != '{"pf:User-Name":["john"],"pf:Filter-Id":["f1","f2"],"pf:NAS-Port":["999"],"pf:Service-Type":["1"],"pf:Event-Timestamp":[1234]}') {
 	test_fail
 }
 
@@ -129,11 +129,11 @@ update control {
 	&Tmp-String-2 := "%{json_array_ex_encode:&request:[*]}"
 }
 
-if (&control:Tmp-String-1 != '[{"name":"User-Name","type":"string","value":"john"},{"name":"Filter-Id","type":"string","value":"f1"},{"name":"Filter-Id","type":"string","value":"f2"},{"name":"NAS-Port","type":"integer","value":999},{"name":"Service-Type","type":"integer","value":"Login-User"}]') {
+if (&control:Tmp-String-1 != '[{"name":"User-Name","type":"string","value":"john"},{"name":"Filter-Id","type":"string","value":"f1"},{"name":"Filter-Id","type":"string","value":"f2"},{"name":"NAS-Port","type":"integer","value":999},{"name":"Service-Type","type":"integer","value":"Login-User"},{"name":"Event-Timestamp","type":"date","value":"Jan  1 1970 00:20:34 UTC"}]') {
 	test_fail
 }
 
-if (&control:Tmp-String-2 != '[{"name":"pf:User-Name","type":"string","value":["john"]},{"name":"pf:Filter-Id","type":"string","value":["f1","f2"]},{"name":"pf:NAS-Port","type":"integer","value":["999"]},{"name":"pf:Service-Type","type":"integer","value":["1"]}]') {
+if (&control:Tmp-String-2 != '[{"name":"pf:User-Name","type":"string","value":["john"]},{"name":"pf:Filter-Id","type":"string","value":["f1","f2"]},{"name":"pf:NAS-Port","type":"integer","value":["999"]},{"name":"pf:Service-Type","type":"integer","value":["1"]},{"name":"pf:Event-Timestamp","type":"date","value":[1234]}]') {
 	test_fail
 }
 
@@ -161,11 +161,11 @@ update control {
 	&Tmp-String-2 := "%{json_array_names_ex_encode:&request:[*]}"
 }
 
-if (&control:Tmp-String-1 != '["User-Name","Filter-Id","Filter-Id","NAS-Port","Service-Type"]') {
+if (&control:Tmp-String-1 != '["User-Name","Filter-Id","Filter-Id","NAS-Port","Service-Type","Event-Timestamp"]') {
 	test_fail
 }
 
-if (&control:Tmp-String-2 != '["pf:User-Name","pf:Filter-Id","pf:Filter-Id","pf:NAS-Port","pf:Service-Type"]') {
+if (&control:Tmp-String-2 != '["pf:User-Name","pf:Filter-Id","pf:Filter-Id","pf:NAS-Port","pf:Service-Type","pf:Event-Timestamp"]') {
 	test_fail
 }
 
@@ -193,11 +193,11 @@ update control {
 	&Tmp-String-2 := "%{json_array_values_ex_encode:&request:[*]}"
 }
 
-if (&control:Tmp-String-1 != '["john","f1","f2",999,"Login-User"]') {
+if (&control:Tmp-String-1 != '["john","f1","f2",999,"Login-User","Jan  1 1970 00:20:34 UTC"]') {
 	test_fail
 }
 
-if (&control:Tmp-String-2 != '["john","f1","f2","999","1"]') {
+if (&control:Tmp-String-2 != '["john","f1","f2","999","1",1234]') {
 	test_fail
 }
 
diff -urpN freeradius-server-3.2.7/src/tests/modules/json/module.conf freeradius-server-3.2.8/src/tests/modules/json/module.conf
--- freeradius-server-3.2.7/src/tests/modules/json/module.conf	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/json/module.conf	2025-08-20 23:29:15.000000000 +0700
@@ -19,6 +19,7 @@ json json_object_no {
 		value {
 			single_value_as_array = no
 			enum_as_integer = no
+			dates_as_integer = no
 			always_string = no
 		}
 	}
@@ -36,6 +37,7 @@ json json_object_ex {
 		value {
 			single_value_as_array = yes
 			enum_as_integer = yes
+			dates_as_integer = yes
 			always_string = yes
 		}
 	}
@@ -63,6 +65,7 @@ json json_object_simple_ex {
 		value {
 			single_value_as_array = yes
 			enum_as_integer = yes
+			dates_as_integer = yes
 			always_string = yes
 		}
 	}
@@ -90,6 +93,7 @@ json json_array_ex {
 		value {
 			single_value_as_array = yes
 			enum_as_integer = yes
+			dates_as_integer = yes
 			always_string = yes
 		}
 	}
@@ -117,6 +121,7 @@ json json_array_names_ex {
 		value {
 			single_value_as_array = yes	# not valid
 			enum_as_integer = yes		# not valid
+			dates_as_integer = yes		# not valid
 			always_string = yes		# not valid
 		}
 	}
@@ -144,6 +149,7 @@ json json_array_values_ex {
 		value {
 			single_value_as_array = yes	# not valid
 			enum_as_integer = yes
+			dates_as_integer = yes
 			always_string = yes
 		}
 	}
diff -urpN freeradius-server-3.2.7/src/tests/modules/kafka/acct.attrs freeradius-server-3.2.8/src/tests/modules/kafka/acct.attrs
--- freeradius-server-3.2.7/src/tests/modules/kafka/acct.attrs	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/kafka/acct.attrs	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,37 @@
+#
+#  Input packet
+#
+User-Name = 'user0@example.org'
+NAS-Port = 17826193
+NAS-IP-Address = 192.0.2.10
+Framed-IP-Address = 198.51.100.59
+NAS-Identifier = 'nas.example.org'
+Acct-Status-Type = Start
+Acct-Delay-Time = 1
+Acct-Input-Octets = 0
+Acct-Output-Octets = 0
+Acct-Session-Id = '00000000'
+Acct-Unique-Session-Id = '00000000'
+Acct-Authentic = RADIUS
+Acct-Session-Time = 0
+Acct-Input-Packets = 0
+Acct-Output-Packets = 0
+Acct-Input-Gigawords = 0
+Acct-Output-Gigawords = 0
+Event-Timestamp = 'Feb  1 2015 08:28:58 WIB'
+NAS-Port-Type = Ethernet
+NAS-Port-Id = 'port 001'
+Service-Type = Framed-User
+Framed-Protocol = PPP
+Acct-Link-Count = 0
+Idle-Timeout = 0
+Session-Timeout = 604800
+Access-Loop-Encapsulation = 0x000000
+Proxy-State = 0x323531
+
+#
+#  Expected answer
+#
+#  There's not an Accounting-Failed packet type in RADIUS...
+#
+Response-Packet-Type == Access-Accept
diff -urpN freeradius-server-3.2.7/src/tests/modules/kafka/acct.unlang freeradius-server-3.2.8/src/tests/modules/kafka/acct.unlang
--- freeradius-server-3.2.7/src/tests/modules/kafka/acct.unlang	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/kafka/acct.unlang	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,6 @@
+kafka.accounting
+if (!ok) {
+	test_fail
+}
+
+test_pass
diff -urpN freeradius-server-3.2.7/src/tests/modules/kafka/all.mk freeradius-server-3.2.8/src/tests/modules/kafka/all.mk
--- freeradius-server-3.2.7/src/tests/modules/kafka/all.mk	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/kafka/all.mk	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,3 @@
+#
+#  Test the kafka module
+#
diff -urpN freeradius-server-3.2.7/src/tests/modules/kafka/auth.attrs freeradius-server-3.2.8/src/tests/modules/kafka/auth.attrs
--- freeradius-server-3.2.7/src/tests/modules/kafka/auth.attrs	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/kafka/auth.attrs	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,11 @@
+#
+#  Input packet
+#
+User-Name = "user_auth"
+User-Password = "password"
+NAS-IP-Address = "1.2.3.4"
+
+#
+#  Expected answer
+#
+Response-Packet-Type == Access-Accept
diff -urpN freeradius-server-3.2.7/src/tests/modules/kafka/auth.unlang freeradius-server-3.2.8/src/tests/modules/kafka/auth.unlang
--- freeradius-server-3.2.7/src/tests/modules/kafka/auth.unlang	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/kafka/auth.unlang	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,6 @@
+kafka.authorize
+if (!ok) {
+	test_fail
+}
+
+test_pass
diff -urpN freeradius-server-3.2.7/src/tests/modules/kafka/module.conf freeradius-server-3.2.8/src/tests/modules/kafka/module.conf
--- freeradius-server-3.2.7/src/tests/modules/kafka/module.conf	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/kafka/module.conf	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,53 @@
+json {
+	encode {
+		output_mode = object_simple
+	}
+}
+
+kafka {
+
+	bootstrap-servers = "localhost:9092"
+	topic = "radius"
+
+	global-config {
+		test.mock.num.brokers = 1
+	}
+
+	topic-config custom-topic {
+		message.timeout.ms = 1000
+	}
+
+	topic-config accounting {
+		request.required.acks = 1
+	}
+
+	topic-config authorize {
+		name = "radius.request"
+	}
+
+	topic-config post-auth {
+		reference = authorize
+	}
+
+	accounting {
+		key = "%{Acct-Unique-Session-Id}"
+		reference = "messages.%{%{Acct-Status-Type}:-unknown}"
+		messages {
+			Start = "%{json_encode:&request:[*]}"
+		}
+	}
+
+	authorize {
+		key = "%{User-Name}"
+		message = "%{json_encode:&request:[*]}"
+	}
+
+	post-auth {
+		key = "%{User-Name}"
+		reference = "messages.%{%{reply:Packet-Type}:-default}"
+		messages {
+			Access-Accept = "%{json_encode:&User-Name &reply:[*]}"
+		}
+	}
+
+}
diff -urpN freeradius-server-3.2.7/src/tests/modules/kafka/post-auth.attrs freeradius-server-3.2.8/src/tests/modules/kafka/post-auth.attrs
--- freeradius-server-3.2.7/src/tests/modules/kafka/post-auth.attrs	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/kafka/post-auth.attrs	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,11 @@
+#
+#  Input packet
+#
+User-Name = "user_auth"
+User-Password = "password"
+NAS-IP-Address = "1.2.3.4"
+
+#
+#  Expected answer
+#
+Response-Packet-Type == Access-Accept
diff -urpN freeradius-server-3.2.7/src/tests/modules/kafka/post-auth.unlang freeradius-server-3.2.8/src/tests/modules/kafka/post-auth.unlang
--- freeradius-server-3.2.7/src/tests/modules/kafka/post-auth.unlang	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/kafka/post-auth.unlang	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,20 @@
+#
+#  Required for message schema reference
+#
+update reply {
+	&Packet-Type := Access-Accept
+}
+
+kafka.post-auth
+if (!ok) {
+	test_fail
+}
+
+#
+#  Reset
+#
+update reply {
+	&Packet-Type !* ANY
+}
+
+test_pass
diff -urpN freeradius-server-3.2.7/src/tests/modules/kafka/xlat.attrs freeradius-server-3.2.8/src/tests/modules/kafka/xlat.attrs
--- freeradius-server-3.2.7/src/tests/modules/kafka/xlat.attrs	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/kafka/xlat.attrs	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,11 @@
+#
+#  Input packet
+#
+User-Name = "user_auth"
+User-Password = "password"
+NAS-IP-Address = "1.2.3.4"
+
+#
+#  Expected answer
+#
+Response-Packet-Type == Access-Accept
diff -urpN freeradius-server-3.2.7/src/tests/modules/kafka/xlat.unlang freeradius-server-3.2.8/src/tests/modules/kafka/xlat.unlang
--- freeradius-server-3.2.7/src/tests/modules/kafka/xlat.unlang	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/kafka/xlat.unlang	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,197 @@
+#
+#  Call from accounting, configured as regular topic
+#
+kafka.accounting
+if (&Module-Failure-Message) {
+	test_fail
+}
+
+
+#
+#  Call from authorize, configured with custom published name
+#
+kafka.authorize
+if (&Module-Failure-Message) {
+	test_fail
+}
+
+
+#
+#  Call from post-auth, configured as reference to accounting
+#
+kafka.accounting
+if (&Module-Failure-Message) {
+	test_fail
+}
+
+
+#
+#  Message with key
+#
+update {
+	&Module-Failure-Message !* ANY
+}
+
+"%{kafka:custom-topic &User-Name Test mmessage}"
+if (&Module-Failure-Message) {
+	test_fail
+}
+
+
+#
+#  Message with key and headers
+#
+update {
+	&Module-Failure-Message !* ANY
+}
+
+"%{kafka:custom-topic (&NAS-IP-Address) &User-Name Test mmessage}"
+if (&Module-Failure-Message) {
+	test_fail
+}
+
+
+#
+#  Bare message, with no key
+#
+update {
+	&Module-Failure-Message !* ANY
+}
+
+"%{kafka:custom-topic  Test message}"
+if (&Module-Failure-Message) {
+	test_fail
+}
+
+
+#
+#  Bare message with headers, but no key
+#
+update {
+	&Module-Failure-Message !* ANY
+}
+
+"%{kafka:custom-topic (&NAS-IP-Address)  Test message}"
+if (&Module-Failure-Message) {
+	test_fail
+}
+
+
+#
+#  No key and empty message is useless, but still acceptable to Kafka
+#
+update {
+	&Module-Failure-Message !* ANY
+}
+
+"%{kafka:custom-topic  }"
+if (&Module-Failure-Message) {
+	test_fail
+}
+
+
+#
+#  Missing topic
+#
+update {
+	&Module-Failure-Message !* ANY
+}
+
+"%{kafka: &User-Name Topic is missing here}"
+if (!(&Module-Failure-Message[*] == "Kafka xlat must begin with a topic, optionally followed by headers, then the payload")) {
+	test_fail
+}
+
+
+#
+#  Lone topic
+#
+update {
+	&Module-Failure-Message !* ANY
+}
+
+"%{kafka:custom-topic}"
+if (!(&Module-Failure-Message[*] == "Kafka xlat must begin with a topic, optionally followed by headers, then the payload")) {
+	test_fail
+}
+
+
+#
+#  Lone topic and headers
+#
+update {
+	&Module-Failure-Message !* ANY
+}
+
+"%{kafka:custom-topic (&NAS-IP-Address)}"
+if (!(&Module-Failure-Message[*] == "Kafka xlat must begin with a topic, optionally followed by headers, then the payload")) {
+	test_fail
+}
+
+
+#
+#  Headers missing closing parenthesis
+#
+update {
+	&Module-Failure-Message !* ANY
+}
+
+"%{kafka:custom-topic (&NAS-IP-Address  Test message}"
+if (!(&Module-Failure-Message[*] == "Header list is missing closing parenthesis)")) {
+	test_fail
+}
+
+
+#
+#  Topic with no payload
+#
+update {
+	&Module-Failure-Message !* ANY
+}
+
+"%{kafka:custom-topic }"
+if (!(&Module-Failure-Message[*] == "Kafka xlat must begin with a topic, optionally followed by headers, then the payload")) {
+	test_fail
+}
+
+
+#
+#  Topic and headers with no payload
+#
+update {
+	&Module-Failure-Message !* ANY
+}
+
+"%{kafka:custom-topic (&NAS-IP-Address)}"
+if (!(&Module-Failure-Message[*] == "Kafka xlat must begin with a topic, optionally followed by headers, then the payload")) {
+	test_fail
+}
+
+
+#
+#  Nonsense payload
+#
+update {
+	&Module-Failure-Message !* ANY
+}
+
+"%{kafka:custom-topic Test message not preceeded by Key-Attr-Ref or two spaces}"
+if (!(&Module-Failure-Message[*] == "Kafka payload must begin with an attribute reference or a space")) {
+	test_fail
+}
+
+
+#
+#  Nonsense payload, with headers
+#
+update {
+	&Module-Failure-Message !* ANY
+}
+
+"%{kafka:custom-topic (&NAS-IP-Address) Test message not preceeded by Key-Attr-Ref or two spaces}"
+if (!(&Module-Failure-Message[*] == "Kafka payload must begin with an attribute reference or a space")) {
+	test_fail
+}
+
+
+test_pass
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_dig_big.attrs freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_dig_big.attrs
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_dig_big.attrs	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_dig_big.attrs	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,11 @@
+#
+#  Input packet
+#
+User-Name = 'pbkdf2_dig_big'
+User-Password = 'password'
+
+#
+#  Expected answer
+#
+Response-Packet-Type == Access-Accept
+
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_dig_big.unlang freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_dig_big.unlang
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_dig_big.unlang	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_dig_big.unlang	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,17 @@
+if ("${feature.tls}" == no) {
+	test_pass
+	return
+}
+
+if (&User-Name == 'pbkdf2_dig_big') {
+	update control {
+		&PBKDF2-Password := 'HMACSHA2+256:AAAAAQ:E+VXOSsE8RwyYGdygQoW9Q==:UivlvrwHML4VtZHMJLiT/xlH7oyoyvbXQceivptq9TI='
+	}
+	pap.authorize
+	pap.authenticate
+	if (!ok) {
+		test_fail
+	} else {
+		test_pass
+	}
+}
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_dig_small.attrs freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_dig_small.attrs
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_dig_small.attrs	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_dig_small.attrs	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,11 @@
+#
+#  Input packet
+#
+User-Name = 'pbkdf2_dig_small'
+User-Password = 'password'
+
+#
+#  Expected answer
+#
+Response-Packet-Type == Access-Accept
+
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_dig_small.unlang freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_dig_small.unlang
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_dig_small.unlang	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_dig_small.unlang	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,17 @@
+if ("${feature.tls}" == no) {
+	test_pass
+	return
+}
+
+if (&User-Name == 'pbkdf2_dig_small') {
+	update control {
+		&PBKDF2-Password := 'HMACSHA2+256:AAAAAQ:E+VXOSsE8RwyYGdygQoW9Q==:UivlvrwHML4VtZHMJLiT/xlH7oyoyvbXQceivptq9TI'
+	}
+	pap.authorize
+	pap.authenticate
+	if (!ok) {
+		test_fail
+	} else {
+		test_pass
+	}
+}
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_iter0.attrs freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_iter0.attrs
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_iter0.attrs	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_iter0.attrs	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,11 @@
+#
+#  Input packet
+#
+User-Name = 'pbkdf2_iter0'
+User-Password = 'password'
+
+#
+#  Expected answer
+#
+Response-Packet-Type == Access-Accept
+
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_iter0.unlang freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_iter0.unlang
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_iter0.unlang	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_iter0.unlang	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,17 @@
+if ("${feature.tls}" == no) {
+	test_pass
+	return
+}
+
+if (&User-Name == 'pbkdf2_iter0') {
+	update control {
+		&PBKDF2-Password := 'HMACSHA2+256:AAAAAP:CuNDJ9NimZoP5ljnPNCBUA==:f09zV7dReGg5SIv/EXY9tCL4XQRr5guhL0Q6UXSKI3c='
+	}
+	pap.authorize
+	pap.authenticate
+	if (!ok) {
+		test_fail
+	} else {
+		test_pass
+	}
+}
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_iter1.attrs freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_iter1.attrs
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_iter1.attrs	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_iter1.attrs	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,11 @@
+#
+#  Input packet
+#
+User-Name = 'pbkdf2_iter1'
+User-Password = 'password'
+
+#
+#  Expected answer
+#
+Response-Packet-Type == Access-Accept
+
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_iter1.unlang freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_iter1.unlang
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_iter1.unlang	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_iter1.unlang	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,17 @@
+if ("${feature.tls}" == no) {
+	test_pass
+	return
+}
+
+if (&User-Name == 'pbkdf2_iter1') {
+	update control {
+		&PBKDF2-Password := 'HMACSHA2+256:AAAAAQ:OErtptMl2hOxhQqvNw7sNw==:4KkrgL+3Q9j8KlHPivtApBKRZAjyWjtDWmZEz2UjNko='
+	}
+	pap.authorize
+	pap.authenticate
+	if (!ok) {
+		test_fail
+	} else {
+		test_pass
+	}
+}
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_iter1000.attrs freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_iter1000.attrs
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_iter1000.attrs	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_iter1000.attrs	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,11 @@
+#
+#  Input packet
+#
+User-Name = 'pbkdf2_iter1000'
+User-Password = 'password'
+
+#
+#  Expected answer
+#
+Response-Packet-Type == Access-Accept
+
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_iter1000.unlang freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_iter1000.unlang
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_iter1000.unlang	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_iter1000.unlang	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,17 @@
+if ("${feature.tls}" == no) {
+	test_pass
+	return
+}
+
+if (&User-Name == 'pbkdf2_iter1000') {
+	update control {
+		&PBKDF2-Password := 'HMACSHA2+256:AAAD6A:yhmqoKrtPLY2KYK6cNjnfw==:Y6gkSZEo4TRtlsryHqnGYZhoe2qn5tJ4IUyyVHb/3WU='
+	}
+	pap.authorize
+	pap.authenticate
+	if (!ok) {
+		test_fail
+	} else {
+		test_pass
+	}
+}
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_iter100000.attrs freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_iter100000.attrs
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_iter100000.attrs	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_iter100000.attrs	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,10 @@
+#
+#  Input packet
+#
+User-Name = 'pbkdf2_iter100000'
+User-Password = 'password'
+
+#
+#  Expected answer
+#
+Response-Packet-Type == Access-Accept
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_iter100000.unlang freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_iter100000.unlang
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_iter100000.unlang	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_iter100000.unlang	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,17 @@
+if ("${feature.tls}" == no) {
+	test_pass
+	return
+}
+
+if (&User-Name == 'pbkdf2_iter100000') {
+	update control {
+		&PBKDF2-Password := 'HMACSHA2+256:AA9CQA:fCfnJGMVC1QLtTOPiaSICA==:KCmjMpQ+lokMvyFTl4f4pPJNc0xJq4iHZPdtHa0OEXM='
+	}
+	pap.authorize
+	pap.authenticate
+	if (!ok) {
+		test_fail
+	} else {
+		test_pass
+	}
+}
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_iter_big.attrs freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_iter_big.attrs
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_iter_big.attrs	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_iter_big.attrs	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,11 @@
+#
+#  Input packet
+#
+User-Name = 'pbkdf2_iter_big'
+User-Password = 'password'
+
+#
+#  Expected answer
+#
+Response-Packet-Type == Access-Accept
+
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_iter_big.unlang freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_iter_big.unlang
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_iter_big.unlang	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_iter_big.unlang	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,17 @@
+if ("${feature.tls}" == no) {
+	test_pass
+	return
+}
+
+if (&User-Name == 'pbkdf2_iter_big') {
+	update control {
+		&PBKDF2-Password := 'HMACSHA2+256:AAAAAQ==:E+VXOSsE8RwyYGdygQoW9Q==:UivlvrwHML4VtZHMJLiT/xlH7oyoyvbXQceivptq9TI='
+	}
+	pap.authorize
+	pap.authenticate
+	if (!ok) {
+		test_fail
+	} else {
+		test_pass
+	}
+}
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_iter_miss.attrs freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_iter_miss.attrs
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_iter_miss.attrs	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_iter_miss.attrs	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,11 @@
+#
+#  Input packet
+#
+User-Name = 'pbkdf2_iter_miss'
+User-Password = 'password'
+
+#
+#  Expected answer
+#
+Response-Packet-Type == Access-Accept
+
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_iter_miss.unlang freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_iter_miss.unlang
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_iter_miss.unlang	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_iter_miss.unlang	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,19 @@
+if ("${feature.tls}" == no) {
+	test_pass
+	return
+}
+
+if (&User-Name == 'pbkdf2_iter_miss') {
+	update control {
+		&PBKDF2-Password := 'HMACSHA2+256::E+VXOSsE8RwyYGdygQoW9Q==:UivlvrwHML4VtZHMJLiT/xlH7oyoyvbXQceivptq9TI='
+	}
+	pap.authorize
+	pap.authenticate {
+		invalid = 1
+	}
+	if (invalid) {
+		test_pass
+	} else {
+		test_fail
+	}
+}
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_iter_small.attrs freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_iter_small.attrs
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_iter_small.attrs	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_iter_small.attrs	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,11 @@
+#
+#  Input packet
+#
+User-Name = 'pbkdf2_iter_small'
+User-Password = 'password'
+
+#
+#  Expected answer
+#
+Response-Packet-Type == Access-Accept
+
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_iter_small.unlang freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_iter_small.unlang
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_iter_small.unlang	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_iter_small.unlang	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,19 @@
+if ("${feature.tls}" == no) {
+	test_pass
+	return
+}
+
+if (&User-Name == 'pbkdf2_iter_small') {
+	update control {
+		&PBKDF2-Password := 'HMACSHA2+256:AAAAA:E+VXOSsE8RwyYGdygQoW9Q==:UivlvrwHML4VtZHMJLiT/xlH7oyoyvbXQceivptq9TI='
+	}
+	pap.authorize
+	pap.authenticate {
+		invalid = 1
+	}
+	if (invalid) {
+		test_pass
+	} else {
+		test_fail
+	}
+}
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_passlib.attrs freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_passlib.attrs
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_passlib.attrs	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_passlib.attrs	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,10 @@
+#
+#  Input packet
+#
+User-Name = 'pbkdf2_passlib'
+User-Password = 'password'
+
+#
+#  Expected answer
+#
+Response-Packet-Type == Access-Accept
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_passlib.unlang freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_passlib.unlang
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_passlib.unlang	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_passlib.unlang	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,20 @@
+# Fixme - Base64 decode seems off for alt base64
+test_pass
+
+#if ("${feature.tls}" == no) {
+#	test_pass
+#	return
+#}
+
+#if (&User-Name == 'pbkdf2_passlib') {
+#	update control {
+#		&PBKDF2-Password := '$pbkdf2-sha256$29000$9t7be09prfXee2/NOUeotQ$Y.RDnnq8vsezSZSKy1QNy6xhKPdoBIwc.0XDdRm9sJ8'
+#	}
+#	pap.authorize
+#	pap.authenticate
+#	if (!ok) {
+#		test_fail
+#	} else {
+#		test_pass
+#	}
+#}
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_salt0.attrs freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_salt0.attrs
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_salt0.attrs	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_salt0.attrs	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,10 @@
+#
+#  Input packet
+#
+User-Name = 'pbkdf2_salt0'
+User-Password = 'password'
+
+#
+#  Expected answer
+#
+Response-Packet-Type == Access-Accept
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_salt0.unlang freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_salt0.unlang
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_salt0.unlang	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_salt0.unlang	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,19 @@
+if ("${feature.tls}" == no) {
+	test_pass
+	return
+}
+
+if (&User-Name == 'pbkdf2_salt0') {
+	update control {
+		&PBKDF2-Password := 'HMACSHA2+256:AAAnEA::4RJEKVFQ5nE8126aURI0cJO9tqy/DIAhq64piBEwshA='
+	}
+	pap.authorize
+	pap.authenticate {
+		invalid = 1
+	}
+	if (invalid) {
+		test_pass
+	} else {
+		test_fail
+	}
+}
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_salt1.attrs freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_salt1.attrs
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_salt1.attrs	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_salt1.attrs	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,10 @@
+#
+#  Input packet
+#
+User-Name = 'pbkdf2_salt1'
+User-Password = 'password'
+
+#
+#  Expected answer
+#
+Response-Packet-Type == Access-Accept
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_salt1.unlang freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_salt1.unlang
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_salt1.unlang	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_salt1.unlang	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,17 @@
+if ("${feature.tls}" == no) {
+	test_pass
+	return
+}
+
+if (&User-Name == 'pbkdf2_salt1') {
+	update control {
+		&PBKDF2-Password := 'HMACSHA2+256:AAAnEA:qg==:KQzCdedgOZYFwx+mQp1TKA8VM4fwf02pqSdJEh2ekwM='
+	}
+	pap.authorize
+	pap.authenticate
+	if (!ok) {
+		test_fail
+	} else {
+		test_pass
+	}
+}
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_salt1024.attrs freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_salt1024.attrs
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_salt1024.attrs	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_salt1024.attrs	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,10 @@
+#
+#  Input packet
+#
+User-Name = 'pbkdf2_salt1024'
+User-Password = 'password'
+
+#
+#  Expected answer
+#
+Response-Packet-Type == Access-Accept
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_salt1024.unlang freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_salt1024.unlang
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_salt1024.unlang	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_salt1024.unlang	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,17 @@
+if ("${feature.tls}" == no) {
+	test_pass
+	return
+}
+
+if (&User-Name == 'pbkdf2_salt1024') {
+	update control {
+		&PBKDF2-Password := 'HMACSHA2+256:AAAnEA:/IUrkJKe+1kzJNBw7aAMbnQuSFZpjbCqPeKso3cbuSUzWinxngxjK8yyZLiWwF+WE/0Gplfx25zZEQNTdRTvjZZNefoxQBR8Hht0FpdU9YiEBaeErwVo63EDEu83+ycvB18uH0IXpJKGSSkIPRfGpHT3BkwJDGo5SqjRJadDsyQzkc/WJCMrrfJ0igaWMxb5eR5J8qfXIjBFepRrOOU6acZGtANW8qvDYLJwN+TMd9Jb1wDDY14eoAlKglTF21S3kewNMkDDyeP+oDYv29t1S/soFUnnB+Pb5IdR6pDy2VDGx4jFZMQGshSHWTYQFqgulavS/tGEF8TvzcorrJZKuksAjKdTSmfZ6j4aBY3U+oMSQ+2lO131pkNfNQuMsDfr72r9wUA2xRgUiL/J7CgKn7mamL2OCaksl0Rw2PGqqIaHvAYS6Q1EoIzsmLNrWBYYqTRLyCGZw6+hUOahYRon2lglGmnuWHPfowU+LgcaR5gF1QjvTXhXQ8I39mB3ePgdi+7TUn644Z1FB+JTqGJbue92x4V40Zyyy+Qdt52QsR49iYokbKAwQRiqfVJ7J8NzCY/kIQnqT9RE0NCxZoMBRzboZxVPchxdpmWGQ9dXP06PqIuDCFFiJlVQUfyPMgOAxIlVJ/9NAmj5MWFdWMrmlBNDx9ihEV1FdTv23iFZH5Ejg+x4D3qN5oOyCDL2i9lobzFXh5z4EDpbbogQaFkUzqKEaxRGPBrfYVOi6XXYujVUnxHJaRxbs2UqjpJNsXMg8f7P78aRvOKCIbW70CHWlt7nF0pA5+kFUQRLXKuq7bW+ivoXKeDW5o4FVP3+Pcr67+DOsUXuehALLj9Mu2ICWlMIV/AWcM2szaqk1bwSo7bAeG4RtDKmNjGA7gpnT+w2x+/qS1eWbc832Sumqc1IA8aY6HNVDPsJZf99To4BR+N0rCoQQ/KIZybI31mQagR3+FR9yNzqWzKIl+qf69RTc1CbUCkKVF8pxWZ0ocP+CAdoKadgpdF8evQIiGcUD73HiJ0RsDWo21y0tN0P5jfzWo3WMhCk9e2wl6o1JAfKw54uHzWJnNlGLBK1LXF+R2m+WvNGBgvUhh4PtYV9gPSudumFdk614oak/Aqcn6xi+YZqOMPkW4WYaiczhHyS7qAyefqKaQkRVYS0Af+79CSjlxZJq57HrD7/1E+d/i0gKmSAbPe80uGHs2a13V3VxztFMBi4xD7zj9Mq7+0goVPD4MNXcR651MZ7vxDRGbvPPmclddZe/nkTEn1YB/909b9mC5P/XzximZYW8gEhBReZouukADRTAjuH8zgSIv6/uyTURnmSVoOumVLBpL7veJIzDm4dZ38BWiasiBnzgMuG9A==:RUoCF5O11OgwLFMTqnKY/yRJy6DYh+yNq4xHZC7COGM='
+	}
+	pap.authorize
+	pap.authenticate
+	if (!ok) {
+		test_fail
+	} else {
+		test_pass
+	}
+}
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_salt64.attrs freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_salt64.attrs
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_salt64.attrs	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_salt64.attrs	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,10 @@
+#
+#  Input packet
+#
+User-Name = 'pbkdf2_salt64'
+User-Password = 'password'
+
+#
+#  Expected answer
+#
+Response-Packet-Type == Access-Accept
\ No newline at end of file
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_salt64.unlang freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_salt64.unlang
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_salt64.unlang	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_salt64.unlang	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,17 @@
+if ("${feature.tls}" == no) {
+	test_pass
+	return
+}
+
+if (&User-Name == 'pbkdf2_salt64') {
+	update control {
+		&PBKDF2-Password := 'HMACSHA2+256:AAAnEA:msGxE1XuC+wlgRr+H4+ioyxZuiN3KYLUSky2FINDTq7KJylKt4XnqloV+FuHGXUbOu1EWcsFp51u2z8wdXVnQQ==:rAV9BeEJH5kt9uZ6pJt0o5pYpN5LQRe4MAYyk2jvjpU='
+	}
+	pap.authorize
+	pap.authenticate
+	if (!ok) {
+		test_fail
+	} else {
+		test_pass
+	}
+}
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_salt_big.attrs freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_salt_big.attrs
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_salt_big.attrs	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_salt_big.attrs	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,10 @@
+#
+#  Input packet
+#
+User-Name = 'pbkdf2_salt_big'
+User-Password = 'password'
+
+#
+#  Expected answer
+#
+Response-Packet-Type == Access-Accept
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_salt_big.unlang freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_salt_big.unlang
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_salt_big.unlang	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_salt_big.unlang	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,17 @@
+if ("${feature.tls}" == no) {
+	test_pass
+	return
+}
+
+if (&User-Name == 'pbkdf2_salt_big') {
+	update control {
+		&PBKDF2-Password := 'HMACSHA2+256:AAAAAQ:E+VXOSsE8RwyYGdygQoW9QA==:pF23EcxNBhJLQ+9JRtd9wQ1Gz+k4i6YjeNZq+7DRBX8='
+	}
+	pap.authorize
+	pap.authenticate
+	if (!ok) {
+		test_fail
+	} else {
+		test_pass
+	}
+}
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_salt_small.attrs freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_salt_small.attrs
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_salt_small.attrs	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_salt_small.attrs	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,10 @@
+#
+#  Input packet
+#
+User-Name = 'pbkdf2_salt_small'
+User-Password = 'password'
+
+#
+#  Expected answer
+#
+Response-Packet-Type == Access-Accept
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_salt_small.unlang freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_salt_small.unlang
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_salt_small.unlang	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_salt_small.unlang	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,17 @@
+if ("${feature.tls}" == no) {
+	test_pass
+	return
+}
+
+if (&User-Name == 'pbkdf2_salt_small') {
+	update control {
+		&PBKDF2-Password := 'HMACSHA2+256:AAAAAQ:E+VXOSsE8RwyYGdygQoW9Q=:UivlvrwHML4VtZHMJLiT/xlH7oyoyvbXQceivptq9TI='
+	}
+	pap.authorize
+	pap.authenticate
+	if (!ok) {
+		test_fail
+	} else {
+		test_pass
+	}
+}
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_sha1.attrs freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_sha1.attrs
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_sha1.attrs	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_sha1.attrs	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,10 @@
+#
+#  Input packet
+#
+User-Name = 'pbkdf2_sha1'
+User-Password = 'password'
+
+#
+#  Expected answer
+#
+Response-Packet-Type == Access-Accept
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_sha1.unlang freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_sha1.unlang
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_sha1.unlang	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_sha1.unlang	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,17 @@
+if ("${feature.tls}" == no) {
+	test_pass
+	return
+}
+
+if (&User-Name == 'pbkdf2_sha1') {
+	update control {
+		&PBKDF2-Password := 'HMACSHA1:AAAD6A:Xw1P133xrwk=:dtQBXQRiR/No5A8Ip3JFGF/qUC0='
+	}
+	pap.authorize
+	pap.authenticate
+	if (!ok) {
+		test_fail
+	} else {
+		test_pass
+	}
+}
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_sha1_389ds.attrs freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_sha1_389ds.attrs
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_sha1_389ds.attrs	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_sha1_389ds.attrs	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,10 @@
+#
+#  Input packet
+#
+User-Name = 'pbkdf2_sha1_389ds'
+User-Password = 'password'
+
+#
+#  Expected answer
+#
+Response-Packet-Type == Access-Accept
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_sha1_389ds.unlang freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_sha1_389ds.unlang
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_sha1_389ds.unlang	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_sha1_389ds.unlang	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,17 @@
+if ("${feature.tls}" == no) {
+	test_pass
+	return
+}
+
+if (User-Name == 'pbkdf2_sha1_389ds') {
+	update control {
+		&PBKDF2-Password := '{PBKDF2-SHA1}10000$13QEHaJHNKHjlJEXX3ddjG2PpUjx1a83$dzrOWMeLso6J/K+evi4eZbOMcOk='
+	}
+	pap.authorize
+	pap.authenticate
+	if (!ok) {
+		test_fail
+	} else {
+		test_pass
+	}
+}
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_sha1_389ds_with_header.attrs freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_sha1_389ds_with_header.attrs
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_sha1_389ds_with_header.attrs	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_sha1_389ds_with_header.attrs	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,10 @@
+#
+#  Input packet
+#
+User-Name = 'pbkdf2_sha1_389ds_with_header'
+User-Password = 'password'
+
+#
+#  Expected answer
+#
+Response-Packet-Type == Access-Accept
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_sha1_389ds_with_header.unlang freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_sha1_389ds_with_header.unlang
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_sha1_389ds_with_header.unlang	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_sha1_389ds_with_header.unlang	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,17 @@
+if ("${feature.tls}" == no) {
+	test_pass
+	return
+}
+
+if (User-Name == 'pbkdf2_sha1_389ds_with_header') {
+	update control {
+		Password-With-Header := '{PBKDF2-SHA1}10000$ooYqHQ0zx2JcxgadlJAVebeCOVYGxwz9$zh5v1+QTaJcRv3yqAuLn7ONN8VE='
+	}
+	pap.authorize
+	pap.authenticate
+	if (!ok) {
+		test_fail
+	} else {
+		test_pass
+	}
+}
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_sha256_389ds.attrs freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_sha256_389ds.attrs
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_sha256_389ds.attrs	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_sha256_389ds.attrs	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,10 @@
+#
+#  Input packet
+#
+User-Name = 'pbkdf2_sha256_389ds'
+User-Password = 'password'
+
+#
+#  Expected answer
+#
+Response-Packet-Type == Access-Accept
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_sha256_389ds.unlang freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_sha256_389ds.unlang
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_sha256_389ds.unlang	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_sha256_389ds.unlang	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,17 @@
+if ("${feature.tls}" == no) {
+	test_pass
+	return
+}
+
+if (User-Name == 'pbkdf2_sha256_389ds') {
+	update control {
+		&PBKDF2-Password := '{PBKDF2-SHA256}10000$9JjBuTTp9OCwANVzqUrq0QUvXnmDUJrm$f8Jrky2bX3z5eQ2SghxA38QSJ2PQwNenecmV4e4Ejyw='
+	}
+	pap.authorize
+	pap.authenticate
+	if (!ok) {
+		test_fail
+	} else {
+		test_pass
+	}
+}
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_sha256_389ds_with_header.attrs freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_sha256_389ds_with_header.attrs
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_sha256_389ds_with_header.attrs	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_sha256_389ds_with_header.attrs	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,10 @@
+#
+#  Input packet
+#
+User-Name = 'pbkdf2_sha256_389ds_with_header'
+User-Password = 'password'
+
+#
+#  Expected answer
+#
+Response-Packet-Type == Access-Accept
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_sha256_389ds_with_header.unlang freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_sha256_389ds_with_header.unlang
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_sha256_389ds_with_header.unlang	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_sha256_389ds_with_header.unlang	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,17 @@
+if ("${feature.tls}" == no) {
+	test_pass
+	return
+}
+
+if (User-Name == 'pbkdf2_sha256_389ds_with_header') {
+	update control {
+		Password-With-Header := '{PBKDF2-SHA256}10000$Y79u61tRN/dthaamikuxU/1PkOSprfbN$stej1qVq0CjglfdkLmwW2C94Hr5WQ20Nj6bIRumMy+E='
+	}
+	pap.authorize
+	pap.authenticate
+	if (!ok) {
+		test_fail
+	} else {
+		test_pass
+	}
+}
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_sha256_legacy_389ds_with_header.attrs freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_sha256_legacy_389ds_with_header.attrs
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_sha256_legacy_389ds_with_header.attrs	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_sha256_legacy_389ds_with_header.attrs	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,10 @@
+#
+#  Input packet
+#
+User-Name = 'pbkdf2_sha256_legacy_389ds_with_header'
+User-Password = 'password'
+
+#
+#  Expected answer
+#
+Response-Packet-Type == Access-Accept
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_sha256_legacy_389ds_with_header.unlang freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_sha256_legacy_389ds_with_header.unlang
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_sha256_legacy_389ds_with_header.unlang	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_sha256_legacy_389ds_with_header.unlang	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,17 @@
+if ("${feature.tls}" == no) {
+	test_pass
+	return
+}
+
+if (User-Name == 'pbkdf2_sha256_legacy_389ds_with_header') {
+	update control {
+		Password-With-Header := '{PBKDF2_SHA256}AAAgAC8OScrYDwaJYr29/qoQ/bcEf+WsQmkZjIFLSIKm1lxzNOSGPQEkueb1J5mWQy8a17m+UAM5jFKKuktMWSTDag9LNVfHTwHocrIsi4GGLf+PSn/eA3+lu5JHVXQo49gbZ+SALQ90cOvor+v+/xa4Q1VPUr42PuvmsdQln6i9jm/j9tVkO06W+CJXvTiCpR+oHiog9v/3s6bHUrWvwNksUe2r2d+MV5IaNdnil7P39qr1BxiKtDiG4d6HyI5aq1VEhJBg6S5ITYQ9iPlDbpoy2MHDLZHNqQduAVnwJuKuHVU3dU+VkynHWm3nGa2hfeV/bD8F8+WYehgL7bJndEzECx1QKuAZO+lK92vIMbZArdMvU6WRjncVlgoJbZtko6tFp1Ew+0VMVX+b6dGED0L391crdsudrTO+/fvU66xH515L'
+	}
+	pap.authorize
+	pap.authenticate
+	if (!ok) {
+		test_fail
+	} else {
+		test_pass
+	}
+}
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_sha2_224.attrs freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_sha2_224.attrs
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_sha2_224.attrs	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_sha2_224.attrs	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,10 @@
+#
+#  Input packet
+#
+User-Name = 'pbkdf2_sha2_224'
+User-Password = 'password'
+
+#
+#  Expected answer
+#
+Response-Packet-Type == Access-Accept
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_sha2_224.unlang freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_sha2_224.unlang
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_sha2_224.unlang	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_sha2_224.unlang	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,17 @@
+if ("${feature.tls}" == no) {
+	test_pass
+	return
+}
+
+if (&User-Name == 'pbkdf2_sha2_224') {
+	update control {
+		&PBKDF2-Password := 'HMACSHA2+224:AAAnEA:UHScBrg/ZWOyBKqQdAh7bw==:tcFp6CDrkIYdhwa60g24U4ko+mBxzAiFxlpPnA=='
+	}
+	pap.authorize
+	pap.authenticate
+	if (!ok) {
+		test_fail
+	} else {
+		test_pass
+	}
+}
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_sha2_256.attrs freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_sha2_256.attrs
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_sha2_256.attrs	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_sha2_256.attrs	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,10 @@
+#
+#  Input packet
+#
+User-Name = 'pbkdf2_sha2_256'
+User-Password = 'password'
+
+#
+#  Expected answer
+#
+Response-Packet-Type == Access-Accept
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_sha2_256.unlang freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_sha2_256.unlang
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_sha2_256.unlang	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_sha2_256.unlang	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,17 @@
+if ("${feature.tls}" == no) {
+	test_pass
+	return
+}
+
+if (&User-Name == 'pbkdf2_sha2_256') {
+	update control {
+		&PBKDF2-Password := 'HMACSHA2+256:AAAnEA:a/8HbYW2HWsMthN27JI+Ew==:3nPlXYOlOuDCFOfethUomHxTXkG9JCivOdvh6FDNdGw='
+	}
+	pap.authorize
+	pap.authenticate
+	if (!ok) {
+		test_fail
+	} else {
+		test_pass
+	}
+}
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_sha2_384.attrs freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_sha2_384.attrs
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_sha2_384.attrs	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_sha2_384.attrs	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,10 @@
+#
+#  Input packet
+#
+User-Name = 'pbkdf2_sha2_384'
+User-Password = 'password'
+
+#
+#  Expected answer
+#
+Response-Packet-Type == Access-Accept
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_sha2_384.unlang freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_sha2_384.unlang
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_sha2_384.unlang	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_sha2_384.unlang	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,17 @@
+if ("${feature.tls}" == no) {
+	test_pass
+	return
+}
+
+if (&User-Name == 'pbkdf2_sha2_384') {
+	update control {
+		&PBKDF2-Password := 'HMACSHA2+384:AAAnEA:pyHRsYLfNZdjszRcu6eHrA==:ktGfNmZ6PyD8FNEgPzFK1fypKERZ13pgvFl+PQdyKouaMXsXIiWPuTMXHqDUCWsx'
+	}
+	pap.authorize
+	pap.authenticate
+	if (!ok) {
+		test_fail
+	} else {
+		test_pass
+	}
+}
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_sha2_512.attrs freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_sha2_512.attrs
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_sha2_512.attrs	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_sha2_512.attrs	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,10 @@
+#
+#  Input packet
+#
+User-Name = 'pbkdf2_sha2_512'
+User-Password = 'password'
+
+#
+#  Expected answer
+#
+Response-Packet-Type == Access-Accept
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_sha2_512.unlang freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_sha2_512.unlang
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_sha2_512.unlang	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_sha2_512.unlang	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,17 @@
+if ("${feature.tls}" == no) {
+	test_pass
+	return
+}
+
+if (&User-Name == 'pbkdf2_sha2_512') {
+	update control {
+		&PBKDF2-Password := 'HMACSHA2+512:AAAnEA:TG8Mb94NEmfPLaePwi5CFA==:SYSFeRf9jr4Uo5DB4NvNUEuc1gmEiLjTac5J4WgyKa7mO58KHKWop9xWmcFeuLtUN/iexLTNSgcubOugAyZcog=='
+	}
+	pap.authorize
+	pap.authenticate
+	if (!ok) {
+		test_fail
+	} else {
+		test_pass
+	}
+}
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_sha512_389ds.attrs freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_sha512_389ds.attrs
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_sha512_389ds.attrs	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_sha512_389ds.attrs	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,10 @@
+#
+#  Input packet
+#
+User-Name = 'pbkdf2_sha512_389ds'
+User-Password = 'password'
+
+#
+#  Expected answer
+#
+Response-Packet-Type == Access-Accept
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_sha512_389ds.unlang freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_sha512_389ds.unlang
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_sha512_389ds.unlang	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_sha512_389ds.unlang	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,17 @@
+if ("${feature.tls}" == no) {
+	test_pass
+	return
+}
+
+if (User-Name == 'pbkdf2_sha512_389ds') {
+	update control {
+		&PBKDF2-Password := '{PBKDF2-SHA512}10000$N3A054iTXUWq4pN2r/2WuCdRFn6ZJ1G+$5MlwC7KpKbXvjIuCaMaDKYmXSVwbUsgzmovEx73cmuuuA1Vet3IOnV5Mj7nZhb9Y4VlDfT6XLJt0xJlBGWESjw=='
+	}
+	pap.authorize
+	pap.authenticate
+	if (!ok) {
+		test_fail
+	} else {
+		test_pass
+	}
+}
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_sha512_389ds_with_header.attrs freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_sha512_389ds_with_header.attrs
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_sha512_389ds_with_header.attrs	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_sha512_389ds_with_header.attrs	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,10 @@
+#
+#  Input packet
+#
+User-Name = 'pbkdf2_sha512_389ds_with_header'
+User-Password = 'password'
+
+#
+#  Expected answer
+#
+Response-Packet-Type == Access-Accept
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_sha512_389ds_with_header.unlang freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_sha512_389ds_with_header.unlang
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkdf2_sha512_389ds_with_header.unlang	1970-01-01 07:00:00.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkdf2_sha512_389ds_with_header.unlang	2025-08-20 23:29:15.000000000 +0700
@@ -0,0 +1,17 @@
+if ("${feature.tls}" == no) {
+	test_pass
+	return
+}
+
+if (User-Name == 'pbkdf2_sha512_389ds_with_header') {
+	update control {
+		Password-With-Header := '{PBKDF2-SHA512}10000$N3A054iTXUWq4pN2r/2WuCdRFn6ZJ1G+$5MlwC7KpKbXvjIuCaMaDKYmXSVwbUsgzmovEx73cmuuuA1Vet3IOnV5Mj7nZhb9Y4VlDfT6XLJt0xJlBGWESjw=='
+	}
+	pap.authorize
+	pap.authenticate
+	if (!ok) {
+		test_fail
+	} else {
+		test_pass
+	}
+}
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_dig_big.attrs freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_dig_big.attrs
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_dig_big.attrs	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_dig_big.attrs	1970-01-01 07:00:00.000000000 +0700
@@ -1,11 +0,0 @@
-#
-#  Input packet
-#
-User-Name = 'pbkdf2_dig_big'
-User-Password = 'password'
-
-#
-#  Expected answer
-#
-Response-Packet-Type == Access-Accept
-
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_dig_big.unlang freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_dig_big.unlang
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_dig_big.unlang	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_dig_big.unlang	1970-01-01 07:00:00.000000000 +0700
@@ -1,17 +0,0 @@
-if ("${feature.tls}" == no) {
-	test_pass
-	return
-}
-
-if (&User-Name == 'pbkdf2_dig_big') {
-	update control {
-		&PBKDF2-Password := 'HMACSHA2+256:AAAAAQ:E+VXOSsE8RwyYGdygQoW9Q==:UivlvrwHML4VtZHMJLiT/xlH7oyoyvbXQceivptq9TI='
-	}
-	pap.authorize
-	pap.authenticate
-	if (!ok) {
-		test_fail
-	} else {
-		test_pass
-	}
-}
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_dig_small.attrs freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_dig_small.attrs
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_dig_small.attrs	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_dig_small.attrs	1970-01-01 07:00:00.000000000 +0700
@@ -1,11 +0,0 @@
-#
-#  Input packet
-#
-User-Name = 'pbkdf2_dig_small'
-User-Password = 'password'
-
-#
-#  Expected answer
-#
-Response-Packet-Type == Access-Accept
-
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_dig_small.unlang freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_dig_small.unlang
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_dig_small.unlang	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_dig_small.unlang	1970-01-01 07:00:00.000000000 +0700
@@ -1,17 +0,0 @@
-if ("${feature.tls}" == no) {
-	test_pass
-	return
-}
-
-if (&User-Name == 'pbkdf2_dig_small') {
-	update control {
-		&PBKDF2-Password := 'HMACSHA2+256:AAAAAQ:E+VXOSsE8RwyYGdygQoW9Q==:UivlvrwHML4VtZHMJLiT/xlH7oyoyvbXQceivptq9TI'
-	}
-	pap.authorize
-	pap.authenticate
-	if (!ok) {
-		test_fail
-	} else {
-		test_pass
-	}
-}
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_iter0.attrs freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_iter0.attrs
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_iter0.attrs	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_iter0.attrs	1970-01-01 07:00:00.000000000 +0700
@@ -1,11 +0,0 @@
-#
-#  Input packet
-#
-User-Name = 'pbkdf2_iter0'
-User-Password = 'password'
-
-#
-#  Expected answer
-#
-Response-Packet-Type == Access-Accept
-
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_iter0.unlang freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_iter0.unlang
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_iter0.unlang	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_iter0.unlang	1970-01-01 07:00:00.000000000 +0700
@@ -1,17 +0,0 @@
-if ("${feature.tls}" == no) {
-	test_pass
-	return
-}
-
-if (&User-Name == 'pbkdf2_iter0') {
-	update control {
-		&PBKDF2-Password := 'HMACSHA2+256:AAAAAP:CuNDJ9NimZoP5ljnPNCBUA==:f09zV7dReGg5SIv/EXY9tCL4XQRr5guhL0Q6UXSKI3c='
-	}
-	pap.authorize
-	pap.authenticate
-	if (!ok) {
-		test_fail
-	} else {
-		test_pass
-	}
-}
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_iter1.attrs freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_iter1.attrs
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_iter1.attrs	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_iter1.attrs	1970-01-01 07:00:00.000000000 +0700
@@ -1,11 +0,0 @@
-#
-#  Input packet
-#
-User-Name = 'pbkdf2_iter1'
-User-Password = 'password'
-
-#
-#  Expected answer
-#
-Response-Packet-Type == Access-Accept
-
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_iter1.unlang freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_iter1.unlang
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_iter1.unlang	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_iter1.unlang	1970-01-01 07:00:00.000000000 +0700
@@ -1,17 +0,0 @@
-if ("${feature.tls}" == no) {
-	test_pass
-	return
-}
-
-if (&User-Name == 'pbkdf2_iter1') {
-	update control {
-		&PBKDF2-Password := 'HMACSHA2+256:AAAAAQ:OErtptMl2hOxhQqvNw7sNw==:4KkrgL+3Q9j8KlHPivtApBKRZAjyWjtDWmZEz2UjNko='
-	}
-	pap.authorize
-	pap.authenticate
-	if (!ok) {
-		test_fail
-	} else {
-		test_pass
-	}
-}
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_iter1000.attrs freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_iter1000.attrs
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_iter1000.attrs	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_iter1000.attrs	1970-01-01 07:00:00.000000000 +0700
@@ -1,11 +0,0 @@
-#
-#  Input packet
-#
-User-Name = 'pbkdf2_iter1000'
-User-Password = 'password'
-
-#
-#  Expected answer
-#
-Response-Packet-Type == Access-Accept
-
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_iter1000.unlang freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_iter1000.unlang
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_iter1000.unlang	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_iter1000.unlang	1970-01-01 07:00:00.000000000 +0700
@@ -1,17 +0,0 @@
-if ("${feature.tls}" == no) {
-	test_pass
-	return
-}
-
-if (&User-Name == 'pbkdf2_iter1000') {
-	update control {
-		&PBKDF2-Password := 'HMACSHA2+256:AAAD6A:yhmqoKrtPLY2KYK6cNjnfw==:Y6gkSZEo4TRtlsryHqnGYZhoe2qn5tJ4IUyyVHb/3WU='
-	}
-	pap.authorize
-	pap.authenticate
-	if (!ok) {
-		test_fail
-	} else {
-		test_pass
-	}
-}
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_iter100000.attrs freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_iter100000.attrs
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_iter100000.attrs	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_iter100000.attrs	1970-01-01 07:00:00.000000000 +0700
@@ -1,10 +0,0 @@
-#
-#  Input packet
-#
-User-Name = 'pbkdf2_iter100000'
-User-Password = 'password'
-
-#
-#  Expected answer
-#
-Response-Packet-Type == Access-Accept
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_iter100000.unlang freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_iter100000.unlang
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_iter100000.unlang	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_iter100000.unlang	1970-01-01 07:00:00.000000000 +0700
@@ -1,17 +0,0 @@
-if ("${feature.tls}" == no) {
-	test_pass
-	return
-}
-
-if (&User-Name == 'pbkdf2_iter100000') {
-	update control {
-		&PBKDF2-Password := 'HMACSHA2+256:AA9CQA:fCfnJGMVC1QLtTOPiaSICA==:KCmjMpQ+lokMvyFTl4f4pPJNc0xJq4iHZPdtHa0OEXM='
-	}
-	pap.authorize
-	pap.authenticate
-	if (!ok) {
-		test_fail
-	} else {
-		test_pass
-	}
-}
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_iter_big.attrs freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_iter_big.attrs
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_iter_big.attrs	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_iter_big.attrs	1970-01-01 07:00:00.000000000 +0700
@@ -1,11 +0,0 @@
-#
-#  Input packet
-#
-User-Name = 'pbkdf2_iter_big'
-User-Password = 'password'
-
-#
-#  Expected answer
-#
-Response-Packet-Type == Access-Accept
-
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_iter_big.unlang freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_iter_big.unlang
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_iter_big.unlang	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_iter_big.unlang	1970-01-01 07:00:00.000000000 +0700
@@ -1,17 +0,0 @@
-if ("${feature.tls}" == no) {
-	test_pass
-	return
-}
-
-if (&User-Name == 'pbkdf2_iter_big') {
-	update control {
-		&PBKDF2-Password := 'HMACSHA2+256:AAAAAQ==:E+VXOSsE8RwyYGdygQoW9Q==:UivlvrwHML4VtZHMJLiT/xlH7oyoyvbXQceivptq9TI='
-	}
-	pap.authorize
-	pap.authenticate
-	if (!ok) {
-		test_fail
-	} else {
-		test_pass
-	}
-}
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_iter_miss.attrs freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_iter_miss.attrs
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_iter_miss.attrs	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_iter_miss.attrs	1970-01-01 07:00:00.000000000 +0700
@@ -1,11 +0,0 @@
-#
-#  Input packet
-#
-User-Name = 'pbkdf2_iter_miss'
-User-Password = 'password'
-
-#
-#  Expected answer
-#
-Response-Packet-Type == Access-Accept
-
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_iter_miss.unlang freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_iter_miss.unlang
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_iter_miss.unlang	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_iter_miss.unlang	1970-01-01 07:00:00.000000000 +0700
@@ -1,19 +0,0 @@
-if ("${feature.tls}" == no) {
-	test_pass
-	return
-}
-
-if (&User-Name == 'pbkdf2_iter_miss') {
-	update control {
-		&PBKDF2-Password := 'HMACSHA2+256::E+VXOSsE8RwyYGdygQoW9Q==:UivlvrwHML4VtZHMJLiT/xlH7oyoyvbXQceivptq9TI='
-	}
-	pap.authorize
-	pap.authenticate {
-		invalid = 1
-	}
-	if (invalid) {
-		test_pass
-	} else {
-		test_fail
-	}
-}
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_iter_small.attrs freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_iter_small.attrs
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_iter_small.attrs	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_iter_small.attrs	1970-01-01 07:00:00.000000000 +0700
@@ -1,11 +0,0 @@
-#
-#  Input packet
-#
-User-Name = 'pbkdf2_iter_small'
-User-Password = 'password'
-
-#
-#  Expected answer
-#
-Response-Packet-Type == Access-Accept
-
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_iter_small.unlang freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_iter_small.unlang
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_iter_small.unlang	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_iter_small.unlang	1970-01-01 07:00:00.000000000 +0700
@@ -1,19 +0,0 @@
-if ("${feature.tls}" == no) {
-	test_pass
-	return
-}
-
-if (&User-Name == 'pbkdf2_iter_small') {
-	update control {
-		&PBKDF2-Password := 'HMACSHA2+256:AAAAA:E+VXOSsE8RwyYGdygQoW9Q==:UivlvrwHML4VtZHMJLiT/xlH7oyoyvbXQceivptq9TI='
-	}
-	pap.authorize
-	pap.authenticate {
-		invalid = 1
-	}
-	if (invalid) {
-		test_pass
-	} else {
-		test_fail
-	}
-}
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_passlib.attrs freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_passlib.attrs
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_passlib.attrs	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_passlib.attrs	1970-01-01 07:00:00.000000000 +0700
@@ -1,10 +0,0 @@
-#
-#  Input packet
-#
-User-Name = 'pbkdf2_passlib'
-User-Password = 'password'
-
-#
-#  Expected answer
-#
-Response-Packet-Type == Access-Accept
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_passlib.unlang freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_passlib.unlang
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_passlib.unlang	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_passlib.unlang	1970-01-01 07:00:00.000000000 +0700
@@ -1,20 +0,0 @@
-# Fixme - Base64 decode seems off for alt base64
-test_pass
-
-#if ("${feature.tls}" == no) {
-#	test_pass
-#	return
-#}
-
-#if (&User-Name == 'pbkdf2_passlib') {
-#	update control {
-#		&PBKDF2-Password := '$pbkdf2-sha256$29000$9t7be09prfXee2/NOUeotQ$Y.RDnnq8vsezSZSKy1QNy6xhKPdoBIwc.0XDdRm9sJ8'
-#	}
-#	pap.authorize
-#	pap.authenticate
-#	if (!ok) {
-#		test_fail
-#	} else {
-#		test_pass
-#	}
-#}
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_salt0.attrs freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_salt0.attrs
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_salt0.attrs	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_salt0.attrs	1970-01-01 07:00:00.000000000 +0700
@@ -1,10 +0,0 @@
-#
-#  Input packet
-#
-User-Name = 'pbkdf2_salt0'
-User-Password = 'password'
-
-#
-#  Expected answer
-#
-Response-Packet-Type == Access-Accept
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_salt0.unlang freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_salt0.unlang
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_salt0.unlang	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_salt0.unlang	1970-01-01 07:00:00.000000000 +0700
@@ -1,19 +0,0 @@
-if ("${feature.tls}" == no) {
-	test_pass
-	return
-}
-
-if (&User-Name == 'pbkdf2_salt0') {
-	update control {
-		&PBKDF2-Password := 'HMACSHA2+256:AAAnEA::4RJEKVFQ5nE8126aURI0cJO9tqy/DIAhq64piBEwshA='
-	}
-	pap.authorize
-	pap.authenticate {
-		invalid = 1
-	}
-	if (invalid) {
-		test_pass
-	} else {
-		test_fail
-	}
-}
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_salt1.attrs freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_salt1.attrs
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_salt1.attrs	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_salt1.attrs	1970-01-01 07:00:00.000000000 +0700
@@ -1,10 +0,0 @@
-#
-#  Input packet
-#
-User-Name = 'pbkdf2_salt1'
-User-Password = 'password'
-
-#
-#  Expected answer
-#
-Response-Packet-Type == Access-Accept
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_salt1.unlang freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_salt1.unlang
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_salt1.unlang	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_salt1.unlang	1970-01-01 07:00:00.000000000 +0700
@@ -1,17 +0,0 @@
-if ("${feature.tls}" == no) {
-	test_pass
-	return
-}
-
-if (&User-Name == 'pbkdf2_salt1') {
-	update control {
-		&PBKDF2-Password := 'HMACSHA2+256:AAAnEA:qg==:KQzCdedgOZYFwx+mQp1TKA8VM4fwf02pqSdJEh2ekwM='
-	}
-	pap.authorize
-	pap.authenticate
-	if (!ok) {
-		test_fail
-	} else {
-		test_pass
-	}
-}
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_salt1024.attrs freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_salt1024.attrs
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_salt1024.attrs	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_salt1024.attrs	1970-01-01 07:00:00.000000000 +0700
@@ -1,10 +0,0 @@
-#
-#  Input packet
-#
-User-Name = 'pbkdf2_salt1024'
-User-Password = 'password'
-
-#
-#  Expected answer
-#
-Response-Packet-Type == Access-Accept
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_salt1024.unlang freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_salt1024.unlang
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_salt1024.unlang	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_salt1024.unlang	1970-01-01 07:00:00.000000000 +0700
@@ -1,17 +0,0 @@
-if ("${feature.tls}" == no) {
-	test_pass
-	return
-}
-
-if (&User-Name == 'pbkdf2_salt1024') {
-	update control {
-		&PBKDF2-Password := 'HMACSHA2+256:AAAnEA:/IUrkJKe+1kzJNBw7aAMbnQuSFZpjbCqPeKso3cbuSUzWinxngxjK8yyZLiWwF+WE/0Gplfx25zZEQNTdRTvjZZNefoxQBR8Hht0FpdU9YiEBaeErwVo63EDEu83+ycvB18uH0IXpJKGSSkIPRfGpHT3BkwJDGo5SqjRJadDsyQzkc/WJCMrrfJ0igaWMxb5eR5J8qfXIjBFepRrOOU6acZGtANW8qvDYLJwN+TMd9Jb1wDDY14eoAlKglTF21S3kewNMkDDyeP+oDYv29t1S/soFUnnB+Pb5IdR6pDy2VDGx4jFZMQGshSHWTYQFqgulavS/tGEF8TvzcorrJZKuksAjKdTSmfZ6j4aBY3U+oMSQ+2lO131pkNfNQuMsDfr72r9wUA2xRgUiL/J7CgKn7mamL2OCaksl0Rw2PGqqIaHvAYS6Q1EoIzsmLNrWBYYqTRLyCGZw6+hUOahYRon2lglGmnuWHPfowU+LgcaR5gF1QjvTXhXQ8I39mB3ePgdi+7TUn644Z1FB+JTqGJbue92x4V40Zyyy+Qdt52QsR49iYokbKAwQRiqfVJ7J8NzCY/kIQnqT9RE0NCxZoMBRzboZxVPchxdpmWGQ9dXP06PqIuDCFFiJlVQUfyPMgOAxIlVJ/9NAmj5MWFdWMrmlBNDx9ihEV1FdTv23iFZH5Ejg+x4D3qN5oOyCDL2i9lobzFXh5z4EDpbbogQaFkUzqKEaxRGPBrfYVOi6XXYujVUnxHJaRxbs2UqjpJNsXMg8f7P78aRvOKCIbW70CHWlt7nF0pA5+kFUQRLXKuq7bW+ivoXKeDW5o4FVP3+Pcr67+DOsUXuehALLj9Mu2ICWlMIV/AWcM2szaqk1bwSo7bAeG4RtDKmNjGA7gpnT+w2x+/qS1eWbc832Sumqc1IA8aY6HNVDPsJZf99To4BR+N0rCoQQ/KIZybI31mQagR3+FR9yNzqWzKIl+qf69RTc1CbUCkKVF8pxWZ0ocP+CAdoKadgpdF8evQIiGcUD73HiJ0RsDWo21y0tN0P5jfzWo3WMhCk9e2wl6o1JAfKw54uHzWJnNlGLBK1LXF+R2m+WvNGBgvUhh4PtYV9gPSudumFdk614oak/Aqcn6xi+YZqOMPkW4WYaiczhHyS7qAyefqKaQkRVYS0Af+79CSjlxZJq57HrD7/1E+d/i0gKmSAbPe80uGHs2a13V3VxztFMBi4xD7zj9Mq7+0goVPD4MNXcR651MZ7vxDRGbvPPmclddZe/nkTEn1YB/909b9mC5P/XzximZYW8gEhBReZouukADRTAjuH8zgSIv6/uyTURnmSVoOumVLBpL7veJIzDm4dZ38BWiasiBnzgMuG9A==:RUoCF5O11OgwLFMTqnKY/yRJy6DYh+yNq4xHZC7COGM='
-	}
-	pap.authorize
-	pap.authenticate
-	if (!ok) {
-		test_fail
-	} else {
-		test_pass
-	}
-}
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_salt64.attrs freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_salt64.attrs
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_salt64.attrs	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_salt64.attrs	1970-01-01 07:00:00.000000000 +0700
@@ -1,10 +0,0 @@
-#
-#  Input packet
-#
-User-Name = 'pbkdf2_salt64'
-User-Password = 'password'
-
-#
-#  Expected answer
-#
-Response-Packet-Type == Access-Accept
\ No newline at end of file
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_salt64.unlang freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_salt64.unlang
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_salt64.unlang	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_salt64.unlang	1970-01-01 07:00:00.000000000 +0700
@@ -1,17 +0,0 @@
-if ("${feature.tls}" == no) {
-	test_pass
-	return
-}
-
-if (&User-Name == 'pbkdf2_salt64') {
-	update control {
-		&PBKDF2-Password := 'HMACSHA2+256:AAAnEA:msGxE1XuC+wlgRr+H4+ioyxZuiN3KYLUSky2FINDTq7KJylKt4XnqloV+FuHGXUbOu1EWcsFp51u2z8wdXVnQQ==:rAV9BeEJH5kt9uZ6pJt0o5pYpN5LQRe4MAYyk2jvjpU='
-	}
-	pap.authorize
-	pap.authenticate
-	if (!ok) {
-		test_fail
-	} else {
-		test_pass
-	}
-}
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_salt_big.attrs freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_salt_big.attrs
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_salt_big.attrs	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_salt_big.attrs	1970-01-01 07:00:00.000000000 +0700
@@ -1,10 +0,0 @@
-#
-#  Input packet
-#
-User-Name = 'pbkdf2_salt_big'
-User-Password = 'password'
-
-#
-#  Expected answer
-#
-Response-Packet-Type == Access-Accept
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_salt_big.unlang freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_salt_big.unlang
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_salt_big.unlang	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_salt_big.unlang	1970-01-01 07:00:00.000000000 +0700
@@ -1,17 +0,0 @@
-if ("${feature.tls}" == no) {
-	test_pass
-	return
-}
-
-if (&User-Name == 'pbkdf2_salt_big') {
-	update control {
-		&PBKDF2-Password := 'HMACSHA2+256:AAAAAQ:E+VXOSsE8RwyYGdygQoW9QA==:pF23EcxNBhJLQ+9JRtd9wQ1Gz+k4i6YjeNZq+7DRBX8='
-	}
-	pap.authorize
-	pap.authenticate
-	if (!ok) {
-		test_fail
-	} else {
-		test_pass
-	}
-}
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_salt_small.attrs freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_salt_small.attrs
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_salt_small.attrs	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_salt_small.attrs	1970-01-01 07:00:00.000000000 +0700
@@ -1,10 +0,0 @@
-#
-#  Input packet
-#
-User-Name = 'pbkdf2_salt_small'
-User-Password = 'password'
-
-#
-#  Expected answer
-#
-Response-Packet-Type == Access-Accept
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_salt_small.unlang freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_salt_small.unlang
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_salt_small.unlang	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_salt_small.unlang	1970-01-01 07:00:00.000000000 +0700
@@ -1,17 +0,0 @@
-if ("${feature.tls}" == no) {
-	test_pass
-	return
-}
-
-if (&User-Name == 'pbkdf2_salt_small') {
-	update control {
-		&PBKDF2-Password := 'HMACSHA2+256:AAAAAQ:E+VXOSsE8RwyYGdygQoW9Q=:UivlvrwHML4VtZHMJLiT/xlH7oyoyvbXQceivptq9TI='
-	}
-	pap.authorize
-	pap.authenticate
-	if (!ok) {
-		test_fail
-	} else {
-		test_pass
-	}
-}
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_sha1.attrs freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_sha1.attrs
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_sha1.attrs	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_sha1.attrs	1970-01-01 07:00:00.000000000 +0700
@@ -1,10 +0,0 @@
-#
-#  Input packet
-#
-User-Name = 'pbkdf2_sha1'
-User-Password = 'password'
-
-#
-#  Expected answer
-#
-Response-Packet-Type == Access-Accept
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_sha1.unlang freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_sha1.unlang
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_sha1.unlang	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_sha1.unlang	1970-01-01 07:00:00.000000000 +0700
@@ -1,17 +0,0 @@
-if ("${feature.tls}" == no) {
-	test_pass
-	return
-}
-
-if (&User-Name == 'pbkdf2_sha1') {
-	update control {
-		&PBKDF2-Password := 'HMACSHA1:AAAD6A:Xw1P133xrwk=:dtQBXQRiR/No5A8Ip3JFGF/qUC0='
-	}
-	pap.authorize
-	pap.authenticate
-	if (!ok) {
-		test_fail
-	} else {
-		test_pass
-	}
-}
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_sha2_224.attrs freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_sha2_224.attrs
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_sha2_224.attrs	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_sha2_224.attrs	1970-01-01 07:00:00.000000000 +0700
@@ -1,10 +0,0 @@
-#
-#  Input packet
-#
-User-Name = 'pbkdf2_sha2_224'
-User-Password = 'password'
-
-#
-#  Expected answer
-#
-Response-Packet-Type == Access-Accept
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_sha2_224.unlang freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_sha2_224.unlang
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_sha2_224.unlang	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_sha2_224.unlang	1970-01-01 07:00:00.000000000 +0700
@@ -1,17 +0,0 @@
-if ("${feature.tls}" == no) {
-	test_pass
-	return
-}
-
-if (&User-Name == 'pbkdf2_sha2_224') {
-	update control {
-		&PBKDF2-Password := 'HMACSHA2+224:AAAnEA:UHScBrg/ZWOyBKqQdAh7bw==:tcFp6CDrkIYdhwa60g24U4ko+mBxzAiFxlpPnA=='
-	}
-	pap.authorize
-	pap.authenticate
-	if (!ok) {
-		test_fail
-	} else {
-		test_pass
-	}
-}
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_sha2_256.attrs freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_sha2_256.attrs
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_sha2_256.attrs	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_sha2_256.attrs	1970-01-01 07:00:00.000000000 +0700
@@ -1,10 +0,0 @@
-#
-#  Input packet
-#
-User-Name = 'pbkdf2_sha2_256'
-User-Password = 'password'
-
-#
-#  Expected answer
-#
-Response-Packet-Type == Access-Accept
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_sha2_256.unlang freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_sha2_256.unlang
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_sha2_256.unlang	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_sha2_256.unlang	1970-01-01 07:00:00.000000000 +0700
@@ -1,17 +0,0 @@
-if ("${feature.tls}" == no) {
-	test_pass
-	return
-}
-
-if (&User-Name == 'pbkdf2_sha2_256') {
-	update control {
-		&PBKDF2-Password := 'HMACSHA2+256:AAAnEA:a/8HbYW2HWsMthN27JI+Ew==:3nPlXYOlOuDCFOfethUomHxTXkG9JCivOdvh6FDNdGw='
-	}
-	pap.authorize
-	pap.authenticate
-	if (!ok) {
-		test_fail
-	} else {
-		test_pass
-	}
-}
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_sha2_384.attrs freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_sha2_384.attrs
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_sha2_384.attrs	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_sha2_384.attrs	1970-01-01 07:00:00.000000000 +0700
@@ -1,10 +0,0 @@
-#
-#  Input packet
-#
-User-Name = 'pbkdf2_sha2_384'
-User-Password = 'password'
-
-#
-#  Expected answer
-#
-Response-Packet-Type == Access-Accept
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_sha2_384.unlang freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_sha2_384.unlang
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_sha2_384.unlang	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_sha2_384.unlang	1970-01-01 07:00:00.000000000 +0700
@@ -1,17 +0,0 @@
-if ("${feature.tls}" == no) {
-	test_pass
-	return
-}
-
-if (&User-Name == 'pbkdf2_sha2_384') {
-	update control {
-		&PBKDF2-Password := 'HMACSHA2+384:AAAnEA:pyHRsYLfNZdjszRcu6eHrA==:ktGfNmZ6PyD8FNEgPzFK1fypKERZ13pgvFl+PQdyKouaMXsXIiWPuTMXHqDUCWsx'
-	}
-	pap.authorize
-	pap.authenticate
-	if (!ok) {
-		test_fail
-	} else {
-		test_pass
-	}
-}
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_sha2_512.attrs freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_sha2_512.attrs
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_sha2_512.attrs	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_sha2_512.attrs	1970-01-01 07:00:00.000000000 +0700
@@ -1,10 +0,0 @@
-#
-#  Input packet
-#
-User-Name = 'pbkdf2_sha2_512'
-User-Password = 'password'
-
-#
-#  Expected answer
-#
-Response-Packet-Type == Access-Accept
diff -urpN freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_sha2_512.unlang freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_sha2_512.unlang
--- freeradius-server-3.2.7/src/tests/modules/pap/pbkfd2_sha2_512.unlang	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/pap/pbkfd2_sha2_512.unlang	1970-01-01 07:00:00.000000000 +0700
@@ -1,17 +0,0 @@
-if ("${feature.tls}" == no) {
-	test_pass
-	return
-}
-
-if (&User-Name == 'pbkdf2_sha2_512') {
-	update control {
-		&PBKDF2-Password := 'HMACSHA2+512:AAAnEA:TG8Mb94NEmfPLaePwi5CFA==:SYSFeRf9jr4Uo5DB4NvNUEuc1gmEiLjTac5J4WgyKa7mO58KHKWop9xWmcFeuLtUN/iexLTNSgcubOugAyZcog=='
-	}
-	pap.authorize
-	pap.authenticate
-	if (!ok) {
-		test_fail
-	} else {
-		test_pass
-	}
-}
diff -urpN freeradius-server-3.2.7/src/tests/modules/sql/acct_0_start.unlang freeradius-server-3.2.8/src/tests/modules/sql/acct_0_start.unlang
--- freeradius-server-3.2.7/src/tests/modules/sql/acct_0_start.unlang	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/sql/acct_0_start.unlang	2025-08-20 23:29:15.000000000 +0700
@@ -38,3 +38,9 @@ if (!&Tmp-Integer-0 || (&Tmp-Integer-0 !
 else {
 	test_pass
 }
+
+if (!&control:SQL-Query-Number || (&control:SQL-Query-Number != 1)) {
+	test_fail
+} else {
+	test_pass
+}
diff -urpN freeradius-server-3.2.7/src/tests/modules/sql/acct_update_no_start.unlang freeradius-server-3.2.8/src/tests/modules/sql/acct_update_no_start.unlang
--- freeradius-server-3.2.7/src/tests/modules/sql/acct_update_no_start.unlang	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/sql/acct_update_no_start.unlang	2025-08-20 23:29:15.000000000 +0700
@@ -38,3 +38,9 @@ if (!&Tmp-Integer-0 || (&Tmp-Integer-0 !
 else {
 	test_pass
 }
+
+if (!&control:SQL-Query-Number || (&control:SQL-Query-Number != 2)) {
+	test_fail
+} else {
+	test_pass
+}
diff -urpN freeradius-server-3.2.7/src/tests/modules/sql_mysql/acct_0_start.unlang freeradius-server-3.2.8/src/tests/modules/sql_mysql/acct_0_start.unlang
--- freeradius-server-3.2.7/src/tests/modules/sql_mysql/acct_0_start.unlang	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/sql_mysql/acct_0_start.unlang	2025-08-20 23:29:15.000000000 +0700
@@ -38,3 +38,9 @@ if (!&Tmp-Integer-0 || (&Tmp-Integer-0 !
 else {
 	test_pass
 }
+
+if (!&control:SQL-Query-Number || (&control:SQL-Query-Number != 1)) {
+	test_fail
+} else {
+	test_pass
+}
diff -urpN freeradius-server-3.2.7/src/tests/modules/sql_mysql/acct_update_no_start.unlang freeradius-server-3.2.8/src/tests/modules/sql_mysql/acct_update_no_start.unlang
--- freeradius-server-3.2.7/src/tests/modules/sql_mysql/acct_update_no_start.unlang	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/sql_mysql/acct_update_no_start.unlang	2025-08-20 23:29:15.000000000 +0700
@@ -38,3 +38,9 @@ if (!&Tmp-Integer-0 || (&Tmp-Integer-0 !
 else {
 	test_pass
 }
+
+if (!&control:SQL-Query-Number || (&control:SQL-Query-Number != 2)) {
+	test_fail
+} else {
+	test_pass
+}
diff -urpN freeradius-server-3.2.7/src/tests/modules/sql_mysql/module.conf freeradius-server-3.2.8/src/tests/modules/sql_mysql/module.conf
--- freeradius-server-3.2.7/src/tests/modules/sql_mysql/module.conf	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/sql_mysql/module.conf	2025-08-20 23:29:15.000000000 +0700
@@ -48,6 +48,8 @@ sql {
 	# The group attribute specific to this instance of rlm_sql
 	group_attribute = "SQL-Group"
 
+	record_query_number = yes
+
 	# Read database-specific queries
 	$INCLUDE ${modconfdir}/${.:name}/main/${dialect}/queries.conf
 }
diff -urpN freeradius-server-3.2.7/src/tests/modules/sql_postgresql/acct_0_start.unlang freeradius-server-3.2.8/src/tests/modules/sql_postgresql/acct_0_start.unlang
--- freeradius-server-3.2.7/src/tests/modules/sql_postgresql/acct_0_start.unlang	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/sql_postgresql/acct_0_start.unlang	2025-08-20 23:29:15.000000000 +0700
@@ -38,3 +38,9 @@ if (!&Tmp-Integer-0 || (&Tmp-Integer-0 !
 else {
 	test_pass
 }
+
+if (!&control:SQL-Query-Number || (&control:SQL-Query-Number != 1)) {
+	test_fail
+} else {
+	test_pass
+}
diff -urpN freeradius-server-3.2.7/src/tests/modules/sql_postgresql/acct_update_no_start.unlang freeradius-server-3.2.8/src/tests/modules/sql_postgresql/acct_update_no_start.unlang
--- freeradius-server-3.2.7/src/tests/modules/sql_postgresql/acct_update_no_start.unlang	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/sql_postgresql/acct_update_no_start.unlang	2025-08-20 23:29:15.000000000 +0700
@@ -38,3 +38,9 @@ if (!&Tmp-Integer-0 || (&Tmp-Integer-0 !
 else {
 	test_pass
 }
+
+if (!&control:SQL-Query-Number || (&control:SQL-Query-Number != 2)) {
+	test_fail
+} else {
+	test_pass
+}
diff -urpN freeradius-server-3.2.7/src/tests/modules/sql_postgresql/module.conf freeradius-server-3.2.8/src/tests/modules/sql_postgresql/module.conf
--- freeradius-server-3.2.7/src/tests/modules/sql_postgresql/module.conf	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/sql_postgresql/module.conf	2025-08-20 23:29:15.000000000 +0700
@@ -47,6 +47,8 @@ sql {
 	# The group attribute specific to this instance of rlm_sql
 	group_attribute = "SQL-Group"
 
+	record_query_number = yes
+
 	# Read database-specific queries
 	$INCLUDE ${modconfdir}/${.:name}/main/${dialect}/queries.conf
 }
diff -urpN freeradius-server-3.2.7/src/tests/modules/sql_sqlite/acct_0_start.unlang freeradius-server-3.2.8/src/tests/modules/sql_sqlite/acct_0_start.unlang
--- freeradius-server-3.2.7/src/tests/modules/sql_sqlite/acct_0_start.unlang	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/sql_sqlite/acct_0_start.unlang	2025-08-20 23:29:15.000000000 +0700
@@ -38,3 +38,9 @@ if (!&Tmp-Integer-0 || (&Tmp-Integer-0 !
 else {
 	test_pass
 }
+
+if (!&control:SQL-Query-Number || (&control:SQL-Query-Number != 1)) {
+	test_fail
+} else {
+	test_pass
+}
diff -urpN freeradius-server-3.2.7/src/tests/modules/sql_sqlite/acct_update_no_start.unlang freeradius-server-3.2.8/src/tests/modules/sql_sqlite/acct_update_no_start.unlang
--- freeradius-server-3.2.7/src/tests/modules/sql_sqlite/acct_update_no_start.unlang	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/sql_sqlite/acct_update_no_start.unlang	2025-08-20 23:29:15.000000000 +0700
@@ -38,3 +38,9 @@ if (!&Tmp-Integer-0 || (&Tmp-Integer-0 !
 else {
 	test_pass
 }
+
+if (!&control:SQL-Query-Number || (&control:SQL-Query-Number != 2)) {
+	test_fail
+} else {
+	test_pass
+}
diff -urpN freeradius-server-3.2.7/src/tests/modules/sql_sqlite/module.conf freeradius-server-3.2.8/src/tests/modules/sql_sqlite/module.conf
--- freeradius-server-3.2.7/src/tests/modules/sql_sqlite/module.conf	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/sql_sqlite/module.conf	2025-08-20 23:29:15.000000000 +0700
@@ -47,6 +47,8 @@ sql {
 	# The group attribute specific to this instance of rlm_sql
 	group_attribute = "SQL-Group"
 
+	record_query_number = yes
+
 	# Read database-specific queries
 	$INCLUDE ${modconfdir}/${.:name}/main/${dialect}/queries.conf
 }
diff -urpN freeradius-server-3.2.7/src/tests/modules/test.mk freeradius-server-3.2.8/src/tests/modules/test.mk
--- freeradius-server-3.2.7/src/tests/modules/test.mk	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/src/tests/modules/test.mk	2025-08-20 23:29:15.000000000 +0700
@@ -52,11 +52,11 @@ endef
 $(BUILD_DIR)/tests/modules/%: src/tests/modules/%.unlang $(BUILD_DIR)/tests/modules/%.attrs $(TESTBINDIR)/unittest | build.raddb
 	@mkdir -p $(dir $@)
 	@echo MODULE-TEST $(lastword $(subst /, ,$(dir $@))) $(basename $(notdir $@))
-	@if ! MODULE_TEST_DIR=$(dir $<) MODULE_TEST_UNLANG=$< $(TESTBIN)/unittest -D share -d src/tests/modules/ -i $@.attrs -f $@.attrs -xxx > $@.log 2>&1; then \
+	@if ! LANG=C TZ=UTC MODULE_TEST_DIR=$(dir $<) MODULE_TEST_UNLANG=$< $(TESTBIN)/unittest -D share -d src/tests/modules/ -i $@.attrs -f $@.attrs -xxx > $@.log 2>&1; then \
 		if ! grep ERROR $< 2>&1 > /dev/null; then \
 			cat $@.log; \
 			echo "# $@.log"; \
-			echo MODULE_TEST_DIR=$(dir $<) MODULE_TEST_UNLANG=$< $(TESTBIN)/unittest -D share -d src/tests/modules/ -i $@.attrs -f $@.attrs -xx; \
+			echo LANG=C TZ=UTC MODULE_TEST_DIR=$(dir $<) MODULE_TEST_UNLANG=$< $(TESTBIN)/unittest -D share -d src/tests/modules/ -i $@.attrs -f $@.attrs -xx; \
 			exit 1; \
 		fi; \
 		FOUND=$$(grep ^$< $@.log | head -1 | sed 's/:.*//;s/.*\[//;s/\].*//'); \
@@ -64,7 +64,7 @@ $(BUILD_DIR)/tests/modules/%: src/tests/
 		if [ "$$EXPECTED" != "$$FOUND" ]; then \
 			cat $@.log; \
 			echo "# $@.log"; \
-			echo MODULE_TEST_DIR=$(dir $<) MODULE_TEST_UNLANG=$< $(TESTBIN)/unittest -D share -d src/tests/modules/ -i $@.attrs -f $@.attrs -xx; \
+			echo LANG=C TZ=UTC MODULE_TEST_DIR=$(dir $<) MODULE_TEST_UNLANG=$< $(TESTBIN)/unittest -D share -d src/tests/modules/ -i $@.attrs -f $@.attrs -xx; \
 			exit 1; \
 		fi \
 	fi
diff -urpN freeradius-server-3.2.7/suse/freeradius.spec freeradius-server-3.2.8/suse/freeradius.spec
--- freeradius-server-3.2.7/suse/freeradius.spec	2025-01-31 18:42:21.000000000 +0700
+++ freeradius-server-3.2.8/suse/freeradius.spec	2025-08-20 23:29:15.000000000 +0700
@@ -1,5 +1,5 @@
 Name:         freeradius-server
-Version:      3.2.7
+Version:      3.2.8
 Release:      0
 License:      GPLv2 ; LGPLv2.1
 Group:        Productivity/Networking/Radius/Servers
@@ -9,7 +9,7 @@ Obsoletes:    freeradius < %{version}
 Conflicts:    radiusd-livingston radiusd-cistron icradius
 Url:          http://www.freeradius.org/
 Summary:      Very Highly Configurable Radius Server
-Source:       ftp://ftp.freeradius.org/pub/freeradius/%{name}-%{version}.tar.bz2
+Source:       https://www.freeradius.org/ftp/pub/freeradius/%{name}-%{version}.tar.bz2
 Source90:     %{name}-rpmlintrc
 Source104:    %{name}-tmpfiles.conf
 PreReq:       %{_sbindir}/useradd %{_sbindir}/groupadd
